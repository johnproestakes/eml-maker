var __extends=this&&this.__extends||function(e,n){function r(){this.constructor=e}for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)},EMLMakerAIEngine;!function(e){var n=function(e){function n(){e.apply(this,arguments)}return __extends(n,e),n.prototype.checkEmail=function(){var e=this,n=this.EMLWorkspace;e.reset();var r=n.generateOutputCode();e.when(function(){var e=!1;return["<o:OfficeDocumentSettings","<o:AllowPNG","<o:PixelsPerInch"].forEach(function(n){var t=new RegExp(n,"gi");t.test(r)||(console.log(n),e=!0)}),e}(),function(e,n){n.messages.push(new EMLModule.MessageObject(ErrorType.BestPractice,"Zoom fix code not detected","Your email might not display correctly in MS Outlook on Windows 10 or displays with resolutions set higher than 96 pixels per inch",{id:"zoom-fix-code-not-detected",severity:ErrorSeverity.High,handler:function(){n.overridden.push("custom-zoom-fix-code-not-detected"),e.intelligence.checkEmail()}}))}),e.when(GlobalVars.EmailRegex.test(r),function(e,n){var t,o=[];do t=GlobalVars.EmailRegexGlobal.exec(r),t&&o.push(t[0]);while(t);n.messages.push(new EMLModule.MessageObject(ErrorType.QA,"Confirm correct contact information - Email address"+(o.length>1?"es":""),"Review: "+o.join(", "),{id:"confrim-contact-email-addresses",severity:ErrorSeverity.Medium,handler:function(){n.overridden.push("custom-confrim-contact-email-addresses"),e.intelligence.checkEmail()}}))}),e.when(GlobalVars.TelephoneRegex.test(r),function(e,n){var t,o=[];do t=GlobalVars.TelephoneRegexGlobal.exec(r),t&&o.push(t[0]);while(t);n.messages.push(new EMLModule.MessageObject(ErrorType.QA,"Confirm correct contact information - Telephone Number"+(o.length>1?"s":""),"Review: "+o.join(", "),{id:"confrim-telephone-numbers",severity:ErrorSeverity.Medium,handler:function(){n.overridden.push("custom-confrim-telephone-numbers"),e.intelligence.checkEmail()}}))}),e.when(function(){if(void 0===n.linkData||0==n.linkData.length)return!1;var e=0,r=0,t=[];return n.linkData.forEach(function(n){!n.readOnly&&n.needsTrackingCode()&&/resource|campaign/g.test(n["new"].url)&&(r++,n["new"].searchParams.has("s")&&(e++,t.push(n["new"].searchParams.get("s"))))}),t.sort().filter(function(e,n,r){return!n||e!=r[n-1]}),1==t.length?n.defaultSCode="s="+t[0]:n.defaultSCode="s=email",e<r}(),function(e,n){n.messages.push(new EMLModule.MessageObject(ErrorType.Suggestion,"Want to update s-codes to ["+e._defaultSCode+"]","Push the button to add s-codes to all relevant links in the email below.",{severity:ErrorSeverity.Low,handler:function(e){e.linkData.forEach(function(n){return!(!n.readOnly&&n.needsTrackingCode()&&/resource|campaign/g.test(n["new"].url))||(n["new"].searchParams.append(e._defaultSCode),void n.isLinkComplete())})},ctaLabel:"Add s-code"}))}),e.when(!n.linkData||function(){var e=!1;return!(!n.linkData||0==n.linkData.length)&&(n.linkData.forEach(function(n){n.readOnly||!n["new"].searchParams.has("elqTrack")&&!n["new"].searchParams.has("elqTrackId")||(e=!0)}),e)}(),function(e,n){n.messages.push(new EMLModule.MessageObject(ErrorType.Suggestion,"Want to remove the junk Eloqua query strings?","I can remove those tags for you to clean things up, Eloqua will add them back anyways.",{severity:ErrorSeverity.Low,handler:function(e){e.linkData.forEach(function(e){return!!e.readOnly||(e["new"].searchParams["delete"]("elqTrack"),e["new"].searchParams["delete"]("elqTrackId"),e["new"].searchParams.updateSearchProp(),void e.isLinkComplete())})},ctaLabel:"Remove them"}))});for(var t=0;t<e.messages.length;t++)e.overridden.indexOf(e.messages[t].id)>-1&&(e.messages[t].override=!0),e.messages[t].type==ErrorType.QA&&0==e.messages[t].override&&(e.canContinue=!1)},n}(IntelligenceEngine);e.EmailIntelligence=n}(EMLMakerAIEngine||(EMLMakerAIEngine={}));