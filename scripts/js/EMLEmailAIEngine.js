var __extends=this&&this.__extends||function(e,n){function r(){this.constructor=e}for(var o in n)n.hasOwnProperty(o)&&(e[o]=n[o]);e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)},EMLMakerAIEngine;!function(e){var n=function(e){function n(){e.apply(this,arguments)}return __extends(n,e),n.prototype.checkEmail=function(){var e=this,n=this.EMLWorkspace;e.reset();var r=n.generateOutputCode();e.when(0==n.linkData.length,function(){e.messages.push(new EMLModule.MessageObject(ErrorType.Warn,"Did not find any links","Although you can export your EML without links, if you intended to            include links, you'll want to go back and make sure you've included some.            Adding links to your email campaign or newsletter helps to engage            your audience and drive traffic to your site.",{id:"did-not-find-links",severity:ErrorSeverity.High}))}),e.when(function(){var e=!1;return["<o:OfficeDocumentSettings","<o:AllowPNG","<o:PixelsPerInch"].forEach(function(n){var o=new RegExp(n,"gi");o.test(r)||(console.log(n),e=!0)}),e}(),function(e,n){n.messages.push(new EMLModule.MessageObject(ErrorType.BestPractice,"Zoom fix code not detected","Your email might not display correctly in MS Outlook on Windows 10 or displays with resolutions set higher than 96 pixels per inch",{id:"zoom-fix-code-not-detected",severity:ErrorSeverity.High,handler:function(){n.overridden.push("custom-zoom-fix-code-not-detected"),e.intelligence.checkEmail()}}))}),e.when(GlobalVars.EmailRegex.test(r),function(e,n){var o,t=[];do o=GlobalVars.EmailRegexGlobal.exec(r),o&&t.push(o[0]);while(o);n.messages.push(new EMLModule.MessageObject(ErrorType.QA,"Confirm correct contact information - Email address"+(t.length>1?"es":""),"<em>Review:</em> "+t.join(", "),{id:"confrim-contact-email-addresses",severity:ErrorSeverity.Medium,handler:function(){n.overridden.push("custom-confrim-contact-email-addresses"),e.intelligence.checkEmail()}}))}),e.when(GlobalVars.TelephoneRegex.test(r),function(e,n){var o,t=[];do o=GlobalVars.TelephoneRegexGlobal.exec(r),o&&t.push(o[0]);while(o);n.messages.push(new EMLModule.MessageObject(ErrorType.QA,"Confirm correct contact information - Telephone Number"+(t.length>1?"s":""),"<em>Review:</em> "+t.join(", "),{id:"confrim-telephone-numbers",severity:ErrorSeverity.Medium,handler:function(){n.overridden.push("custom-confrim-telephone-numbers"),e.intelligence.checkEmail()}}))}),e.when(GlobalVars.PreheaderRegexGlobal.test(n.sourceCode),function(e,n){var r="";/\<p\s[^\<]*class=\"preheader\"[^\>]*\>(.*?)?\<\/p\>/gi.test(e.sourceCode)?(r=/\<p\s[^\<]*class=\"preheader\"[^\>]*\>(.*?)?\<\/p\>/gi.exec(e.sourceCode))&&n.messages.push(new EMLModule.MessageObject(ErrorType.Suggestion,"Preheader text found","<em>Preview text:</em> "+r[1],{severity:ErrorSeverity.High})):n.messages.push(new EMLModule.MessageObject(ErrorType.Suggestion,"Preheader code looks broken","This can sometimes mean that the email will not display properly on some devices and email clients. The only fix I can help you with right now, is removing the preheader code from the email.",{severity:ErrorSeverity.High,handler:function(){e.sourceCode=e.sourceCode.replace(/\<p\s[^\<]*class=\"preheader\"[^\>]*\>/gi,""),e.intelligence.checkEmail()},ctaLabel:"Remove code"}))}),e.when(function(){if(void 0===n.linkData||0==n.linkData.length)return!1;var e=0,r=0,o=[];return n.linkData.forEach(function(n){!n.readOnly&&n.needsTrackingCode()&&/resource|campaign/g.test(n["new"].url)&&(r++,n["new"].searchParams.has("s")&&(e++,o.push(n["new"].searchParams.get("s"))))}),o.sort().filter(function(e,n,r){return!n||e!=r[n-1]}),1==o.length?n.defaultSCode="s="+o[0]:n.defaultSCode="s=email",e<r}(),function(e,n){n.messages.push(new EMLModule.MessageObject(ErrorType.Suggestion,"Want to update s-codes to ["+e._defaultSCode+"]","Push the button to add s-codes to all relevant links in the email below.",{severity:ErrorSeverity.Low,handler:function(e){e.linkData.forEach(function(n){return!(!n.readOnly&&n.needsTrackingCode()&&/resource|campaign/g.test(n["new"].url))||(n["new"].searchParams.append(e._defaultSCode),void n.isLinkComplete())})},ctaLabel:"Add s-code"}))}),e.when(!n.linkData||function(){var e=!1;return!(!n.linkData||0==n.linkData.length)&&(n.linkData.forEach(function(n){n.readOnly||!n["new"].searchParams.has("elqTrack")&&!n["new"].searchParams.has("elqTrackId")||(e=!0)}),e)}(),function(e,n){n.messages.push(new EMLModule.MessageObject(ErrorType.Suggestion,"Want to remove the junk Eloqua query strings?","I can remove those tags for you to clean things up, Eloqua will add them back anyways.",{severity:ErrorSeverity.Low,handler:function(e){e.linkData.forEach(function(e){return!!e.readOnly||(e["new"].searchParams["delete"]("elqTrack"),e["new"].searchParams["delete"]("elqTrackId"),e["new"].searchParams.updateSearchProp(),void e.isLinkComplete())})},ctaLabel:"Remove them"}))});for(var o=0;o<e.messages.length;o++)e.overridden.indexOf(e.messages[o].id)>-1&&(e.messages[o].override=!0),e.messages[o].type==ErrorType.QA&&0==e.messages[o].override&&(e.canContinue=!1)},n}(IntelligenceEngine);e.EmailIntelligence=n}(EMLMakerAIEngine||(EMLMakerAIEngine={}));