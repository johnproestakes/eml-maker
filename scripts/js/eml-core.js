function getOfflineVersionNumber(){var e="";if(window.location.search.indexOf("offline_version")){var t=window.location.search.substr(1,window.location.search.length).split("&");t.forEach(function(t){t.indexOf("offline_version=")>-1&&(e=t.substr("offline_version=".length,t.length))})}return e}var ErrorSeverity;!function(e){e[e.High=1]="High",e[e.Medium=2]="Medium",e[e.Low=3]="Low",e[e.Zero=4]="Zero"}(ErrorSeverity||(ErrorSeverity={}));var ErrorType;!function(e){e[e.Fix=1]="Fix",e[e.Warn=2]="Warn",e[e.Suggestion=3]="Suggestion",e[e.QA=4]="QA",e[e.BestPractice=5]="BestPractice"}(ErrorType||(ErrorType={}));var GlobalVars;!function(e){e.landingPagePreferred=/(\.mp4|\.avi|\.mpeg|\.mp3|\.swf|\.mov|\.pdf)/i,e.extDoesNotrequireTrackingCode=/(\.pdf|\.oft|\.ics|\.png|\.jpeg|\.jpg)/i,e.linkEncapsulatedPunctuation=/([\.\?\,\:\*]+)((\n|\r|\s)+)?<\/a>$/,e.RequiresSCodeRegex=/http(.*)optum(.*)\/(campaign|resource)/i,e.RequiresTrackingCodeRegex=RegExp("^http(s)?://(.*?)?optum(.*?)?.co[m.]?"),e.TelephoneRegex=/(\+?\d{1,2}(\s|-|\.))?\(?\d{3}\)?[\s.-]\d{3,}[\s.-]\d{4,}/,e.TelephoneRegexGlobal=/(\+?\d{1,2}(\s|-|\.))?\(?\d{3}\)?[\s.-]\d{3,}[\s.-]\d{4,}/g,e.EmailRegex=/(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))/,e.EmailRegexGlobal=/(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))/g,e.UrlRegex=/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:[\/?#]\S*)?$/i,e.LinkHasTitleTagRegexGlobal=/<a\s([^<]*)title=\"(.*?)\">/gi,e.PreheaderRegexGlobal=/\<p\s[^\<]*class=\"preheader\"[^\>]*\>/gi,e.RequiredTrackingCodeWhitelist=[".pdf",".ics",".oft","optumsurveys.co","healthid.optum.com","learning.optum.com","app.info.optum.com","optum.webex.com","twitter.com","facebook.com","linkedin.com","info.optum"]}(GlobalVars||(GlobalVars={}));var EMLModule;!function(e){var t=function(){function e(e){this.parent=e,this.email="",this.subject="",this.body="",this.parent.isLinkType("mailto")&&this.initEmailEditor()}return e.prototype.has=function(e){return this.updateMailtoObj(),this[e]&&""!==this[e].trim()},e.prototype.isValidEmailAddress=function(){return GlobalVars.EmailRegex.test(this.email)},e.prototype.deinitEmailEditor=function(){this.email="",this.subject="",this.body=""},e.prototype.composeEmail=function(){this.parent["new"].url="mailto:"+this.email;for(var e=["subject","body"],t=0;t<e.length;t++)this[e[t]]&&""!==this[e[t]]?this.parent["new"].searchParams.set(e[t],this[e[t]]):""==this[e[t]]&&this.parent["new"].searchParams["delete"](e[t])},e.prototype.updateMailtoObj=function(){var e=this,t=this.parent["new"].url.substr(7,this.parent["new"].url.length-7),i=t.split("?");this.email=i[0],this.parent["new"].searchParams.updateEntries(),i.length>1?["subject","body"].forEach(function(t){e.parent["new"].searchParams.has(t)&&(e[t]=window.decodeURIComponent(e.parent["new"].searchParams.get(t)))}):(this.subject="",this.body="")},e.prototype.inputOnBlur=function(){this.parent["new"].searchParams.updateEntries(),this.parent["new"].searchParams.updateSearchProp()},e.prototype.openEditor=function(){this.initEmailEditor();var e=this.parent;console.log(e.id-1),e.showMailtoEditor=!0},e.prototype.initEmailEditor=function(){this.updateMailtoObj()},e}();e.MailtoLinkObject=t;var i=function(){function e(e){this.href="",this.search="",this.origin="",this.hash="",this.protocol="",this.url=e,this.searchParams=new r(this)}return e.prototype.prepareExport=function(){},e.prototype.isValid=function(){return GlobalVars.UrlRegex.test(this.url)},e.prototype.contains=function(e){return this.url.indexOf(e)>-1},Object.defineProperty(e.prototype,"url",{get:function(){this.prepareExport();var e=this.origin+this.search+this.hash;return e=e.replace("?undefined","")},set:function(e){this.search="",this.hash="";var t=/^(https?|mailto|ftp)\:/gi;if(t.test(e)){var i=e.match(t);this.protocol=i[0]}if(this.href=e,"#"==e.trim())this.hash="#";else if(e.trim().length>1&&e.indexOf("#")>-1){var r=e.split("#");this.hash="#"+r.pop();var n=r.join("#").split("?");this.origin=n[0],this.search=n.length>0?"?"+n[1]:""}else if(e.indexOf("?")>-1){var n=e.split("?");this.origin=n[0],this.search=n.length>0?"?"+n[1]:""}else this.origin=e},enumerable:!0,configurable:!0}),e}();e.URLObj=i;var r=function(){function e(e){this.parent=e,this.parent.search.length>0?this._entries=this.parent.search.substr(1,this.parent.search.length).split(/\&amp\;|\&/g):this._entries=[]}return Object.defineProperty(e.prototype,"entries",{get:function(){for(var e=[],t=0;t<this._entries.length;t++){var i=this._entries[t].split("=");i.length>1&&(i[1]=decodeURIComponent(i[1])),e.push(i.join("="))}return e},enumerable:!0,configurable:!0}),e.prototype.updateEntries=function(){if(this._entries=[],"?"!==this.parent.search&&this.parent.search.length>1)for(var e=this.parent.search.substr(1,this.parent.search.length).split(/\&amp\;|\&/g),t=0;t<e.length;t++)this._entries.push(e[t])},e.prototype.updateSearchProp=function(){var e=[];if(this._entries.length>0)for(var t=0;t<this._entries.length;t++){var i=this._entries[t].split("=");/[a-z]{1,4}=(.*?:){3,9}/gi.test(this._entries[t])?e.push(this._entries[t]):e.push(i[0]+(i.length>1?"="+encodeURIComponent(decodeURIComponent(i[1])):""))}this.parent.search=e.length>0?"?"+e.join("&"):""},e.prototype.has=function(e){for(var t=new RegExp("^"+e+"=","g"),i=!1,r=0;r<this._entries.length;r++)t.test(this._entries[r])&&(i=!0);return i},e.prototype.get=function(e){for(var t=new RegExp("^"+e+"=","g"),i=!1,r=0;r<this._entries.length;r++)t.test(this._entries[r])&&(i=this._entries[r].split("=").pop());return i},e.prototype.set=function(e,t){for(var i=new RegExp("^"+e+"=","g"),r=!1,n=0;n<this._entries.length;n++)i.test(this._entries[n])&&(this._entries[n]=e+"="+t,r=!0);r||this.append(e+"="+t),this.updateSearchProp()},e.prototype.append=function(e){this._entries.push(e),this.updateSearchProp()},e.prototype.deleteAll=function(){this._entries=[],this.updateSearchProp()},e.prototype.deleteAtIndex=function(e){this._entries.splice(e,1),this.updateSearchProp()},e.prototype["delete"]=function(e){for(var t=0;t<this._entries.length;t++)this._entries[t].substr(0,e.length+1)==e+"="&&this.deleteAtIndex(t)},e}();e.URLObjSearchParams=r;var n=function(){function e(e,t){this.context=t,this._super=e;for(var i=["src","alt","height","width"],r=0,n=i;r<n.length;r++){var s=n[r],o=new RegExp(s+'="([^"].*?)?"',"i");o.test(t)&&(this[s]=t.match(o)[1])}var a=this.width&&parseInt(this.width.toString()),h=this.height&&parseInt(this.height.toString());a&&h||"string"==typeof this.src&&this.preloadImage(this.src)}return e.prototype.preloadImage=function(e){var t=this,i=new Image;i.onload=function(){t.height=i.height,t.width=i.width,console.log(i.height,i.width),i.parentNode.removeChild(i)},i.src=t.src,console.log(i),document.body.appendChild(i)},e.prototype.generateOutput=function(e){var t=this;return e=this.context.indexOf("alt")>-1?e.replace(this.context,function(e){return e.replace(/alt\=\"([^\"].*?)?\"/g,'alt="'+(void 0===t.alt?"":t.alt)+'"')}):e.replace(this.context,function(e){return e.replace("<img",'<img alt="'+(void 0===t.alt?"":t.alt)+'"')})},e}();e.LinkedImage=n;var s=function(){function e(e,i,r){this.__isComplete=!1,this._super=r,this.showQueryStringEditor=!1,this.showMailtoEditor=!1,this.id=0,this.line=e+1,this.context=i,this.queryStrings=[],this.ChangeMonitor=new o(this),this.errors=EMLIntelligence.module("hyperlink").monitor(),this.errors.associateVariable("LinkObject",this),this.whiteListedUrl="~~whitelist~~",this.__locateHref(i),this.__locateLinkedImage(i),this.mailto=new t(this),this.isLinkComplete()}return e.prototype.__locateHref=function(e){var t=/href\=\"([^\"\>]*)\"/g,r=e.match(t);r.length>0&&('href=""'==r[0]?(this["new"]=new i("#"),this.old=new i("#"),this.context=this.context.replace(new RegExp('href=""',"g"),'href="#"')):(this["new"]=new i(r[0].substr(6,r[0].length-7).trim()),this.old=new i(r[0].substr(6,r[0].length-7).trim())))},e.prototype.__locateLinkedImage=function(e){if(/\<img([^>].*?)\>/.test(e)){var t=e.match(/\<img([^>].*?)\>/);t.length>0&&(this.LinkedImage=new n(this,t[0]),this.LinkedImageOld=new n(this,t[0]))}},e.prototype.hasDuplicateQueryStrings=function(){var e=[],t=[];if(this["new"].searchParams.entries.length>0)for(var i=0,r=this["new"].searchParams.entries;i<r.length;i++){var n=r[i],s=n.split("=").shift();t.indexOf(s)>-1&&e.push(s),t.push(s)}return e.length>0&&e},e.prototype.overrideTrackingRequirements=function(){this.whiteListedUrl=this["new"].url},e.prototype.displayFormattedURL=function(){var e=this.context;e=e.replace(/\seml\-id\=\"([0-9]*)\"/,"");var t='href="',i=e.indexOf(t);return e=e.replace(new RegExp('href=""',"g"),'href="#"'),this.LinkedImage&&(e=this.LinkedImage.generateOutput(e)),e=e.substr(0,i)+t+"|||a.href|||"+e.substr(i+(t.length+this.old.url.length),e.length),e=e.replace(new RegExp('"',"g"),"&quot;"),e=e.replace(new RegExp("/","g"),"&#47;"),e=e.replace(new RegExp(">","g"),"&gt;"),e=e.replace(new RegExp("<","g"),"&lt;"),e=e.replace(/([^\s]*?)\=/g,'<span class="attr">$1</span><span class="keyword">=</span>'),e=e.replace(/\&quot\;\&gt\;/g,'&quot;<span class="tag">&gt;</span>'),e=e.replace(/\&\#47\;\&gt\;/g,'<span class="tag">&#47;&gt;</span>'),e=e.replace(/\&quot\;(.*?)\&quot\;/g,'<span class="value">"$1"</span>'),e=e.replace(/\&lt\;([a-z]+\s?)/g,'<span class="tag">&lt;$1</span>'),e=e.replace(/\&lt\;\&\#47\;([a-z]+\s?)\&gt\;/g,'<span class="tag">&lt;&#47;$1&gt;</span>'),e=e.replace(/\n/g,"<br>"),e=e.replace(/\&gt\;/g,'<span class="tag">&gt;</span>'),e=e.replace(/\s{3}/g,"&nbsp;&nbsp;&nbsp"),e=e.replace(/\|\|\|a\.href\|\|\|/g,"<strong>"+(this.hasOwnProperty("deleteOnRender")&&this.deleteOnRender?this.old.url:this["new"].url)+"</strong>")},e.prototype.isLinkComplete=function(){return this._super.intelligence.evaluateRules(),this.errors.evaluateRules(),this.ChangeMonitor.update(),this.__isComplete=this.errors.canContinue,this.hasOwnProperty("deleteOnRender")&&this.deleteOnRender&&(this.__isComplete=!0),this.__isComplete},e.prototype.isLinkType=function(e){var t=!1;switch(e){case"http":"http:"!=this["new"].protocol&&"https:"!=this["new"].protocol||(t=!0);break;case"mailto":"mailto:"==this["new"].protocol&&(t=!0)}return t},e.prototype.hasTrackingCode=function(e){void 0===e&&(e=this["new"].url);var t=/[a-z]{1,4}=(.*?:){3,9}/gi;return t.test(e)},e.prototype.requiresTrackingCode=function(e){var t=!1;if(GlobalVars.RequiresTrackingCodeRegex.test(this["new"].url)){t=!0;for(var i=0;i<GlobalVars.RequiredTrackingCodeWhitelist.length;i++)GlobalVars.RequiredTrackingCodeWhitelist[i]instanceof RegExp?GlobalVars.RequiredTrackingCodeWhitelist[i].test(this["new"].url)&&(t=!1):this["new"].url.indexOf(GlobalVars.RequiredTrackingCodeWhitelist[i])>-1&&(t=!1)}return t},e.prototype.requiresSCode=function(){return!!GlobalVars.RequiresSCodeRegex.test(this["new"].url)},e.prototype.needsTrackingCode=function(){var e=this.requiresTrackingCode();return this.whiteListedUrl!=this["new"].url&&(this.hasTrackingCode()&&(e=!1),e)},e.prototype.updateInput=function(){this.isLinkType("mailto")?this.mailto.updateMailtoObj():this["new"].searchParams.updateEntries(),this.isLinkComplete()},e}();e.LinkObject=s;var o=function(){function e(e){this.visible=!1,this._super=e,this.messages=[]}return e.prototype.compareOldAndNew=function(){var e=["protocol","origin","search","hash"],t=[],i=this._super;return e.forEach(function(e){i.old.hasOwnProperty(e)&&i.old[e]!==i["new"][e]&&t.push(e)}),i.LinkedImage&&i.LinkedImage.alt!==i.LinkedImageOld.alt&&t.push("alt"),t},e.prototype.beforeDidReturnChanges=function(){},e.prototype.afterDidReturnChanges=function(){},e.prototype.update=function(){if(0==this._super.readOnly){var e=[],t=this.compareOldAndNew(),i=this;t.forEach(function(t){e.push(i.articulateChanges(t,{}))}),this.messages=e}},e.prototype.compareSearchStrings=function(e,t){var i={added:[],updated:[],removed:[]};for(var r in e)t.indexOf(e[r])===-1&&i.removed.push(e[r]);for(r in t)e.indexOf(t[r])===-1&&i.added.push(t[r]);var n=function(e,t){for(var i=-1,r=0;r<t.length;r++)e.test(t[r])&&(i=r);return i};for(r in e){var s=new RegExp(e[r].split("=")[0]+"="),o=n(s,i.added);if(o>-1){i.updated.push(i.added[o]);var a=n(s,i.removed);i.removed.splice(a,1),i.added.splice(o,1)}}return i},e.prototype.articulateChanges=function(e,t){if("protocol"==e)return"mailto:"==this._super["new"].protocol?{message:"Changed to mailto link.",data:[]}:{message:(""==this._super.old.protocol?"Updated":"Changed")+" protocol to "+this._super["new"].protocol,data:[]};if("origin"==e)return"mailto:"==this._super["new"].protocol?{message:"Changed mailto link to "+this._super["new"].origin,data:[]}:{message:"Changed link URL to "+this._super["new"].origin,data:[]};if("alt"==e)return""==this._super.LinkedImage.alt?{message:"Removed linked image ALT text",data:[]}:{message:"Updated linked image ALT text to <b>"+this._super.LinkedImage.alt+"</b>",data:[]};if("search"==e){var i=this._super.old.searchParams._entries,r=this._super["new"].searchParams._entries,n=this.compareSearchStrings(i,r),s="",o=this._super;return["updated","added","removed"].forEach(function(e){n[e].length>0&&(s=s+e[0].toUpperCase()+e.substr(1,e.length)+" "+("mailto:"==o["new"].protocol?"parameter":"query string")+(n[e].length>1?"s":"")+": <b>"+n[e].join(", ")+"</b><br>")}),{message:s,data:[]}}return"hash"==e?""==this._super.old.hash?{message:"You added the hash "+this._super["new"].hash,data:[]}:""==this._super["new"].hash?{message:"You removed the hash "+this._super.old.hash,data:[]}:{message:"You changed the hash from "+this._super.old.hash+" to "+this._super["new"].hash,data:[]}:void 0},e}();e.ChangeMonitor=o;var a=function(){function e(e,t){this.overriddenIds=[],void 0===e&&(e=""),void 0===t&&(t="");this.buffer=null,this.scope=t,this.linksView="experimental",this.sourceCode=e,this.workingCode="",this.fileName="eml-maker-untitled",this.linkData=[],this._defaultSCode="s=email",this.header={subject:""},this.messages=[],this.exportForEloqua="Yes",this.__emlHeaders="",this.keyBoardShortcuts=[],this.__allowableHeaderFields={to:{syntax:"To: ",label:"To",instructions:"A list of email addresses separated by commas."},subject:{syntax:"Subject: ",label:"Subject",instructions:""},cc:{syntax:"Cc: ",label:"CC",instructions:"A list of email addresses separated by commas."},replyto:{syntax:"Reply-to: ",label:"Reply to",instructions:"A list of email addresses separated by commas."}},this.headers=["X-Unsent: 1","Mime-Version: 1.0 (Mac OS X Mail 10.1 (3251))","X-Uniform-Type-Identifier: com.apple.mail-draft","Content-Transfer-Encoding: 7bit"],this.intelligence=EMLIntelligence.module("email").monitor(),this.intelligence.associateVariable("EMLWorkspace",this)}return e.prototype.mapLinkObjects=function(e){if(this.linkData.length>0)for(var t=0;t<this.linkData.length;t++)e(this.linkData[t])},e.prototype.composeEML=function(){location.href="#/export-compose-eml"},e.prototype.downloadEml=function(){this.beforeDidDownloadEml();var e=this.__emlHeaders+"\n\n"+this.__removeWhiteSpace(this.__replaceEloquaMergeFields(this.generateOutputCode("oft")));this.fileName=this.__formatFileName(this.fileName),window.saveAs(new Blob([e],{type:"text/html"}),this.fileName+".eml"),this.afterDidDownloadEml()},e.prototype.beforeDidDownloadEml=function(){this.mapLinkObjects(function(e){if(e["new"].searchParams.has("elqTrack")){var t=e["new"].searchParams.entries.indexOf("elqTrack=true");t>-1&&e["new"].searchParams.deleteAtIndex(t)}!e["new"].searchParams.has("s")&&e.requiresSCode()?e["new"].searchParams.append("s=oft"):"email"==e["new"].searchParams.get("s")&&e["new"].searchParams.set("s","oft")}),this.mapLinkObjects(function(e){e.ChangeMonitor.update()})},e.prototype.afterDidDownloadEml=function(){window.ga("send","event","EML","download","EML Export"),location.href="#/export-eml"},e.prototype.downloadCsv=function(){var e="Context,Original URL,Modified URL\n";this.mapLinkObjects(function(t){e+=t.context.replace(/,/g,"(comma)")+","+t.old.url+","+t["new"].url+"\n"}),this.fileName=this.__formatFileName(this.fileName),window.saveAs(new Blob([e],{type:"text/csv"}),this.fileName+"_links.csv"),window.ga("send","event","CSV","download","CSV Export")},e.prototype.downloadHtml=function(){var e=this.beforeDidDownloadHtml(this.generateOutputCode("email"));this.fileName=this.__formatFileName(this.fileName),window.saveAs(new Blob([e],{type:"text/html"}),this.fileName+".html"),this.afterDidDownloadHtml()},e.prototype.beforeDidDownloadHtml=function(e){return e},e.prototype.afterDidDownloadHtml=function(){window.ga("send","event","HTML","download","HTML Export")},e.prototype.exportCodeToHTML=function(){this.beforeDidExportCodeToHTML(),this.outputCode=this.generateOutputCode("email"),this.afterDidExportCodeToHTML()},e.prototype.beforeDidExportCodeToHTML=function(){var e=!1;this.exportForEloqua&&"Yes"==this.exportForEloqua?(window.ga("send","event","HTML","Add Eloqua Tracking","Add Eloqua Tracking"),this.mapLinkObjects(function(t){e=t.whiteListedUrl==t["new"].url,t.isLinkType("mailto")||t["new"].searchParams.has("elqTrack")||/app\.info\.optum\.com/gi.test(t["new"].url)||(t["new"].searchParams.append("elqTrack=true"),e&&(t.whiteListedUrl=t["new"].url))})):this.mapLinkObjects(function(e){if(e["new"].searchParams.has("elqTrack")){var t=e["new"].searchParams.entries.indexOf("elqTrack=true");t>-1&&e["new"].searchParams.deleteAtIndex(t),e.isLinkComplete()}e.ChangeMonitor.update()}),this.mapLinkObjects(function(e){!e["new"].searchParams.has("s")&&e.requiresSCode()?e["new"].searchParams.append("s=email"):e["new"].searchParams.has("s")&&"oft"==e["new"].searchParams.get("s")&&e["new"].searchParams.set("s","email"),e.ChangeMonitor.update()}),this.mapLinkObjects(function(e){e.ChangeMonitor.update()})},e.prototype.afterDidExportCodeToHTML=function(){this.mapLinkObjects(function(e){e.whiteListedUrl==e["new"].url&&window.ga("send","event","Tracking-Optout","override",e["new"].url)}),window.ga("send","event","HTML","view sourcecode","Export/View HTML"),location.href="#/export-html"},e.prototype.setUpShortcutKeys=function(){var e=this;this.keyBoardShortcuts=[],e.keyBoardShortcuts.push(new h(function(e){return(e.ctrlKey||e.metaKey)&&e.shiftKey&&52==e.which},function(){e.scope.$apply(function(){console.log("downloading file"),e.downloadHtml()})},"CTRL + SHIFT + 4","Download HTML")),e.keyBoardShortcuts.push(new h(function(e){return(e.ctrlKey||e.metaKey)&&e.shiftKey&&51==e.which},function(){e.scope.$apply(function(){e.mapLinkObjects(function(e){e.errors.messages.length>0&&(e.errors.messages.forEach(function(e){e.type==ErrorType.Suggestion&&e.ctaHandler()}),e.isLinkComplete())})})},"CTRL + SHIFT + 3","Apply all suggestions")),e.keyBoardShortcuts.push(new h(function(e){return(e.ctrlKey||e.metaKey)&&e.shiftKey&&50==e.which},function(){e.scope.$apply(function(){e.mapLinkObjects(function(e){e.readOnly||!e.requiresSCode()||e["new"].searchParams.has("s")||(e["new"].searchParams.append("s=email"),e.isLinkComplete())})})},"CTRL + SHIFT + 2","Add s=email to all links")),e.keyBoardShortcuts.push(new h(function(e){return(e.ctrlKey||e.metaKey)&&e.shiftKey&&49==e.which},function(){e.scope.$apply(function(){e.mapLinkObjects(function(t){return!!t.readOnly||(t["new"].searchParams["delete"]("o"),t["new"].searchParams["delete"]("oin"),t["new"].searchParams["delete"]("v"),t["new"].searchParams["delete"]("oiex"),t["new"].searchParams["delete"]("elq_mid"),t["new"].searchParams["delete"]("elq_lid"),t["new"].searchParams["delete"]("elqTrack"),t["new"].searchParams["delete"]("elqTrackId"),t["new"].searchParams["delete"]("s"),t["new"].searchParams["delete"]("s3"),t.isLinkComplete(),void e.areLinksComplete())})})},"CTRL + SHIFT + 1","Remove all query strings from email")),document.onkeyup=function(t){for(var i=0,r=e.keyBoardShortcuts;i<r.length;i++){var n=r[i];n.when&&n.when(t)&&n.doThis()}}},e.prototype.replaceSpecialCharacters=function(e){var t={174:["&reg;"],169:["&copy;"],8211:["&ndash;"],8212:["&mdash;"],8220:["&ldquo;"],8221:["&rdquo;"],8216:["&lsquo;"],8217:["&rsquo;"],8482:["&trade;"]};for(var i in t)if(t.hasOwnProperty(i)){var r=new RegExp(String.fromCharCode(parseInt(i)),"g");r.test(e)&&(e=e.replace(r,t[i][0]))}return e},e.prototype.processHtml=function(){if(this.setUpShortcutKeys(),this.linkData=[],this.intelligence.overridden=[],this.intelligence.evaluateRules(),window.scrollTo(0,0),this.workingCode=this.replaceSpecialCharacters(this.sourceCode),this.__emlHeaders=this.__buildHeaders(),"untitled"==this.fileName){var e=/<title>([^<].*?)<\/title>/gi;if(e.test(this.workingCode)){var t=this.workingCode.match(e);t.length>0&&(this.fileName=this.__formatFileName(t[0].replace(e,"$1")))}}var i=this,r=/<a\b[^>]*?>([\r\n]|.)*?<\/a>/gm,n=0;this.workingCode=this.workingCode.replace(r,function(e){return n++,e.replace("<a",'<a eml-id="'+n+'"')}),n=0,this.workingCode=this.workingCode.replace(r,function(e){n++;var t=i.workingCode.substr(0,i.workingCode.indexOf(e)).split("\n").length-1;if(/(href\=\"([^\"\>]*)\"?)/g.test(e)){n++;var r=new s(t,e,i);return r.id=n,r.readOnly=r["new"].contains(".com/e/es.aspx")&&r["new"].contains("~~eloqua"),i.linkData.push(r),"{{EMLMaker_Link:"+n+"}}"}return e}),this.mapLinkObjects(function(e){e.isLinkComplete()}),location.href="#/links"},e.prototype.addNewHeaderField=function(e){this.header[e]=""},e.prototype.removeHeaderField=function(e){delete this.header[e]},e.prototype.isHeaderSelected=function(e){return!this.header.hasOwnProperty(e)||""==this.header},e.prototype.verifyLinkSectionComplete=function(){var e=!1;return!(this.intelligence&&!this.intelligence.canContinue)&&(e=(!this.linkData||0!=this.linkData.length)&&!!this.areLinksComplete())},e.prototype.generateOutputCode=function(e,t){void 0===e&&(e="email"),void 0===t&&(t=!0);var i=this.workingCode;this.mapLinkObjects(function(e){if(e.hasOwnProperty("deleteOnRender")&&e.deleteOnRender)i=i.replace(new RegExp("{{EMLMaker_Link:"+e.id+"}}","gi"),"");else if(e.readOnly){var t=e.context.replace(/eml\-id\=\"[0-9]{1,}\"\s/g,"");i=i.replace(new RegExp("{{EMLMaker_Link:"+e.id+"}}","gi"),t)}else{var r=e.context.indexOf('href="'+e.old.url),n=e.context;n=n.substr(0,r)+'href="'+e["new"].url+n.substr(r+6+e.old.url.length,n.length),e.LinkedImage&&(n=e.LinkedImage.generateOutput(n)),n=n.replace(/\s?eml\-id\=\"[0-9]*\"/g,""),i=i.replace(new RegExp("{{EMLMaker_Link:"+e.id+"}}","gi"),n)}}),i=i.replace(/\<img[^\>].*?\>/gi,function(e){return e.indexOf("alt=")>-1?e:e.replace(/\<img/gi,'<img alt=""')});try{i=i.replace(/<\/a>\n{0,5}(\.|,|\?|!|:|;|\|)/g,"</a>$1")}catch(r){console.log("error merging lines with links that previously had punctuation.")}return i},e.prototype.updateLinksAndExport=function(){return!!this.areLinksComplete()&&(location.href="#/export",window.scrollTo(0,0),!0)},e.prototype.areLinksComplete=function(){var e=!0;return this.mapLinkObjects(function(t){t.__isComplete||(e=!1),t.needsTrackingCode()&&(e=!1)}),e},e.prototype.getLinksSummary=function(){var e={needsTracking:0,invalidUrl:0};return this.mapLinkObjects(function(t){t.needsTrackingCode()&&e.needsTracking++,t.isLinkComplete()&&e.invalidUrl++}),e},e.prototype.importHtmlFromFileDrop=function(e){this.sourceCode.length>0&&(this.sourceCode="");var t=e.dataTransfer.files;if(e.dataTransfer.files.length>1)alert("you can only import one file at at time.");else{var i=new FileReader,r=this;i.onloadend=function(e){var i=e.target.result,n=t[0].name.split("."),s=n.pop().toLowerCase();r.fileName=r.__formatFileName(n.join(".")),"eml"==s?r.sourceCode=r.__stripHtmlAndSubjectFromEML(i):r.sourceCode=i,r.processHtml(),location.href="#/links"},i.readAsText(t[0]),window.ga("send","event","HTML","import","HTML Import File Drop")}},Object.defineProperty(e.prototype,"defaultSCode",{set:function(e){var t=this._defaultSCode;t!==e&&(this._defaultSCode=e,this.mapLinkObjects(function(e){e.isLinkComplete()}))},enumerable:!0,configurable:!0}),e.prototype.__formatFileName=function(e){var t=/[^\w\s-]/g,i=/[-\s]+/g;return e=e.replace(t,"").trim().toLowerCase(),e=e.replace(i,"-")},e.prototype.__replaceEloquaMergeFields=function(e){var t=/<span(%20|\s)class="?eloquaemail"?\s?>(.*?)<\/span>/gi;return e=e.replace(t,"#$2#")},e.prototype.__stripHtmlAndSubjectFromEML=function(e){for(var t=e.split("\n"),i=t.pop(),r=0;r<t.length;r++)t[r].indexOf("Subject:")>-1&&void 0===this.header&&(this.header={});return i},e.prototype.__removeWhiteSpace=function(e){var t=e;return t=t.replace(new RegExp("\n","g")," "),t=t.replace(new RegExp("\t","g")," "),t=t.replace(/\s{2,99999}/g," ")},e.prototype.__buildHeaders=function(){for(var e=[],t=0;t<this.headers.length;t++)e.push(this.headers[t]);var i=this.__getCharsetFromHTML(this.sourceCode);""==i&&(i="charset=UTF-8"),e.push("Content-Type: text/html;\n\t"+i);for(var r in this.header)this.header.hasOwnProperty(r)&&this.__allowableHeaderFields.hasOwnProperty(r)&&e.push(this.__allowableHeaderFields[r].syntax+" "+this.header[r]);return this.__emlHeaders=e.join("\n"),e.join("\n")},e.prototype.__getCharsetFromHTML=function(e){var t=/<meta.*?charset=([^\s"]*)/gi,i="",r=e.match(t);return r&&r.forEach(function(e){var t=e.match(/charset=([^\s"]*)/gi);i=t?t[0]:"charset=UTF-8"}),i},e}();e.EMLWorkspace=a;var h=function(){function e(e,t,i,r){this.when=e,this.doThis=t,this.keys=i,this.description=r}return e}();e.KeyboardShortcut=h}(EMLModule||(EMLModule={}));var IntelligenceAlert=function(){function e(){this.override=!1}return e.prototype.generateGuid=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(e){this._type=e,this.cleanType=ErrorType[e]},enumerable:!0,configurable:!0}),e.prototype.setOverrideStatus=function(e){this.override=e},e}(),EMLMakerIntelligence;!function(e){var t=function(){function e(e,t){this._scope=t,this._monitor=e,this.searchType=this.defaultSearchType()}return e.prototype.setType=function(e){this.searchType=e},e.prototype.defaultSearchType=function(){this._monitor.types;return Object.keys(this._monitor.tabs).length>1?"":this._monitor.tabs[Object.keys(this._monitor.tabs)[0]]},e.prototype.canViewAll=function(){return Object.keys(this._monitor.tabs).length>1},Object.defineProperty(e.prototype,"search",{get:function(){var e=this._monitor.types;return e&&this.searchType in e?{type:this.searchType}:{type:this.defaultSearchType()}},enumerable:!0,configurable:!0}),e}();e.IntelligenceCenter=t;var i=function(){function e(){this.messages=[],this.canContinue=!0,this.cachedResults=[],this.scopes=[]}return e.prototype.__locateScope=function(e){var t=this.scopes.filter(function(t){return t.scope==e});if(0==t.length){var i=new r(e);this.scopes.push(i);return i}return t[0]},e.prototype.readOutRules=function(){this.scopes.forEach(function(e){for(var t=Object.keys(e.rules),i=0;i<t.length;i++);})},e.prototype.module=function(e){var t=this.__locateScope(e);return t},e}();e.IntelligenceEngine=i;var r=function(){function e(e){this.scope=e,this.rules={}}return e.prototype.monitor=function(){return new n(this)},e.prototype.register=function(e,t){return this.rules[e]=t,this},e}();e.IntelligenceModule=r;var n=function(){function e(e){this.rules=e.rules,this.overridden=[],this.variables={IntelligenceMonitor:this},this.reset()}return e.prototype.reset=function(){this.messages=[],this.canContinue=!0},e.prototype.associateVariable=function(e,t){this.variables[e]=t},e.prototype.evaluateRule=function(e){var t;if("object"==typeof e){var i=e[e.length-1],r=e.slice(0,e.length-1),n=this,s=r.map(function(e){return n.variables[e]});try{t=i.apply(null,s)}catch(o){console.error(o)}}else t=e();return t},e.prototype.evaluateRules=function(){this.reset();for(var e=Object.keys(this.rules),t=0,i=e;t<i.length;t++){var r=i[t],n=this.evaluateRule(this.rules[r]),s=!!n.hasOwnProperty("when")&&n.when.apply(null);if(s){var o=new IntelligenceAlert;o.id=void 0===n.id||""==n.id?o.generateGuid():n.id,o.type=void 0===n.type?ErrorType.Warn:n.type,o.severity=void 0===n.severity?ErrorSeverity.Zero:n.severity,o.title=void 0===n.title?"":n.title,o.description=void 0===n.description?"":n.description,o.resource=void 0===n.resource?"":n.resource,o.ctaHandler=n.cta&&n.cta.handler?n.cta.handler:function(){},o.ctaLabel=n.cta&&n.cta.label?n.cta.label:"",o.canContinue=!n.hasOwnProperty("canContinue")||n.canContinue,this.messages.push(o)}}for(var a=0;a<this.messages.length;a++)this.overridden.indexOf(this.messages[a].id)>-1&&(this.messages[a].override=!0),this.messages[a].canContinue||this.messages[a].override||(this.canContinue=!1);this.messages.sort(function(e,t){return e._type>t._type?1:e._type<t._type?-1:0})},Object.defineProperty(e.prototype,"tabs",{get:function(){for(var e={},t=0;t<this.messages.length;t++)e[this.messages[t].cleanType]=this.messages[t].type;return e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"types",{get:function(){for(var e={},t=0;t<this.messages.length;t++)e[this.messages[t].type]=ErrorType[this.messages[t].type];return e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"count",{get:function(){for(var e={},t=0;t<this.messages.length;t++)void 0===e[ErrorType[this.messages[t].type]]&&(e[ErrorType[this.messages[t].type]]=0),e[ErrorType[this.messages[t].type]]++;return e},enumerable:!0,configurable:!0}),e}();e.IntelligenceMonitor=n}(EMLMakerIntelligence||(EMLMakerIntelligence={}));var EMLIntelligence=new EMLMakerIntelligence.IntelligenceEngine,AccessOnlineVersion=function(){function e(e){this.animate=!0,this.status="attempting",this.headline="Checking availability of online version",this.message="If we're able to access the online version, you will be redirected.",void 0===e.success&&(e.success=function(){}),void 0===e.onerror&&(e.onerror=function(){}),window.LOCALHOST=this.isLocalMachine(),window.OFFLINE_VERSION=getOfflineVersionNumber(),window.LOCALHOST?(window.scrollTo(0,0),this.obtainKeyFromServer(e)):(this.status="failed",this.animate=!1,document.title=window.PAGE_TITLE)}return e.prototype.obtainKeyFromServer=function(e){if(this.isLocalMachine()){var t,i,r;window.redirectJsonpCallback=function(t){1==t?(e.success(),console.log("FOUND?"),setTimeout(function(){location.href="http://johnproestakes.github.io/eml-maker?offline_version="+window.CURRENT_VERSION},500)):console.log("not github")},t=document.createElement("script"),i=document.getElementsByTagName("script")[0],t.type="text/javascript",t.onerror=function(){e.onerror()},t.src=this.isLocalMachine()?"http://johnproestakes.github.io/eml-maker/prod/app/canredirect.js":"",setTimeout(function(){i.parentNode.insertBefore(t,r)},2e3),document.title=window.PAGE_TITLE+" (Offline Mode)"}else this.status="failed",this.animate=!1,document.title=window.PAGE_TITLE},e.prototype.getOfflineVersionNumber=function(){var e="";if(window.location.search.indexOf("offline_version")){var t=window.location.search.substr(1,window.location.search.length).split("&");t.forEach(function(t){t.indexOf("offline_version=")>-1&&(e=t.substr("offline_version=".length,t.length))})}return e},e.prototype.isLocalMachine=function(){return location.href.indexOf("johnproestakes.github.io")==-1},e}(),UpdateModule=function(){function e(){if(this.updateVersion=!1,this.updateForced=!1,this.offlineVersion=void 0===window.OFFLINE_VERSION?getOfflineVersionNumber():window.OFFLINE_VERSION,this.onlineVersion=window.CURRENT_VERSION,location.href.indexOf("localhost")>-1&&(window.LOCALHOST=!1),""==window.OFFLINE_VERSION)this.accessingFromOffline=!1;else if(window.OFFLINE_VERSION&&window.LOCALHOST&&(this.accessingFromOffline=!0),
window.OFFLINE_VERSION&&window.OFFLINE_VERSION!==window.CURRENT_VERSION){this.updateVersion=!0;var e=new ApplicationVersion(window.OFFLINE_VERSION),t=new ApplicationVersion(window.CURRENT_VERSION);this.updateForced=e.compareAgainst(t)<=AppVersionDifferenceType.PATCH,console.log("UPDATEFORCED?",this.updateForced,e,t)}}return e.prototype.showMessage=function(){return this.updateVersion&&this.updateForced},e.prototype.showTeaser=function(){return""==this.offlineVersion&&!window.LOCALHOST},e.prototype.forceUpdate=function(e,t){for(var i=e.split("."),r=t.split("."),n=0,s=!1,o=0;o<r.length;o++)r[o]==i[o]&&n++;return n<3&&(s=!0),s},e}(),AppVersionDifferenceType;!function(e){e[e.MAJOR=0]="MAJOR",e[e.MINOR=1]="MINOR",e[e.PATCH=2]="PATCH",e[e.SUBPATCH=3]="SUBPATCH",e[e.NONE=4]="NONE"}(AppVersionDifferenceType||(AppVersionDifferenceType={}));var ApplicationVersion=function(){function e(e){this._version=e,this.versionObject=this._version.split(".").map(function(e){return parseInt(e)})}return e.prototype.compareAgainst=function(e){for(var t=this.versionObject,i=e.versionObject,r=0,n=0;n<4&&t[n]==i[n];n++)r++;return AppVersionDifferenceType[AppVersionDifferenceType[r]]},e}(),SecureGateway=function(){function e(e,t){this.canLogin=!1,this.loginCallback=e,this.loginTimer=null,this.sessionUserEmail="",this.timerDelay=500,this.salt="47dafea9aae3b28ab5c39eb7f7d2c924",this.emailRegex=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,this.sessionIdLocalStorageKey="EMLMaker.emlSessionUID",window.persist_store||(window.persist_store=new window.Persist.Store("EMLMaker"),window.addEventListener("unload",function(){window.persist_store.save()}));location.href="#/login"}return e.prototype.init=function(){var e=this;this.hasSavedSessionId()&&this.isValidEmailAddress(this.sessionId)?(this.sessionUserEmail=this.sessionId,location.href="#/login",this.loginTimer=setTimeout(function(){location.href="#/main",e.setCurrentUser(e.sessionUserEmail)},this.timerDelay)):(location.href="#/login",this.sessionUserEmail=""),window.addEventListener("hashchange",function(){""!=e.sessionUserEmail&&e.hasSavedSessionId()||(location.href="#/login")})},e.prototype.logOut=function(){this.loginAsOther(),this.sessionId="",this.sessionUserEmail="",window.persist_store.remove(this.sessionIdLocalStorageKey),"reload"in location?location.reload():document.location.href=document.location.href},e.prototype.loginAsOther=function(){clearTimeout(this.loginTimer),delete this.loginTimer},e.prototype.sessionUpdateUserEmail=function(){this.errorMessage="",this.isValidEmailAddress(this.sessionUserEmail)?(this.setCurrentUser(this.sessionUserEmail),this.loginCallback(),location.href="#/main"):this.errorMessage="Sorry! You have to enter a valid email address."},e.prototype.hasSavedSessionId=function(){var e=window.persist_store.get(this.sessionIdLocalStorageKey);return e?(this.sessionId=this.decrypt(e),!0):(this.sessionId="",!1)},e.prototype.encrypt=function(e){var t=e+"";return t=t.replace(/./gi,function(e){return String.fromCharCode(e.charCodeAt(0)+1)})},e.prototype.decrypt=function(e){var t=e+"";return t=t.replace(/./gi,function(e){return String.fromCharCode(e.charCodeAt(0)-1)})},e.prototype.setCurrentUser=function(e){var t=window.CryptoJS.MD5(e+this.salt).toString();window.persist_store.set(this.sessionIdLocalStorageKey,this.encrypt(e)),window.ga("set","userId",t)},e.prototype.isValidEmailAddress=function(e){return this.emailRegex.test(e)?(console.log(e,"is valid"),!0):(console.log(e,"is not valid"),!1)},e}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlVwZGF0ZU1vZHVsZS50cyIsIkVNTE1vZHVsZS50cyIsImVtbC1jb3JlLmpzIiwiSW50ZWxsaWdlbmNlRW5naW5lLnRzIiwiVXNlck1hbmFnZW1lbnQudHMiXSwibmFtZXMiOlsiZ2V0T2ZmbGluZVZlcnNpb25OdW1iZXIiLCJvdXRwdXQiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsInNlYXJjaCIsImluZGV4T2YiLCJwYXJhbXMiLCJzdWJzdHIiLCJsZW5ndGgiLCJzcGxpdCIsImZvckVhY2giLCJwYXJhbSIsIkVycm9yU2V2ZXJpdHkiLCJFcnJvclR5cGUiLCJHbG9iYWxWYXJzIiwibGFuZGluZ1BhZ2VQcmVmZXJyZWQiLCJleHREb2VzTm90cmVxdWlyZVRyYWNraW5nQ29kZSIsImxpbmtFbmNhcHN1bGF0ZWRQdW5jdHVhdGlvbiIsIlJlcXVpcmVzU0NvZGVSZWdleCIsIlJlcXVpcmVzVHJhY2tpbmdDb2RlUmVnZXgiLCJSZWdFeHAiLCJUZWxlcGhvbmVSZWdleCIsIlRlbGVwaG9uZVJlZ2V4R2xvYmFsIiwiRW1haWxSZWdleCIsIkVtYWlsUmVnZXhHbG9iYWwiLCJVcmxSZWdleCIsIkxpbmtIYXNUaXRsZVRhZ1JlZ2V4R2xvYmFsIiwiUHJlaGVhZGVyUmVnZXhHbG9iYWwiLCJSZXF1aXJlZFRyYWNraW5nQ29kZVdoaXRlbGlzdCIsIkVNTE1vZHVsZSIsIk1haWx0b0xpbmtPYmplY3QiLCJMaW5rT2JqZWN0IiwidGhpcyIsInBhcmVudCIsImVtYWlsIiwic3ViamVjdCIsImJvZHkiLCJpc0xpbmtUeXBlIiwiaW5pdEVtYWlsRWRpdG9yIiwicHJvdG90eXBlIiwiaGFzIiwib3B0aW9uIiwidXBkYXRlTWFpbHRvT2JqIiwidHJpbSIsImlzVmFsaWRFbWFpbEFkZHJlc3MiLCJ0ZXN0IiwiZGVpbml0RW1haWxFZGl0b3IiLCJjb21wb3NlRW1haWwiLCJ1cmwiLCJvcHRpb25zIiwiaSIsInNlYXJjaFBhcmFtcyIsInNldCIsIl90aGlzIiwiYSIsImIiLCJ1cGRhdGVFbnRyaWVzIiwiZGVjb2RlVVJJQ29tcG9uZW50IiwiZ2V0IiwiaW5wdXRPbkJsdXIiLCJ1cGRhdGVTZWFyY2hQcm9wIiwib3BlbkVkaXRvciIsIkxPIiwiY29uc29sZSIsImxvZyIsImlkIiwic2hvd01haWx0b0VkaXRvciIsIlVSTE9iaiIsImhyZWYiLCJvcmlnaW4iLCJoYXNoIiwicHJvdG9jb2wiLCJVUkxPYmpTZWFyY2hQYXJhbXMiLCJwcmVwYXJlRXhwb3J0IiwiaXNWYWxpZCIsImNvbnRhaW5zIiwic3RyIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJ1IiwicmVwbGFjZSIsInByb3RvY29sVHlwZSIsIm1hdGNoIiwidXJsUGFydHMiLCJwb3AiLCJwYXJ0cyIsImpvaW4iLCJlbnVtZXJhYmxlIiwiY29uZmlndXJhYmxlIiwiX2VudHJpZXMiLCJwdXNoIiwicHJvcHMiLCJwcm9wIiwiZW5jb2RlVVJJQ29tcG9uZW50IiwicmVnZXgiLCJ2YWx1ZSIsImFwcGVuZCIsInZhbHVlUGFpciIsImRlbGV0ZUFsbCIsImRlbGV0ZUF0SW5kZXgiLCJpbmRleCIsInNwbGljZSIsIkxpbmtlZEltYWdlIiwiX3N1cGVyIiwiY29kZSIsImNvbnRleHQiLCJ0YWdzIiwiX2kiLCJ0YWdzXzEiLCJ0YWciLCJoYXNXaWR0aCIsIndpZHRoIiwicGFyc2VJbnQiLCJ0b1N0cmluZyIsImhhc0hlaWdodCIsImhlaWdodCIsInNyYyIsInByZWxvYWRJbWFnZSIsIkxJIiwiaW1nIiwiSW1hZ2UiLCJvbmxvYWQiLCJwYXJlbnROb2RlIiwicmVtb3ZlQ2hpbGQiLCJkb2N1bWVudCIsImFwcGVuZENoaWxkIiwiZ2VuZXJhdGVPdXRwdXQiLCJjb250ZW50IiwiZiIsInVuZGVmaW5lZCIsImFsdCIsImxpbmUiLCJfX2lzQ29tcGxldGUiLCJzaG93UXVlcnlTdHJpbmdFZGl0b3IiLCJxdWVyeVN0cmluZ3MiLCJDaGFuZ2VNb25pdG9yIiwiZXJyb3JzIiwiRU1MSW50ZWxsaWdlbmNlIiwibW9kdWxlIiwibW9uaXRvciIsImFzc29jaWF0ZVZhcmlhYmxlIiwid2hpdGVMaXN0ZWRVcmwiLCJfX2xvY2F0ZUhyZWYiLCJfX2xvY2F0ZUxpbmtlZEltYWdlIiwibWFpbHRvIiwiaXNMaW5rQ29tcGxldGUiLCJyZTIiLCJvbGQiLCJmb3VuZCIsIkxpbmtlZEltYWdlT2xkIiwiaGFzRHVwbGljYXRlUXVlcnlTdHJpbmdzIiwicmVzdWx0IiwidXNlZFN0cmluZ3MiLCJlbnRyaWVzIiwiX2EiLCJzaGlmdCIsIm92ZXJyaWRlVHJhY2tpbmdSZXF1aXJlbWVudHMiLCJkaXNwbGF5Rm9ybWF0dGVkVVJMIiwiZmluZFN0YXJ0Iiwic3RhcnQiLCJoYXNPd25Qcm9wZXJ0eSIsImRlbGV0ZU9uUmVuZGVyIiwiaW50ZWxsaWdlbmNlIiwiZXZhbHVhdGVSdWxlcyIsInVwZGF0ZSIsImNhbkNvbnRpbnVlIiwidHlwZSIsImhhc1RyYWNraW5nQ29kZSIsIm9iaiIsInJlcXVpcmVzVHJhY2tpbmdDb2RlIiwicmVxdWlyZXNTQ29kZSIsIm5lZWRzVHJhY2tpbmdDb2RlIiwidXBkYXRlSW5wdXQiLCJ2aXNpYmxlIiwibWVzc2FnZXMiLCJjb21wYXJlT2xkQW5kTmV3IiwidXJsUGFyYW1zIiwiY2hhbmdlZCIsImJlZm9yZURpZFJldHVybkNoYW5nZXMiLCJhZnRlckRpZFJldHVybkNoYW5nZXMiLCJyZWFkT25seSIsImNoYW5nZXMiLCJDTSIsInNjb3BlIiwiYXJ0aWN1bGF0ZUNoYW5nZXMiLCJjb21wYXJlU2VhcmNoU3RyaW5ncyIsIm9sZFAiLCJuZXdQIiwicGF5bG9hZCIsImFkZGVkIiwidXBkYXRlZCIsInJlbW92ZWQiLCJmaW5kX3BhdHRlcm5faW5BcnJheSIsInBhdHRlcm4iLCJhcnIiLCJ5IiwicmUiLCJvdGhlciIsImFyZ3MiLCJtZXNzYWdlIiwiZGF0YSIsIm9sZFBhcmFtcyIsIm5ld1BhcmFtcyIsInNlYXJjaENoYW5nZXNfMSIsImtleSIsInRvVXBwZXJDYXNlIiwiRU1MV29ya3NwYWNlIiwiaHRtbCIsIiRzY29wZSIsIm92ZXJyaWRkZW5JZHMiLCJidWZmZXIiLCJsaW5rc1ZpZXciLCJzb3VyY2VDb2RlIiwid29ya2luZ0NvZGUiLCJmaWxlTmFtZSIsImxpbmtEYXRhIiwiX2RlZmF1bHRTQ29kZSIsImhlYWRlciIsImV4cG9ydEZvckVsb3F1YSIsIl9fZW1sSGVhZGVycyIsImtleUJvYXJkU2hvcnRjdXRzIiwiX19hbGxvd2FibGVIZWFkZXJGaWVsZHMiLCJ0byIsInN5bnRheCIsImxhYmVsIiwiaW5zdHJ1Y3Rpb25zIiwiY2MiLCJyZXBseXRvIiwiaGVhZGVycyIsIm1hcExpbmtPYmplY3RzIiwiY2FsbGJhY2siLCJjb21wb3NlRU1MIiwiZG93bmxvYWRFbWwiLCJiZWZvcmVEaWREb3dubG9hZEVtbCIsIl9fcmVtb3ZlV2hpdGVTcGFjZSIsIl9fcmVwbGFjZUVsb3F1YU1lcmdlRmllbGRzIiwiZ2VuZXJhdGVPdXRwdXRDb2RlIiwiX19mb3JtYXRGaWxlTmFtZSIsInNhdmVBcyIsIkJsb2IiLCJhZnRlckRpZERvd25sb2FkRW1sIiwiZ2EiLCJkb3dubG9hZENzdiIsImRvd25sb2FkSHRtbCIsImJlZm9yZURpZERvd25sb2FkSHRtbCIsImFmdGVyRGlkRG93bmxvYWRIdG1sIiwiZXhwb3J0Q29kZVRvSFRNTCIsImJlZm9yZURpZEV4cG9ydENvZGVUb0hUTUwiLCJvdXRwdXRDb2RlIiwiYWZ0ZXJEaWRFeHBvcnRDb2RlVG9IVE1MIiwidHJhY2tpbmdPcHRPdXQiLCJzZXRVcFNob3J0Y3V0S2V5cyIsIktleWJvYXJkU2hvcnRjdXQiLCJlIiwiY3RybEtleSIsIm1ldGFLZXkiLCJzaGlmdEtleSIsIndoaWNoIiwiJGFwcGx5IiwiTWVzc2FnZU9iamVjdCIsIlN1Z2dlc3Rpb24iLCJjdGFIYW5kbGVyIiwiYXJlTGlua3NDb21wbGV0ZSIsIm9ua2V5dXAiLCJzaG9ydGN1dCIsIndoZW4iLCJkb1RoaXMiLCJyZXBsYWNlU3BlY2lhbENoYXJhY3RlcnMiLCJ0ZXh0IiwiMTc0IiwiMTY5IiwiODIxMSIsIjgyMTIiLCI4MjIwIiwiODIyMSIsIjgyMTYiLCI4MjE3IiwiODQ4MiIsInJlZ2V4cCIsIlN0cmluZyIsImZyb21DaGFyQ29kZSIsInByb2Nlc3NIdG1sIiwib3ZlcnJpZGRlbiIsInNjcm9sbFRvIiwiX19idWlsZEhlYWRlcnMiLCJ0aXRsZVJlZyIsInRpdGxlVGFnIiwicmUxIiwibiIsImFkZE5ld0hlYWRlckZpZWxkIiwicmVtb3ZlSGVhZGVyRmllbGQiLCJpc0hlYWRlclNlbGVjdGVkIiwidmVyaWZ5TGlua1NlY3Rpb25Db21wbGV0ZSIsImNsb25lIiwicmVhZE9ubHlVcmwiLCJuZXdDb250ZXh0IiwidXBkYXRlTGlua3NBbmRFeHBvcnQiLCJnZXRMaW5rc1N1bW1hcnkiLCJuZWVkc1RyYWNraW5nIiwiaW52YWxpZFVybCIsImltcG9ydEh0bWxGcm9tRmlsZURyb3AiLCJldnQiLCJmaWxlcyIsImRhdGFUcmFuc2ZlciIsImFsZXJ0IiwicmVhZGVyIiwiRmlsZVJlYWRlciIsIldTIiwib25sb2FkZW5kIiwiZHJvcFRleHQiLCJ0YXJnZXQiLCJuYW1lUGFydHMiLCJuYW1lIiwiZXh0IiwidG9Mb3dlckNhc2UiLCJfX3N0cmlwSHRtbEFuZFN1YmplY3RGcm9tRU1MIiwicmVhZEFzVGV4dCIsIm5ld1ZhbHVlIiwiX3NsdWdpZnlfc3RyaXBfcmUiLCJfc2x1Z2lmeV9oeXBoZW5hdGVfcmUiLCJyZTQiLCJjaGFyc2V0IiwiX19nZXRDaGFyc2V0RnJvbUhUTUwiLCJpXzEiLCJyZTUiLCJtZXRhVGFncyIsIml0ZW0iLCJjaGFyc2V0VmFscyIsImtleXMiLCJkZXNjcmlwdGlvbiIsIkludGVsbGlnZW5jZUFsZXJ0Iiwib3ZlcnJpZGUiLCJnZW5lcmF0ZUd1aWQiLCJzNCIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsInN1YnN0cmluZyIsIl90eXBlIiwibmV3VmFsIiwiY2xlYW5UeXBlIiwic2V0T3ZlcnJpZGVTdGF0dXMiLCJ2YWwiLCJFTUxNYWtlckludGVsbGlnZW5jZSIsIkludGVsbGlnZW5jZUNlbnRlciIsIiRtb25pdG9yIiwiX3Njb3BlIiwiX21vbml0b3IiLCJzZWFyY2hUeXBlIiwiZGVmYXVsdFNlYXJjaFR5cGUiLCJzZXRUeXBlIiwidHlwZXMiLCJ0YWJzIiwiY2FuVmlld0FsbCIsIkludGVsbGlnZW5jZUVuZ2luZSIsImNhY2hlZFJlc3VsdHMiLCJzY29wZXMiLCJfX2xvY2F0ZVNjb3BlIiwiZmlsdGVyIiwiSW50ZWxsaWdlbmNlTW9kdWxlIiwicmVhZE91dFJ1bGVzIiwicnVsZXMiLCJJbnRlbGxpZ2VuY2VNb25pdG9yIiwicmVnaXN0ZXIiLCJydWxlIiwicGFyZW50U2NvcGUiLCJ2YXJpYWJsZXMiLCJyZXNldCIsImFjY2Vzc29yIiwiZXZhbHVhdGVSdWxlIiwiZnVuYyIsInBhcmFtZXRlcnMiLCJzbGljZSIsIklNXzEiLCJtYXAiLCJhcHBseSIsImVycm9yIiwicnVsZXNfMSIsInByb2NlZWQiLCJJQSIsIldhcm4iLCJzZXZlcml0eSIsIlplcm8iLCJ0aXRsZSIsInJlc291cmNlIiwiY3RhIiwiaGFuZGxlciIsImN0YUxhYmVsIiwic29ydCIsIkFjY2Vzc09ubGluZVZlcnNpb24iLCJhbmltYXRlIiwic3RhdHVzIiwiaGVhZGxpbmUiLCJzdWNjZXNzIiwib25lcnJvciIsIkxPQ0FMSE9TVCIsImlzTG9jYWxNYWNoaW5lIiwiT0ZGTElORV9WRVJTSU9OIiwib2J0YWluS2V5RnJvbVNlcnZlciIsIlBBR0VfVElUTEUiLCJyIiwibSIsInJlZGlyZWN0SnNvbnBDYWxsYmFjayIsInNldFRpbWVvdXQiLCJDVVJSRU5UX1ZFUlNJT04iLCJjcmVhdGVFbGVtZW50IiwiZ2V0RWxlbWVudHNCeVRhZ05hbWUiLCJpbnNlcnRCZWZvcmUiLCJVcGRhdGVNb2R1bGUiLCJ1cGRhdGVWZXJzaW9uIiwidXBkYXRlRm9yY2VkIiwib2ZmbGluZVZlcnNpb24iLCJvbmxpbmVWZXJzaW9uIiwiYWNjZXNzaW5nRnJvbU9mZmxpbmUiLCJvZlYiLCJBcHBsaWNhdGlvblZlcnNpb24iLCJvblYiLCJjb21wYXJlQWdhaW5zdCIsIkFwcFZlcnNpb25EaWZmZXJlbmNlVHlwZSIsIlBBVENIIiwic2hvd01lc3NhZ2UiLCJzaG93VGVhc2VyIiwiZm9yY2VVcGRhdGUiLCJvZmZsaW5lIiwib25saW5lIiwidmVyc2lvbiIsIl92ZXJzaW9uIiwidmVyc2lvbk9iamVjdCIsIk90aGVyVmVyc2lvbiIsIm1lIiwiU2VjdXJlR2F0ZXdheSIsImxvZ2luQ2FsbGJhY2siLCJjYW5Mb2dpbiIsImxvZ2luVGltZXIiLCJzZXNzaW9uVXNlckVtYWlsIiwidGltZXJEZWxheSIsInNhbHQiLCJlbWFpbFJlZ2V4Iiwic2Vzc2lvbklkTG9jYWxTdG9yYWdlS2V5IiwicGVyc2lzdF9zdG9yZSIsIlBlcnNpc3QiLCJTdG9yZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJzYXZlIiwiaW5pdCIsImhhc1NhdmVkU2Vzc2lvbklkIiwic2Vzc2lvbklkIiwic2V0Q3VycmVudFVzZXIiLCJsb2dPdXQiLCJsb2dpbkFzT3RoZXIiLCJyZW1vdmUiLCJyZWxvYWQiLCJjbGVhclRpbWVvdXQiLCJzZXNzaW9uVXBkYXRlVXNlckVtYWlsIiwiZXJyb3JNZXNzYWdlIiwic2F2ZWRFbWFpbElkIiwiZGVjcnlwdCIsImVuY3J5cHQiLCJjaCIsImNoYXJDb2RlQXQiLCJDcnlwdG9KUyIsIk1ENSJdLCJtYXBwaW5ncyI6IkFBU0EsUUFBQUEsMkJBQ0UsR0FBSUMsR0FBUyxFQUNiLElBQUdDLE9BQU9DLFNBQVNDLE9BQU9DLFFBQVEsbUJBQW9CLENBQ3BELEdBQUlDLEdBQVNKLE9BQU9DLFNBQVNDLE9BQU9HLE9BQU8sRUFBRUwsT0FBT0MsU0FBU0MsT0FBT0ksUUFBUUMsTUFBTSxJQUNsRkgsR0FBT0ksUUFBUSxTQUFTQyxHQUNuQkEsRUFBTU4sUUFBUSx5QkFDZkosRUFBU1UsRUFBTUosT0FBTyxtQkFBbUJDLE9BQVFHLEVBQU1ILFdBSTdELE1BQU9QLEdDUVQsR0FBS1csZ0JBQUwsU0FBS0EsR0FDSEEsRUFBQUEsRUFBQSxLQUFBLEdBQUEsT0FDQUEsRUFBQUEsRUFBQSxPQUFBLEdBQUEsU0FDQUEsRUFBQUEsRUFBQSxJQUFBLEdBQUEs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R0FBRyxNQUtoRDdCLEVBQUF2WSxVQUFBaWEsUUFBQSxTQUFRNUwsR0FDTixHQUFJM1EsR0FBTzJRLEVBQUssRUFLaEIsT0FKQTNRLEdBQVNBLEVBQU8rRSxRQUFRLE1BQU0sU0FBUzBYLEdBRXJDLE1BQU9uTCxRQUFPQyxhQUFha0wsRUFBR0MsV0FBVyxHQUFHLE1BS2hEN0IsRUFBQXZZLFVBQUF3WixlQUFBLFNBQWU3WixHQUNiLEdBQUlvQyxHQUFPcEUsT0FBTzBjLFNBQVNDLElBQUkzYSxFQUFRRixLQUFLb1osTUFBTW5VLFVBQ2xEL0csUUFBT3FiLGNBQWNuWSxJQUFJcEIsS0FBS3NaLHlCQUEwQnRaLEtBQUt5YSxRQUFRdmEsSUFDckVoQyxPQUFPK08sR0FBRyxNQUFPLFNBQVUzSyxJQUU3QndXLEVBQUF2WSxVQUFBSyxvQkFBQSxTQUFvQlYsR0FDbEIsTUFBR0YsTUFBS3FaLFdBQVd4WSxLQUFLWCxJQUN0QjZCLFFBQVFDLElBQUk5QixFQUFPLGFBQ1osSUFFUDZCLFFBQVFDLElBQUk5QixFQUFPLGlCQUNaLElBS2I0WSIsImZpbGUiOiJlbWwtY29yZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIlxuaW50ZXJmYWNlIFdpbmRvdyB7XG4gIE9GRkxJTkVfVkVSU0lPTjogc3RyaW5nO1xuICBDVVJSRU5UX1ZFUlNJT046IHN0cmluZztcbiAgcGVyc2lzdF9zdG9yZTogYW55O1xuICBMT0NBTEhPU1Q6IGJvb2xlYW47XG4gIFBBR0VfVElUTEU6IHN0cmluZztcbiAgcmVkaXJlY3RKc29ucENhbGxiYWNrOiAoc3RyaW5nKT0+dm9pZDtcbn1cbmZ1bmN0aW9uIGdldE9mZmxpbmVWZXJzaW9uTnVtYmVyKCl7XG4gIHZhciBvdXRwdXQgPSBcIlwiO1xuICBpZih3aW5kb3cubG9jYXRpb24uc2VhcmNoLmluZGV4T2YoXCJvZmZsaW5lX3ZlcnNpb25cIikpIHtcbiAgICB2YXIgcGFyYW1zID0gd2luZG93LmxvY2F0aW9uLnNlYXJjaC5zdWJzdHIoMSx3aW5kb3cubG9jYXRpb24uc2VhcmNoLmxlbmd0aCkuc3BsaXQoXCImXCIpO1xuICAgIHBhcmFtcy5mb3JFYWNoKGZ1bmN0aW9uKHBhcmFtKXtcbiAgICAgIGlmKHBhcmFtLmluZGV4T2YoXCJvZmZsaW5lX3ZlcnNpb249XCIpPi0xKXtcbiAgICAgICAgb3V0cHV0ID0gcGFyYW0uc3Vic3RyKFwib2ZmbGluZV92ZXJzaW9uPVwiLmxlbmd0aCwgcGFyYW0ubGVuZ3RoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuICByZXR1cm4gb3V0cHV0O1xufVxuY2xhc3MgQWNjZXNzT25saW5lVmVyc2lvbiB7XG4gIGhlYWRsaW5lOiBzdHJpbmc7XG4gIG1lc3NhZ2U6IHN0cmluZztcbiAgc3RhdHVzOiBzdHJpbmc7XG4gIGFuaW1hdGU6IGJvb2xlYW47XG4gIHN1Y2Nlc3M6KCk9PnZvaWQ7XG4gIG9uZXJyb3I6KCk9PnZvaWQ7XG4gIGNvbnN0cnVjdG9yKGFyZ3Mpe1xuXG4gICAgdGhpcy5hbmltYXRlPSB0cnVlO1xuICAgIHRoaXMuc3RhdHVzPSBcImF0dGVtcHRpbmdcIjtcbiAgICB0aGlzLmhlYWRsaW5lPSBcIkNoZWNraW5nIGF2YWlsYWJpbGl0eSBvZiBvbmxpbmUgdmVyc2lvblwiO1xuICAgIHRoaXMubWVzc2FnZT0gXCJJZiB3ZSdyZSBhYmxlIHRvIGFjY2VzcyB0aGUgb25saW5lIHZlcnNpb24sIHlvdSB3aWxsIGJlIHJlZGlyZWN0ZWQuXCI7XG5cbiAgICBpZihhcmdzLnN1Y2Nlc3MgPT09IHVuZGVmaW5lZCkgYXJncy5zdWNjZXNzPWZ1bmN0aW9uKCl7fTtcbiAgICBpZihhcmdzLm9uZXJyb3IgPT09IHVuZGVmaW5lZCkgYXJncy5vbmVycm9yPWZ1bmN0aW9uKCl7fTtcblxuICAgIHdpbmRvdy5MT0NBTEhPU1QgPSB0aGlzLmlzTG9jYWxNYWNoaW5lKCk7XG4gICAgd2luZG93Lk9GRkxJTkVfVkVSU0lPTiA9IGdldE9mZmxpbmVWZXJzaW9uTnVtYmVyKCk7XG5cbiAgICBpZih3aW5kb3cuTE9DQUxIT1NUKXtcbiAgICAgIHdpbmRvdy5zY3JvbGxUbygwLCAwKTtcbiAgICAgIHRoaXMub2J0YWluS2V5RnJvbVNlcnZlcihhcmdzKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5zdGF0dXMgPSBcImZhaWxlZFwiO1xuICAgICAgdGhpcy5hbmltYXRlID0gZmFsc2U7XG4gICAgICBkb2N1bWVudC50aXRsZSA9IHdpbmRvdy5QQUdFX1RJVExFO1xuICAgIH1cblxuXG4gIH1cbiAgb2J0YWluS2V5RnJvbVNlcnZlcihhcmdzKXtcblxuICAgIGlmKHRoaXMuaXNMb2NhbE1hY2hpbmUoKSl7XG4gICAgICB2YXIgciwgYSwgbTtcbiAgICAgICAgd2luZG93LnJlZGlyZWN0SnNvbnBDYWxsYmFjayA9IGZ1bmN0aW9uKHJlc3VsdCl7XG4gICAgICAgICAgaWYocmVzdWx0ID09IHRydWUpIHtcbiAgICAgICAgICAgIGFyZ3Muc3VjY2VzcygpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJGT1VORD9cIik7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgIGxvY2F0aW9uLmhyZWY9XCJodHRwOi8vam9obnByb2VzdGFrZXMuZ2l0aHViLmlvL2VtbC1tYWtlcj9vZmZsaW5lX3ZlcnNpb249XCIrd2luZG93LkNVUlJFTlRfVkVSU0lPTjtcbiAgICAgICAgICAgIH0sIDUwMCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29uc29sZS5sb2coJ25vdCBnaXRodWInKTtcblxuICAgICAgfX07XG4gICAgICByID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2NyaXB0JyksXG4gICAgICBhID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3NjcmlwdCcpWzBdO1xuICAgICAgci50eXBlPVwidGV4dC9qYXZhc2NyaXB0XCI7XG4gICAgICByLm9uZXJyb3IgPSBmdW5jdGlvbigpe1xuICAgICAgICBhcmdzLm9uZXJyb3IoKTtcbiAgICAgICB9O1xuXG4gICAgICByLnNyYz0gIXRoaXMuaXNMb2NhbE1hY2hpbmUoKSA/IFwiXCIgOiBcImh0dHA6Ly9qb2hucHJvZXN0YWtlcy5naXRodWIuaW8vZW1sLW1ha2VyL3Byb2QvYXBwL2NhbnJlZGlyZWN0LmpzXCI7XG4gICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICAgIGEucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUocixtKTtcbiAgICAgIH0sMjAwMCk7XG4gICAgICBkb2N1bWVudC50aXRsZSA9IHdpbmRvdy5QQUdFX1RJVExFICsgXCIgKE9mZmxpbmUgTW9kZSlcIjtcbiAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnN0YXR1cyA9IFwiZmFpbGVkXCI7XG4gICAgICB0aGlzLmFuaW1hdGUgPSBmYWxzZTtcbiAgICAgIGRvY3VtZW50LnRpdGxlID0gd2luZG93LlBBR0VfVElUTEU7XG5cbiAgIH1cbiAgfVxuICBnZXRPZmZsaW5lVmVyc2lvbk51bWJlcigpOnN0cmluZ3tcbiAgICB2YXIgb3V0cHV0ID0gXCJcIjtcbiAgICBpZih3aW5kb3cubG9jYXRpb24uc2VhcmNoLmluZGV4T2YoXCJvZmZsaW5lX3ZlcnNpb25cIikpIHtcbiAgICAgIHZhciBwYXJhbXMgPSB3aW5kb3cubG9jYXRpb24uc2VhcmNoLnN1YnN0cigxLHdpbmRvdy5sb2NhdGlvbi5zZWFyY2gubGVuZ3RoKS5zcGxpdChcIiZcIik7XG4gICAgICBwYXJhbXMuZm9yRWFjaChmdW5jdGlvbihwYXJhbSl7XG4gICAgICAgIGlmKHBhcmFtLmluZGV4T2YoXCJvZmZsaW5lX3ZlcnNpb249XCIpPi0xKXtcbiAgICAgICAgICBvdXRwdXQgPSBwYXJhbS5zdWJzdHIoXCJvZmZsaW5lX3ZlcnNpb249XCIubGVuZ3RoLCBwYXJhbS5sZW5ndGgpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIG91dHB1dDtcbiAgfVxuICBpc0xvY2FsTWFjaGluZSgpe1xuICAgIC8vIHJldHVybiBmYWxzZTtcbiAgICByZXR1cm4gbG9jYXRpb24uaHJlZi5pbmRleE9mKCdqb2hucHJvZXN0YWtlcy5naXRodWIuaW8nKT09LTE7XG4gIH1cbn1cblxuXG5jbGFzcyBVcGRhdGVNb2R1bGUge1xuXG4gIHVwZGF0ZVZlcnNpb246IGJvb2xlYW47XG4gIHVwZGF0ZUZvcmNlZDogYm9vbGVhbjtcbiAgb2ZmbGluZVZlcnNpb246IHN0cmluZztcbiAgb25saW5lVmVyc2lvbjogc3RyaW5nO1xuICBhY2Nlc3NpbmdGcm9tT2ZmbGluZTogYm9vbGVhbjtcblxuICBjb25zdHJ1Y3Rvcigpe1xuXG4gICAgdGhpcy51cGRhdGVWZXJzaW9uID0gZmFsc2U7XG4gICAgdGhpcy51cGRhdGVGb3JjZWQgPSBmYWxzZTtcbiAgICB0aGlzLm9mZmxpbmVWZXJzaW9uID0gd2luZG93Lk9GRkxJTkVfVkVSU0lPTiA9PT0gdW5kZWZpbmVkID8gZ2V0T2ZmbGluZVZlcnNpb25OdW1iZXIoKSA6IHdpbmRvdy5PRkZMSU5FX1ZFUlNJT04gO1xuICAgIHRoaXMub25saW5lVmVyc2lvbiA9IHdpbmRvdy5DVVJSRU5UX1ZFUlNJT047XG5cbiAgICAvL3RyZWF0IGxvY2FsaG9zdDo4ODg4IGFzIGludGVybmV0XG4gICAgaWYobG9jYXRpb24uaHJlZi5pbmRleE9mKFwibG9jYWxob3N0XCIpPi0xKXsgd2luZG93LkxPQ0FMSE9TVCA9IGZhbHNlO31cblxuICAgIGlmKHdpbmRvdy5PRkZMSU5FX1ZFUlNJT04gPT0gXCJcIil7XG4gICAgICB0aGlzLmFjY2Vzc2luZ0Zyb21PZmZsaW5lID0gZmFsc2U7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmKHdpbmRvdy5PRkZMSU5FX1ZFUlNJT04gJiYgd2luZG93LkxPQ0FMSE9TVCl7XG4gICAgICAgIHRoaXMuYWNjZXNzaW5nRnJvbU9mZmxpbmUgPSB0cnVlO1xuICAgICAgfVxuICAgICAgaWYod2luZG93Lk9GRkxJTkVfVkVSU0lPTiAmJiAod2luZG93Lk9GRkxJTkVfVkVSU0lPTiAhPT0gd2luZG93LkNVUlJFTlRfVkVSU0lPTikpe1xuICAgICAgICB0aGlzLnVwZGF0ZVZlcnNpb24gPSB0cnVlO1xuICAgICAgICBsZXQgb2ZWID0gbmV3IEFwcGxpY2F0aW9uVmVyc2lvbih3aW5kb3cuT0ZGTElORV9WRVJTSU9OKSxcbiAgICAgICAgICBvblYgPSBuZXcgQXBwbGljYXRpb25WZXJzaW9uKHdpbmRvdy5DVVJSRU5UX1ZFUlNJT04pO1xuICAgICAgICB0aGlzLnVwZGF0ZUZvcmNlZCA9IG9mVi5jb21wYXJlQWdhaW5zdChvblYpPD1BcHBWZXJzaW9uRGlmZmVyZW5jZVR5cGUuUEFUQ0g7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiVVBEQVRFRk9SQ0VEP1wiLCB0aGlzLnVwZGF0ZUZvcmNlZCwgb2ZWLG9uVik7XG4gICAgICB9XG4gICAgfVxuXG4gIH1cbiAgc2hvd01lc3NhZ2UoKXtcbiAgICByZXR1cm4gdGhpcy51cGRhdGVWZXJzaW9uICYmIHRoaXMudXBkYXRlRm9yY2VkO1xuICB9XG4gIHNob3dUZWFzZXIoKXtcbiAgICByZXR1cm4gdGhpcy5vZmZsaW5lVmVyc2lvbj09XCJcIiAmJiAhd2luZG93LkxPQ0FMSE9TVDtcbiAgfVxuICBmb3JjZVVwZGF0ZShvZmZsaW5lLCBvbmxpbmUpe1xuICAgIHZhciBvZmZsaW5lVmVyc2lvbiA9IG9mZmxpbmUuc3BsaXQoXCIuXCIpLFxuICAgIG9ubGluZVZlcnNpb24gPSBvbmxpbmUuc3BsaXQoXCIuXCIpLFxuICAgIG1hdGNoID0gMCwgb3V0cHV0ID0gZmFsc2U7XG4gICAgZm9yKHZhciBpPTA7IGk8b25saW5lVmVyc2lvbi5sZW5ndGg7aSsrKXtcbiAgICAgIGlmKG9ubGluZVZlcnNpb25baV09PSBvZmZsaW5lVmVyc2lvbltpXSkgbWF0Y2grKztcbiAgICB9XG4gICAgaWYobWF0Y2g8Myl7XG4gICAgICBvdXRwdXQgPSB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gb3V0cHV0O1xuICB9XG59XG5cbmVudW0gQXBwVmVyc2lvbkRpZmZlcmVuY2VUeXBle1xuICBNQUpPUj0wLFxuICBNSU5PUixcbiAgUEFUQ0gsXG4gIFNVQlBBVENILFxuICBOT05FXG59XG5jbGFzcyBBcHBsaWNhdGlvblZlcnNpb24ge1xuICBfdmVyc2lvbjogc3RyaW5nO1xuICB2ZXJzaW9uT2JqZWN0OiBudW1iZXJbXTtcbiAgY29uc3RydWN0b3IodmVyc2lvbjpzdHJpbmcpe1xuICAgIHRoaXMuX3ZlcnNpb24gPSB2ZXJzaW9uO1xuICAgIHRoaXMudmVyc2lvbk9iamVjdCA9IHRoaXMuX3ZlcnNpb24uc3BsaXQoXCIuXCIpLm1hcCgobjpzdHJpbmcpPT5wYXJzZUludChuKSk7XG4gIH1cbiAgY29tcGFyZUFnYWluc3QoT3RoZXJWZXJzaW9uOkFwcGxpY2F0aW9uVmVyc2lvbik6QXBwVmVyc2lvbkRpZmZlcmVuY2VUeXBle1xuICAgIHZhciBtZSA9IHRoaXMudmVyc2lvbk9iamVjdCxcbiAgICAgIG90aGVyID0gT3RoZXJWZXJzaW9uLnZlcnNpb25PYmplY3QsXG4gICAgICBtYXRjaCA9IDAsXG4gICAgICBvdXRwdXQgPSBmYWxzZTtcblxuICAgIGZvcih2YXIgaT0wOyBpPDQ7aSsrKXtcbiAgICAgIGlmKG1lW2ldPT0gb3RoZXJbaV0pe1xuICAgICAgICAgbWF0Y2grKztcbiAgICAgICB9IGVsc2Uge1xuICAgICAgICAgYnJlYWs7XG4gICAgICAgfVxuICAgICB9XG5cbiAgICByZXR1cm4gQXBwVmVyc2lvbkRpZmZlcmVuY2VUeXBlW0FwcFZlcnNpb25EaWZmZXJlbmNlVHlwZVttYXRjaF1dO1xuICB9XG59XG4iLCJcbmludGVyZmFjZSBXaW5kb3cge1xuICAgIGdhKG9wdGlvbjEsIG9wdGlvbjIsIG9wdGlvbjMsIG9wdGlvbjQsIG9wdGlvbjUpOiB2b2lkO1xuICAgIHNhdmVBcyhvcHRpb24xPywgb3B0aW9uMj8pOiB2b2lkO1xuICAgIGpRdWVyeShvcHRpb24pOmFueTtcbiAgICBkZWNvZGVVUklDb21wb25lbnQob3B0aW9uKTogc3RyaW5nO1xuICAgIGVuY29kZVVSSUNvbXBvbmVudChvcHRpb24pOiBzdHJpbmc7XG59XG5pbnRlcmZhY2UgRXZlbnRUYXJnZXQge1xuICByZXN1bHQ/OmFueTtcbn1cbi8vIGRlY2xhcmUgdmFyIHdpbmRvdzogTXlXaW5kb3c7XG5cbmludGVyZmFjZSAkU2NlIHtcbiAgdHJ1c3RBc0h0bWwoc3RyOiBzdHJpbmcpOiBhbnk7XG59XG5cbmludGVyZmFjZSBTZWFyY2hTdHJpbmdQYXlsb2FkIHtcbiAgYWRkZWQ6IHN0cmluZ1tdLFxuICB1cGRhdGVkOiBzdHJpbmdbXSxcbiAgcmVtb3ZlZDogc3RyaW5nW10sXG59XG5pbnRlcmZhY2UgQ2hhbmdlTW9uaXRvck1zZyB7XG4gIG1lc3NhZ2U6IHN0cmluZyxcbiAgZGF0YTogYW55W11cbn1cblxuZW51bSBFcnJvclNldmVyaXR5IHtcbiAgSGlnaD0xLFxuICBNZWRpdW0sXG4gIExvdyxcbiAgWmVyb1xufVxuZW51bSBFcnJvclR5cGUge1xuICBGaXg9MSxcbiAgV2FybixcbiAgU3VnZ2VzdGlvbixcbiAgUUEsXG4gIEJlc3RQcmFjdGljZVxufVxuXG5cbm5hbWVzcGFjZSBHbG9iYWxWYXJzIHtcbiAgZXhwb3J0IGxldCBsYW5kaW5nUGFnZVByZWZlcnJlZCA9IC8oXFwubXA0fFxcLmF2aXxcXC5tcGVnfFxcLm1wM3xcXC5zd2Z8XFwubW92fFxcLnBkZikvaTtcbiAgZXhwb3J0IGxldCBleHREb2VzTm90cmVxdWlyZVRyYWNraW5nQ29kZSA9IC8oXFwucGRmfFxcLm9mdHxcXC5pY3N8XFwucG5nfFxcLmpwZWd8XFwuanBnKS9pO1xuICBleHBvcnQgbGV0IGxpbmtFbmNhcHN1bGF0ZWRQdW5jdHVhdGlvbiA9IC8oW1xcLlxcP1xcLFxcOlxcKl0rKSgoXFxufFxccnxcXHMpKyk/PFxcL2E+JC87XG5cbiAgZXhwb3J0IGxldCBSZXF1aXJlc1NDb2RlUmVnZXggPSAvaHR0cCguKilvcHR1bSguKilcXC8oY2FtcGFpZ258cmVzb3VyY2UpL2k7XG4gIGV4cG9ydCBsZXQgUmVxdWlyZXNUcmFja2luZ0NvZGVSZWdleCA9IFJlZ0V4cChcIl5odHRwKHMpPzpcXC9cXC8oLio/KT9vcHR1bSguKj8pP1xcLmNvW21cXC5dP1wiKTtcbiAgZXhwb3J0IGxldCBUZWxlcGhvbmVSZWdleCA9IC8oXFwrP1xcZHsxLDJ9KFxcc3wtfFxcLikpP1xcKD9cXGR7M31cXCk/W1xccy4tXVxcZHszLH1bXFxzLi1dXFxkezQsfS87XG4gIGV4cG9ydCBsZXQgVGVsZXBob25lUmVnZXhHbG9iYWwgPSAvKFxcKz9cXGR7MSwyfShcXHN8LXxcXC4pKT9cXCg/XFxkezN9XFwpP1tcXHMuLV1cXGR7Myx9W1xccy4tXVxcZHs0LH0vZztcbiAgZXhwb3J0IGxldCBFbWFpbFJlZ2V4ID0gLygoW148PigpXFxbXFxdXFxcXC4sOzpcXHNAXCJdKyhcXC5bXjw+KClcXFtcXF1cXFxcLiw7Olxcc0BcIl0rKSopfChcIi4rXCIpKUAoKFxcW1swLTldezEsM31cXC5bMC05XXsxLDN9XFwuWzAtOV17MSwzfVxcLlswLTldezEsM31cXF0pfCgoW2EtekEtWlxcLTAtOV0rXFwuKStbYS16QS1aXXsyLH0pKS87XG4gIGV4cG9ydCBsZXQgRW1haWxSZWdleEdsb2JhbCA9IC8oKFtePD4oKVxcW1xcXVxcXFwuLDs6XFxzQFwiXSsoXFwuW148PigpXFxbXFxdXFxcXC4sOzpcXHNAXCJdKykqKXwoXCIuK1wiKSlAKChcXFtbMC05XXsxLDN9XFwuWzAtOV17MSwzfVxcLlswLTldezEsM31cXC5bMC05XXsxLDN9XFxdKXwoKFthLXpBLVpcXC0wLTldK1xcLikrW2EtekEtWl17Mix9KSkvZztcbiAgZXhwb3J0IGxldCBVcmxSZWdleCA9IC9eKD86KD86KD86aHR0cHM/fGZ0cCk6KT9cXC9cXC8pKD86XFxTKyg/OjpcXFMqKT9AKT8oPzooPyEoPzoxMHwxMjcpKD86XFwuXFxkezEsM30pezN9KSg/ISg/OjE2OVxcLjI1NHwxOTJcXC4xNjgpKD86XFwuXFxkezEsM30pezJ9KSg/ITE3MlxcLig/OjFbNi05XXwyXFxkfDNbMC0xXSkoPzpcXC5cXGR7MSwzfSl7Mn0pKD86WzEtOV1cXGQ/fDFcXGRcXGR8MlswMV1cXGR8MjJbMC0zXSkoPzpcXC4oPzoxP1xcZHsxLDJ9fDJbMC00XVxcZHwyNVswLTVdKSl7Mn0oPzpcXC4oPzpbMS05XVxcZD98MVxcZFxcZHwyWzAtNF1cXGR8MjVbMC00XSkpfCg/Oig/OlthLXpcXHUwMGExLVxcdWZmZmYwLTldLSopKlthLXpcXHUwMGExLVxcdWZmZmYwLTldKykoPzpcXC4oPzpbYS16XFx1MDBhMS1cXHVmZmZmMC05XS0qKSpbYS16XFx1MDBhMS1cXHVmZmZmMC05XSspKig/OlxcLig/OlthLXpcXHUwMGExLVxcdWZmZmZdezIsfSkpKSg/OjpcXGR7Miw1fSk/KD86Wy8/I11cXFMqKT8kL2k7XG4gIGV4cG9ydCBsZXQgTGlua0hhc1RpdGxlVGFnUmVnZXhHbG9iYWwgPSAvPGFcXHMoW148XSopdGl0bGU9XFxcIiguKj8pXFxcIj4vZ2k7XG4gIGV4cG9ydCBsZXQgUHJlaGVhZGVyUmVnZXhHbG9iYWwgPSAvXFw8cFxcc1teXFw8XSpjbGFzcz1cXFwicHJlaGVhZGVyXFxcIlteXFw+XSpcXD4vZ2k7XG4gIGV4cG9ydCBsZXQgUmVxdWlyZWRUcmFja2luZ0NvZGVXaGl0ZWxpc3Q6IGFueVtdID0gW1xuICAgICcucGRmJywnLmljcycsJy5vZnQnLCdvcHR1bXN1cnZleXMuY28nLCdoZWFsdGhpZC5vcHR1bS5jb20nLCdsZWFybmluZy5vcHR1bS5jb20nLCdhcHAuaW5mby5vcHR1bS5jb20nLFxuICAgICdvcHR1bS53ZWJleC5jb20nLCd0d2l0dGVyLmNvbScsJ2ZhY2Vib29rLmNvbScsJ2xpbmtlZGluLmNvbScsJ2luZm8ub3B0dW0nXG4gIF07XG59XG5cblxubmFtZXNwYWNlIEVNTE1vZHVsZSB7XG5cblxuXG4gIGV4cG9ydCBjbGFzcyBNYWlsdG9MaW5rT2JqZWN0IHtcbiAgICAgcGFyZW50OiBMaW5rT2JqZWN0O1xuICAgICBlbWFpbDogc3RyaW5nO1xuICAgICBzdWJqZWN0OiBzdHJpbmc7XG4gICAgIGJvZHk6IHN0cmluZztcblxuICAgICBjb25zdHJ1Y3RvcihMaW5rT2JqZWN0KXtcbiAgICAgICB0aGlzLnBhcmVudCA9IExpbmtPYmplY3Q7XG4gICAgICAgdGhpcy5lbWFpbCA9IFwiXCI7XG4gICAgICAgdGhpcy5zdWJqZWN0ID0gXCJcIjtcbiAgICAgICB0aGlzLmJvZHkgPSBcIlwiO1xuXG4gICAgICAgaWYodGhpcy5wYXJlbnQuaXNMaW5rVHlwZSgnbWFpbHRvJykpe1xuICAgICAgICAgdGhpcy5pbml0RW1haWxFZGl0b3IoKTtcbiAgICAgICB9XG4gICAgIH1cbiAgICAgaGFzKG9wdGlvbik6Ym9vbGVhbntcbiAgICAgICB0aGlzLnVwZGF0ZU1haWx0b09iaigpO1xuICAgICAgIHJldHVybiB0aGlzW29wdGlvbl0gJiYgdGhpc1tvcHRpb25dLnRyaW0oKSE9PVwiXCI7XG4gICAgIH1cbiAgICAgaXNWYWxpZEVtYWlsQWRkcmVzcygpe1xuICAgICAgIHJldHVybiBHbG9iYWxWYXJzLkVtYWlsUmVnZXgudGVzdCh0aGlzLmVtYWlsKTtcbiAgICAgfVxuICAgICBkZWluaXRFbWFpbEVkaXRvcigpe1xuICAgICAgIHRoaXMuZW1haWwgPSBcIlwiO1xuICAgICAgIHRoaXMuc3ViamVjdCA9IFwiXCI7XG4gICAgICAgdGhpcy5ib2R5ID0gXCJcIjtcbiAgICAgfVxuICAgICBjb21wb3NlRW1haWwoKXtcbiAgICAgICB0aGlzLnBhcmVudC5uZXcudXJsID0gXCJtYWlsdG86XCIgKyB0aGlzLmVtYWlsO1xuICAgICAgIHZhciBvcHRpb25zID0gW1wic3ViamVjdFwiLFwiYm9keVwiXTtcbiAgICAgICBmb3IodmFyIGkgPTA7IGk8b3B0aW9ucy5sZW5ndGg7IGkrKyl7XG4gICAgICAgICBpZih0aGlzW29wdGlvbnNbaV1dICYmIHRoaXNbb3B0aW9uc1tpXV0gIT09IFwiXCIpIHtcbiAgICAgICAgICAgdGhpcy5wYXJlbnQubmV3LnNlYXJjaFBhcmFtcy5zZXQob3B0aW9uc1tpXSwgdGhpc1tvcHRpb25zW2ldXSk7XG4gICAgICAgICB9IGVsc2UgaWYodGhpc1tvcHRpb25zW2ldXT09XCJcIil7XG4gICAgICAgICAgIHRoaXMucGFyZW50Lm5ldy5zZWFyY2hQYXJhbXMuZGVsZXRlKG9wdGlvbnNbaV0pO1xuICAgICAgICAgICAvLyBbXCJzdWJqZWN0XCIsXCJib2R5XCJdLmZvckVhY2goKG9wdGlvbik9PntcbiAgICAgICAgICAgLy8gICBpZih0aGlzW29wdGlvbl0gPT0gXCJcIikge1xuICAgICAgICAgICAvL1xuICAgICAgICAgICAvLyAgICB9XG4gICAgICAgICAgIC8vICB9KTtcbiAgICAgICAgICAgLy8gLy9kZWxldGUgaXQ7XG4gICAgICAgICAgIC8vIHRoaXMucGFyZW50Lm5ldy5zZWFyY2hQYXJhbXMuZGVsZXRlKG9wdGlvbnNbaV0pO1xuICAgICAgICAgfVxuICAgICAgIH1cbiAgICAgfVxuICAgICB1cGRhdGVNYWlsdG9PYmooKXtcblxuICAgICAgIHZhciBhID0gdGhpcy5wYXJlbnQubmV3LnVybC5zdWJzdHIoNywgdGhpcy5wYXJlbnQubmV3LnVybC5sZW5ndGgtNyk7XG4gICAgICAgdmFyIGIgPSBhLnNwbGl0KFwiP1wiKTtcbiAgICAgICB0aGlzLmVtYWlsID0gYlswXTtcblxuICAgICAgIHRoaXMucGFyZW50Lm5ldy5zZWFyY2hQYXJhbXMudXBkYXRlRW50cmllcygpO1xuICAgICAgIGlmKGIubGVuZ3RoPjEpe1xuICAgICAgICAgW1wic3ViamVjdFwiLFwiYm9keVwiXS5mb3JFYWNoKChvcHRpb24pPT57XG4gICAgICAgICAgIGlmKHRoaXMucGFyZW50Lm5ldy5zZWFyY2hQYXJhbXMuaGFzKG9wdGlvbikpe1xuICAgICAgICAgICAgIHRoaXNbb3B0aW9uXSA9IHdpbmRvdy5kZWNvZGVVUklDb21wb25lbnQodGhpcy5wYXJlbnQubmV3LnNlYXJjaFBhcmFtcy5nZXQob3B0aW9uKSk7XG4gICAgICAgICAgIH1cbiAgICAgICAgIH0pO1xuICAgICAgIH0gZWxzZSB7XG4gICAgICAgICB0aGlzLnN1YmplY3Q9IFwiXCI7XG4gICAgICAgICB0aGlzLmJvZHkgPSBcIlwiO1xuICAgICAgIH1cbiAgICAgfVxuICAgICBpbnB1dE9uQmx1cigpe1xuICAgICAgIC8vZGVjb2RlZCB1cmwgYWxsIHRoZSBlbnRyaWVzO1xuICAgICAgIC8vcmVlbmNvZGUgdGhlbS5cblxuICAgICAgIHRoaXMucGFyZW50Lm5ldy5zZWFyY2hQYXJhbXMudXBkYXRlRW50cmllcygpO1xuICAgICAgIHRoaXMucGFyZW50Lm5ldy5zZWFyY2hQYXJhbXMudXBkYXRlU2VhcmNoUHJvcCgpO1xuXG5cbiAgICAgfVxuICAgICBvcGVuRWRpdG9yKCl7XG4gICAgICAgdGhpcy5pbml0RW1haWxFZGl0b3IoKTtcbiAgICAgICAvLyB3aW5kb3cualF1ZXJ5KFwiaHRtbCxib2R5XCIpXG4gICAgICAgLy8gLmFuaW1hdGUoe3Njcm9sbFRvcDogd2luZG93LmpRdWVyeSgnI2xpbmstJysodGhpcy5wYXJlbnQuaWQtMSkpLm9mZnNldCgpLnRvcCAtIDc1fSwgMzAwKTtcbiAgICAgICB2YXIgTE8gPSB0aGlzLnBhcmVudDtcbiAgICAgICAgIGNvbnNvbGUubG9nKExPLmlkLTEpO1xuICAgICAgICAgTE8uc2hvd01haWx0b0VkaXRvciA9IHRydWU7XG4gICAgIH1cbiAgICAgaW5pdEVtYWlsRWRpdG9yKCl7XG4gICAgICAgdGhpcy51cGRhdGVNYWlsdG9PYmooKTtcbiAgICAgfVxuICAgfVxuXG4gIGV4cG9ydCBjbGFzcyBVUkxPYmoge1xuICAgIHNlYXJjaDogc3RyaW5nO1xuICAgIGhyZWY6IHN0cmluZztcbiAgICBvcmlnaW46IHN0cmluZztcbiAgICBoYXNoOiBzdHJpbmc7XG4gICAgcHJvdG9jb2w6IHN0cmluZztcbiAgICBzZWFyY2hQYXJhbXM6IFVSTE9ialNlYXJjaFBhcmFtcztcblxuICAgIGNvbnN0cnVjdG9yKHVybCl7XG4gICAgICB0aGlzLmhyZWYgPSBcIlwiO1xuICAgICAgdGhpcy5zZWFyY2ggPSBcIlwiO1xuICAgICAgdGhpcy5vcmlnaW4gPSBcIlwiO1xuICAgICAgdGhpcy5oYXNoID0gXCJcIjtcbiAgICAgIHRoaXMucHJvdG9jb2wgPSBcIlwiO1xuICAgICAgdGhpcy51cmwgPSB1cmw7XG4gICAgICB0aGlzLnNlYXJjaFBhcmFtcyA9IG5ldyBVUkxPYmpTZWFyY2hQYXJhbXModGhpcyk7XG4gICAgfVxuICAgIHByZXBhcmVFeHBvcnQoKXtcbiAgICAvL2RvIHNvbWV0aGluZyBoZXJlP1xuICAgICAgLy90aGlzLnNlYXJjaFBhcmFtcy51cGRhdGVTZWFyY2hQcm9wKCk7XG4gICAgfVxuICAgIGlzVmFsaWQoKTpib29sZWFuIHtcbiAgICAgIHJldHVybiBHbG9iYWxWYXJzLlVybFJlZ2V4LnRlc3QodGhpcy51cmwpO1xuICAgIH1cbiAgICBjb250YWlucyhzdHI6c3RyaW5nKTogYm9vbGVhbntcbiAgICAgIGlmKHRoaXMudXJsLmluZGV4T2Yoc3RyKT4tMSkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9XG4gICAgZ2V0IHVybCgpe1xuICAgICAgdGhpcy5wcmVwYXJlRXhwb3J0KCk7XG4gICAgICB2YXIgdSA9IHRoaXMub3JpZ2luICsgdGhpcy5zZWFyY2ggKyB0aGlzLmhhc2g7XG4gICAgICB1ID0gdS5yZXBsYWNlKFwiP3VuZGVmaW5lZFwiLFwiXCIpO1xuICAgICAgcmV0dXJuIHU7XG4gICAgfVxuICAgIHNldCB1cmwodXJsKXtcbiAgICAgIHRoaXMuc2VhcmNoID0gXCJcIjtcbiAgICAgIHRoaXMuaGFzaCA9IFwiXCI7XG4gICAgICB2YXIgcHJvdG9jb2xUeXBlID0gL14oaHR0cHM/fG1haWx0b3xmdHApXFw6L2dpO1xuICAgICAgaWYocHJvdG9jb2xUeXBlLnRlc3QodXJsKSl7XG4gICAgICAgIHZhciBhID0gdXJsLm1hdGNoKHByb3RvY29sVHlwZSk7XG4gICAgICAgIHRoaXMucHJvdG9jb2wgPSBhWzBdO1xuICAgICAgfVxuICAgICAgdGhpcy5ocmVmID0gdXJsO1xuICAgICAgaWYodXJsLnRyaW0oKT09XCIjXCIpe1xuICAgICAgICB0aGlzLmhhc2ggPSBcIiNcIjtcbiAgICAgIH1cbiAgICAgIGVsc2UgaWYodXJsLnRyaW0oKS5sZW5ndGg+MSAmJiB1cmwuaW5kZXhPZihcIiNcIik+LTEpe1xuICAgICAgICB2YXIgdXJsUGFydHMgPSB1cmwuc3BsaXQoXCIjXCIpO1xuICAgICAgICB0aGlzLmhhc2ggPSBcIiNcIiArIHVybFBhcnRzLnBvcCgpOyAvL2p1bXAgbGluay4uIG5lZWQgdG8gcmVtb3ZlIGl0IGZyb20gdGhlIG90aGVyIHN0dWZmLlxuICAgICAgICB2YXIgcGFydHMgPSAodXJsUGFydHMuam9pbihcIiNcIikpLnNwbGl0KFwiP1wiKTtcbiAgICAgICAgdGhpcy5vcmlnaW4gPSBwYXJ0c1swXTtcbiAgICAgICAgdGhpcy5zZWFyY2ggPSBwYXJ0cy5sZW5ndGg+MCA/IFwiP1wiK3BhcnRzWzFdOlwiXCI7XG4gICAgICB9XG4gICAgICBlbHNlIHtcblxuICAgICAgICBpZih1cmwuaW5kZXhPZihcIj9cIik+LTEpe1xuICAgICAgICAgIHZhciBwYXJ0cyA9IHVybC5zcGxpdChcIj9cIik7XG4gICAgICAgICAgdGhpcy5vcmlnaW4gPSBwYXJ0c1swXTtcbiAgICAgICAgICB0aGlzLnNlYXJjaCA9IChwYXJ0cy5sZW5ndGggPiAwKSA/IFwiP1wiK3BhcnRzWzFdOlwiXCI7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5vcmlnaW4gPSB1cmw7XG4gICAgICAgIH1cblxuICAgICAgfVxuICAgICAgLy90aGlzLnNlYXJjaFBhcmFtcy51cGRhdGVTZWFyY2hQcm9wKCk7XG4gICAgfVxuXG4gIH1cblxuICBleHBvcnQgY2xhc3MgVVJMT2JqU2VhcmNoUGFyYW1zIHtcbiAgICBfZW50cmllcyA6IGFueVtdO1xuICAgIHBhcmVudDogVVJMT2JqO1xuXG4gICAgY29uc3RydWN0b3IocGFyZW50OlVSTE9iail7XG5cbiAgICAgIHRoaXMucGFyZW50ID0gcGFyZW50O1xuICAgICAgaWYodGhpcy5wYXJlbnQuc2VhcmNoLmxlbmd0aD4wKXtcbiAgICAgICAgdGhpcy5fZW50cmllcyA9ICh0aGlzLnBhcmVudC5zZWFyY2guc3Vic3RyKDEsdGhpcy5wYXJlbnQuc2VhcmNoLmxlbmd0aCkpLnNwbGl0KC9cXCZhbXBcXDt8XFwmL2cpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5fZW50cmllcz1bXTtcbiAgICAgIH1cblxuXG4gICAgfVxuICAgIGdldCBlbnRyaWVzKCl7XG4gICAgICBsZXQgb3V0cHV0ID0gW107XG4gICAgICBmb3IobGV0IGkgPSAwOyBpPHRoaXMuX2VudHJpZXMubGVuZ3RoO2krKyl7XG4gICAgICAgIHZhciBhID0gdGhpcy5fZW50cmllc1tpXS5zcGxpdChcIj1cIik7XG4gICAgICAgIGlmKGEubGVuZ3RoPjEpe1xuICAgICAgICAgIGFbMV0gPSBkZWNvZGVVUklDb21wb25lbnQoYVsxXSk7XG4gICAgICAgIH1cbiAgICAgICAgb3V0cHV0LnB1c2goYS5qb2luKFwiPVwiKSk7XG4gICAgICB9XG5cblxuICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICB9XG4gICAgdXBkYXRlRW50cmllcygpOnZvaWQge1xuICAgICAgdGhpcy5fZW50cmllcyA9IFtdO1xuICAgICAgaWYodGhpcy5wYXJlbnQuc2VhcmNoIT09IFwiP1wiICYmIHRoaXMucGFyZW50LnNlYXJjaC5sZW5ndGg+MSl7XG4gICAgICAgIHZhciBwcm9wcyA9ICh0aGlzLnBhcmVudC5zZWFyY2guc3Vic3RyKDEsdGhpcy5wYXJlbnQuc2VhcmNoLmxlbmd0aCkpLnNwbGl0KC9cXCZhbXBcXDt8XFwmL2cpO1xuICAgICAgICBmb3IobGV0IGkgPSAwOyBpPHByb3BzLmxlbmd0aDtpKyspe1xuICAgICAgICAgIHRoaXMuX2VudHJpZXMucHVzaChwcm9wc1tpXSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgdXBkYXRlU2VhcmNoUHJvcCgpOnZvaWR7XG4gICAgICB2YXIgb3V0cHV0ID0gW107XG4gICAgICBpZih0aGlzLl9lbnRyaWVzLmxlbmd0aD4wKXtcbiAgICAgICAgZm9yKHZhciBpID0wO2k8dGhpcy5fZW50cmllcy5sZW5ndGg7aSsrKXtcbiAgICAgICAgICB2YXIgcHJvcCA9dGhpcy5fZW50cmllc1tpXS5zcGxpdChcIj1cIik7XG4gICAgICAgICAgaWYoL1thLXpdezEsNH09KC4qPzopezMsOX0vZ2kudGVzdCh0aGlzLl9lbnRyaWVzW2ldKSkge1xuICAgICAgICAgICAgb3V0cHV0LnB1c2godGhpcy5fZW50cmllc1tpXSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG91dHB1dC5wdXNoKHByb3BbMF0rKHByb3AubGVuZ3RoPjEgPyBcIj1cIisgZW5jb2RlVVJJQ29tcG9uZW50KGRlY29kZVVSSUNvbXBvbmVudChwcm9wWzFdKSkgOiBcIlwiKSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHRoaXMucGFyZW50LnNlYXJjaCA9IG91dHB1dC5sZW5ndGg+MCA/IFwiP1wiK291dHB1dC5qb2luKFwiJlwiKSA6IFwiXCI7XG4gICAgfVxuICAgIGhhcyhwYXJhbSk6Ym9vbGVhbntcbiAgICAgIHZhciByZWdleCA9IG5ldyBSZWdFeHAoXCJeXCIgKyBwYXJhbSArIFwiXFw9XCIsXCJnXCIpO1xuICAgICAgdmFyIG91dHB1dCA9IGZhbHNlO1xuICAgICAgZm9yKHZhciBpPTA7aTx0aGlzLl9lbnRyaWVzLmxlbmd0aDtpKyspe1xuICAgICAgICBpZihyZWdleC50ZXN0KHRoaXMuX2VudHJpZXNbaV0pKSBvdXRwdXQgPSB0cnVlO1xuICAgICAgfVxuICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICB9XG4gICAgZ2V0KHBhcmFtKXtcbiAgICAgIHZhciByZWdleCA9IG5ldyBSZWdFeHAoXCJeXCIgKyBwYXJhbSArIFwiXFw9XCIsXCJnXCIpLFxuICAgICAgICAgIG91dHB1dCA9IGZhbHNlO1xuICAgICAgZm9yKHZhciBpPTA7aTx0aGlzLl9lbnRyaWVzLmxlbmd0aDtpKyspe1xuICAgICAgICBpZihyZWdleC50ZXN0KHRoaXMuX2VudHJpZXNbaV0pKSB7XG4gICAgICAgICAgb3V0cHV0ID0gKHRoaXMuX2VudHJpZXNbaV0uc3BsaXQoXCI9XCIpKS5wb3AoKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICB9XG4gICAgc2V0KHBhcmFtLCB2YWx1ZSk6dm9pZHtcbiAgICAgIHZhciByZWdleCA9IG5ldyBSZWdFeHAoXCJeXCIgKyBwYXJhbSArIFwiXFw9XCIsXCJnXCIpLFxuICAgICAgICAgIG91dHB1dCA9IGZhbHNlO1xuICAgICAgZm9yKHZhciBpPTA7aTx0aGlzLl9lbnRyaWVzLmxlbmd0aDtpKyspe1xuICAgICAgICBpZihyZWdleC50ZXN0KHRoaXMuX2VudHJpZXNbaV0pKSB7XG4gICAgICAgICAgdGhpcy5fZW50cmllc1tpXSA9IHBhcmFtICsgXCI9XCIgKyB2YWx1ZTtcbiAgICAgICAgICBvdXRwdXQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZighb3V0cHV0KXtcbiAgICAgICAgdGhpcy5hcHBlbmQocGFyYW0gKyBcIj1cIiArIHZhbHVlKTtcbiAgICAgIH1cbiAgICAgIHRoaXMudXBkYXRlU2VhcmNoUHJvcCgpO1xuICAgIH1cbiAgICBhcHBlbmQodmFsdWVQYWlyKXtcbiAgICAgIHRoaXMuX2VudHJpZXMucHVzaCh2YWx1ZVBhaXIpO1xuICAgICAgdGhpcy51cGRhdGVTZWFyY2hQcm9wKCk7XG4gICAgfVxuICAgIGRlbGV0ZUFsbCgpe1xuICAgICAgdGhpcy5fZW50cmllcyA9IFtdO1xuICAgICAgdGhpcy51cGRhdGVTZWFyY2hQcm9wKCk7XG4gICAgfVxuICAgIGRlbGV0ZUF0SW5kZXgoaW5kZXgpe1xuICAgICAgdGhpcy5fZW50cmllcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgdGhpcy51cGRhdGVTZWFyY2hQcm9wKCk7XG4gICAgfVxuICAgIGRlbGV0ZShwYXJhbSl7XG4gICAgICAvL2RvZXNudCBkbyBhbnl0aGluZyB5ZXQuXG4gICAgICBmb3IobGV0IGk9MDtpIDwgdGhpcy5fZW50cmllcy5sZW5ndGg7aSsrKXtcbiAgICAgICAgaWYodGhpcy5fZW50cmllc1tpXS5zdWJzdHIoMCxwYXJhbS5sZW5ndGgrMSk9PXBhcmFtK1wiPVwiKXtcbiAgICAgICAgICB0aGlzLmRlbGV0ZUF0SW5kZXgoaSk7XG4gICAgICAgICAgLy8gYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBleHBvcnQgY2xhc3MgTGlua2VkSW1hZ2Uge1xuICAgIHNyYzogc3RyaW5nfGJvb2xlYW47XG4gICAgYWx0OiBzdHJpbmd8Ym9vbGVhbjtcbiAgICBoZWlnaHQ6IG51bWJlcnxib29sZWFuO1xuICAgIHdpZHRoOiBudW1iZXJ8Ym9vbGVhbjtcbiAgICBjb250ZXh0OiBzdHJpbmc7XG4gICAgX3N1cGVyOiBMaW5rT2JqZWN0O1xuXG5cbiAgICBjb25zdHJ1Y3RvciAoX3N1cGVyLCBjb2RlKSB7XG4gICAgICB0aGlzLmNvbnRleHQgPSBjb2RlO1xuICAgICAgdGhpcy5fc3VwZXIgPSBfc3VwZXI7XG4gICAgICB2YXIgdGFncyA9IFtcInNyY1wiLCBcImFsdFwiLCBcImhlaWdodFwiLCBcIndpZHRoXCJdO1xuICAgICAgZm9yKGxldCB0YWcgb2YgdGFncyl7XG4gICAgICAgIHZhciByZWdleCA9IG5ldyBSZWdFeHAodGFnK1wiPVxcXCIoW15cXFwiXS4qPyk/XFxcIlwiLFwiaVwiKTtcbiAgICAgICAgaWYocmVnZXgudGVzdChjb2RlKSl7XG4gICAgICAgICAgdGhpc1t0YWddID0gY29kZS5tYXRjaChyZWdleClbMV07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGxldCBoYXNXaWR0aCA9IHRoaXMud2lkdGggJiYgcGFyc2VJbnQodGhpcy53aWR0aC50b1N0cmluZygpKTtcbiAgICAgIGxldCBoYXNIZWlnaHQgPSB0aGlzLmhlaWdodCAmJiBwYXJzZUludCh0aGlzLmhlaWdodC50b1N0cmluZygpKTtcblxuICAgICAgaWYoIWhhc1dpZHRoIHx8ICFoYXNIZWlnaHQpe1xuICAgICAgICBpZih0eXBlb2YgdGhpcy5zcmMgPT09IFwic3RyaW5nXCIpe1xuICAgICAgICAgIHRoaXMucHJlbG9hZEltYWdlKHRoaXMuc3JjKTtcbiAgICAgICAgfVxuICAgICAgfSAvL2VpdGhlciBpcyBub3Qgc2V0XG5cbiAgICB9XG4gICAgcHJlbG9hZEltYWdlKHNyYyl7XG4gICAgICB2YXIgTEkgPSB0aGlzO1xuICAgICAgICB2YXIgaW1nID0gbmV3IEltYWdlKCk7XG4gICAgICAgIC8vIGltZy5zdHlsZS52aXNpYmlsaXR5ID0gXCJoaWRkZW5cIjtcbiAgICAgICAgaW1nLm9ubG9hZD1mdW5jdGlvbigpe1xuICAgICAgICAgIExJLmhlaWdodCA9IGltZy5oZWlnaHQ7XG4gICAgICAgICAgTEkud2lkdGggPSBpbWcud2lkdGg7XG4gICAgICAgICAgY29uc29sZS5sb2coaW1nLmhlaWdodCxpbWcud2lkdGgpO1xuICAgICAgICAgIGltZy5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGltZyk7XG4gICAgICAgIH07XG5cblxuICAgICAgICBpbWcuc3JjID0gPHN0cmluZz5MSS5zcmM7XG4gICAgICAgIGNvbnNvbGUubG9nKGltZyk7XG4gICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoaW1nKTtcbiAgICB9XG4gICAgZ2VuZXJhdGVPdXRwdXQoY29udGVudCk6c3RyaW5nIHtcbiAgICAgIHZhciBfdGhpcz0gdGhpcztcbiAgICAgIGlmKHRoaXMuY29udGV4dC5pbmRleE9mKFwiYWx0XCIpPi0xKXtcbiAgICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSh0aGlzLmNvbnRleHQsIGZ1bmN0aW9uKGYpe1xuICAgICAgICAgIHJldHVybiBmLnJlcGxhY2UoL2FsdFxcPVxcXCIoW15cXFwiXS4qPyk/XFxcIi9nLCBcImFsdD1cXFwiXCIgKyAoX3RoaXMuYWx0PT09dW5kZWZpbmVkP1wiXCI6X3RoaXMuYWx0KSArIFwiXFxcIlwiKTtcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKHRoaXMuY29udGV4dCwgZnVuY3Rpb24oZil7XG4gICAgICAgICAgcmV0dXJuIGYucmVwbGFjZShcIjxpbWdcIiwgXCI8aW1nIGFsdD1cXFwiXCIrKF90aGlzLmFsdD09PXVuZGVmaW5lZD9cIlwiOl90aGlzLmFsdCkrXCJcXFwiXCIpO30pO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGNvbnRlbnQ7XG4gICAgfVxuICB9XG5cbiAgZXhwb3J0IGNsYXNzIExpbmtPYmplY3Qge1xuICAgIF9zdXBlcjogRU1MV29ya3NwYWNlO1xuICAgIF9faXNDb21wbGV0ZTogYm9vbGVhbjtcblxuXG4gICAgcmVhZE9ubHk6IGJvb2xlYW47XG4gICAgY29udGV4dDogc3RyaW5nO1xuICAgIGRlbGV0ZU9uUmVuZGVyOiBib29sZWFuO1xuICAgIGVtYWlsUmVnZXg6IFJlZ0V4cDtcbiAgICBlcnJvcnM6IGFueTtcbiAgICBpZDogbnVtYmVyO1xuICAgIGxpbmU6IG51bWJlcjtcbiAgICBMaW5rZWRJbWFnZTogTGlua2VkSW1hZ2U7XG4gICAgTGlua2VkSW1hZ2VPbGQ6IExpbmtlZEltYWdlO1xuICAgIG1haWx0bzogTWFpbHRvTGlua09iamVjdDtcbiAgICBuZXc6IFVSTE9iajtcbiAgICBvbGQ6IFVSTE9iajtcbiAgICBDaGFuZ2VNb25pdG9yOiBDaGFuZ2VNb25pdG9yO1xuICAgIHNob3dNYWlsdG9FZGl0b3I6IGJvb2xlYW47XG4gICAgc2hvd1F1ZXJ5U3RyaW5nRWRpdG9yOiBib29sZWFuO1xuICAgIHF1ZXJ5U3RyaW5nczogc3RyaW5nW107XG4gICAgLy8gdXJsUmVnZXg6IFJlZ0V4cDtcbiAgICB3aGl0ZUxpc3RlZFVybDogc3RyaW5nO1xuXG5cbiAgICBjb25zdHJ1Y3RvcihsaW5lOiBudW1iZXIsIGNvbnRleHQ6IHN0cmluZywgcGFyZW50OiBFTUxXb3Jrc3BhY2Upe1xuICAgICAgdGhpcy5fX2lzQ29tcGxldGUgPSBmYWxzZTtcbiAgICAgIHRoaXMuX3N1cGVyID0gcGFyZW50O1xuXG4gICAgICB0aGlzLnNob3dRdWVyeVN0cmluZ0VkaXRvciA9IGZhbHNlO1xuICAgICAgdGhpcy5zaG93TWFpbHRvRWRpdG9yID0gZmFsc2U7XG5cbiAgICAgIHRoaXMuaWQgPSAwO1xuICAgICAgdGhpcy5saW5lID0gbGluZSArIDE7XG4gICAgICB0aGlzLmNvbnRleHQgPSBjb250ZXh0O1xuICAgICAgdGhpcy5xdWVyeVN0cmluZ3MgPSBbXTtcblxuICAgICAgdGhpcy5DaGFuZ2VNb25pdG9yID0gbmV3IENoYW5nZU1vbml0b3IodGhpcyk7XG4gICAgICB0aGlzLmVycm9ycyA9IEVNTEludGVsbGlnZW5jZS5tb2R1bGUoXCJoeXBlcmxpbmtcIikubW9uaXRvcigpO1xuICAgICAgdGhpcy5lcnJvcnMuYXNzb2NpYXRlVmFyaWFibGUoXCJMaW5rT2JqZWN0XCIsIHRoaXMpO1xuXG4gICAgICB0aGlzLndoaXRlTGlzdGVkVXJsID0gXCJ+fndoaXRlbGlzdH5+XCI7XG5cbiAgICAgIC8vZmluZCBocmVmXG4gICAgICB0aGlzLl9fbG9jYXRlSHJlZihjb250ZXh0KTtcbiAgICAgIC8vZmluZCBpbWFnZVxuICAgICAgdGhpcy5fX2xvY2F0ZUxpbmtlZEltYWdlKGNvbnRleHQpO1xuXG4gICAgICAvL25lZWQgdG8gc2V0IHRoZSB1cmwgYmVmb3JlIHlvdSBkbyB0aGlzO1xuICAgICAgdGhpcy5tYWlsdG8gPSBuZXcgTWFpbHRvTGlua09iamVjdCh0aGlzKTtcbiAgICAgIHRoaXMuaXNMaW5rQ29tcGxldGUoKTtcbiAgICB9XG4gICAgX19sb2NhdGVIcmVmKGNvbnRleHQpe1xuICAgICAgdmFyIHJlMiA9IC9ocmVmXFw9XFxcIihbXlxcXCJcXD5dKilcXFwiL2c7XG4gICAgICB2YXIgaHJlZiA9IGNvbnRleHQubWF0Y2gocmUyKTtcbiAgICAgIGlmKGhyZWYubGVuZ3RoPjApe1xuICAgICAgICBpZihocmVmWzBdPT1cImhyZWY9XFxcIlxcXCJcIikge1xuICAgICAgICAgIHRoaXMubmV3ID0gIG5ldyBVUkxPYmooXCIjXCIpO1xuICAgICAgICAgIHRoaXMub2xkID0gbmV3IFVSTE9iaihcIiNcIik7XG4gICAgICAgICAgdGhpcy5jb250ZXh0ID0gdGhpcy5jb250ZXh0LnJlcGxhY2UobmV3IFJlZ0V4cChcImhyZWY9XFxcIlxcXCJcIixcImdcIiksXCJocmVmPVxcXCIjXFxcIlwiKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLm5ldyA9IG5ldyBVUkxPYmooKGhyZWZbMF0uc3Vic3RyKDYsIGhyZWZbMF0ubGVuZ3RoLTcpKS50cmltKCkpO1xuICAgICAgICAgIHRoaXMub2xkID0gbmV3IFVSTE9iaigoaHJlZlswXS5zdWJzdHIoNiwgaHJlZlswXS5sZW5ndGgtNykpLnRyaW0oKSk7XG4gICAgICAgIH1cblxuICAgICAgfVxuICAgIH1cbiAgICBfX2xvY2F0ZUxpbmtlZEltYWdlKGNvbnRleHQpe1xuICAgICAgaWYoL1xcPGltZyhbXj5dLio/KVxcPi8udGVzdChjb250ZXh0KSl7XG4gICAgICAgIHZhciBmb3VuZCA9IGNvbnRleHQubWF0Y2goL1xcPGltZyhbXj5dLio/KVxcPi8pO1xuICAgICAgICBpZihmb3VuZC5sZW5ndGg+MCl7XG4gICAgICAgICAgdGhpcy5MaW5rZWRJbWFnZSA9IG5ldyBMaW5rZWRJbWFnZSh0aGlzLCBmb3VuZFswXSk7XG4gICAgICAgICAgdGhpcy5MaW5rZWRJbWFnZU9sZCA9IG5ldyBMaW5rZWRJbWFnZSh0aGlzLCBmb3VuZFswXSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBoYXNEdXBsaWNhdGVRdWVyeVN0cmluZ3MoKTogc3RyaW5nW118Ym9vbGVhbiB7XG4gICAgICB2YXIgcmVzdWx0ID0gW10sXG4gICAgICAgICAgdXNlZFN0cmluZ3MgPSBbXTtcblxuICAgICAgaWYodGhpcy5uZXcuc2VhcmNoUGFyYW1zLmVudHJpZXMubGVuZ3RoID4gMCkge1xuICAgICAgICBmb3IobGV0IGEgb2YgdGhpcy5uZXcuc2VhcmNoUGFyYW1zLmVudHJpZXMpe1xuICAgICAgICAgIHZhciBwYXJhbSA9IGEuc3BsaXQoXCI9XCIpLnNoaWZ0KCk7XG4gICAgICAgICAgaWYodXNlZFN0cmluZ3MuaW5kZXhPZihwYXJhbSk+LTEpe1xuICAgICAgICAgICAgcmVzdWx0LnB1c2gocGFyYW0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICB1c2VkU3RyaW5ncy5wdXNoKHBhcmFtKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZihyZXN1bHQubGVuZ3RoPjApe1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuXG4gICAgfVxuXG4gICAgb3ZlcnJpZGVUcmFja2luZ1JlcXVpcmVtZW50cygpe1xuICAgICAgdGhpcy53aGl0ZUxpc3RlZFVybCA9IHRoaXMubmV3LnVybDtcbiAgICB9XG4gICAgZGlzcGxheUZvcm1hdHRlZFVSTCgpe1xuICAgICAgLy9kaXNwbGF5cyB1cmw7XG4gICAgICB2YXIgY29udGVudCA9IHRoaXMuY29udGV4dDtcbiAgICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoL1xcc2VtbFxcLWlkXFw9XFxcIihbMC05XSopXFxcIi8sIFwiXCIpO1xuXG4gICAgICB2YXIgZmluZFN0YXJ0ID0gXCJocmVmPVxcXCJcIjtcbiAgICAgIHZhciBzdGFydCA9IGNvbnRlbnQuaW5kZXhPZihmaW5kU3RhcnQpO1xuICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZShuZXcgUmVnRXhwKFwiaHJlZj1cXFwiXFxcIlwiLFwiZ1wiKSwgXCJocmVmPVxcXCIjXFxcIlwiKTtcbiAgICAgIC8vIHZhciBpbWdSZWcgPSAvXFw8aW1nKFtePl0uKj8pXFw+L2c7XG4gICAgICBpZih0aGlzLkxpbmtlZEltYWdlKXtcbiAgICAgICAgY29udGVudCA9IHRoaXMuTGlua2VkSW1hZ2UuZ2VuZXJhdGVPdXRwdXQoY29udGVudCk7XG4gICAgICB9XG4gICAgICBjb250ZW50ID0gY29udGVudC5zdWJzdHIoMCwgc3RhcnQpICsgZmluZFN0YXJ0KyBcInx8fGEuaHJlZnx8fFwiICsgY29udGVudC5zdWJzdHIoc3RhcnQgKyAoZmluZFN0YXJ0Lmxlbmd0aCsodGhpcy5vbGQudXJsLmxlbmd0aCkpLCBjb250ZW50Lmxlbmd0aCApIDtcbiAgICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UobmV3IFJlZ0V4cChcIlxcXCJcIixcImdcIiksIFwiJnF1b3Q7XCIpO1xuICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZShuZXcgUmVnRXhwKFwiL1wiLFwiZ1wiKSwgXCImIzQ3O1wiKTtcbiAgICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UobmV3IFJlZ0V4cChcIj5cIixcImdcIiksIFwiJmd0O1wiKTtcbiAgICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UobmV3IFJlZ0V4cChcIjxcIixcImdcIiksIFwiJmx0O1wiKTtcblxuXG4gICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC8oW15cXHNdKj8pXFw9L2csXCI8c3BhbiBjbGFzcz1cXFwiYXR0clxcXCI+JDE8L3NwYW4+PHNwYW4gY2xhc3M9XFxcImtleXdvcmRcXFwiPj08L3NwYW4+XCIpO1xuICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvXFwmcXVvdFxcO1xcJmd0XFw7L2csXCImcXVvdDs8c3BhbiBjbGFzcz1cXFwidGFnXFxcIj4mZ3Q7PC9zcGFuPlwiKTtcbiAgICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoL1xcJlxcIzQ3XFw7XFwmZ3RcXDsvZyxcIjxzcGFuIGNsYXNzPVxcXCJ0YWdcXFwiPiYjNDc7Jmd0Ozwvc3Bhbj5cIik7XG4gICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC9cXCZxdW90XFw7KC4qPylcXCZxdW90XFw7L2csXCI8c3BhbiBjbGFzcz1cXFwidmFsdWVcXFwiPlxcXCIkMVxcXCI8L3NwYW4+XCIpO1xuICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvXFwmbHRcXDsoW2Etel0rXFxzPykvZyxcIjxzcGFuIGNsYXNzPVxcXCJ0YWdcXFwiPiZsdDskMTwvc3Bhbj5cIik7XG4gICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC9cXCZsdFxcO1xcJlxcIzQ3XFw7KFthLXpdK1xccz8pXFwmZ3RcXDsvZyxcIjxzcGFuIGNsYXNzPVxcXCJ0YWdcXFwiPiZsdDsmIzQ3OyQxJmd0Ozwvc3Bhbj5cIik7XG4gICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC9cXG4vZyxcIjxicj5cIik7XG5cbiAgICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoL1xcJmd0XFw7L2csXCI8c3BhbiBjbGFzcz1cXFwidGFnXFxcIj4mZ3Q7PC9zcGFuPlwiKTtcbiAgICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoL1xcc3szfS9nLFwiJm5ic3A7Jm5ic3A7Jm5ic3BcIik7XG5cbiAgICAgIC8vIGlmKHRoaXMuTGlua2VkSW1hZ2UpIHtcbiAgICAgIC8vICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvXFx8XFx8XFx8aW1nXFwuYWx0XFx8XFx8XFx8L2csIHRoaXMuTGlua2VkSW1hZ2UuYWx0ID09PSB1bmRlZmluZWQgPyBcIlwiIDogdGhpcy5MaW5rZWRJbWFnZS5hbHQpO1xuICAgICAgLy8gfVxuXG4gICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC9cXHxcXHxcXHxhXFwuaHJlZlxcfFxcfFxcfC9nLCBcIjxzdHJvbmc+XCIrKHRoaXMuaGFzT3duUHJvcGVydHkoXCJkZWxldGVPblJlbmRlclwiKSAmJiB0aGlzLmRlbGV0ZU9uUmVuZGVyID8gdGhpcy5vbGQudXJsIDogdGhpcy5uZXcudXJsKStcIjwvc3Ryb25nPlwiKTtcblxuXG5cblxuXG4gICAgICByZXR1cm4gY29udGVudDtcbiAgICB9XG5cbiAgICBpc0xpbmtDb21wbGV0ZSgpe1xuICAgICAgLy9pbnRlbGxpZ2VuY2Ugc2NhbnM6XG4gICAgICB0aGlzLl9zdXBlci5pbnRlbGxpZ2VuY2UuZXZhbHVhdGVSdWxlcygpO1xuICAgICAgdGhpcy5lcnJvcnMuZXZhbHVhdGVSdWxlcygpO1xuICAgICAgLy90cmFjayBjaGFuZ2VzOlxuICAgICAgdGhpcy5DaGFuZ2VNb25pdG9yLnVwZGF0ZSgpO1xuXG4gICAgICB0aGlzLl9faXNDb21wbGV0ZT0gdGhpcy5lcnJvcnMuY2FuQ29udGludWU7XG4gICAgICBpZih0aGlzLmhhc093blByb3BlcnR5KFwiZGVsZXRlT25SZW5kZXJcIikmJiB0aGlzLmRlbGV0ZU9uUmVuZGVyKSB0aGlzLl9faXNDb21wbGV0ZSA9IHRydWU7XG4gICAgICByZXR1cm4gdGhpcy5fX2lzQ29tcGxldGU7XG4gICAgfVxuXG4gICAgaXNMaW5rVHlwZSh0eXBlKTogYm9vbGVhbiB7XG4gICAgICB2YXIgb3V0cHV0ID0gZmFsc2U7XG4gICAgICBzd2l0Y2ggKHR5cGUpIHtcbiAgICAgICAgY2FzZSBcImh0dHBcIjpcbiAgICAgICAgICBpZih0aGlzLm5ldy5wcm90b2NvbD09XCJodHRwOlwiIHx8IHRoaXMubmV3LnByb3RvY29sPT1cImh0dHBzOlwiKXtcbiAgICAgICAgICAgIG91dHB1dCA9IHRydWU7XG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwibWFpbHRvXCI6XG4gICAgICAgICAgaWYodGhpcy5uZXcucHJvdG9jb2w9PVwibWFpbHRvOlwiKXtcbiAgICAgICAgICAgIG91dHB1dCA9IHRydWU7XG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBkZWZhdWx0OlxuXG4gICAgICB9XG4gICAgICByZXR1cm4gb3V0cHV0O1xuICAgIH1cblxuICAgIGhhc1RyYWNraW5nQ29kZShvYmo/KTogYm9vbGVhbiB7Ly9zdXNwZWN0XG4gICAgICBpZihvYmo9PT11bmRlZmluZWQpIG9iaiA9IHRoaXMubmV3LnVybDtcbiAgICAgIC8vIGlmKHRoaXMud2hpdGVMaXN0ZWRVcmw9PXRoaXMubmV3KSByZXR1cm4gdHJ1ZTtcbiAgICAgIHZhciBhID0gL1thLXpdezEsNH09KC4qPzopezMsOX0vaWc7XG4gICAgICByZXR1cm4gYS50ZXN0KG9iaik7XG4gICAgfVxuICAgIHJlcXVpcmVzVHJhY2tpbmdDb2RlKG9iaj8pOiBib29sZWFuIHtcbiAgICAgIHZhciBvdXRwdXQ6IGJvb2xlYW4gPSBmYWxzZTtcbiAgICAgIGlmKEdsb2JhbFZhcnMuUmVxdWlyZXNUcmFja2luZ0NvZGVSZWdleC50ZXN0KHRoaXMubmV3LnVybCkpIHtcbiAgICAgICAgb3V0cHV0ID0gdHJ1ZTtcbiAgICAgICAgLy8gaXRlcmF0ZSBvZmVyIHdoaXRlbGlzdFxuICAgICAgICBmb3IodmFyIGkgPTA7IGkgPCBHbG9iYWxWYXJzLlJlcXVpcmVkVHJhY2tpbmdDb2RlV2hpdGVsaXN0Lmxlbmd0aDsgaSsrKXtcbiAgICAgICAgICBpZiggR2xvYmFsVmFycy5SZXF1aXJlZFRyYWNraW5nQ29kZVdoaXRlbGlzdFtpXSBpbnN0YW5jZW9mIFJlZ0V4cCkge1xuICAgICAgICAgICAgaWYoR2xvYmFsVmFycy5SZXF1aXJlZFRyYWNraW5nQ29kZVdoaXRlbGlzdFtpXVtcInRlc3RcIl0odGhpcy5uZXcudXJsKSkgeyBvdXRwdXQgPSBmYWxzZTsgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZih0aGlzLm5ldy51cmwuaW5kZXhPZihHbG9iYWxWYXJzLlJlcXVpcmVkVHJhY2tpbmdDb2RlV2hpdGVsaXN0W2ldKT4tMSkgeyBvdXRwdXQgPSBmYWxzZTsgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICB9XG4gICAgcmVxdWlyZXNTQ29kZSgpOiBib29sZWFuIHtcbiAgICAgIGlmKEdsb2JhbFZhcnMuUmVxdWlyZXNTQ29kZVJlZ2V4LnRlc3QodGhpcy5uZXcudXJsKSl7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH1cbiAgICBuZWVkc1RyYWNraW5nQ29kZSgpOiBib29sZWFuIHtcbiAgICAgIHZhciBvdXRwdXQ6IGJvb2xlYW4gPSB0aGlzLnJlcXVpcmVzVHJhY2tpbmdDb2RlKCk7XG4gICAgICBpZih0aGlzLndoaXRlTGlzdGVkVXJsPT10aGlzLm5ldy51cmwpIHJldHVybiBmYWxzZTtcbiAgICAgIC8vIGRldGVybWluZSBsaW5rcyB0aGF0IG5lZWQgc3BlY2lhbCB0cmFja2luZ1xuICAgICAgaWYodGhpcy5oYXNUcmFja2luZ0NvZGUoKSApe1xuICAgICAgICBvdXRwdXQgPSBmYWxzZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgfVxuICAgIHVwZGF0ZUlucHV0KCl7XG4gICAgICBpZih0aGlzLmlzTGlua1R5cGUoJ21haWx0bycpKXtcbiAgICAgICAgdGhpcy5tYWlsdG8udXBkYXRlTWFpbHRvT2JqKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLm5ldy5zZWFyY2hQYXJhbXMudXBkYXRlRW50cmllcygpXG4gICAgICB9XG4gICAgICB0aGlzLmlzTGlua0NvbXBsZXRlKCk7XG4gICAgfVxuXG4gIH1cblxuXG5cblxuICBleHBvcnQgY2xhc3MgQ2hhbmdlTW9uaXRvcntcbiAgICBfc3VwZXI6IExpbmtPYmplY3Q7XG4gICAgbWVzc2FnZXM6IENoYW5nZU1vbml0b3JNc2dbXTtcbiAgICB2aXNpYmxlOiBib29sZWFuO1xuXG4gICAgY29uc3RydWN0b3IoX3N1cGVyKXtcbiAgICAgIHRoaXMudmlzaWJsZSA9IGZhbHNlO1xuICAgICAgdGhpcy5fc3VwZXIgPSBfc3VwZXI7XG4gICAgICB0aGlzLm1lc3NhZ2VzID0gW107XG4gICAgfVxuICAgIGNvbXBhcmVPbGRBbmROZXcoKTogc3RyaW5nW117XG4gICAgICBsZXQgdXJsUGFyYW1zID0gW1wicHJvdG9jb2xcIixcIm9yaWdpblwiLFwic2VhcmNoXCIsXCJoYXNoXCJdO1xuICAgICAgdmFyIGNoYW5nZWQgPSBbXTtcbiAgICAgIHZhciBfc3VwZXIgPSB0aGlzLl9zdXBlcjtcbiAgICAgIHVybFBhcmFtcy5mb3JFYWNoKGZ1bmN0aW9uKHBhcmFtKXtcbiAgICAgICAgaWYoX3N1cGVyLm9sZC5oYXNPd25Qcm9wZXJ0eShwYXJhbSkgJiYgX3N1cGVyLm9sZFtwYXJhbV0hPT0gX3N1cGVyLm5ld1twYXJhbV0pe1xuICAgICAgICAgIGNoYW5nZWQucHVzaChwYXJhbSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgaWYoX3N1cGVyLkxpbmtlZEltYWdlICYmIF9zdXBlci5MaW5rZWRJbWFnZS5hbHQhPT1fc3VwZXIuTGlua2VkSW1hZ2VPbGQuYWx0KXtcbiAgICAgICAgY2hhbmdlZC5wdXNoKFwiYWx0XCIpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGNoYW5nZWQ7XG4gICAgfVxuICAgIGJlZm9yZURpZFJldHVybkNoYW5nZXMoKXsgfVxuICAgIGFmdGVyRGlkUmV0dXJuQ2hhbmdlcygpeyB9XG4gICAgdXBkYXRlKCl7XG4gICAgICBpZih0aGlzLl9zdXBlci5yZWFkT25seSA9PSBmYWxzZSl7XG4gICAgICAgIHZhciBvdXRwdXQgPSBbXTtcbiAgICAgICAgbGV0IGNoYW5nZXMgPSB0aGlzLmNvbXBhcmVPbGRBbmROZXcoKTtcbiAgICAgICAgdmFyIENNID0gdGhpcztcbiAgICAgICAgY2hhbmdlcy5mb3JFYWNoKGZ1bmN0aW9uKHNjb3BlKXtcbiAgICAgICAgICBvdXRwdXQucHVzaChDTS5hcnRpY3VsYXRlQ2hhbmdlcyhzY29wZSwge30pKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMubWVzc2FnZXMgPSBvdXRwdXQ7XG4gICAgICB9XG4gICAgfVxuXG4gICAgY29tcGFyZVNlYXJjaFN0cmluZ3Mob2xkUCwgbmV3UCk6IFNlYXJjaFN0cmluZ1BheWxvYWQge1xuICAgICAgdmFyIHBheWxvYWQ6IFNlYXJjaFN0cmluZ1BheWxvYWQgPSB7XG4gICAgICAgIGFkZGVkOiBbXSxcbiAgICAgICAgdXBkYXRlZDogW10sXG4gICAgICAgIHJlbW92ZWQ6W11cbiAgICAgIH07XG4gICAgICBmb3IodmFyIGkgaW4gb2xkUCl7XG4gICAgICAgIGlmKG5ld1AuaW5kZXhPZihvbGRQW2ldKT09PS0xKXsgcGF5bG9hZC5yZW1vdmVkLnB1c2gob2xkUFtpXSkgfVxuICAgICAgfVxuICAgICAgZm9yKGkgaW4gbmV3UCl7XG4gICAgICAgIGlmKG9sZFAuaW5kZXhPZihuZXdQW2ldKT09PS0xKXsgcGF5bG9hZC5hZGRlZC5wdXNoKG5ld1BbaV0pIH1cbiAgICAgIH1cbiAgICAgIGxldCBmaW5kX3BhdHRlcm5faW5BcnJheSA9IGZ1bmN0aW9uKHBhdHRlcm46UmVnRXhwLCBhcnI6IHN0cmluZ1tdKXtcbiAgICAgICAgdmFyIG91dHB1dDogbnVtYmVyID0gLTE7XG4gICAgICAgICBmb3IodmFyIHk9MDt5PGFyci5sZW5ndGg7eSsrKXtcbiAgICAgICAgICAgLy8gY29uc29sZS5sb2coXCJ1dXBkYXRyZWQ/XCIseSk7XG4gICAgICAgICAgIGlmKHBhdHRlcm4udGVzdChhcnJbeV0pKXtcbiAgICAgICAgICAgICBvdXRwdXQgPSB5O1xuICAgICAgICAgICB9XG4gICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgICB9O1xuICAgICAgZm9yKGkgaW4gb2xkUCl7XG4gICAgICAgIHZhciByZSA9IG5ldyBSZWdFeHAob2xkUFtpXS5zcGxpdChcIj1cIilbMF0rXCI9XCIpO1xuICAgICAgICB2YXIgZm91bmQgPSBmaW5kX3BhdHRlcm5faW5BcnJheShyZSwgcGF5bG9hZC5hZGRlZCk7XG4gICAgICAgIGlmKGZvdW5kPi0xKXtcbiAgICAgICAgICBwYXlsb2FkLnVwZGF0ZWQucHVzaChwYXlsb2FkLmFkZGVkW2ZvdW5kXSk7XG4gICAgICAgICAgdmFyIG90aGVyID0gZmluZF9wYXR0ZXJuX2luQXJyYXkocmUsIHBheWxvYWQucmVtb3ZlZCk7XG4gICAgICAgICAgcGF5bG9hZC5yZW1vdmVkLnNwbGljZShvdGhlciwxKTtcbiAgICAgICAgICBwYXlsb2FkLmFkZGVkLnNwbGljZShmb3VuZCwxKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHBheWxvYWQ7XG4gICAgfVxuICAgIGFydGljdWxhdGVDaGFuZ2VzKHNjb3BlLCBhcmdzKToge21lc3NhZ2U6IHN0cmluZywgZGF0YTogYW55fSB7XG4gICAgICBpZihzY29wZT09XCJwcm90b2NvbFwiKXtcbiAgICAgICAgaWYodGhpcy5fc3VwZXIubmV3LnByb3RvY29sID09IFwibWFpbHRvOlwiKXtcbiAgICAgICAgICByZXR1cm4ge21lc3NhZ2U6IFwiQ2hhbmdlZCB0byBtYWlsdG8gbGluay5cIiwgZGF0YTogW119O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBtZXNzYWdlOiAodGhpcy5fc3VwZXIub2xkLnByb3RvY29sPT1cIlwiID8gXCJVcGRhdGVkXCIgOiBcIkNoYW5nZWRcIikrXCIgcHJvdG9jb2wgdG8gXCIgKyB0aGlzLl9zdXBlci5uZXcucHJvdG9jb2wsXG4gICAgICAgICAgICBkYXRhOiBbXVxuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZihzY29wZT09XCJvcmlnaW5cIil7XG4gICAgICAgIGlmKHRoaXMuX3N1cGVyLm5ldy5wcm90b2NvbCA9PSBcIm1haWx0bzpcIil7XG4gICAgICAgICAgcmV0dXJuIHttZXNzYWdlOiBcIkNoYW5nZWQgbWFpbHRvIGxpbmsgdG8gXCIgKyB0aGlzLl9zdXBlci5uZXcub3JpZ2luLCBkYXRhOiBbXX07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIHttZXNzYWdlOiBcIkNoYW5nZWQgbGluayBVUkwgdG8gXCIgKyB0aGlzLl9zdXBlci5uZXcub3JpZ2luLCBkYXRhOiBbXX07XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZihzY29wZT09XCJhbHRcIikge1xuICAgICAgICBpZih0aGlzLl9zdXBlci5MaW5rZWRJbWFnZS5hbHQgPT0gXCJcIil7XG4gICAgICAgICAgcmV0dXJuIHttZXNzYWdlOiBcIlJlbW92ZWQgbGlua2VkIGltYWdlIEFMVCB0ZXh0XCIsIGRhdGE6IFtdfTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4ge21lc3NhZ2U6IFwiVXBkYXRlZCBsaW5rZWQgaW1hZ2UgQUxUIHRleHQgdG8gPGI+XCIgKyB0aGlzLl9zdXBlci5MaW5rZWRJbWFnZS5hbHQgKyBcIjwvYj5cIiwgZGF0YTogW119O1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYoc2NvcGU9PVwic2VhcmNoXCIpIHtcblxuICAgICAgICBsZXQgb2xkUGFyYW1zID0gdGhpcy5fc3VwZXIub2xkLnNlYXJjaFBhcmFtcy5fZW50cmllcztcbiAgICAgICAgbGV0IG5ld1BhcmFtcyA9IHRoaXMuX3N1cGVyLm5ldy5zZWFyY2hQYXJhbXMuX2VudHJpZXM7XG5cbiAgICAgICAgbGV0IHNlYXJjaENoYW5nZXMgPSB0aGlzLmNvbXBhcmVTZWFyY2hTdHJpbmdzKG9sZFBhcmFtcywgbmV3UGFyYW1zKTtcblxuICAgICAgICB2YXIgbWVzc2FnZSA9IFwiXCI7XG4gICAgICAgIHZhciBfc3VwZXIgPSB0aGlzLl9zdXBlcjtcbiAgICAgICAgW1widXBkYXRlZFwiLFwiYWRkZWRcIixcInJlbW92ZWRcIl0uZm9yRWFjaChmdW5jdGlvbihrZXkpe1xuICAgICAgICAgIGlmKHNlYXJjaENoYW5nZXNba2V5XS5sZW5ndGg+MCl7XG4gICAgICAgICAgICBtZXNzYWdlID0gbWVzc2FnZSArIGtleVswXS50b1VwcGVyQ2FzZSgpK2tleS5zdWJzdHIoMSxrZXkubGVuZ3RoKSArIFwiIFwiKyhfc3VwZXIubmV3LnByb3RvY29sPT1cIm1haWx0bzpcIiA/IFwicGFyYW1ldGVyXCIgOiBcInF1ZXJ5IHN0cmluZ1wiKSsoc2VhcmNoQ2hhbmdlc1trZXldLmxlbmd0aD4xID8gXCJzXCI6IFwiXCIpICsgXCI6IDxiPlwiICsgc2VhcmNoQ2hhbmdlc1trZXldLmpvaW4oXCIsIFwiKSArIFwiPC9iPjxicj5cIjtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiB7IG1lc3NhZ2U6IG1lc3NhZ2UsIGRhdGE6IFtdIH07XG5cblxuICAgICAgfSBlbHNlIGlmKHNjb3BlPT1cImhhc2hcIikge1xuICAgICAgICBpZih0aGlzLl9zdXBlci5vbGQuaGFzaCA9PVwiXCIpIHtcbiAgICAgICAgICByZXR1cm4ge21lc3NhZ2U6IFwiWW91IGFkZGVkIHRoZSBoYXNoIFwiICsgdGhpcy5fc3VwZXIubmV3Lmhhc2gsIGRhdGE6W119O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmKHRoaXMuX3N1cGVyLm5ldy5oYXNoID09XCJcIil7XG4gICAgICAgICAgICByZXR1cm4ge21lc3NhZ2U6IFwiWW91IHJlbW92ZWQgdGhlIGhhc2ggXCIgKyB0aGlzLl9zdXBlci5vbGQuaGFzaCwgZGF0YTpbXX07XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB7bWVzc2FnZTogXCJZb3UgY2hhbmdlZCB0aGUgaGFzaCBmcm9tIFwiICsgdGhpcy5fc3VwZXIub2xkLmhhc2ggKyBcIiB0byBcIiArIHRoaXMuX3N1cGVyLm5ldy5oYXNoLCBkYXRhOltdfTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgfVxuICB9XG4gIGV4cG9ydCBjbGFzcyBFTUxXb3Jrc3BhY2Uge1xuXG4gICAgc2NvcGU6IGFueTtcbiAgICBidWZmZXI6IGFueTtcbiAgICBsaW5rc1ZpZXc6IHN0cmluZztcbiAgICBzb3VyY2VDb2RlOiBzdHJpbmc7XG4gICAgd29ya2luZ0NvZGU6IHN0cmluZztcbiAgICBvdXRwdXRDb2RlOiBzdHJpbmc7XG4gICAgaW50ZWxsaWdlbmNlOiBhbnk7XG4gICAgb3ZlcnJpZGRlbklkczpzdHJpbmdbXTtcbiAgICBrZXlCb2FyZFNob3J0Y3V0czogYW55W107XG4gICAgbWVzc2FnZXM6IGFueVtdO1xuICAgIGZpbGVOYW1lOiBzdHJpbmc7XG4gICAgbGlua0RhdGE6IExpbmtPYmplY3RbXTtcbiAgICBfZGVmYXVsdFNDb2RlOiBzdHJpbmc7XG4gICAgaGVhZGVyOiBhbnk7XG4gICAgZXJyb3JzOiBhbnk7XG4gICAgZXhwb3J0Rm9yRWxvcXVhOiBzdHJpbmc7XG4gICAgX19lbWxIZWFkZXJzOiBzdHJpbmc7XG4gICAgX19hbGxvd2FibGVIZWFkZXJGaWVsZHM6IGFueTtcbiAgICBoZWFkZXJzOiBzdHJpbmdbXTtcblxuICAgIGNvbnN0cnVjdG9yKGh0bWw6IHN0cmluZywgJHNjb3BlOiBhbnkpe1xuICAgICAgdGhpcy5vdmVycmlkZGVuSWRzID0gW107XG4gICAgICBpZiggaHRtbCA9PT0gdW5kZWZpbmVkKSBodG1sID0gXCJcIjtcbiAgICAgIGlmKCAkc2NvcGUgPT09IHVuZGVmaW5lZCkgJHNjb3BlID0gXCJcIjtcbiAgICAgIHZhciBXb3Jrc3BhY2UgPSB0aGlzO1xuICAgICAgdGhpcy5idWZmZXIgPSBudWxsO1xuICAgICAgdGhpcy5zY29wZSA9ICRzY29wZTtcbiAgICAgIHRoaXMubGlua3NWaWV3ID0gJ2V4cGVyaW1lbnRhbCc7IC8vYWR2YW5jZWQgc2hvd3MgYWxsXG4gICAgICB0aGlzLnNvdXJjZUNvZGUgPSBodG1sOyAvL2luaXRhbFxuICAgICAgdGhpcy53b3JraW5nQ29kZSA9IFwiXCI7XG4gICAgICB0aGlzLmZpbGVOYW1lID0gXCJlbWwtbWFrZXItdW50aXRsZWRcIjtcbiAgICAgIHRoaXMubGlua0RhdGEgPSBbXTtcbiAgICAgIHRoaXMuX2RlZmF1bHRTQ29kZSA9IFwicz1lbWFpbFwiO1xuICAgICAgdGhpcy5oZWFkZXIgPSB7XCJzdWJqZWN0XCI6XCJcIn07XG4gICAgICB0aGlzLm1lc3NhZ2VzID0gW107XG4gICAgICB0aGlzLmV4cG9ydEZvckVsb3F1YSAgPSBcIlllc1wiO1xuXG4gICAgICB0aGlzLl9fZW1sSGVhZGVycyA9IFwiXCI7XG4gICAgICB0aGlzLmtleUJvYXJkU2hvcnRjdXRzID0gW107XG4gICAgICB0aGlzLl9fYWxsb3dhYmxlSGVhZGVyRmllbGRzID0ge1xuICAgICAgICBcInRvXCI6IHtzeW50YXg6XCJUbzogXCIsIGxhYmVsOlwiVG9cIiwgaW5zdHJ1Y3Rpb25zOiBcIkEgbGlzdCBvZiBlbWFpbCBhZGRyZXNzZXMgc2VwYXJhdGVkIGJ5IGNvbW1hcy5cIn0sXG4gICAgICAgIFwic3ViamVjdFwiOiB7c3ludGF4OiBcIlN1YmplY3Q6IFwiLCBsYWJlbDpcIlN1YmplY3RcIiwgaW5zdHJ1Y3Rpb25zOiBcIlwifSxcbiAgICAgICAgXCJjY1wiIDoge3N5bnRheDpcIkNjOiBcIiwgbGFiZWw6XCJDQ1wiLCBpbnN0cnVjdGlvbnM6IFwiQSBsaXN0IG9mIGVtYWlsIGFkZHJlc3NlcyBzZXBhcmF0ZWQgYnkgY29tbWFzLlwifSxcbiAgICAgICAgXCJyZXBseXRvXCI6IHsgc3ludGF4OlwiUmVwbHktdG86IFwiLCBsYWJlbDpcIlJlcGx5IHRvXCIsIGluc3RydWN0aW9uczogXCJBIGxpc3Qgb2YgZW1haWwgYWRkcmVzc2VzIHNlcGFyYXRlZCBieSBjb21tYXMuXCJ9XG4gICAgICB9O1xuICAgICAgdGhpcy5oZWFkZXJzID0gW1xuICAgICAgICBcIlgtVW5zZW50OiAxXCIsXG4gICAgICAgIFwiTWltZS1WZXJzaW9uOiAxLjAgKE1hYyBPUyBYIE1haWwgMTAuMSBcXCgzMjUxXFwpKVwiLFxuICAgICAgICBcIlgtVW5pZm9ybS1UeXBlLUlkZW50aWZpZXI6IGNvbS5hcHBsZS5tYWlsLWRyYWZ0XCIsXG4gICAgICAgIFwiQ29udGVudC1UcmFuc2Zlci1FbmNvZGluZzogN2JpdFwiXG4gICAgICBdO1xuICAgICAgdGhpcy5pbnRlbGxpZ2VuY2UgPSBFTUxJbnRlbGxpZ2VuY2UubW9kdWxlKFwiZW1haWxcIikubW9uaXRvcigpO1xuICAgICAgdGhpcy5pbnRlbGxpZ2VuY2UuYXNzb2NpYXRlVmFyaWFibGUoXCJFTUxXb3Jrc3BhY2VcIiwgdGhpcyk7XG4gICAgfVxuICAgIG1hcExpbmtPYmplY3RzKGNhbGxiYWNrKXtcbiAgICAgIGlmKHRoaXMubGlua0RhdGEubGVuZ3RoPjApe1xuICAgICAgICBmb3IodmFyIGk9MDsgaTx0aGlzLmxpbmtEYXRhLmxlbmd0aDsgaSsrKXtcbiAgICAgICAgICBjYWxsYmFjayh0aGlzLmxpbmtEYXRhW2ldKTtcbiAgICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGNvbXBvc2VFTUwoKTp2b2lke1xuICAgICAgbG9jYXRpb24uaHJlZj0gXCIjL2V4cG9ydC1jb21wb3NlLWVtbFwiO1xuICAgIH1cblxuICAgIGRvd25sb2FkRW1sKCk6dm9pZHtcbiAgICAgIHRoaXMuYmVmb3JlRGlkRG93bmxvYWRFbWwoKTtcbiAgICAgIHZhciBvdXRwdXQgPSB0aGlzLl9fZW1sSGVhZGVycyArIFwiXFxuXFxuXCIgKyB0aGlzLl9fcmVtb3ZlV2hpdGVTcGFjZSh0aGlzLl9fcmVwbGFjZUVsb3F1YU1lcmdlRmllbGRzKHRoaXMuZ2VuZXJhdGVPdXRwdXRDb2RlKFwib2Z0XCIpKSk7XG4gICAgICB0aGlzLmZpbGVOYW1lID0gdGhpcy5fX2Zvcm1hdEZpbGVOYW1lKHRoaXMuZmlsZU5hbWUpO1xuICAgICAgd2luZG93LnNhdmVBcyhuZXcgQmxvYihbb3V0cHV0XSwge3R5cGU6XCJ0ZXh0L2h0bWxcIn0pLCB0aGlzLmZpbGVOYW1lK1wiLmVtbFwiKTtcbiAgICAgIHRoaXMuYWZ0ZXJEaWREb3dubG9hZEVtbCgpO1xuICAgIH1cbiAgICBiZWZvcmVEaWREb3dubG9hZEVtbCgpe1xuICAgICAgdGhpcy5tYXBMaW5rT2JqZWN0cyhmdW5jdGlvbihMaW5rT2JqZWN0KXtcbiAgICAgICAgaWYoTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLmhhcyhcImVscVRyYWNrXCIpKXtcbiAgICAgICAgICBsZXQgaW5kZXggPSBMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuZW50cmllcy5pbmRleE9mKFwiZWxxVHJhY2s9dHJ1ZVwiKTtcbiAgICAgICAgICBpZihpbmRleD4tMSl7XG4gICAgICAgICAgICBMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuZGVsZXRlQXRJbmRleChpbmRleCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmKCFMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuaGFzKFwic1wiKSYmIExpbmtPYmplY3QucmVxdWlyZXNTQ29kZSgpKXtcbiAgICAgICAgICBMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuYXBwZW5kKFwicz1vZnRcIik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYoTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLmdldChcInNcIik9PVwiZW1haWxcIil7XG4gICAgICAgICAgICBMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuc2V0KFwic1wiLFwib2Z0XCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICB0aGlzLm1hcExpbmtPYmplY3RzKGZ1bmN0aW9uKExpbmtPYmplY3Qpe1xuICAgICAgICBMaW5rT2JqZWN0LkNoYW5nZU1vbml0b3IudXBkYXRlKCk7XG4gICAgICB9KTtcbiAgICB9XG4gICAgYWZ0ZXJEaWREb3dubG9hZEVtbCgpe1xuICAgICAgd2luZG93LmdhKCdzZW5kJywgJ2V2ZW50JywgXCJFTUxcIiwgXCJkb3dubG9hZFwiLCBcIkVNTCBFeHBvcnRcIik7XG4gICAgICBsb2NhdGlvbi5ocmVmPSBcIiMvZXhwb3J0LWVtbFwiO1xuICAgIH1cblxuICAgIGRvd25sb2FkQ3N2KCk6dm9pZHtcbiAgICAgIHZhciBvdXRwdXQgPSBcIkNvbnRleHQsT3JpZ2luYWwgVVJMLE1vZGlmaWVkIFVSTFxcblwiO1xuICAgICAgdGhpcy5tYXBMaW5rT2JqZWN0cyhmdW5jdGlvbihMaW5rT2JqZWN0KSB7XG4gICAgICAgIG91dHB1dCArPSBMaW5rT2JqZWN0LmNvbnRleHQucmVwbGFjZSgvLC9nLCBcIihjb21tYSlcIikgKyBcIixcIiArIExpbmtPYmplY3Qub2xkLnVybCArIFwiLFwiICtMaW5rT2JqZWN0Lm5ldy51cmwgKyBcIlxcblwiO1xuICAgICAgfSk7XG4gICAgICB0aGlzLmZpbGVOYW1lID0gdGhpcy5fX2Zvcm1hdEZpbGVOYW1lKHRoaXMuZmlsZU5hbWUpO1xuICAgICAgd2luZG93LnNhdmVBcyhuZXcgQmxvYihbb3V0cHV0XSwge3R5cGU6XCJ0ZXh0L2NzdlwifSksIHRoaXMuZmlsZU5hbWUrXCJfbGlua3MuY3N2XCIpO1xuICAgICAgd2luZG93LmdhKCdzZW5kJywgJ2V2ZW50JywgXCJDU1ZcIiwgXCJkb3dubG9hZFwiLCBcIkNTViBFeHBvcnRcIik7XG4gICAgfVxuXG4gICAgZG93bmxvYWRIdG1sKCk6dm9pZHtcbiAgICAgIHZhciBvdXRwdXQgPSB0aGlzLmJlZm9yZURpZERvd25sb2FkSHRtbCh0aGlzLmdlbmVyYXRlT3V0cHV0Q29kZShcImVtYWlsXCIpKTtcbiAgICAgIHRoaXMuZmlsZU5hbWUgPSB0aGlzLl9fZm9ybWF0RmlsZU5hbWUodGhpcy5maWxlTmFtZSk7XG4gICAgICB3aW5kb3cuc2F2ZUFzKG5ldyBCbG9iKFtvdXRwdXRdLCB7dHlwZTpcInRleHQvaHRtbFwifSksIHRoaXMuZmlsZU5hbWUrXCIuaHRtbFwiKTtcbiAgICAgIHRoaXMuYWZ0ZXJEaWREb3dubG9hZEh0bWwoKTtcbiAgICB9XG4gICAgYmVmb3JlRGlkRG93bmxvYWRIdG1sKGNvZGUpe1xuICAgICAgcmV0dXJuIGNvZGU7XG4gICAgfVxuICAgIGFmdGVyRGlkRG93bmxvYWRIdG1sKCl7XG4gICAgICB3aW5kb3cuZ2EoJ3NlbmQnLCAnZXZlbnQnLCBcIkhUTUxcIiwgXCJkb3dubG9hZFwiLCBcIkhUTUwgRXhwb3J0XCIpO1xuICAgIH1cblxuXG4gICAgZXhwb3J0Q29kZVRvSFRNTCgpOnZvaWR7XG4gICAgICB0aGlzLmJlZm9yZURpZEV4cG9ydENvZGVUb0hUTUwoKTtcbiAgICAgIHRoaXMub3V0cHV0Q29kZSA9IHRoaXMuZ2VuZXJhdGVPdXRwdXRDb2RlKFwiZW1haWxcIik7XG4gICAgICB0aGlzLmFmdGVyRGlkRXhwb3J0Q29kZVRvSFRNTCgpO1xuICAgIH1cbiAgICBiZWZvcmVEaWRFeHBvcnRDb2RlVG9IVE1MKCl7XG4gICAgICBsZXQgdHJhY2tpbmdPcHRPdXQgPSBmYWxzZTtcbiAgICAgIGlmKHRoaXMuZXhwb3J0Rm9yRWxvcXVhICYmIHRoaXMuZXhwb3J0Rm9yRWxvcXVhID09IFwiWWVzXCIpIHtcbiAgICAgICAgd2luZG93LmdhKCdzZW5kJywgJ2V2ZW50JywgXCJIVE1MXCIsIFwiQWRkIEVsb3F1YSBUcmFja2luZ1wiLCBcIkFkZCBFbG9xdWEgVHJhY2tpbmdcIik7XG4gICAgICAgIHRoaXMubWFwTGlua09iamVjdHMoZnVuY3Rpb24oTGlua09iamVjdCl7XG4gICAgICAgICAgdHJhY2tpbmdPcHRPdXQgPSBMaW5rT2JqZWN0LndoaXRlTGlzdGVkVXJsID09IExpbmtPYmplY3QubmV3LnVybDtcbiAgICAgICAgICBpZighTGlua09iamVjdC5pc0xpbmtUeXBlKFwibWFpbHRvXCIpXG4gICAgICAgICAgJiYgIUxpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5oYXMoXCJlbHFUcmFja1wiKVxuICAgICAgICAgICYmICEvYXBwXFwuaW5mb1xcLm9wdHVtXFwuY29tL2dpLnRlc3QoTGlua09iamVjdC5uZXcudXJsKSl7XG4gICAgICAgICAgICBMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuYXBwZW5kKFwiZWxxVHJhY2s9dHJ1ZVwiKTtcblxuICAgICAgICAgICAgaWYodHJhY2tpbmdPcHRPdXQpIHtcbiAgICAgICAgICAgICAgTGlua09iamVjdC53aGl0ZUxpc3RlZFVybCA9IExpbmtPYmplY3QubmV3LnVybDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cblxuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMubWFwTGlua09iamVjdHMoZnVuY3Rpb24oTGlua09iamVjdCl7XG4gICAgICAgICAgaWYoTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLmhhcyhcImVscVRyYWNrXCIpKXtcbiAgICAgICAgICAgIGxldCBpbmRleCA9IExpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5lbnRyaWVzLmluZGV4T2YoXCJlbHFUcmFjaz10cnVlXCIpO1xuICAgICAgICAgICAgaWYoaW5kZXg+LTEpe1xuICAgICAgICAgICAgICBMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuZGVsZXRlQXRJbmRleChpbmRleCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBMaW5rT2JqZWN0LmlzTGlua0NvbXBsZXRlKCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIExpbmtPYmplY3QuQ2hhbmdlTW9uaXRvci51cGRhdGUoKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIHRoaXMubWFwTGlua09iamVjdHMoZnVuY3Rpb24oTGlua09iamVjdCl7XG4gICAgICAgIGlmKCFMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuaGFzKFwic1wiKSAmJiBMaW5rT2JqZWN0LnJlcXVpcmVzU0NvZGUoKSl7XG4gICAgICAgICAgTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLmFwcGVuZChcInM9ZW1haWxcIik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYoTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLmhhcyhcInNcIikgJiYgTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLmdldChcInNcIik9PVwib2Z0XCIpe1xuICAgICAgICAgICAgTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLnNldChcInNcIixcImVtYWlsXCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBMaW5rT2JqZWN0LkNoYW5nZU1vbml0b3IudXBkYXRlKCk7XG4gICAgICB9KTtcblxuICAgICAgdGhpcy5tYXBMaW5rT2JqZWN0cyhmdW5jdGlvbihMaW5rT2JqZWN0KXtcbiAgICAgICAgTGlua09iamVjdC5DaGFuZ2VNb25pdG9yLnVwZGF0ZSgpO1xuICAgICAgfSk7XG5cbiAgICB9XG4gICAgYWZ0ZXJEaWRFeHBvcnRDb2RlVG9IVE1MKCl7XG4gICAgICB0aGlzLm1hcExpbmtPYmplY3RzKGZ1bmN0aW9uKExpbmtPYmplY3Qpe1xuICAgICAgICBpZihMaW5rT2JqZWN0LndoaXRlTGlzdGVkVXJsPT1MaW5rT2JqZWN0Lm5ldy51cmwpe1xuICAgICAgICAgIC8vcmVwb3J0IHRoZSBub24gdHJhY2tlZCBsaW5rO1xuICAgICAgICAgIHdpbmRvdy5nYSgnc2VuZCcsICdldmVudCcsIFwiVHJhY2tpbmctT3B0b3V0XCIsIFwib3ZlcnJpZGVcIiwgTGlua09iamVjdC5uZXcudXJsKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICB3aW5kb3cuZ2EoJ3NlbmQnLCAnZXZlbnQnLCBcIkhUTUxcIiwgXCJ2aWV3IHNvdXJjZWNvZGVcIiwgXCJFeHBvcnQvVmlldyBIVE1MXCIpO1xuICAgICAgbG9jYXRpb24uaHJlZj0gXCIjL2V4cG9ydC1odG1sXCI7XG4gICAgfVxuXG5cbiAgICBzZXRVcFNob3J0Y3V0S2V5cygpOnZvaWR7XG4gICAgICB2YXIgX3RoaXM9IHRoaXM7XG4gICAgICB0aGlzLmtleUJvYXJkU2hvcnRjdXRzID0gW107XG5cbiAgICAgIF90aGlzLmtleUJvYXJkU2hvcnRjdXRzLnB1c2goXG4gICAgICAgIG5ldyBLZXlib2FyZFNob3J0Y3V0KFxuICAgICAgICAgIGZ1bmN0aW9uKGUpeyByZXR1cm4gKGUuY3RybEtleXx8ZS5tZXRhS2V5KSAmJiBlLnNoaWZ0S2V5ICYmIGUud2hpY2ggPT0gNTI7IH0sXG4gICAgICAgICAgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIC8vZG90aGlzO1xuICAgICAgICAgICAgX3RoaXMuc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdkb3dubG9hZGluZyBmaWxlJyk7XG4gICAgICAgICAgICAgIF90aGlzLmRvd25sb2FkSHRtbCgpO1xuXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiQ1RSTCArIFNISUZUICsgNFwiLFxuICAgICAgICAgIFwiRG93bmxvYWQgSFRNTFwiXG4gICAgICAgIClcbiAgICAgICk7XG5cbiAgICAgIF90aGlzLmtleUJvYXJkU2hvcnRjdXRzLnB1c2goXG4gICAgICAgIG5ldyBLZXlib2FyZFNob3J0Y3V0KFxuICAgICAgICAgIGZ1bmN0aW9uKGUpeyByZXR1cm4gKGUuY3RybEtleXx8ZS5tZXRhS2V5KSAmJiBlLnNoaWZ0S2V5ICYmIGUud2hpY2ggPT0gNTE7IH0sXG4gICAgICAgICAgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIC8vZG90aGlzO1xuICAgICAgICAgICAgX3RoaXMuc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgIF90aGlzLm1hcExpbmtPYmplY3RzKGZ1bmN0aW9uKExpbmtPYmplY3Qpe1xuICAgICAgICAgICAgICAgIGlmKExpbmtPYmplY3QuZXJyb3JzLm1lc3NhZ2VzLmxlbmd0aD4wKXtcbiAgICAgICAgICAgICAgICAgIExpbmtPYmplY3QuZXJyb3JzLm1lc3NhZ2VzLmZvckVhY2goZnVuY3Rpb24oTWVzc2FnZU9iamVjdCl7XG4gICAgICAgICAgICAgICAgICAgIGlmKE1lc3NhZ2VPYmplY3QudHlwZSA9PSBFcnJvclR5cGUuU3VnZ2VzdGlvbil7XG4gICAgICAgICAgICAgICAgICAgICAgTWVzc2FnZU9iamVjdC5jdGFIYW5kbGVyKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgTGlua09iamVjdC5pc0xpbmtDb21wbGV0ZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiQ1RSTCArIFNISUZUICsgM1wiLFxuICAgICAgICAgIFwiQXBwbHkgYWxsIHN1Z2dlc3Rpb25zXCJcbiAgICAgICAgKVxuICAgICAgKTtcblxuICAgICAgX3RoaXMua2V5Qm9hcmRTaG9ydGN1dHMucHVzaChcbiAgICAgICAgbmV3IEtleWJvYXJkU2hvcnRjdXQoXG4gICAgICAgICAgZnVuY3Rpb24oZSl7IHJldHVybiAoZS5jdHJsS2V5fHxlLm1ldGFLZXkpICYmIGUuc2hpZnRLZXkgJiYgZS53aGljaCA9PSA1MDsgfSxcbiAgICAgICAgICBmdW5jdGlvbigpe1xuICAgICAgICAgICAgLy9kb3RoaXM7XG4gICAgICAgICAgICBfdGhpcy5zY29wZS4kYXBwbHkoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgX3RoaXMubWFwTGlua09iamVjdHMoZnVuY3Rpb24oTGlua09iamVjdCl7XG4gICAgICAgICAgICAgICAgaWYoIUxpbmtPYmplY3QucmVhZE9ubHlcbiAgICAgICAgICAgICAgICAgICYmIExpbmtPYmplY3QucmVxdWlyZXNTQ29kZSgpXG4gICAgICAgICAgICAgICAgJiYgIUxpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5oYXMoJ3MnKSl7XG4gICAgICAgICAgICAgICAgICBMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuYXBwZW5kKCdzPWVtYWlsJyk7XG4gICAgICAgICAgICAgICAgICBMaW5rT2JqZWN0LmlzTGlua0NvbXBsZXRlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJDVFJMICsgU0hJRlQgKyAyXCIsXG4gICAgICAgICAgXCJBZGQgcz1lbWFpbCB0byBhbGwgbGlua3NcIlxuICAgICAgICApXG4gICAgICApO1xuXG4gICAgICBfdGhpcy5rZXlCb2FyZFNob3J0Y3V0cy5wdXNoKFxuICAgICAgICBuZXcgS2V5Ym9hcmRTaG9ydGN1dChcbiAgICAgICAgICBmdW5jdGlvbihlKXsgcmV0dXJuIChlLmN0cmxLZXl8fGUubWV0YUtleSkgJiYgZS5zaGlmdEtleSAmJiBlLndoaWNoID09IDQ5OyB9LFxuICAgICAgICAgIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAvL2RvdGhpcztcbiAgICAgICAgICAgIF90aGlzLnNjb3BlLiRhcHBseShmdW5jdGlvbigpe1xuICAgICAgICAgICAgICBfdGhpcy5tYXBMaW5rT2JqZWN0cyhmdW5jdGlvbihMaW5rT2JqZWN0KXtcbiAgICAgICAgICAgICAgICBpZihMaW5rT2JqZWN0LnJlYWRPbmx5KSByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICBMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuZGVsZXRlKFwib1wiKTtcbiAgICAgICAgICAgICAgICBMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuZGVsZXRlKFwib2luXCIpO1xuICAgICAgICAgICAgICAgIExpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5kZWxldGUoXCJ2XCIpO1xuICAgICAgICAgICAgICAgIExpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5kZWxldGUoXCJvaWV4XCIpO1xuICAgICAgICAgICAgICAgIExpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5kZWxldGUoXCJlbHFfbWlkXCIpO1xuICAgICAgICAgICAgICAgIExpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5kZWxldGUoXCJlbHFfbGlkXCIpO1xuICAgICAgICAgICAgICAgIExpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5kZWxldGUoXCJlbHFUcmFja1wiKTtcbiAgICAgICAgICAgICAgICBMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuZGVsZXRlKFwiZWxxVHJhY2tJZFwiKTtcbiAgICAgICAgICAgICAgICBMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuZGVsZXRlKFwic1wiKTtcbiAgICAgICAgICAgICAgICBMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuZGVsZXRlKFwiczNcIik7XG5cbiAgICAgICAgICAgICAgICBMaW5rT2JqZWN0LmlzTGlua0NvbXBsZXRlKCk7XG4gICAgICAgICAgICAgICAgX3RoaXMuYXJlTGlua3NDb21wbGV0ZSgpO1xuICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBcIkNUUkwgKyBTSElGVCArIDFcIixcbiAgICAgICAgICBcIlJlbW92ZSBhbGwgcXVlcnkgc3RyaW5ncyBmcm9tIGVtYWlsXCJcbiAgICAgICAgKVxuICAgICAgKTtcblxuXG5cbiAgICAgIGRvY3VtZW50Lm9ua2V5dXAgPSBmdW5jdGlvbihlKXtcbiAgICAgICAgZm9yKGxldCBzaG9ydGN1dCBvZiBfdGhpcy5rZXlCb2FyZFNob3J0Y3V0cyl7XG4gICAgICAgICAgaWYoc2hvcnRjdXQud2hlbiAmJiBzaG9ydGN1dC53aGVuKGUpKXtcbiAgICAgICAgICAgIHNob3J0Y3V0LmRvVGhpcygpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9XG4gICAgcmVwbGFjZVNwZWNpYWxDaGFyYWN0ZXJzKHRleHQpOnN0cmluZ3tcbiAgICAgIHZhciByZXBsYWNlID0ge1xuICAgICAgICAxNzQ6IFtcIiZyZWc7XCJdLFxuICAgICAgICAxNjk6IFtcIiZjb3B5O1wiXSxcbiAgICAgICAgODIxMSA6IFtcIiZuZGFzaDtcIl0sXG4gICAgICAgIDgyMTIgOiBbXCImbWRhc2g7XCJdLFxuICAgICAgICA4MjIwIDogW1wiJmxkcXVvO1wiXSxcbiAgICAgICAgODIyMSA6IFtcIiZyZHF1bztcIl0sXG4gICAgICAgIDgyMTYgOiBbXCImbHNxdW87XCJdLFxuICAgICAgICA4MjE3IDogW1wiJnJzcXVvO1wiXSxcbiAgICAgICAgODQ4MiA6IFtcIiZ0cmFkZTtcIl1cbiAgICAgIH07XG4gICAgICBmb3IobGV0IGkgaW4gcmVwbGFjZSl7XG4gICAgICAgIGlmKHJlcGxhY2UuaGFzT3duUHJvcGVydHkoaSkpe1xuICAgICAgICAgIHZhciByZWdleHAgPSBuZXcgUmVnRXhwKFN0cmluZy5mcm9tQ2hhckNvZGUocGFyc2VJbnQoaSkpLFwiZ1wiKTtcbiAgICAgICAgICBpZihyZWdleHAudGVzdCh0ZXh0KSl7XG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhcImZvdW5kIGNoYXJhY3RlclwiICsgU3RyaW5nLmZyb21DaGFyQ29kZShwYXJzZUludChpKSkpO1xuICAgICAgICAgICAgdGV4dCA9IHRleHQucmVwbGFjZShyZWdleHAsIHJlcGxhY2VbaV1bMF0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHRleHQ7XG4gICAgfVxuICAgIHByb2Nlc3NIdG1sKCk6dm9pZHtcbiAgICAgIC8vY3JlYXRlcyBhIG5ldyB3b3Jrc3BhY2UgZnJvbSBodG1sXG4gICAgICB0aGlzLnNldFVwU2hvcnRjdXRLZXlzKCk7XG4gICAgICB0aGlzLmxpbmtEYXRhID0gW107XG4gICAgICB0aGlzLmludGVsbGlnZW5jZS5vdmVycmlkZGVuID0gW107XG4gICAgICB0aGlzLmludGVsbGlnZW5jZS5ldmFsdWF0ZVJ1bGVzKCk7XG4gICAgICB3aW5kb3cuc2Nyb2xsVG8oMCwwKTtcbiAgICAgIC8vIC5yZXBsYWNlKG5ldyBSZWdFeHAoXCI8L2E+XCIsXCJpZ1wiKSwgXCI8L2E+XFxuXCIpXG4gICAgICB0aGlzLndvcmtpbmdDb2RlID0gdGhpcy5yZXBsYWNlU3BlY2lhbENoYXJhY3RlcnModGhpcy5zb3VyY2VDb2RlKTtcbiAgICAgIC8vZGV0ZXJtaW5lIGVtYWlsIGhlYWRlcnNcbiAgICAgIHRoaXMuX19lbWxIZWFkZXJzID0gdGhpcy5fX2J1aWxkSGVhZGVycygpO1xuICAgICAgLy8gICAkc2NvcGUuZGF0YS5oZWFkZXIsXG4gICAgICAvLyAgICRzY29wZS5kYXRhLmFsbG93YWJsZUhlYWRlckZpZWxkcyk7XG5cbiAgICAgIC8vcmVwbGFjZSBtZXJnZSBmaWVsZHNcbiAgICAgIGlmKHRoaXMuZmlsZU5hbWU9PVwidW50aXRsZWRcIil7XG4gICAgICAgIHZhciB0aXRsZVJlZyA9IC88dGl0bGU+KFtePF0uKj8pPFxcL3RpdGxlPi9naTtcbiAgICAgICAgaWYodGl0bGVSZWcudGVzdCh0aGlzLndvcmtpbmdDb2RlKSl7XG4gICAgICAgICAgdmFyIHRpdGxlVGFnID0gdGhpcy53b3JraW5nQ29kZS5tYXRjaCh0aXRsZVJlZyk7XG4gICAgICAgICAgaWYodGl0bGVUYWcubGVuZ3RoPjApe1xuICAgICAgICAgICAgdGhpcy5maWxlTmFtZSA9IHRoaXMuX19mb3JtYXRGaWxlTmFtZSh0aXRsZVRhZ1swXS5yZXBsYWNlKHRpdGxlUmVnLCBcIiQxXCIpKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHZhciBfc3VwZXIgPSB0aGlzO1xuICAgICAgdmFyIHJlMSA9IC88YVxcYltePl0qPz4oW1xcclxcbl18LikqPzxcXC9hPi9nbSwgbiA9IDA7XG4gICAgICB0aGlzLndvcmtpbmdDb2RlID0gdGhpcy53b3JraW5nQ29kZS5yZXBsYWNlKHJlMSwgZnVuY3Rpb24oZm91bmQpe1xuICAgICAgICBuKys7IHJldHVybiBmb3VuZC5yZXBsYWNlKFwiPGFcIiwgXCI8YSBlbWwtaWQ9XFxcIlwiK24rXCJcXFwiXCIpO1xuICAgICAgfSk7XG5cbiAgICAgIG4gPSAwO1xuICAgICAgdGhpcy53b3JraW5nQ29kZSA9IHRoaXMud29ya2luZ0NvZGUucmVwbGFjZShyZTEsIGZ1bmN0aW9uKGNvbnRleHQpe1xuICAgICAgICBuKys7XG4gICAgICAgIC8vZ2V0IGxpbmVcbiAgICAgICAgdmFyIGxpbmUgPSBfc3VwZXIud29ya2luZ0NvZGUuc3Vic3RyKDAsIF9zdXBlci53b3JraW5nQ29kZS5pbmRleE9mKGNvbnRleHQpKS5zcGxpdChcIlxcblwiKS5sZW5ndGgtMTtcblxuICAgICAgICBpZigvKGhyZWZcXD1cXFwiKFteXFxcIlxcPl0qKVxcXCI/KS9nLnRlc3QoY29udGV4dCkpe1xuICAgICAgICAgIG4rKztcbiAgICAgICAgICB2YXIgYSA9IG5ldyBMaW5rT2JqZWN0KGxpbmUsIGNvbnRleHQsIF9zdXBlcik7XG4gICAgICAgICAgYS5pZCA9IG47XG4gICAgICAgICAgYS5yZWFkT25seSA9IChhLm5ldy5jb250YWlucyhcIi5jb20vZS9lcy5hc3B4XCIpICYmIGEubmV3LmNvbnRhaW5zKFwifn5lbG9xdWFcIikpO1xuICAgICAgICAgIF9zdXBlci5saW5rRGF0YS5wdXNoKGEpO1xuICAgICAgICAgIHJldHVybiBcInt7RU1MTWFrZXJfTGluazpcIituK1wifX1cIjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gY29udGV4dDtcbiAgICAgICAgfVxuXG4gICAgICB9KTtcblxuXG4gICAgICB0aGlzLm1hcExpbmtPYmplY3RzKGZ1bmN0aW9uKExpbmtPYmplY3Qpe1xuICAgICAgICBMaW5rT2JqZWN0LmlzTGlua0NvbXBsZXRlKCk7XG4gICAgICB9KTtcblxuXG4gICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLmludGVsbGlnZW5jZSk7XG4gICAgICAvL3JlZGlyZWN0XG5cbiAgICAgIGxvY2F0aW9uLmhyZWY9XCIjL2xpbmtzXCI7XG4gICAgfVxuICAgIGFkZE5ld0hlYWRlckZpZWxkKHZhbHVlKXtcbiAgICAgIHRoaXMuaGVhZGVyW3ZhbHVlXSA9IFwiXCI7XG4gICAgfVxuICAgIHJlbW92ZUhlYWRlckZpZWxkKHZhbHVlKXtcbiAgICAgIGRlbGV0ZSB0aGlzLmhlYWRlclt2YWx1ZV07XG4gICAgfVxuICAgIGlzSGVhZGVyU2VsZWN0ZWQoaGVhZGVyKTpib29sZWFue1xuICAgICAgaWYoIXRoaXMuaGVhZGVyLmhhc093blByb3BlcnR5KGhlYWRlcikgfHwgdGhpcy5oZWFkZXI9PVwiXCIgICkgeyByZXR1cm4gdHJ1ZTsgfVxuICAgICAgZWxzZSB7IHJldHVybiBmYWxzZTsgfVxuICAgIH1cbiAgICB2ZXJpZnlMaW5rU2VjdGlvbkNvbXBsZXRlKCk6Ym9vbGVhbntcbiAgICAgIHZhciBvdXRwdXQgPSBmYWxzZTtcblxuICAgICAgaWYodGhpcy5pbnRlbGxpZ2VuY2UgJiYgIXRoaXMuaW50ZWxsaWdlbmNlLmNhbkNvbnRpbnVlKXtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICAgIC8vIGFyZSB0aGVyZSBsaW5rIGlzc3Vlcz9cbiAgICAgIGlmICh0aGlzLmxpbmtEYXRhICYmIHRoaXMubGlua0RhdGEubGVuZ3RoID09IDApIHtcbiAgICAgICAgb3V0cHV0ID0gZmFsc2U7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAodGhpcy5hcmVMaW5rc0NvbXBsZXRlKCkpIHtcbiAgICAgICAgICBvdXRwdXQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgIG91dHB1dCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gb3V0cHV0O1xuICAgIH1cblxuXG4gICAgZ2VuZXJhdGVPdXRwdXRDb2RlKHR5cGU/LCBjbG9uZT8pOnN0cmluZ3tcbiAgICAgIGlmKHR5cGUgPT09IHVuZGVmaW5lZCkgdHlwZSA9IFwiZW1haWxcIjtcbiAgICAgIGlmKGNsb25lID09PSB1bmRlZmluZWQpIGNsb25lID0gdHJ1ZTtcbiAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICB2YXIgb3V0cHV0OnN0cmluZyA9IHRoaXMud29ya2luZ0NvZGU7XG5cbiAgICAgIC8vcG9zdCBwcm9jZXNzaW5nLlxuICAgICAgLy9kbyBwb3N0IHByb2Nlc3NpbmcuXG4gICAgICAvL2V4cG9ydCBjb2RlP1xuICAgICAgdGhpcy5tYXBMaW5rT2JqZWN0cyhmdW5jdGlvbihMaW5rT2JqZWN0KXtcblxuICAgICAgICBpZihMaW5rT2JqZWN0Lmhhc093blByb3BlcnR5KFwiZGVsZXRlT25SZW5kZXJcIikmJkxpbmtPYmplY3QuZGVsZXRlT25SZW5kZXIpe1xuICAgICAgICAgIG91dHB1dCA9IG91dHB1dC5yZXBsYWNlKG5ldyBSZWdFeHAoXCJ7e0VNTE1ha2VyX0xpbms6XCIrTGlua09iamVjdC5pZCtcIn19XCIsIFwiZ2lcIiksIFwiXCIpO1xuICAgICAgICB9IGVsc2UgaWYoTGlua09iamVjdC5yZWFkT25seSkge1xuICAgICAgICAgIGxldCByZWFkT25seVVybCA9IExpbmtPYmplY3QuY29udGV4dC5yZXBsYWNlKC9lbWxcXC1pZFxcPVxcXCJbMC05XXsxLH1cXFwiXFxzL2csXCJcIik7XG4gICAgICAgICAgb3V0cHV0ID0gb3V0cHV0LnJlcGxhY2UobmV3IFJlZ0V4cChcInt7RU1MTWFrZXJfTGluazpcIitMaW5rT2JqZWN0LmlkK1wifX1cIiwgXCJnaVwiKSwgcmVhZE9ubHlVcmwpO1xuICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgdmFyIHN0YXJ0ID0gTGlua09iamVjdC5jb250ZXh0LmluZGV4T2YoXCJocmVmPVxcXCJcIiArIExpbmtPYmplY3Qub2xkLnVybCk7XG4gICAgICAgICAgLy8gY29kZUxpbmVzW2xpbmVdID0gY29kZUxpbmVzW2xpbmVdLnN1YnN0cigwLCBzdGFydCkgKyBcImhyZWY9XFxcIlwiICsgTGlua09iamVjdC5uZXcudXJsICsgY29kZUxpbmVzW2xpbmVdLnN1YnN0cihzdGFydCs2K0xpbmtPYmplY3Qub2xkLnVybC5sZW5ndGgsIGNvZGVMaW5lc1tsaW5lXS5sZW5ndGgpO1xuICAgICAgICAgIC8vdGhpcyBpcyB3aGVyZSB3ZSB1cGRhdGUgdGhlIGNvbnRleHQ7XG4gICAgICAgICAgdmFyIG5ld0NvbnRleHQgPSBMaW5rT2JqZWN0LmNvbnRleHQ7XG4gICAgICAgICAgbmV3Q29udGV4dCA9IG5ld0NvbnRleHQuc3Vic3RyKDAsc3RhcnQpICsgXCJocmVmPVxcXCJcIiArIExpbmtPYmplY3QubmV3LnVybCArIG5ld0NvbnRleHQuc3Vic3RyKHN0YXJ0KzYrTGlua09iamVjdC5vbGQudXJsLmxlbmd0aCwgbmV3Q29udGV4dC5sZW5ndGgpO1xuICAgICAgICAgIGlmKExpbmtPYmplY3QuTGlua2VkSW1hZ2Upe1xuICAgICAgICAgICAgbmV3Q29udGV4dCA9IExpbmtPYmplY3QuTGlua2VkSW1hZ2UuZ2VuZXJhdGVPdXRwdXQobmV3Q29udGV4dCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIG5ld0NvbnRleHQgPSBuZXdDb250ZXh0LnJlcGxhY2UoL1xccz9lbWxcXC1pZFxcPVxcXCJbMC05XSpcXFwiL2csXCJcIik7XG4gICAgICAgICAgLy90aGVuIHVwZGF0ZSB0aGUgd29ya2luZyBjb2RlIHdpdGggdGhlIG5ldyBjb250ZXh0O1xuICAgICAgICAgIG91dHB1dCA9IG91dHB1dC5yZXBsYWNlKG5ldyBSZWdFeHAoXCJ7e0VNTE1ha2VyX0xpbms6XCIrTGlua09iamVjdC5pZCtcIn19XCIsIFwiZ2lcIiksIG5ld0NvbnRleHQpO1xuICAgICAgICB9XG5cbiAgICAgIH0pO1xuXG4gICAgICAvL2ZpbmQgYWxsIGltYWdlcyB3aXRob3V0IGFsdCBhdHRyaWJ1dGUgYW5kIGFkZCBhbHQ9XCJcIjtcbiAgICAgIG91dHB1dCA9IG91dHB1dC5yZXBsYWNlKC9cXDxpbWdbXlxcPl0uKj9cXD4vZ2ksIGZ1bmN0aW9uKGZvdW5kKXtcbiAgICAgICAgaWYoZm91bmQuaW5kZXhPZihcImFsdD1cIik+LTEpe1xuICAgICAgICAgIHJldHVybiBmb3VuZDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gZm91bmQucmVwbGFjZSgvXFw8aW1nL2dpLCBcIjxpbWcgYWx0PVxcXCJcXFwiXCIpO1xuICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICB0cnkge1xuICAgICAgICBvdXRwdXQgPSBvdXRwdXQucmVwbGFjZSgvPFxcL2E+XFxuezAsNX0oXFwufCx8XFw/fCF8Onw7fFxcfCkvZywgXCI8L2E+JDFcIik7XG4gICAgICB9IGNhdGNoKGUpe1xuICAgICAgICBjb25zb2xlLmxvZyhcImVycm9yIG1lcmdpbmcgbGluZXMgd2l0aCBsaW5rcyB0aGF0IHByZXZpb3VzbHkgaGFkIHB1bmN0dWF0aW9uLlwiKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgfVxuICAgIHVwZGF0ZUxpbmtzQW5kRXhwb3J0KCk6Ym9vbGVhbntcbiAgICAgIGlmKCF0aGlzLmFyZUxpbmtzQ29tcGxldGUoKSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG5cblxuICAgICAgbG9jYXRpb24uaHJlZj1cIiMvZXhwb3J0XCI7XG4gICAgICB3aW5kb3cuc2Nyb2xsVG8oMCwwKTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICBhcmVMaW5rc0NvbXBsZXRlKCk6Ym9vbGVhbntcbiAgICAgIHZhciBvdXRwdXQgPSB0cnVlO1xuXG4gICAgICB0aGlzLm1hcExpbmtPYmplY3RzKGZ1bmN0aW9uKExpbmtPYmplY3Qpe1xuXG4gICAgICAgIGlmKCFMaW5rT2JqZWN0Ll9faXNDb21wbGV0ZSl7XG4gICAgICAgICAgb3V0cHV0ID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYoTGlua09iamVjdC5uZWVkc1RyYWNraW5nQ29kZSgpKXtcbiAgICAgICAgICBvdXRwdXQgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgfVxuICAgIGdldExpbmtzU3VtbWFyeSgpOmFueXtcbiAgICAgIHZhciBkYXRhID0ge1xuICAgICAgICBuZWVkc1RyYWNraW5nOiAwLFxuICAgICAgICBpbnZhbGlkVXJsOiAwXG4gICAgICB9O1xuICAgICAgdGhpcy5tYXBMaW5rT2JqZWN0cyhmdW5jdGlvbihMaW5rT2JqZWN0KXtcbiAgICAgICAgaWYoTGlua09iamVjdC5uZWVkc1RyYWNraW5nQ29kZSgpKSBkYXRhLm5lZWRzVHJhY2tpbmcrKztcbiAgICAgICAgaWYoTGlua09iamVjdC5pc0xpbmtDb21wbGV0ZSgpKSBkYXRhLmludmFsaWRVcmwrKztcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGRhdGE7XG4gICAgfVxuICAgIGltcG9ydEh0bWxGcm9tRmlsZURyb3AoZXZ0KTp2b2lke1xuICAgICAgaWYodGhpcy5zb3VyY2VDb2RlLmxlbmd0aD4wKSB7IHRoaXMuc291cmNlQ29kZSA9IFwiXCI7IH1cbiAgICAgIHZhciBmaWxlcyA9IGV2dC5kYXRhVHJhbnNmZXIuZmlsZXM7XG4gICAgICBpZihldnQuZGF0YVRyYW5zZmVyLmZpbGVzLmxlbmd0aD4xKXtcbiAgICAgICAgYWxlcnQoJ3lvdSBjYW4gb25seSBpbXBvcnQgb25lIGZpbGUgYXQgYXQgdGltZS4nKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpO1xuICAgICAgICB2YXIgV1MgPSB0aGlzO1xuICAgICAgICByZWFkZXIub25sb2FkZW5kID0gZnVuY3Rpb24oZXZ0KXtcbiAgICAgICAgICB2YXIgZHJvcFRleHQgPSBldnQudGFyZ2V0LnJlc3VsdDtcblxuICAgICAgICAgIHZhciBuYW1lUGFydHMgPSBmaWxlc1swXS5uYW1lLnNwbGl0KFwiLlwiKTtcbiAgICAgICAgICB2YXIgZXh0ID0gbmFtZVBhcnRzLnBvcCgpLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgV1MuZmlsZU5hbWUgPSBXUy5fX2Zvcm1hdEZpbGVOYW1lKG5hbWVQYXJ0cy5qb2luKFwiLlwiKSk7XG5cbiAgICAgICAgICBpZihleHQ9PSdlbWwnKXtcbiAgICAgICAgICAgIFdTLnNvdXJjZUNvZGUgPSBXUy5fX3N0cmlwSHRtbEFuZFN1YmplY3RGcm9tRU1MKGRyb3BUZXh0KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgV1Muc291cmNlQ29kZSA9IGRyb3BUZXh0O1xuICAgICAgICAgIH1cbiAgICAgICAgICBXUy5wcm9jZXNzSHRtbCgpO1xuICAgICAgICAgIC8vIFdTLmludGVsbGlnZW5jZSA9IEVNTE1ha2VyQUlFbmdpbmUuQ2hlY2tFbWFpbChXUyk7XG4gICAgICAgICAgbG9jYXRpb24uaHJlZiA9IFwiIy9saW5rc1wiO1xuICAgICAgICB9O1xuICAgICAgICByZWFkZXIucmVhZEFzVGV4dChmaWxlc1swXSk7XG4gICAgICAgIHdpbmRvdy5nYSgnc2VuZCcsICdldmVudCcsIFwiSFRNTFwiLCBcImltcG9ydFwiLCBcIkhUTUwgSW1wb3J0IEZpbGUgRHJvcFwiKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBzZXQgZGVmYXVsdFNDb2RlKG5ld1ZhbHVlKXtcbiAgICAgIGxldCBvbGQgPXRoaXMuX2RlZmF1bHRTQ29kZTtcblxuICAgICAgaWYob2xkIT09bmV3VmFsdWUpe1xuICAgICAgICB0aGlzLl9kZWZhdWx0U0NvZGUgPSBuZXdWYWx1ZTtcbiAgICAgICAgdGhpcy5tYXBMaW5rT2JqZWN0cyhmdW5jdGlvbihMaW5rT2JqZWN0KXtcbiAgICAgICAgICBMaW5rT2JqZWN0LmlzTGlua0NvbXBsZXRlKCk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgfVxuXG5cbiAgICBfX2Zvcm1hdEZpbGVOYW1lKG5hbWUpOnN0cmluZyB7XG4gICAgICBsZXQgX3NsdWdpZnlfc3RyaXBfcmUgPSAvW15cXHdcXHMtXS9nO1xuICAgICAgbGV0IF9zbHVnaWZ5X2h5cGhlbmF0ZV9yZSA9IC9bLVxcc10rL2c7XG4gICAgICBuYW1lID0gbmFtZS5yZXBsYWNlKF9zbHVnaWZ5X3N0cmlwX3JlLCAnJykudHJpbSgpLnRvTG93ZXJDYXNlKCk7XG4gICAgICBuYW1lID0gbmFtZS5yZXBsYWNlKF9zbHVnaWZ5X2h5cGhlbmF0ZV9yZSwgJy0nKTtcbiAgICAgIHJldHVybiBuYW1lO1xuICAgIH1cbiAgICBfX3JlcGxhY2VFbG9xdWFNZXJnZUZpZWxkcyhjb250ZW50KTpzdHJpbmd7XG4gICAgICB2YXIgcmU0ID0gLzxzcGFuKCUyMHxcXHMpY2xhc3M9XCI/ZWxvcXVhZW1haWxcIj9cXHM/PiguKj8pPFxcL3NwYW4+L2lnO1xuICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZShyZTQsIFwiIyQyI1wiKTtcbiAgICAgIHJldHVybiBjb250ZW50O1xuICAgIH1cbiAgICBfX3N0cmlwSHRtbEFuZFN1YmplY3RGcm9tRU1MKGNvZGUpOnN0cmluZ3tcbiAgICAgIHZhciBvdXRwdXQgPSBjb2RlLnNwbGl0KFwiXFxuXCIpO1xuICAgICAgdmFyIGh0bWwgPSBvdXRwdXQucG9wKCk7XG5cbiAgICAgIGZvcih2YXIgaSA9MDsgaTwgb3V0cHV0Lmxlbmd0aDsgaSsrKXtcblxuICAgICAgICBpZihvdXRwdXRbaV0uaW5kZXhPZihcIlN1YmplY3Q6XCIpPi0xKXtcbiAgICAgICAgICBpZih0aGlzLmhlYWRlciA9PT0gdW5kZWZpbmVkKSB0aGlzLmhlYWRlciA9IHt9O1xuXG4gICAgICAgICAgLy8gJHNjb3BlLiRhcHBseShmdW5jdGlvbigpe1xuICAgICAgICAgIC8vICAgICB0aGlzLmhlYWRlcltcInN1YmplY3RcIl0gPSAgb3V0cHV0W2ldLnN1YnN0cig4LG91dHB1dFtpXS5sZW5ndGgpLnRyaW0oKTtcbiAgICAgICAgICAvLyB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIGh0bWw7XG4gICAgfVxuICAgIF9fcmVtb3ZlV2hpdGVTcGFjZShjb2RlKTpzdHJpbmcge1xuICAgICAgdmFyIG91dHB1dCA9IGNvZGU7XG4gICAgICBvdXRwdXQgPSBvdXRwdXQucmVwbGFjZShuZXcgUmVnRXhwKFwiXFxuXCIsIFwiZ1wiKSwgXCIgXCIpO1xuICAgICAgb3V0cHV0ID0gb3V0cHV0LnJlcGxhY2UobmV3IFJlZ0V4cChcIlxcdFwiLCBcImdcIiksIFwiIFwiKTtcbiAgICAgIG91dHB1dCA9IG91dHB1dC5yZXBsYWNlKC9cXHN7Miw5OTk5OX0vZywgXCIgXCIpO1xuICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICB9XG4gICAgX19idWlsZEhlYWRlcnMoKTpzdHJpbmd7XG4gICAgICB2YXIgaGVhZGVyczpzdHJpbmdbXSA9IFtdO1xuICAgICAgZm9yKHZhciBpPTA7IGk8dGhpcy5oZWFkZXJzLmxlbmd0aDsgaSsrKXsgaGVhZGVycy5wdXNoKHRoaXMuaGVhZGVyc1tpXSk7IH1cbiAgICAgIHZhciBjaGFyc2V0ID0gdGhpcy5fX2dldENoYXJzZXRGcm9tSFRNTCh0aGlzLnNvdXJjZUNvZGUpO1xuICAgICAgaWYoY2hhcnNldCA9PSBcIlwiKSBjaGFyc2V0ID0gXCJjaGFyc2V0PVVURi04XCI7XG4gICAgICBoZWFkZXJzLnB1c2goXCJDb250ZW50LVR5cGU6IHRleHQvaHRtbDtcXG5cXHRcIiArIGNoYXJzZXQpO1xuXG4gICAgICAvLyBjb25zb2xlLmxvZyhoZWFkZXJzLCBhbGxvd2FibGVIZWFkZXJGaWVsZHMpO1xuICAgICAgZm9yKGxldCBpIGluIHRoaXMuaGVhZGVyKXtcbiAgICAgICAgaWYodGhpcy5oZWFkZXIuaGFzT3duUHJvcGVydHkoaSkpe1xuICAgICAgICAgIGlmKHRoaXMuX19hbGxvd2FibGVIZWFkZXJGaWVsZHMuaGFzT3duUHJvcGVydHkoaSkpe1xuICAgICAgICAgICAgaGVhZGVycy5wdXNoKFxuICAgICAgICAgICAgICB0aGlzLl9fYWxsb3dhYmxlSGVhZGVyRmllbGRzW2ldLnN5bnRheCArIFwiIFwiICsgdGhpcy5oZWFkZXJbaV1cbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICB0aGlzLl9fZW1sSGVhZGVycyA9IGhlYWRlcnMuam9pbihcIlxcblwiKTtcbiAgICAgIHJldHVybiBoZWFkZXJzLmpvaW4oXCJcXG5cIik7XG4gICAgfVxuICAgIF9fZ2V0Q2hhcnNldEZyb21IVE1MKGNvbnRlbnQpOnN0cmluZ3tcbiAgICAgIHZhciByZTUgPSAvPG1ldGEuKj9jaGFyc2V0PShbXlxcc1wiXSopL2lnLCBjaGFyc2V0ID1cIlwiO1xuXG4gICAgICB2YXIgbWV0YVRhZ3MgPSBjb250ZW50Lm1hdGNoKHJlNSk7XG4gICAgICBpZihtZXRhVGFncyl7XG4gICAgICAgIG1ldGFUYWdzLmZvckVhY2goZnVuY3Rpb24oaXRlbSl7XG4gICAgICAgICAgdmFyIGNoYXJzZXRWYWxzID0gaXRlbS5tYXRjaCgvY2hhcnNldD0oW15cXHNcIl0qKS9pZyk7XG4gICAgICAgICAgaWYoY2hhcnNldFZhbHMpe1xuICAgICAgICAgICAgY2hhcnNldCA9IGNoYXJzZXRWYWxzWzBdO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjaGFyc2V0ID0gXCJjaGFyc2V0PVVURi04XCI7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGNoYXJzZXQ7XG4gICAgfVxuXG4gIH1cblxuXG4gIGV4cG9ydCBjbGFzcyBLZXlib2FyZFNob3J0Y3V0IHtcblxuICAgIHdoZW4gOiAoKT0+Ym9vbGVhbjtcbiAgICBkb1RoaXMgOiAoKT0+dm9pZDtcbiAgICBkZXNjcmlwdGlvbjogc3RyaW5nO1xuICAgIGtleXM6IHN0cmluZztcblxuICAgIGNvbnN0cnVjdG9yKHdoZW4sIGRvVGhpcywga2V5cywgZGVzY3JpcHRpb24pe1xuXG4gICAgICB0aGlzLndoZW4gPSB3aGVuO1xuICAgICAgdGhpcy5kb1RoaXMgPSBkb1RoaXM7XG4gICAgICB0aGlzLmtleXMgPSBrZXlzO1xuICAgICAgdGhpcy5kZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uO1xuICAgIH1cbiAgfVxuXG5cbn1cbiIsInZhciBFcnJvclNldmVyaXR5O1xuKGZ1bmN0aW9uIChFcnJvclNldmVyaXR5KSB7XG4gICAgRXJyb3JTZXZlcml0eVtFcnJvclNldmVyaXR5W1wiSGlnaFwiXSA9IDFdID0gXCJIaWdoXCI7XG4gICAgRXJyb3JTZXZlcml0eVtFcnJvclNldmVyaXR5W1wiTWVkaXVtXCJdID0gMl0gPSBcIk1lZGl1bVwiO1xuICAgIEVycm9yU2V2ZXJpdHlbRXJyb3JTZXZlcml0eVtcIkxvd1wiXSA9IDNdID0gXCJMb3dcIjtcbiAgICBFcnJvclNldmVyaXR5W0Vycm9yU2V2ZXJpdHlbXCJaZXJvXCJdID0gNF0gPSBcIlplcm9cIjtcbn0pKEVycm9yU2V2ZXJpdHkgfHwgKEVycm9yU2V2ZXJpdHkgPSB7fSkpO1xudmFyIEVycm9yVHlwZTtcbihmdW5jdGlvbiAoRXJyb3JUeXBlKSB7XG4gICAgRXJyb3JUeXBlW0Vycm9yVHlwZVtcIkZpeFwiXSA9IDFdID0gXCJGaXhcIjtcbiAgICBFcnJvclR5cGVbRXJyb3JUeXBlW1wiV2FyblwiXSA9IDJdID0gXCJXYXJuXCI7XG4gICAgRXJyb3JUeXBlW0Vycm9yVHlwZVtcIlN1Z2dlc3Rpb25cIl0gPSAzXSA9IFwiU3VnZ2VzdGlvblwiO1xuICAgIEVycm9yVHlwZVtFcnJvclR5cGVbXCJRQVwiXSA9IDRdID0gXCJRQVwiO1xuICAgIEVycm9yVHlwZVtFcnJvclR5cGVbXCJCZXN0UHJhY3RpY2VcIl0gPSA1XSA9IFwiQmVzdFByYWN0aWNlXCI7XG59KShFcnJvclR5cGUgfHwgKEVycm9yVHlwZSA9IHt9KSk7XG52YXIgR2xvYmFsVmFycztcbihmdW5jdGlvbiAoR2xvYmFsVmFycykge1xuICAgIEdsb2JhbFZhcnMubGFuZGluZ1BhZ2VQcmVmZXJyZWQgPSAvKFxcLm1wNHxcXC5hdml8XFwubXBlZ3xcXC5tcDN8XFwuc3dmfFxcLm1vdnxcXC5wZGYpL2k7XG4gICAgR2xvYmFsVmFycy5leHREb2VzTm90cmVxdWlyZVRyYWNraW5nQ29kZSA9IC8oXFwucGRmfFxcLm9mdHxcXC5pY3N8XFwucG5nfFxcLmpwZWd8XFwuanBnKS9pO1xuICAgIEdsb2JhbFZhcnMubGlua0VuY2Fwc3VsYXRlZFB1bmN0dWF0aW9uID0gLyhbXFwuXFw/XFwsXFw6XFwqXSspKChcXG58XFxyfFxccykrKT88XFwvYT4kLztcbiAgICBHbG9iYWxWYXJzLlJlcXVpcmVzU0NvZGVSZWdleCA9IC9odHRwKC4qKW9wdHVtKC4qKVxcLyhjYW1wYWlnbnxyZXNvdXJjZSkvaTtcbiAgICBHbG9iYWxWYXJzLlJlcXVpcmVzVHJhY2tpbmdDb2RlUmVnZXggPSBSZWdFeHAoXCJeaHR0cChzKT86XFwvXFwvKC4qPyk/b3B0dW0oLio/KT9cXC5jb1ttXFwuXT9cIik7XG4gICAgR2xvYmFsVmFycy5UZWxlcGhvbmVSZWdleCA9IC8oXFwrP1xcZHsxLDJ9KFxcc3wtfFxcLikpP1xcKD9cXGR7M31cXCk/W1xccy4tXVxcZHszLH1bXFxzLi1dXFxkezQsfS87XG4gICAgR2xvYmFsVmFycy5UZWxlcGhvbmVSZWdleEdsb2JhbCA9IC8oXFwrP1xcZHsxLDJ9KFxcc3wtfFxcLikpP1xcKD9cXGR7M31cXCk/W1xccy4tXVxcZHszLH1bXFxzLi1dXFxkezQsfS9nO1xuICAgIEdsb2JhbFZhcnMuRW1haWxSZWdleCA9IC8oKFtePD4oKVxcW1xcXVxcXFwuLDs6XFxzQFwiXSsoXFwuW148PigpXFxbXFxdXFxcXC4sOzpcXHNAXCJdKykqKXwoXCIuK1wiKSlAKChcXFtbMC05XXsxLDN9XFwuWzAtOV17MSwzfVxcLlswLTldezEsM31cXC5bMC05XXsxLDN9XFxdKXwoKFthLXpBLVpcXC0wLTldK1xcLikrW2EtekEtWl17Mix9KSkvO1xuICAgIEdsb2JhbFZhcnMuRW1haWxSZWdleEdsb2JhbCA9IC8oKFtePD4oKVxcW1xcXVxcXFwuLDs6XFxzQFwiXSsoXFwuW148PigpXFxbXFxdXFxcXC4sOzpcXHNAXCJdKykqKXwoXCIuK1wiKSlAKChcXFtbMC05XXsxLDN9XFwuWzAtOV17MSwzfVxcLlswLTldezEsM31cXC5bMC05XXsxLDN9XFxdKXwoKFthLXpBLVpcXC0wLTldK1xcLikrW2EtekEtWl17Mix9KSkvZztcbiAgICBHbG9iYWxWYXJzLlVybFJlZ2V4ID0gL14oPzooPzooPzpodHRwcz98ZnRwKTopP1xcL1xcLykoPzpcXFMrKD86OlxcUyopP0ApPyg/Oig/ISg/OjEwfDEyNykoPzpcXC5cXGR7MSwzfSl7M30pKD8hKD86MTY5XFwuMjU0fDE5MlxcLjE2OCkoPzpcXC5cXGR7MSwzfSl7Mn0pKD8hMTcyXFwuKD86MVs2LTldfDJcXGR8M1swLTFdKSg/OlxcLlxcZHsxLDN9KXsyfSkoPzpbMS05XVxcZD98MVxcZFxcZHwyWzAxXVxcZHwyMlswLTNdKSg/OlxcLig/OjE/XFxkezEsMn18MlswLTRdXFxkfDI1WzAtNV0pKXsyfSg/OlxcLig/OlsxLTldXFxkP3wxXFxkXFxkfDJbMC00XVxcZHwyNVswLTRdKSl8KD86KD86W2EtelxcdTAwYTEtXFx1ZmZmZjAtOV0tKikqW2EtelxcdTAwYTEtXFx1ZmZmZjAtOV0rKSg/OlxcLig/OlthLXpcXHUwMGExLVxcdWZmZmYwLTldLSopKlthLXpcXHUwMGExLVxcdWZmZmYwLTldKykqKD86XFwuKD86W2EtelxcdTAwYTEtXFx1ZmZmZl17Mix9KSkpKD86OlxcZHsyLDV9KT8oPzpbLz8jXVxcUyopPyQvaTtcbiAgICBHbG9iYWxWYXJzLkxpbmtIYXNUaXRsZVRhZ1JlZ2V4R2xvYmFsID0gLzxhXFxzKFtePF0qKXRpdGxlPVxcXCIoLio/KVxcXCI+L2dpO1xuICAgIEdsb2JhbFZhcnMuUHJlaGVhZGVyUmVnZXhHbG9iYWwgPSAvXFw8cFxcc1teXFw8XSpjbGFzcz1cXFwicHJlaGVhZGVyXFxcIlteXFw+XSpcXD4vZ2k7XG4gICAgR2xvYmFsVmFycy5SZXF1aXJlZFRyYWNraW5nQ29kZVdoaXRlbGlzdCA9IFtcbiAgICAgICAgJy5wZGYnLCAnLmljcycsICcub2Z0JywgJ29wdHVtc3VydmV5cy5jbycsICdoZWFsdGhpZC5vcHR1bS5jb20nLCAnbGVhcm5pbmcub3B0dW0uY29tJywgJ2FwcC5pbmZvLm9wdHVtLmNvbScsXG4gICAgICAgICdvcHR1bS53ZWJleC5jb20nLCAndHdpdHRlci5jb20nLCAnZmFjZWJvb2suY29tJywgJ2xpbmtlZGluLmNvbScsICdpbmZvLm9wdHVtJ1xuICAgIF07XG59KShHbG9iYWxWYXJzIHx8IChHbG9iYWxWYXJzID0ge30pKTtcbnZhciBFTUxNb2R1bGU7XG4oZnVuY3Rpb24gKEVNTE1vZHVsZSkge1xuICAgIHZhciBNYWlsdG9MaW5rT2JqZWN0ID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gTWFpbHRvTGlua09iamVjdChMaW5rT2JqZWN0KSB7XG4gICAgICAgICAgICB0aGlzLnBhcmVudCA9IExpbmtPYmplY3Q7XG4gICAgICAgICAgICB0aGlzLmVtYWlsID0gXCJcIjtcbiAgICAgICAgICAgIHRoaXMuc3ViamVjdCA9IFwiXCI7XG4gICAgICAgICAgICB0aGlzLmJvZHkgPSBcIlwiO1xuICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LmlzTGlua1R5cGUoJ21haWx0bycpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5pbml0RW1haWxFZGl0b3IoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBNYWlsdG9MaW5rT2JqZWN0LnByb3RvdHlwZS5oYXMgPSBmdW5jdGlvbiAob3B0aW9uKSB7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZU1haWx0b09iaigpO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXNbb3B0aW9uXSAmJiB0aGlzW29wdGlvbl0udHJpbSgpICE9PSBcIlwiO1xuICAgICAgICB9O1xuICAgICAgICBNYWlsdG9MaW5rT2JqZWN0LnByb3RvdHlwZS5pc1ZhbGlkRW1haWxBZGRyZXNzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIEdsb2JhbFZhcnMuRW1haWxSZWdleC50ZXN0KHRoaXMuZW1haWwpO1xuICAgICAgICB9O1xuICAgICAgICBNYWlsdG9MaW5rT2JqZWN0LnByb3RvdHlwZS5kZWluaXRFbWFpbEVkaXRvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMuZW1haWwgPSBcIlwiO1xuICAgICAgICAgICAgdGhpcy5zdWJqZWN0ID0gXCJcIjtcbiAgICAgICAgICAgIHRoaXMuYm9keSA9IFwiXCI7XG4gICAgICAgIH07XG4gICAgICAgIE1haWx0b0xpbmtPYmplY3QucHJvdG90eXBlLmNvbXBvc2VFbWFpbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMucGFyZW50Lm5ldy51cmwgPSBcIm1haWx0bzpcIiArIHRoaXMuZW1haWw7XG4gICAgICAgICAgICB2YXIgb3B0aW9ucyA9IFtcInN1YmplY3RcIiwgXCJib2R5XCJdO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBvcHRpb25zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXNbb3B0aW9uc1tpXV0gJiYgdGhpc1tvcHRpb25zW2ldXSAhPT0gXCJcIikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBhcmVudC5uZXcuc2VhcmNoUGFyYW1zLnNldChvcHRpb25zW2ldLCB0aGlzW29wdGlvbnNbaV1dKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAodGhpc1tvcHRpb25zW2ldXSA9PSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGFyZW50Lm5ldy5zZWFyY2hQYXJhbXMuZGVsZXRlKG9wdGlvbnNbaV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgTWFpbHRvTGlua09iamVjdC5wcm90b3R5cGUudXBkYXRlTWFpbHRvT2JqID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIHZhciBhID0gdGhpcy5wYXJlbnQubmV3LnVybC5zdWJzdHIoNywgdGhpcy5wYXJlbnQubmV3LnVybC5sZW5ndGggLSA3KTtcbiAgICAgICAgICAgIHZhciBiID0gYS5zcGxpdChcIj9cIik7XG4gICAgICAgICAgICB0aGlzLmVtYWlsID0gYlswXTtcbiAgICAgICAgICAgIHRoaXMucGFyZW50Lm5ldy5zZWFyY2hQYXJhbXMudXBkYXRlRW50cmllcygpO1xuICAgICAgICAgICAgaWYgKGIubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgICAgIFtcInN1YmplY3RcIiwgXCJib2R5XCJdLmZvckVhY2goZnVuY3Rpb24gKG9wdGlvbikge1xuICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXMucGFyZW50Lm5ldy5zZWFyY2hQYXJhbXMuaGFzKG9wdGlvbikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzW29wdGlvbl0gPSB3aW5kb3cuZGVjb2RlVVJJQ29tcG9uZW50KF90aGlzLnBhcmVudC5uZXcuc2VhcmNoUGFyYW1zLmdldChvcHRpb24pKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zdWJqZWN0ID0gXCJcIjtcbiAgICAgICAgICAgICAgICB0aGlzLmJvZHkgPSBcIlwiO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBNYWlsdG9MaW5rT2JqZWN0LnByb3RvdHlwZS5pbnB1dE9uQmx1ciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIC8vZGVjb2RlZCB1cmwgYWxsIHRoZSBlbnRyaWVzO1xuICAgICAgICAgICAgLy9yZWVuY29kZSB0aGVtLlxuICAgICAgICAgICAgdGhpcy5wYXJlbnQubmV3LnNlYXJjaFBhcmFtcy51cGRhdGVFbnRyaWVzKCk7XG4gICAgICAgICAgICB0aGlzLnBhcmVudC5uZXcuc2VhcmNoUGFyYW1zLnVwZGF0ZVNlYXJjaFByb3AoKTtcbiAgICAgICAgfTtcbiAgICAgICAgTWFpbHRvTGlua09iamVjdC5wcm90b3R5cGUub3BlbkVkaXRvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMuaW5pdEVtYWlsRWRpdG9yKCk7XG4gICAgICAgICAgICAvLyB3aW5kb3cualF1ZXJ5KFwiaHRtbCxib2R5XCIpXG4gICAgICAgICAgICAvLyAuYW5pbWF0ZSh7c2Nyb2xsVG9wOiB3aW5kb3cualF1ZXJ5KCcjbGluay0nKyh0aGlzLnBhcmVudC5pZC0xKSkub2Zmc2V0KCkudG9wIC0gNzV9LCAzMDApO1xuICAgICAgICAgICAgdmFyIExPID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhMTy5pZCAtIDEpO1xuICAgICAgICAgICAgTE8uc2hvd01haWx0b0VkaXRvciA9IHRydWU7XG4gICAgICAgIH07XG4gICAgICAgIE1haWx0b0xpbmtPYmplY3QucHJvdG90eXBlLmluaXRFbWFpbEVkaXRvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlTWFpbHRvT2JqKCk7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBNYWlsdG9MaW5rT2JqZWN0O1xuICAgIH0oKSk7XG4gICAgRU1MTW9kdWxlLk1haWx0b0xpbmtPYmplY3QgPSBNYWlsdG9MaW5rT2JqZWN0O1xuICAgIHZhciBVUkxPYmogPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBVUkxPYmoodXJsKSB7XG4gICAgICAgICAgICB0aGlzLmhyZWYgPSBcIlwiO1xuICAgICAgICAgICAgdGhpcy5zZWFyY2ggPSBcIlwiO1xuICAgICAgICAgICAgdGhpcy5vcmlnaW4gPSBcIlwiO1xuICAgICAgICAgICAgdGhpcy5oYXNoID0gXCJcIjtcbiAgICAgICAgICAgIHRoaXMucHJvdG9jb2wgPSBcIlwiO1xuICAgICAgICAgICAgdGhpcy51cmwgPSB1cmw7XG4gICAgICAgICAgICB0aGlzLnNlYXJjaFBhcmFtcyA9IG5ldyBVUkxPYmpTZWFyY2hQYXJhbXModGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgVVJMT2JqLnByb3RvdHlwZS5wcmVwYXJlRXhwb3J0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgLy9kbyBzb21ldGhpbmcgaGVyZT9cbiAgICAgICAgICAgIC8vdGhpcy5zZWFyY2hQYXJhbXMudXBkYXRlU2VhcmNoUHJvcCgpO1xuICAgICAgICB9O1xuICAgICAgICBVUkxPYmoucHJvdG90eXBlLmlzVmFsaWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gR2xvYmFsVmFycy5VcmxSZWdleC50ZXN0KHRoaXMudXJsKTtcbiAgICAgICAgfTtcbiAgICAgICAgVVJMT2JqLnByb3RvdHlwZS5jb250YWlucyA9IGZ1bmN0aW9uIChzdHIpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnVybC5pbmRleE9mKHN0cikgPiAtMSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVVJMT2JqLnByb3RvdHlwZSwgXCJ1cmxcIiwge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wcmVwYXJlRXhwb3J0KCk7XG4gICAgICAgICAgICAgICAgdmFyIHUgPSB0aGlzLm9yaWdpbiArIHRoaXMuc2VhcmNoICsgdGhpcy5oYXNoO1xuICAgICAgICAgICAgICAgIHUgPSB1LnJlcGxhY2UoXCI/dW5kZWZpbmVkXCIsIFwiXCIpO1xuICAgICAgICAgICAgICAgIHJldHVybiB1O1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNldDogZnVuY3Rpb24gKHVybCkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2VhcmNoID0gXCJcIjtcbiAgICAgICAgICAgICAgICB0aGlzLmhhc2ggPSBcIlwiO1xuICAgICAgICAgICAgICAgIHZhciBwcm90b2NvbFR5cGUgPSAvXihodHRwcz98bWFpbHRvfGZ0cClcXDovZ2k7XG4gICAgICAgICAgICAgICAgaWYgKHByb3RvY29sVHlwZS50ZXN0KHVybCkpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGEgPSB1cmwubWF0Y2gocHJvdG9jb2xUeXBlKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcm90b2NvbCA9IGFbMF07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuaHJlZiA9IHVybDtcbiAgICAgICAgICAgICAgICBpZiAodXJsLnRyaW0oKSA9PSBcIiNcIikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmhhc2ggPSBcIiNcIjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAodXJsLnRyaW0oKS5sZW5ndGggPiAxICYmIHVybC5pbmRleE9mKFwiI1wiKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB1cmxQYXJ0cyA9IHVybC5zcGxpdChcIiNcIik7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaGFzaCA9IFwiI1wiICsgdXJsUGFydHMucG9wKCk7IC8vanVtcCBsaW5rLi4gbmVlZCB0byByZW1vdmUgaXQgZnJvbSB0aGUgb3RoZXIgc3R1ZmYuXG4gICAgICAgICAgICAgICAgICAgIHZhciBwYXJ0cyA9ICh1cmxQYXJ0cy5qb2luKFwiI1wiKSkuc3BsaXQoXCI/XCIpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm9yaWdpbiA9IHBhcnRzWzBdO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlYXJjaCA9IHBhcnRzLmxlbmd0aCA+IDAgPyBcIj9cIiArIHBhcnRzWzFdIDogXCJcIjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh1cmwuaW5kZXhPZihcIj9cIikgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHBhcnRzID0gdXJsLnNwbGl0KFwiP1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub3JpZ2luID0gcGFydHNbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnNlYXJjaCA9IChwYXJ0cy5sZW5ndGggPiAwKSA/IFwiP1wiICsgcGFydHNbMV0gOiBcIlwiO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vcmlnaW4gPSB1cmw7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy90aGlzLnNlYXJjaFBhcmFtcy51cGRhdGVTZWFyY2hQcm9wKCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIFVSTE9iajtcbiAgICB9KCkpO1xuICAgIEVNTE1vZHVsZS5VUkxPYmogPSBVUkxPYmo7XG4gICAgdmFyIFVSTE9ialNlYXJjaFBhcmFtcyA9IChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIFVSTE9ialNlYXJjaFBhcmFtcyhwYXJlbnQpIHtcbiAgICAgICAgICAgIHRoaXMucGFyZW50ID0gcGFyZW50O1xuICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LnNlYXJjaC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fZW50cmllcyA9ICh0aGlzLnBhcmVudC5zZWFyY2guc3Vic3RyKDEsIHRoaXMucGFyZW50LnNlYXJjaC5sZW5ndGgpKS5zcGxpdCgvXFwmYW1wXFw7fFxcJi9nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuX2VudHJpZXMgPSBbXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVVJMT2JqU2VhcmNoUGFyYW1zLnByb3RvdHlwZSwgXCJlbnRyaWVzXCIsIHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBvdXRwdXQgPSBbXTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuX2VudHJpZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGEgPSB0aGlzLl9lbnRyaWVzW2ldLnNwbGl0KFwiPVwiKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGEubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYVsxXSA9IGRlY29kZVVSSUNvbXBvbmVudChhWzFdKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBvdXRwdXQucHVzaChhLmpvaW4oXCI9XCIpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICAgIH0pO1xuICAgICAgICBVUkxPYmpTZWFyY2hQYXJhbXMucHJvdG90eXBlLnVwZGF0ZUVudHJpZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLl9lbnRyaWVzID0gW107XG4gICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQuc2VhcmNoICE9PSBcIj9cIiAmJiB0aGlzLnBhcmVudC5zZWFyY2gubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgICAgIHZhciBwcm9wcyA9ICh0aGlzLnBhcmVudC5zZWFyY2guc3Vic3RyKDEsIHRoaXMucGFyZW50LnNlYXJjaC5sZW5ndGgpKS5zcGxpdCgvXFwmYW1wXFw7fFxcJi9nKTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2VudHJpZXMucHVzaChwcm9wc1tpXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBVUkxPYmpTZWFyY2hQYXJhbXMucHJvdG90eXBlLnVwZGF0ZVNlYXJjaFByb3AgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgb3V0cHV0ID0gW107XG4gICAgICAgICAgICBpZiAodGhpcy5fZW50cmllcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLl9lbnRyaWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBwcm9wID0gdGhpcy5fZW50cmllc1tpXS5zcGxpdChcIj1cIik7XG4gICAgICAgICAgICAgICAgICAgIGlmICgvW2Etel17MSw0fT0oLio/Oil7Myw5fS9naS50ZXN0KHRoaXMuX2VudHJpZXNbaV0pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXQucHVzaCh0aGlzLl9lbnRyaWVzW2ldKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG91dHB1dC5wdXNoKHByb3BbMF0gKyAocHJvcC5sZW5ndGggPiAxID8gXCI9XCIgKyBlbmNvZGVVUklDb21wb25lbnQoZGVjb2RlVVJJQ29tcG9uZW50KHByb3BbMV0pKSA6IFwiXCIpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMucGFyZW50LnNlYXJjaCA9IG91dHB1dC5sZW5ndGggPiAwID8gXCI/XCIgKyBvdXRwdXQuam9pbihcIiZcIikgOiBcIlwiO1xuICAgICAgICB9O1xuICAgICAgICBVUkxPYmpTZWFyY2hQYXJhbXMucHJvdG90eXBlLmhhcyA9IGZ1bmN0aW9uIChwYXJhbSkge1xuICAgICAgICAgICAgdmFyIHJlZ2V4ID0gbmV3IFJlZ0V4cChcIl5cIiArIHBhcmFtICsgXCJcXD1cIiwgXCJnXCIpO1xuICAgICAgICAgICAgdmFyIG91dHB1dCA9IGZhbHNlO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLl9lbnRyaWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKHJlZ2V4LnRlc3QodGhpcy5fZW50cmllc1tpXSkpXG4gICAgICAgICAgICAgICAgICAgIG91dHB1dCA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gb3V0cHV0O1xuICAgICAgICB9O1xuICAgICAgICBVUkxPYmpTZWFyY2hQYXJhbXMucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uIChwYXJhbSkge1xuICAgICAgICAgICAgdmFyIHJlZ2V4ID0gbmV3IFJlZ0V4cChcIl5cIiArIHBhcmFtICsgXCJcXD1cIiwgXCJnXCIpLCBvdXRwdXQgPSBmYWxzZTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5fZW50cmllcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmIChyZWdleC50ZXN0KHRoaXMuX2VudHJpZXNbaV0pKSB7XG4gICAgICAgICAgICAgICAgICAgIG91dHB1dCA9ICh0aGlzLl9lbnRyaWVzW2ldLnNwbGl0KFwiPVwiKSkucG9wKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICAgICAgfTtcbiAgICAgICAgVVJMT2JqU2VhcmNoUGFyYW1zLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAocGFyYW0sIHZhbHVlKSB7XG4gICAgICAgICAgICB2YXIgcmVnZXggPSBuZXcgUmVnRXhwKFwiXlwiICsgcGFyYW0gKyBcIlxcPVwiLCBcImdcIiksIG91dHB1dCA9IGZhbHNlO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLl9lbnRyaWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKHJlZ2V4LnRlc3QodGhpcy5fZW50cmllc1tpXSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZW50cmllc1tpXSA9IHBhcmFtICsgXCI9XCIgKyB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgb3V0cHV0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoIW91dHB1dCkge1xuICAgICAgICAgICAgICAgIHRoaXMuYXBwZW5kKHBhcmFtICsgXCI9XCIgKyB2YWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVNlYXJjaFByb3AoKTtcbiAgICAgICAgfTtcbiAgICAgICAgVVJMT2JqU2VhcmNoUGFyYW1zLnByb3RvdHlwZS5hcHBlbmQgPSBmdW5jdGlvbiAodmFsdWVQYWlyKSB7XG4gICAgICAgICAgICB0aGlzLl9lbnRyaWVzLnB1c2godmFsdWVQYWlyKTtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlU2VhcmNoUHJvcCgpO1xuICAgICAgICB9O1xuICAgICAgICBVUkxPYmpTZWFyY2hQYXJhbXMucHJvdG90eXBlLmRlbGV0ZUFsbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMuX2VudHJpZXMgPSBbXTtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlU2VhcmNoUHJvcCgpO1xuICAgICAgICB9O1xuICAgICAgICBVUkxPYmpTZWFyY2hQYXJhbXMucHJvdG90eXBlLmRlbGV0ZUF0SW5kZXggPSBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgICAgICAgIHRoaXMuX2VudHJpZXMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlU2VhcmNoUHJvcCgpO1xuICAgICAgICB9O1xuICAgICAgICBVUkxPYmpTZWFyY2hQYXJhbXMucHJvdG90eXBlLmRlbGV0ZSA9IGZ1bmN0aW9uIChwYXJhbSkge1xuICAgICAgICAgICAgLy9kb2VzbnQgZG8gYW55dGhpbmcgeWV0LlxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLl9lbnRyaWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2VudHJpZXNbaV0uc3Vic3RyKDAsIHBhcmFtLmxlbmd0aCArIDEpID09IHBhcmFtICsgXCI9XCIpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kZWxldGVBdEluZGV4KGkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIFVSTE9ialNlYXJjaFBhcmFtcztcbiAgICB9KCkpO1xuICAgIEVNTE1vZHVsZS5VUkxPYmpTZWFyY2hQYXJhbXMgPSBVUkxPYmpTZWFyY2hQYXJhbXM7XG4gICAgdmFyIExpbmtlZEltYWdlID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gTGlua2VkSW1hZ2UoX3N1cGVyLCBjb2RlKSB7XG4gICAgICAgICAgICB0aGlzLmNvbnRleHQgPSBjb2RlO1xuICAgICAgICAgICAgdGhpcy5fc3VwZXIgPSBfc3VwZXI7XG4gICAgICAgICAgICB2YXIgdGFncyA9IFtcInNyY1wiLCBcImFsdFwiLCBcImhlaWdodFwiLCBcIndpZHRoXCJdO1xuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCB0YWdzXzEgPSB0YWdzOyBfaSA8IHRhZ3NfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgdGFnID0gdGFnc18xW19pXTtcbiAgICAgICAgICAgICAgICB2YXIgcmVnZXggPSBuZXcgUmVnRXhwKHRhZyArIFwiPVxcXCIoW15cXFwiXS4qPyk/XFxcIlwiLCBcImlcIik7XG4gICAgICAgICAgICAgICAgaWYgKHJlZ2V4LnRlc3QoY29kZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpc1t0YWddID0gY29kZS5tYXRjaChyZWdleClbMV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGhhc1dpZHRoID0gdGhpcy53aWR0aCAmJiBwYXJzZUludCh0aGlzLndpZHRoLnRvU3RyaW5nKCkpO1xuICAgICAgICAgICAgdmFyIGhhc0hlaWdodCA9IHRoaXMuaGVpZ2h0ICYmIHBhcnNlSW50KHRoaXMuaGVpZ2h0LnRvU3RyaW5nKCkpO1xuICAgICAgICAgICAgaWYgKCFoYXNXaWR0aCB8fCAhaGFzSGVpZ2h0KSB7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB0aGlzLnNyYyA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByZWxvYWRJbWFnZSh0aGlzLnNyYyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSAvL2VpdGhlciBpcyBub3Qgc2V0XG4gICAgICAgIH1cbiAgICAgICAgTGlua2VkSW1hZ2UucHJvdG90eXBlLnByZWxvYWRJbWFnZSA9IGZ1bmN0aW9uIChzcmMpIHtcbiAgICAgICAgICAgIHZhciBMSSA9IHRoaXM7XG4gICAgICAgICAgICB2YXIgaW1nID0gbmV3IEltYWdlKCk7XG4gICAgICAgICAgICAvLyBpbWcuc3R5bGUudmlzaWJpbGl0eSA9IFwiaGlkZGVuXCI7XG4gICAgICAgICAgICBpbWcub25sb2FkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIExJLmhlaWdodCA9IGltZy5oZWlnaHQ7XG4gICAgICAgICAgICAgICAgTEkud2lkdGggPSBpbWcud2lkdGg7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coaW1nLmhlaWdodCwgaW1nLndpZHRoKTtcbiAgICAgICAgICAgICAgICBpbWcucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChpbWcpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGltZy5zcmMgPSBMSS5zcmM7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhpbWcpO1xuICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChpbWcpO1xuICAgICAgICB9O1xuICAgICAgICBMaW5rZWRJbWFnZS5wcm90b3R5cGUuZ2VuZXJhdGVPdXRwdXQgPSBmdW5jdGlvbiAoY29udGVudCkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIGlmICh0aGlzLmNvbnRleHQuaW5kZXhPZihcImFsdFwiKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSh0aGlzLmNvbnRleHQsIGZ1bmN0aW9uIChmKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmLnJlcGxhY2UoL2FsdFxcPVxcXCIoW15cXFwiXS4qPyk/XFxcIi9nLCBcImFsdD1cXFwiXCIgKyAoX3RoaXMuYWx0ID09PSB1bmRlZmluZWQgPyBcIlwiIDogX3RoaXMuYWx0KSArIFwiXFxcIlwiKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UodGhpcy5jb250ZXh0LCBmdW5jdGlvbiAoZikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZi5yZXBsYWNlKFwiPGltZ1wiLCBcIjxpbWcgYWx0PVxcXCJcIiArIChfdGhpcy5hbHQgPT09IHVuZGVmaW5lZCA/IFwiXCIgOiBfdGhpcy5hbHQpICsgXCJcXFwiXCIpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGNvbnRlbnQ7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBMaW5rZWRJbWFnZTtcbiAgICB9KCkpO1xuICAgIEVNTE1vZHVsZS5MaW5rZWRJbWFnZSA9IExpbmtlZEltYWdlO1xuICAgIHZhciBMaW5rT2JqZWN0ID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gTGlua09iamVjdChsaW5lLCBjb250ZXh0LCBwYXJlbnQpIHtcbiAgICAgICAgICAgIHRoaXMuX19pc0NvbXBsZXRlID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLl9zdXBlciA9IHBhcmVudDtcbiAgICAgICAgICAgIHRoaXMuc2hvd1F1ZXJ5U3RyaW5nRWRpdG9yID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLnNob3dNYWlsdG9FZGl0b3IgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuaWQgPSAwO1xuICAgICAgICAgICAgdGhpcy5saW5lID0gbGluZSArIDE7XG4gICAgICAgICAgICB0aGlzLmNvbnRleHQgPSBjb250ZXh0O1xuICAgICAgICAgICAgdGhpcy5xdWVyeVN0cmluZ3MgPSBbXTtcbiAgICAgICAgICAgIHRoaXMuQ2hhbmdlTW9uaXRvciA9IG5ldyBDaGFuZ2VNb25pdG9yKHRoaXMpO1xuICAgICAgICAgICAgdGhpcy5lcnJvcnMgPSBFTUxJbnRlbGxpZ2VuY2UubW9kdWxlKFwiaHlwZXJsaW5rXCIpLm1vbml0b3IoKTtcbiAgICAgICAgICAgIHRoaXMuZXJyb3JzLmFzc29jaWF0ZVZhcmlhYmxlKFwiTGlua09iamVjdFwiLCB0aGlzKTtcbiAgICAgICAgICAgIHRoaXMud2hpdGVMaXN0ZWRVcmwgPSBcIn5+d2hpdGVsaXN0fn5cIjtcbiAgICAgICAgICAgIC8vZmluZCBocmVmXG4gICAgICAgICAgICB0aGlzLl9fbG9jYXRlSHJlZihjb250ZXh0KTtcbiAgICAgICAgICAgIC8vZmluZCBpbWFnZVxuICAgICAgICAgICAgdGhpcy5fX2xvY2F0ZUxpbmtlZEltYWdlKGNvbnRleHQpO1xuICAgICAgICAgICAgLy9uZWVkIHRvIHNldCB0aGUgdXJsIGJlZm9yZSB5b3UgZG8gdGhpcztcbiAgICAgICAgICAgIHRoaXMubWFpbHRvID0gbmV3IE1haWx0b0xpbmtPYmplY3QodGhpcyk7XG4gICAgICAgICAgICB0aGlzLmlzTGlua0NvbXBsZXRlKCk7XG4gICAgICAgIH1cbiAgICAgICAgTGlua09iamVjdC5wcm90b3R5cGUuX19sb2NhdGVIcmVmID0gZnVuY3Rpb24gKGNvbnRleHQpIHtcbiAgICAgICAgICAgIHZhciByZTIgPSAvaHJlZlxcPVxcXCIoW15cXFwiXFw+XSopXFxcIi9nO1xuICAgICAgICAgICAgdmFyIGhyZWYgPSBjb250ZXh0Lm1hdGNoKHJlMik7XG4gICAgICAgICAgICBpZiAoaHJlZi5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgaWYgKGhyZWZbMF0gPT0gXCJocmVmPVxcXCJcXFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5uZXcgPSBuZXcgVVJMT2JqKFwiI1wiKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vbGQgPSBuZXcgVVJMT2JqKFwiI1wiKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb250ZXh0ID0gdGhpcy5jb250ZXh0LnJlcGxhY2UobmV3IFJlZ0V4cChcImhyZWY9XFxcIlxcXCJcIiwgXCJnXCIpLCBcImhyZWY9XFxcIiNcXFwiXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5uZXcgPSBuZXcgVVJMT2JqKChocmVmWzBdLnN1YnN0cig2LCBocmVmWzBdLmxlbmd0aCAtIDcpKS50cmltKCkpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm9sZCA9IG5ldyBVUkxPYmooKGhyZWZbMF0uc3Vic3RyKDYsIGhyZWZbMF0ubGVuZ3RoIC0gNykpLnRyaW0oKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBMaW5rT2JqZWN0LnByb3RvdHlwZS5fX2xvY2F0ZUxpbmtlZEltYWdlID0gZnVuY3Rpb24gKGNvbnRleHQpIHtcbiAgICAgICAgICAgIGlmICgvXFw8aW1nKFtePl0uKj8pXFw+Ly50ZXN0KGNvbnRleHQpKSB7XG4gICAgICAgICAgICAgICAgdmFyIGZvdW5kID0gY29udGV4dC5tYXRjaCgvXFw8aW1nKFtePl0uKj8pXFw+Lyk7XG4gICAgICAgICAgICAgICAgaWYgKGZvdW5kLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5MaW5rZWRJbWFnZSA9IG5ldyBMaW5rZWRJbWFnZSh0aGlzLCBmb3VuZFswXSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuTGlua2VkSW1hZ2VPbGQgPSBuZXcgTGlua2VkSW1hZ2UodGhpcywgZm91bmRbMF0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgTGlua09iamVjdC5wcm90b3R5cGUuaGFzRHVwbGljYXRlUXVlcnlTdHJpbmdzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IFtdLCB1c2VkU3RyaW5ncyA9IFtdO1xuICAgICAgICAgICAgaWYgKHRoaXMubmV3LnNlYXJjaFBhcmFtcy5lbnRyaWVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gdGhpcy5uZXcuc2VhcmNoUGFyYW1zLmVudHJpZXM7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBhID0gX2FbX2ldO1xuICAgICAgICAgICAgICAgICAgICB2YXIgcGFyYW0gPSBhLnNwbGl0KFwiPVwiKS5zaGlmdCgpO1xuICAgICAgICAgICAgICAgICAgICBpZiAodXNlZFN0cmluZ3MuaW5kZXhPZihwYXJhbSkgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnB1c2gocGFyYW0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHVzZWRTdHJpbmdzLnB1c2gocGFyYW0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChyZXN1bHQubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIExpbmtPYmplY3QucHJvdG90eXBlLm92ZXJyaWRlVHJhY2tpbmdSZXF1aXJlbWVudHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLndoaXRlTGlzdGVkVXJsID0gdGhpcy5uZXcudXJsO1xuICAgICAgICB9O1xuICAgICAgICBMaW5rT2JqZWN0LnByb3RvdHlwZS5kaXNwbGF5Rm9ybWF0dGVkVVJMID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgLy9kaXNwbGF5cyB1cmw7XG4gICAgICAgICAgICB2YXIgY29udGVudCA9IHRoaXMuY29udGV4dDtcbiAgICAgICAgICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoL1xcc2VtbFxcLWlkXFw9XFxcIihbMC05XSopXFxcIi8sIFwiXCIpO1xuICAgICAgICAgICAgdmFyIGZpbmRTdGFydCA9IFwiaHJlZj1cXFwiXCI7XG4gICAgICAgICAgICB2YXIgc3RhcnQgPSBjb250ZW50LmluZGV4T2YoZmluZFN0YXJ0KTtcbiAgICAgICAgICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UobmV3IFJlZ0V4cChcImhyZWY9XFxcIlxcXCJcIiwgXCJnXCIpLCBcImhyZWY9XFxcIiNcXFwiXCIpO1xuICAgICAgICAgICAgLy8gdmFyIGltZ1JlZyA9IC9cXDxpbWcoW14+XS4qPylcXD4vZztcbiAgICAgICAgICAgIGlmICh0aGlzLkxpbmtlZEltYWdlKSB7XG4gICAgICAgICAgICAgICAgY29udGVudCA9IHRoaXMuTGlua2VkSW1hZ2UuZ2VuZXJhdGVPdXRwdXQoY29udGVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb250ZW50ID0gY29udGVudC5zdWJzdHIoMCwgc3RhcnQpICsgZmluZFN0YXJ0ICsgXCJ8fHxhLmhyZWZ8fHxcIiArIGNvbnRlbnQuc3Vic3RyKHN0YXJ0ICsgKGZpbmRTdGFydC5sZW5ndGggKyAodGhpcy5vbGQudXJsLmxlbmd0aCkpLCBjb250ZW50Lmxlbmd0aCk7XG4gICAgICAgICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKG5ldyBSZWdFeHAoXCJcXFwiXCIsIFwiZ1wiKSwgXCImcXVvdDtcIik7XG4gICAgICAgICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKG5ldyBSZWdFeHAoXCIvXCIsIFwiZ1wiKSwgXCImIzQ3O1wiKTtcbiAgICAgICAgICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UobmV3IFJlZ0V4cChcIj5cIiwgXCJnXCIpLCBcIiZndDtcIik7XG4gICAgICAgICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKG5ldyBSZWdFeHAoXCI8XCIsIFwiZ1wiKSwgXCImbHQ7XCIpO1xuICAgICAgICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvKFteXFxzXSo/KVxcPS9nLCBcIjxzcGFuIGNsYXNzPVxcXCJhdHRyXFxcIj4kMTwvc3Bhbj48c3BhbiBjbGFzcz1cXFwia2V5d29yZFxcXCI+PTwvc3Bhbj5cIik7XG4gICAgICAgICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC9cXCZxdW90XFw7XFwmZ3RcXDsvZywgXCImcXVvdDs8c3BhbiBjbGFzcz1cXFwidGFnXFxcIj4mZ3Q7PC9zcGFuPlwiKTtcbiAgICAgICAgICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoL1xcJlxcIzQ3XFw7XFwmZ3RcXDsvZywgXCI8c3BhbiBjbGFzcz1cXFwidGFnXFxcIj4mIzQ3OyZndDs8L3NwYW4+XCIpO1xuICAgICAgICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvXFwmcXVvdFxcOyguKj8pXFwmcXVvdFxcOy9nLCBcIjxzcGFuIGNsYXNzPVxcXCJ2YWx1ZVxcXCI+XFxcIiQxXFxcIjwvc3Bhbj5cIik7XG4gICAgICAgICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC9cXCZsdFxcOyhbYS16XStcXHM/KS9nLCBcIjxzcGFuIGNsYXNzPVxcXCJ0YWdcXFwiPiZsdDskMTwvc3Bhbj5cIik7XG4gICAgICAgICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC9cXCZsdFxcO1xcJlxcIzQ3XFw7KFthLXpdK1xccz8pXFwmZ3RcXDsvZywgXCI8c3BhbiBjbGFzcz1cXFwidGFnXFxcIj4mbHQ7JiM0NzskMSZndDs8L3NwYW4+XCIpO1xuICAgICAgICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvXFxuL2csIFwiPGJyPlwiKTtcbiAgICAgICAgICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoL1xcJmd0XFw7L2csIFwiPHNwYW4gY2xhc3M9XFxcInRhZ1xcXCI+Jmd0Ozwvc3Bhbj5cIik7XG4gICAgICAgICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC9cXHN7M30vZywgXCImbmJzcDsmbmJzcDsmbmJzcFwiKTtcbiAgICAgICAgICAgIC8vIGlmKHRoaXMuTGlua2VkSW1hZ2UpIHtcbiAgICAgICAgICAgIC8vICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvXFx8XFx8XFx8aW1nXFwuYWx0XFx8XFx8XFx8L2csIHRoaXMuTGlua2VkSW1hZ2UuYWx0ID09PSB1bmRlZmluZWQgPyBcIlwiIDogdGhpcy5MaW5rZWRJbWFnZS5hbHQpO1xuICAgICAgICAgICAgLy8gfVxuICAgICAgICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvXFx8XFx8XFx8YVxcLmhyZWZcXHxcXHxcXHwvZywgXCI8c3Ryb25nPlwiICsgKHRoaXMuaGFzT3duUHJvcGVydHkoXCJkZWxldGVPblJlbmRlclwiKSAmJiB0aGlzLmRlbGV0ZU9uUmVuZGVyID8gdGhpcy5vbGQudXJsIDogdGhpcy5uZXcudXJsKSArIFwiPC9zdHJvbmc+XCIpO1xuICAgICAgICAgICAgcmV0dXJuIGNvbnRlbnQ7XG4gICAgICAgIH07XG4gICAgICAgIExpbmtPYmplY3QucHJvdG90eXBlLmlzTGlua0NvbXBsZXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgLy9pbnRlbGxpZ2VuY2Ugc2NhbnM6XG4gICAgICAgICAgICB0aGlzLl9zdXBlci5pbnRlbGxpZ2VuY2UuZXZhbHVhdGVSdWxlcygpO1xuICAgICAgICAgICAgdGhpcy5lcnJvcnMuZXZhbHVhdGVSdWxlcygpO1xuICAgICAgICAgICAgLy90cmFjayBjaGFuZ2VzOlxuICAgICAgICAgICAgdGhpcy5DaGFuZ2VNb25pdG9yLnVwZGF0ZSgpO1xuICAgICAgICAgICAgdGhpcy5fX2lzQ29tcGxldGUgPSB0aGlzLmVycm9ycy5jYW5Db250aW51ZTtcbiAgICAgICAgICAgIGlmICh0aGlzLmhhc093blByb3BlcnR5KFwiZGVsZXRlT25SZW5kZXJcIikgJiYgdGhpcy5kZWxldGVPblJlbmRlcilcbiAgICAgICAgICAgICAgICB0aGlzLl9faXNDb21wbGV0ZSA9IHRydWU7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fX2lzQ29tcGxldGU7XG4gICAgICAgIH07XG4gICAgICAgIExpbmtPYmplY3QucHJvdG90eXBlLmlzTGlua1R5cGUgPSBmdW5jdGlvbiAodHlwZSkge1xuICAgICAgICAgICAgdmFyIG91dHB1dCA9IGZhbHNlO1xuICAgICAgICAgICAgc3dpdGNoICh0eXBlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSBcImh0dHBcIjpcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMubmV3LnByb3RvY29sID09IFwiaHR0cDpcIiB8fCB0aGlzLm5ldy5wcm90b2NvbCA9PSBcImh0dHBzOlwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJtYWlsdG9cIjpcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMubmV3LnByb3RvY29sID09IFwibWFpbHRvOlwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gb3V0cHV0O1xuICAgICAgICB9O1xuICAgICAgICBMaW5rT2JqZWN0LnByb3RvdHlwZS5oYXNUcmFja2luZ0NvZGUgPSBmdW5jdGlvbiAob2JqKSB7XG4gICAgICAgICAgICBpZiAob2JqID09PSB1bmRlZmluZWQpXG4gICAgICAgICAgICAgICAgb2JqID0gdGhpcy5uZXcudXJsO1xuICAgICAgICAgICAgLy8gaWYodGhpcy53aGl0ZUxpc3RlZFVybD09dGhpcy5uZXcpIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgdmFyIGEgPSAvW2Etel17MSw0fT0oLio/Oil7Myw5fS9pZztcbiAgICAgICAgICAgIHJldHVybiBhLnRlc3Qob2JqKTtcbiAgICAgICAgfTtcbiAgICAgICAgTGlua09iamVjdC5wcm90b3R5cGUucmVxdWlyZXNUcmFja2luZ0NvZGUgPSBmdW5jdGlvbiAob2JqKSB7XG4gICAgICAgICAgICB2YXIgb3V0cHV0ID0gZmFsc2U7XG4gICAgICAgICAgICBpZiAoR2xvYmFsVmFycy5SZXF1aXJlc1RyYWNraW5nQ29kZVJlZ2V4LnRlc3QodGhpcy5uZXcudXJsKSkge1xuICAgICAgICAgICAgICAgIG91dHB1dCA9IHRydWU7XG4gICAgICAgICAgICAgICAgLy8gaXRlcmF0ZSBvZmVyIHdoaXRlbGlzdFxuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgR2xvYmFsVmFycy5SZXF1aXJlZFRyYWNraW5nQ29kZVdoaXRlbGlzdC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoR2xvYmFsVmFycy5SZXF1aXJlZFRyYWNraW5nQ29kZVdoaXRlbGlzdFtpXSBpbnN0YW5jZW9mIFJlZ0V4cCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEdsb2JhbFZhcnMuUmVxdWlyZWRUcmFja2luZ0NvZGVXaGl0ZWxpc3RbaV1bXCJ0ZXN0XCJdKHRoaXMubmV3LnVybCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm5ldy51cmwuaW5kZXhPZihHbG9iYWxWYXJzLlJlcXVpcmVkVHJhY2tpbmdDb2RlV2hpdGVsaXN0W2ldKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gb3V0cHV0O1xuICAgICAgICB9O1xuICAgICAgICBMaW5rT2JqZWN0LnByb3RvdHlwZS5yZXF1aXJlc1NDb2RlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKEdsb2JhbFZhcnMuUmVxdWlyZXNTQ29kZVJlZ2V4LnRlc3QodGhpcy5uZXcudXJsKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBMaW5rT2JqZWN0LnByb3RvdHlwZS5uZWVkc1RyYWNraW5nQ29kZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBvdXRwdXQgPSB0aGlzLnJlcXVpcmVzVHJhY2tpbmdDb2RlKCk7XG4gICAgICAgICAgICBpZiAodGhpcy53aGl0ZUxpc3RlZFVybCA9PSB0aGlzLm5ldy51cmwpXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgLy8gZGV0ZXJtaW5lIGxpbmtzIHRoYXQgbmVlZCBzcGVjaWFsIHRyYWNraW5nXG4gICAgICAgICAgICBpZiAodGhpcy5oYXNUcmFja2luZ0NvZGUoKSkge1xuICAgICAgICAgICAgICAgIG91dHB1dCA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICAgICAgfTtcbiAgICAgICAgTGlua09iamVjdC5wcm90b3R5cGUudXBkYXRlSW5wdXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5pc0xpbmtUeXBlKCdtYWlsdG8nKSkge1xuICAgICAgICAgICAgICAgIHRoaXMubWFpbHRvLnVwZGF0ZU1haWx0b09iaigpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5uZXcuc2VhcmNoUGFyYW1zLnVwZGF0ZUVudHJpZXMoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuaXNMaW5rQ29tcGxldGUoKTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIExpbmtPYmplY3Q7XG4gICAgfSgpKTtcbiAgICBFTUxNb2R1bGUuTGlua09iamVjdCA9IExpbmtPYmplY3Q7XG4gICAgdmFyIENoYW5nZU1vbml0b3IgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBDaGFuZ2VNb25pdG9yKF9zdXBlcikge1xuICAgICAgICAgICAgdGhpcy52aXNpYmxlID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLl9zdXBlciA9IF9zdXBlcjtcbiAgICAgICAgICAgIHRoaXMubWVzc2FnZXMgPSBbXTtcbiAgICAgICAgfVxuICAgICAgICBDaGFuZ2VNb25pdG9yLnByb3RvdHlwZS5jb21wYXJlT2xkQW5kTmV3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHVybFBhcmFtcyA9IFtcInByb3RvY29sXCIsIFwib3JpZ2luXCIsIFwic2VhcmNoXCIsIFwiaGFzaFwiXTtcbiAgICAgICAgICAgIHZhciBjaGFuZ2VkID0gW107XG4gICAgICAgICAgICB2YXIgX3N1cGVyID0gdGhpcy5fc3VwZXI7XG4gICAgICAgICAgICB1cmxQYXJhbXMuZm9yRWFjaChmdW5jdGlvbiAocGFyYW0pIHtcbiAgICAgICAgICAgICAgICBpZiAoX3N1cGVyLm9sZC5oYXNPd25Qcm9wZXJ0eShwYXJhbSkgJiYgX3N1cGVyLm9sZFtwYXJhbV0gIT09IF9zdXBlci5uZXdbcGFyYW1dKSB7XG4gICAgICAgICAgICAgICAgICAgIGNoYW5nZWQucHVzaChwYXJhbSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAoX3N1cGVyLkxpbmtlZEltYWdlICYmIF9zdXBlci5MaW5rZWRJbWFnZS5hbHQgIT09IF9zdXBlci5MaW5rZWRJbWFnZU9sZC5hbHQpIHtcbiAgICAgICAgICAgICAgICBjaGFuZ2VkLnB1c2goXCJhbHRcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gY2hhbmdlZDtcbiAgICAgICAgfTtcbiAgICAgICAgQ2hhbmdlTW9uaXRvci5wcm90b3R5cGUuYmVmb3JlRGlkUmV0dXJuQ2hhbmdlcyA9IGZ1bmN0aW9uICgpIHsgfTtcbiAgICAgICAgQ2hhbmdlTW9uaXRvci5wcm90b3R5cGUuYWZ0ZXJEaWRSZXR1cm5DaGFuZ2VzID0gZnVuY3Rpb24gKCkgeyB9O1xuICAgICAgICBDaGFuZ2VNb25pdG9yLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fc3VwZXIucmVhZE9ubHkgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICB2YXIgb3V0cHV0ID0gW107XG4gICAgICAgICAgICAgICAgdmFyIGNoYW5nZXMgPSB0aGlzLmNvbXBhcmVPbGRBbmROZXcoKTtcbiAgICAgICAgICAgICAgICB2YXIgQ00gPSB0aGlzO1xuICAgICAgICAgICAgICAgIGNoYW5nZXMuZm9yRWFjaChmdW5jdGlvbiAoc2NvcGUpIHtcbiAgICAgICAgICAgICAgICAgICAgb3V0cHV0LnB1c2goQ00uYXJ0aWN1bGF0ZUNoYW5nZXMoc2NvcGUsIHt9KSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlcyA9IG91dHB1dDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgQ2hhbmdlTW9uaXRvci5wcm90b3R5cGUuY29tcGFyZVNlYXJjaFN0cmluZ3MgPSBmdW5jdGlvbiAob2xkUCwgbmV3UCkge1xuICAgICAgICAgICAgdmFyIHBheWxvYWQgPSB7XG4gICAgICAgICAgICAgICAgYWRkZWQ6IFtdLFxuICAgICAgICAgICAgICAgIHVwZGF0ZWQ6IFtdLFxuICAgICAgICAgICAgICAgIHJlbW92ZWQ6IFtdXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgZm9yICh2YXIgaSBpbiBvbGRQKSB7XG4gICAgICAgICAgICAgICAgaWYgKG5ld1AuaW5kZXhPZihvbGRQW2ldKSA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgcGF5bG9hZC5yZW1vdmVkLnB1c2gob2xkUFtpXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yIChpIGluIG5ld1ApIHtcbiAgICAgICAgICAgICAgICBpZiAob2xkUC5pbmRleE9mKG5ld1BbaV0pID09PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICBwYXlsb2FkLmFkZGVkLnB1c2gobmV3UFtpXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGZpbmRfcGF0dGVybl9pbkFycmF5ID0gZnVuY3Rpb24gKHBhdHRlcm4sIGFycikge1xuICAgICAgICAgICAgICAgIHZhciBvdXRwdXQgPSAtMTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciB5ID0gMDsgeSA8IGFyci5sZW5ndGg7IHkrKykge1xuICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhcInV1cGRhdHJlZD9cIix5KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBhdHRlcm4udGVzdChhcnJbeV0pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXQgPSB5O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgZm9yIChpIGluIG9sZFApIHtcbiAgICAgICAgICAgICAgICB2YXIgcmUgPSBuZXcgUmVnRXhwKG9sZFBbaV0uc3BsaXQoXCI9XCIpWzBdICsgXCI9XCIpO1xuICAgICAgICAgICAgICAgIHZhciBmb3VuZCA9IGZpbmRfcGF0dGVybl9pbkFycmF5KHJlLCBwYXlsb2FkLmFkZGVkKTtcbiAgICAgICAgICAgICAgICBpZiAoZm91bmQgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICBwYXlsb2FkLnVwZGF0ZWQucHVzaChwYXlsb2FkLmFkZGVkW2ZvdW5kXSk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBvdGhlciA9IGZpbmRfcGF0dGVybl9pbkFycmF5KHJlLCBwYXlsb2FkLnJlbW92ZWQpO1xuICAgICAgICAgICAgICAgICAgICBwYXlsb2FkLnJlbW92ZWQuc3BsaWNlKG90aGVyLCAxKTtcbiAgICAgICAgICAgICAgICAgICAgcGF5bG9hZC5hZGRlZC5zcGxpY2UoZm91bmQsIDEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBwYXlsb2FkO1xuICAgICAgICB9O1xuICAgICAgICBDaGFuZ2VNb25pdG9yLnByb3RvdHlwZS5hcnRpY3VsYXRlQ2hhbmdlcyA9IGZ1bmN0aW9uIChzY29wZSwgYXJncykge1xuICAgICAgICAgICAgaWYgKHNjb3BlID09IFwicHJvdG9jb2xcIikge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9zdXBlci5uZXcucHJvdG9jb2wgPT0gXCJtYWlsdG86XCIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsgbWVzc2FnZTogXCJDaGFuZ2VkIHRvIG1haWx0byBsaW5rLlwiLCBkYXRhOiBbXSB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICh0aGlzLl9zdXBlci5vbGQucHJvdG9jb2wgPT0gXCJcIiA/IFwiVXBkYXRlZFwiIDogXCJDaGFuZ2VkXCIpICsgXCIgcHJvdG9jb2wgdG8gXCIgKyB0aGlzLl9zdXBlci5uZXcucHJvdG9jb2wsXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBbXVxuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHNjb3BlID09IFwib3JpZ2luXCIpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fc3VwZXIubmV3LnByb3RvY29sID09IFwibWFpbHRvOlwiKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7IG1lc3NhZ2U6IFwiQ2hhbmdlZCBtYWlsdG8gbGluayB0byBcIiArIHRoaXMuX3N1cGVyLm5ldy5vcmlnaW4sIGRhdGE6IFtdIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4geyBtZXNzYWdlOiBcIkNoYW5nZWQgbGluayBVUkwgdG8gXCIgKyB0aGlzLl9zdXBlci5uZXcub3JpZ2luLCBkYXRhOiBbXSB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHNjb3BlID09IFwiYWx0XCIpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fc3VwZXIuTGlua2VkSW1hZ2UuYWx0ID09IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsgbWVzc2FnZTogXCJSZW1vdmVkIGxpbmtlZCBpbWFnZSBBTFQgdGV4dFwiLCBkYXRhOiBbXSB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsgbWVzc2FnZTogXCJVcGRhdGVkIGxpbmtlZCBpbWFnZSBBTFQgdGV4dCB0byA8Yj5cIiArIHRoaXMuX3N1cGVyLkxpbmtlZEltYWdlLmFsdCArIFwiPC9iPlwiLCBkYXRhOiBbXSB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHNjb3BlID09IFwic2VhcmNoXCIpIHtcbiAgICAgICAgICAgICAgICB2YXIgb2xkUGFyYW1zID0gdGhpcy5fc3VwZXIub2xkLnNlYXJjaFBhcmFtcy5fZW50cmllcztcbiAgICAgICAgICAgICAgICB2YXIgbmV3UGFyYW1zID0gdGhpcy5fc3VwZXIubmV3LnNlYXJjaFBhcmFtcy5fZW50cmllcztcbiAgICAgICAgICAgICAgICB2YXIgc2VhcmNoQ2hhbmdlc18xID0gdGhpcy5jb21wYXJlU2VhcmNoU3RyaW5ncyhvbGRQYXJhbXMsIG5ld1BhcmFtcyk7XG4gICAgICAgICAgICAgICAgdmFyIG1lc3NhZ2UgPSBcIlwiO1xuICAgICAgICAgICAgICAgIHZhciBfc3VwZXIgPSB0aGlzLl9zdXBlcjtcbiAgICAgICAgICAgICAgICBbXCJ1cGRhdGVkXCIsIFwiYWRkZWRcIiwgXCJyZW1vdmVkXCJdLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2VhcmNoQ2hhbmdlc18xW2tleV0ubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZSA9IG1lc3NhZ2UgKyBrZXlbMF0udG9VcHBlckNhc2UoKSArIGtleS5zdWJzdHIoMSwga2V5Lmxlbmd0aCkgKyBcIiBcIiArIChfc3VwZXIubmV3LnByb3RvY29sID09IFwibWFpbHRvOlwiID8gXCJwYXJhbWV0ZXJcIiA6IFwicXVlcnkgc3RyaW5nXCIpICsgKHNlYXJjaENoYW5nZXNfMVtrZXldLmxlbmd0aCA+IDEgPyBcInNcIiA6IFwiXCIpICsgXCI6IDxiPlwiICsgc2VhcmNoQ2hhbmdlc18xW2tleV0uam9pbihcIiwgXCIpICsgXCI8L2I+PGJyPlwiO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgbWVzc2FnZTogbWVzc2FnZSwgZGF0YTogW10gfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHNjb3BlID09IFwiaGFzaFwiKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX3N1cGVyLm9sZC5oYXNoID09IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsgbWVzc2FnZTogXCJZb3UgYWRkZWQgdGhlIGhhc2ggXCIgKyB0aGlzLl9zdXBlci5uZXcuaGFzaCwgZGF0YTogW10gfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9zdXBlci5uZXcuaGFzaCA9PSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4geyBtZXNzYWdlOiBcIllvdSByZW1vdmVkIHRoZSBoYXNoIFwiICsgdGhpcy5fc3VwZXIub2xkLmhhc2gsIGRhdGE6IFtdIH07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4geyBtZXNzYWdlOiBcIllvdSBjaGFuZ2VkIHRoZSBoYXNoIGZyb20gXCIgKyB0aGlzLl9zdXBlci5vbGQuaGFzaCArIFwiIHRvIFwiICsgdGhpcy5fc3VwZXIubmV3Lmhhc2gsIGRhdGE6IFtdIH07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBDaGFuZ2VNb25pdG9yO1xuICAgIH0oKSk7XG4gICAgRU1MTW9kdWxlLkNoYW5nZU1vbml0b3IgPSBDaGFuZ2VNb25pdG9yO1xuICAgIHZhciBFTUxXb3Jrc3BhY2UgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBFTUxXb3Jrc3BhY2UoaHRtbCwgJHNjb3BlKSB7XG4gICAgICAgICAgICB0aGlzLm92ZXJyaWRkZW5JZHMgPSBbXTtcbiAgICAgICAgICAgIGlmIChodG1sID09PSB1bmRlZmluZWQpXG4gICAgICAgICAgICAgICAgaHRtbCA9IFwiXCI7XG4gICAgICAgICAgICBpZiAoJHNjb3BlID09PSB1bmRlZmluZWQpXG4gICAgICAgICAgICAgICAgJHNjb3BlID0gXCJcIjtcbiAgICAgICAgICAgIHZhciBXb3Jrc3BhY2UgPSB0aGlzO1xuICAgICAgICAgICAgdGhpcy5idWZmZXIgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5zY29wZSA9ICRzY29wZTtcbiAgICAgICAgICAgIHRoaXMubGlua3NWaWV3ID0gJ2V4cGVyaW1lbnRhbCc7IC8vYWR2YW5jZWQgc2hvd3MgYWxsXG4gICAgICAgICAgICB0aGlzLnNvdXJjZUNvZGUgPSBodG1sOyAvL2luaXRhbFxuICAgICAgICAgICAgdGhpcy53b3JraW5nQ29kZSA9IFwiXCI7XG4gICAgICAgICAgICB0aGlzLmZpbGVOYW1lID0gXCJlbWwtbWFrZXItdW50aXRsZWRcIjtcbiAgICAgICAgICAgIHRoaXMubGlua0RhdGEgPSBbXTtcbiAgICAgICAgICAgIHRoaXMuX2RlZmF1bHRTQ29kZSA9IFwicz1lbWFpbFwiO1xuICAgICAgICAgICAgdGhpcy5oZWFkZXIgPSB7IFwic3ViamVjdFwiOiBcIlwiIH07XG4gICAgICAgICAgICB0aGlzLm1lc3NhZ2VzID0gW107XG4gICAgICAgICAgICB0aGlzLmV4cG9ydEZvckVsb3F1YSA9IFwiWWVzXCI7XG4gICAgICAgICAgICB0aGlzLl9fZW1sSGVhZGVycyA9IFwiXCI7XG4gICAgICAgICAgICB0aGlzLmtleUJvYXJkU2hvcnRjdXRzID0gW107XG4gICAgICAgICAgICB0aGlzLl9fYWxsb3dhYmxlSGVhZGVyRmllbGRzID0ge1xuICAgICAgICAgICAgICAgIFwidG9cIjogeyBzeW50YXg6IFwiVG86IFwiLCBsYWJlbDogXCJUb1wiLCBpbnN0cnVjdGlvbnM6IFwiQSBsaXN0IG9mIGVtYWlsIGFkZHJlc3NlcyBzZXBhcmF0ZWQgYnkgY29tbWFzLlwiIH0sXG4gICAgICAgICAgICAgICAgXCJzdWJqZWN0XCI6IHsgc3ludGF4OiBcIlN1YmplY3Q6IFwiLCBsYWJlbDogXCJTdWJqZWN0XCIsIGluc3RydWN0aW9uczogXCJcIiB9LFxuICAgICAgICAgICAgICAgIFwiY2NcIjogeyBzeW50YXg6IFwiQ2M6IFwiLCBsYWJlbDogXCJDQ1wiLCBpbnN0cnVjdGlvbnM6IFwiQSBsaXN0IG9mIGVtYWlsIGFkZHJlc3NlcyBzZXBhcmF0ZWQgYnkgY29tbWFzLlwiIH0sXG4gICAgICAgICAgICAgICAgXCJyZXBseXRvXCI6IHsgc3ludGF4OiBcIlJlcGx5LXRvOiBcIiwgbGFiZWw6IFwiUmVwbHkgdG9cIiwgaW5zdHJ1Y3Rpb25zOiBcIkEgbGlzdCBvZiBlbWFpbCBhZGRyZXNzZXMgc2VwYXJhdGVkIGJ5IGNvbW1hcy5cIiB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdGhpcy5oZWFkZXJzID0gW1xuICAgICAgICAgICAgICAgIFwiWC1VbnNlbnQ6IDFcIixcbiAgICAgICAgICAgICAgICBcIk1pbWUtVmVyc2lvbjogMS4wIChNYWMgT1MgWCBNYWlsIDEwLjEgXFwoMzI1MVxcKSlcIixcbiAgICAgICAgICAgICAgICBcIlgtVW5pZm9ybS1UeXBlLUlkZW50aWZpZXI6IGNvbS5hcHBsZS5tYWlsLWRyYWZ0XCIsXG4gICAgICAgICAgICAgICAgXCJDb250ZW50LVRyYW5zZmVyLUVuY29kaW5nOiA3Yml0XCJcbiAgICAgICAgICAgIF07XG4gICAgICAgICAgICB0aGlzLmludGVsbGlnZW5jZSA9IEVNTEludGVsbGlnZW5jZS5tb2R1bGUoXCJlbWFpbFwiKS5tb25pdG9yKCk7XG4gICAgICAgICAgICB0aGlzLmludGVsbGlnZW5jZS5hc3NvY2lhdGVWYXJpYWJsZShcIkVNTFdvcmtzcGFjZVwiLCB0aGlzKTtcbiAgICAgICAgfVxuICAgICAgICBFTUxXb3Jrc3BhY2UucHJvdG90eXBlLm1hcExpbmtPYmplY3RzID0gZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5saW5rRGF0YS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmxpbmtEYXRhLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKHRoaXMubGlua0RhdGFbaV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgRU1MV29ya3NwYWNlLnByb3RvdHlwZS5jb21wb3NlRU1MID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgbG9jYXRpb24uaHJlZiA9IFwiIy9leHBvcnQtY29tcG9zZS1lbWxcIjtcbiAgICAgICAgfTtcbiAgICAgICAgRU1MV29ya3NwYWNlLnByb3RvdHlwZS5kb3dubG9hZEVtbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMuYmVmb3JlRGlkRG93bmxvYWRFbWwoKTtcbiAgICAgICAgICAgIHZhciBvdXRwdXQgPSB0aGlzLl9fZW1sSGVhZGVycyArIFwiXFxuXFxuXCIgKyB0aGlzLl9fcmVtb3ZlV2hpdGVTcGFjZSh0aGlzLl9fcmVwbGFjZUVsb3F1YU1lcmdlRmllbGRzKHRoaXMuZ2VuZXJhdGVPdXRwdXRDb2RlKFwib2Z0XCIpKSk7XG4gICAgICAgICAgICB0aGlzLmZpbGVOYW1lID0gdGhpcy5fX2Zvcm1hdEZpbGVOYW1lKHRoaXMuZmlsZU5hbWUpO1xuICAgICAgICAgICAgd2luZG93LnNhdmVBcyhuZXcgQmxvYihbb3V0cHV0XSwgeyB0eXBlOiBcInRleHQvaHRtbFwiIH0pLCB0aGlzLmZpbGVOYW1lICsgXCIuZW1sXCIpO1xuICAgICAgICAgICAgdGhpcy5hZnRlckRpZERvd25sb2FkRW1sKCk7XG4gICAgICAgIH07XG4gICAgICAgIEVNTFdvcmtzcGFjZS5wcm90b3R5cGUuYmVmb3JlRGlkRG93bmxvYWRFbWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLm1hcExpbmtPYmplY3RzKGZ1bmN0aW9uIChMaW5rT2JqZWN0KSB7XG4gICAgICAgICAgICAgICAgaWYgKExpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5oYXMoXCJlbHFUcmFja1wiKSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgaW5kZXggPSBMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuZW50cmllcy5pbmRleE9mKFwiZWxxVHJhY2s9dHJ1ZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGluZGV4ID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIExpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5kZWxldGVBdEluZGV4KGluZGV4KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoIUxpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5oYXMoXCJzXCIpICYmIExpbmtPYmplY3QucmVxdWlyZXNTQ29kZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgIExpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5hcHBlbmQoXCJzPW9mdFwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuZ2V0KFwic1wiKSA9PSBcImVtYWlsXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIExpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5zZXQoXCJzXCIsIFwib2Z0XCIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLm1hcExpbmtPYmplY3RzKGZ1bmN0aW9uIChMaW5rT2JqZWN0KSB7XG4gICAgICAgICAgICAgICAgTGlua09iamVjdC5DaGFuZ2VNb25pdG9yLnVwZGF0ZSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIEVNTFdvcmtzcGFjZS5wcm90b3R5cGUuYWZ0ZXJEaWREb3dubG9hZEVtbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHdpbmRvdy5nYSgnc2VuZCcsICdldmVudCcsIFwiRU1MXCIsIFwiZG93bmxvYWRcIiwgXCJFTUwgRXhwb3J0XCIpO1xuICAgICAgICAgICAgbG9jYXRpb24uaHJlZiA9IFwiIy9leHBvcnQtZW1sXCI7XG4gICAgICAgIH07XG4gICAgICAgIEVNTFdvcmtzcGFjZS5wcm90b3R5cGUuZG93bmxvYWRDc3YgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgb3V0cHV0ID0gXCJDb250ZXh0LE9yaWdpbmFsIFVSTCxNb2RpZmllZCBVUkxcXG5cIjtcbiAgICAgICAgICAgIHRoaXMubWFwTGlua09iamVjdHMoZnVuY3Rpb24gKExpbmtPYmplY3QpIHtcbiAgICAgICAgICAgICAgICBvdXRwdXQgKz0gTGlua09iamVjdC5jb250ZXh0LnJlcGxhY2UoLywvZywgXCIoY29tbWEpXCIpICsgXCIsXCIgKyBMaW5rT2JqZWN0Lm9sZC51cmwgKyBcIixcIiArIExpbmtPYmplY3QubmV3LnVybCArIFwiXFxuXCI7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMuZmlsZU5hbWUgPSB0aGlzLl9fZm9ybWF0RmlsZU5hbWUodGhpcy5maWxlTmFtZSk7XG4gICAgICAgICAgICB3aW5kb3cuc2F2ZUFzKG5ldyBCbG9iKFtvdXRwdXRdLCB7IHR5cGU6IFwidGV4dC9jc3ZcIiB9KSwgdGhpcy5maWxlTmFtZSArIFwiX2xpbmtzLmNzdlwiKTtcbiAgICAgICAgICAgIHdpbmRvdy5nYSgnc2VuZCcsICdldmVudCcsIFwiQ1NWXCIsIFwiZG93bmxvYWRcIiwgXCJDU1YgRXhwb3J0XCIpO1xuICAgICAgICB9O1xuICAgICAgICBFTUxXb3Jrc3BhY2UucHJvdG90eXBlLmRvd25sb2FkSHRtbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBvdXRwdXQgPSB0aGlzLmJlZm9yZURpZERvd25sb2FkSHRtbCh0aGlzLmdlbmVyYXRlT3V0cHV0Q29kZShcImVtYWlsXCIpKTtcbiAgICAgICAgICAgIHRoaXMuZmlsZU5hbWUgPSB0aGlzLl9fZm9ybWF0RmlsZU5hbWUodGhpcy5maWxlTmFtZSk7XG4gICAgICAgICAgICB3aW5kb3cuc2F2ZUFzKG5ldyBCbG9iKFtvdXRwdXRdLCB7IHR5cGU6IFwidGV4dC9odG1sXCIgfSksIHRoaXMuZmlsZU5hbWUgKyBcIi5odG1sXCIpO1xuICAgICAgICAgICAgdGhpcy5hZnRlckRpZERvd25sb2FkSHRtbCgpO1xuICAgICAgICB9O1xuICAgICAgICBFTUxXb3Jrc3BhY2UucHJvdG90eXBlLmJlZm9yZURpZERvd25sb2FkSHRtbCA9IGZ1bmN0aW9uIChjb2RlKSB7XG4gICAgICAgICAgICByZXR1cm4gY29kZTtcbiAgICAgICAgfTtcbiAgICAgICAgRU1MV29ya3NwYWNlLnByb3RvdHlwZS5hZnRlckRpZERvd25sb2FkSHRtbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHdpbmRvdy5nYSgnc2VuZCcsICdldmVudCcsIFwiSFRNTFwiLCBcImRvd25sb2FkXCIsIFwiSFRNTCBFeHBvcnRcIik7XG4gICAgICAgIH07XG4gICAgICAgIEVNTFdvcmtzcGFjZS5wcm90b3R5cGUuZXhwb3J0Q29kZVRvSFRNTCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMuYmVmb3JlRGlkRXhwb3J0Q29kZVRvSFRNTCgpO1xuICAgICAgICAgICAgdGhpcy5vdXRwdXRDb2RlID0gdGhpcy5nZW5lcmF0ZU91dHB1dENvZGUoXCJlbWFpbFwiKTtcbiAgICAgICAgICAgIHRoaXMuYWZ0ZXJEaWRFeHBvcnRDb2RlVG9IVE1MKCk7XG4gICAgICAgIH07XG4gICAgICAgIEVNTFdvcmtzcGFjZS5wcm90b3R5cGUuYmVmb3JlRGlkRXhwb3J0Q29kZVRvSFRNTCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciB0cmFja2luZ09wdE91dCA9IGZhbHNlO1xuICAgICAgICAgICAgaWYgKHRoaXMuZXhwb3J0Rm9yRWxvcXVhICYmIHRoaXMuZXhwb3J0Rm9yRWxvcXVhID09IFwiWWVzXCIpIHtcbiAgICAgICAgICAgICAgICB3aW5kb3cuZ2EoJ3NlbmQnLCAnZXZlbnQnLCBcIkhUTUxcIiwgXCJBZGQgRWxvcXVhIFRyYWNraW5nXCIsIFwiQWRkIEVsb3F1YSBUcmFja2luZ1wiKTtcbiAgICAgICAgICAgICAgICB0aGlzLm1hcExpbmtPYmplY3RzKGZ1bmN0aW9uIChMaW5rT2JqZWN0KSB7XG4gICAgICAgICAgICAgICAgICAgIHRyYWNraW5nT3B0T3V0ID0gTGlua09iamVjdC53aGl0ZUxpc3RlZFVybCA9PSBMaW5rT2JqZWN0Lm5ldy51cmw7XG4gICAgICAgICAgICAgICAgICAgIGlmICghTGlua09iamVjdC5pc0xpbmtUeXBlKFwibWFpbHRvXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAmJiAhTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLmhhcyhcImVscVRyYWNrXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAmJiAhL2FwcFxcLmluZm9cXC5vcHR1bVxcLmNvbS9naS50ZXN0KExpbmtPYmplY3QubmV3LnVybCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIExpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5hcHBlbmQoXCJlbHFUcmFjaz10cnVlXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRyYWNraW5nT3B0T3V0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTGlua09iamVjdC53aGl0ZUxpc3RlZFVybCA9IExpbmtPYmplY3QubmV3LnVybDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5tYXBMaW5rT2JqZWN0cyhmdW5jdGlvbiAoTGlua09iamVjdCkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLmhhcyhcImVscVRyYWNrXCIpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW5kZXggPSBMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuZW50cmllcy5pbmRleE9mKFwiZWxxVHJhY2s9dHJ1ZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbmRleCA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLmRlbGV0ZUF0SW5kZXgoaW5kZXgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgTGlua09iamVjdC5pc0xpbmtDb21wbGV0ZSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIExpbmtPYmplY3QuQ2hhbmdlTW9uaXRvci51cGRhdGUoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMubWFwTGlua09iamVjdHMoZnVuY3Rpb24gKExpbmtPYmplY3QpIHtcbiAgICAgICAgICAgICAgICBpZiAoIUxpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5oYXMoXCJzXCIpICYmIExpbmtPYmplY3QucmVxdWlyZXNTQ29kZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgIExpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5hcHBlbmQoXCJzPWVtYWlsXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKExpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5oYXMoXCJzXCIpICYmIExpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5nZXQoXCJzXCIpID09IFwib2Z0XCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIExpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5zZXQoXCJzXCIsIFwiZW1haWxcIik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgTGlua09iamVjdC5DaGFuZ2VNb25pdG9yLnVwZGF0ZSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLm1hcExpbmtPYmplY3RzKGZ1bmN0aW9uIChMaW5rT2JqZWN0KSB7XG4gICAgICAgICAgICAgICAgTGlua09iamVjdC5DaGFuZ2VNb25pdG9yLnVwZGF0ZSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIEVNTFdvcmtzcGFjZS5wcm90b3R5cGUuYWZ0ZXJEaWRFeHBvcnRDb2RlVG9IVE1MID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5tYXBMaW5rT2JqZWN0cyhmdW5jdGlvbiAoTGlua09iamVjdCkge1xuICAgICAgICAgICAgICAgIGlmIChMaW5rT2JqZWN0LndoaXRlTGlzdGVkVXJsID09IExpbmtPYmplY3QubmV3LnVybCkge1xuICAgICAgICAgICAgICAgICAgICAvL3JlcG9ydCB0aGUgbm9uIHRyYWNrZWQgbGluaztcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmdhKCdzZW5kJywgJ2V2ZW50JywgXCJUcmFja2luZy1PcHRvdXRcIiwgXCJvdmVycmlkZVwiLCBMaW5rT2JqZWN0Lm5ldy51cmwpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgd2luZG93LmdhKCdzZW5kJywgJ2V2ZW50JywgXCJIVE1MXCIsIFwidmlldyBzb3VyY2Vjb2RlXCIsIFwiRXhwb3J0L1ZpZXcgSFRNTFwiKTtcbiAgICAgICAgICAgIGxvY2F0aW9uLmhyZWYgPSBcIiMvZXhwb3J0LWh0bWxcIjtcbiAgICAgICAgfTtcbiAgICAgICAgRU1MV29ya3NwYWNlLnByb3RvdHlwZS5zZXRVcFNob3J0Y3V0S2V5cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICB0aGlzLmtleUJvYXJkU2hvcnRjdXRzID0gW107XG4gICAgICAgICAgICBfdGhpcy5rZXlCb2FyZFNob3J0Y3V0cy5wdXNoKG5ldyBLZXlib2FyZFNob3J0Y3V0KGZ1bmN0aW9uIChlKSB7IHJldHVybiAoZS5jdHJsS2V5IHx8IGUubWV0YUtleSkgJiYgZS5zaGlmdEtleSAmJiBlLndoaWNoID09IDUyOyB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgLy9kb3RoaXM7XG4gICAgICAgICAgICAgICAgX3RoaXMuc2NvcGUuJGFwcGx5KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2Rvd25sb2FkaW5nIGZpbGUnKTtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuZG93bmxvYWRIdG1sKCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LCBcIkNUUkwgKyBTSElGVCArIDRcIiwgXCJEb3dubG9hZCBIVE1MXCIpKTtcbiAgICAgICAgICAgIF90aGlzLmtleUJvYXJkU2hvcnRjdXRzLnB1c2gobmV3IEtleWJvYXJkU2hvcnRjdXQoZnVuY3Rpb24gKGUpIHsgcmV0dXJuIChlLmN0cmxLZXkgfHwgZS5tZXRhS2V5KSAmJiBlLnNoaWZ0S2V5ICYmIGUud2hpY2ggPT0gNTE7IH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAvL2RvdGhpcztcbiAgICAgICAgICAgICAgICBfdGhpcy5zY29wZS4kYXBwbHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5tYXBMaW5rT2JqZWN0cyhmdW5jdGlvbiAoTGlua09iamVjdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKExpbmtPYmplY3QuZXJyb3JzLm1lc3NhZ2VzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBMaW5rT2JqZWN0LmVycm9ycy5tZXNzYWdlcy5mb3JFYWNoKGZ1bmN0aW9uIChNZXNzYWdlT2JqZWN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChNZXNzYWdlT2JqZWN0LnR5cGUgPT0gRXJyb3JUeXBlLlN1Z2dlc3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIE1lc3NhZ2VPYmplY3QuY3RhSGFuZGxlcigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTGlua09iamVjdC5pc0xpbmtDb21wbGV0ZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0sIFwiQ1RSTCArIFNISUZUICsgM1wiLCBcIkFwcGx5IGFsbCBzdWdnZXN0aW9uc1wiKSk7XG4gICAgICAgICAgICBfdGhpcy5rZXlCb2FyZFNob3J0Y3V0cy5wdXNoKG5ldyBLZXlib2FyZFNob3J0Y3V0KGZ1bmN0aW9uIChlKSB7IHJldHVybiAoZS5jdHJsS2V5IHx8IGUubWV0YUtleSkgJiYgZS5zaGlmdEtleSAmJiBlLndoaWNoID09IDUwOyB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgLy9kb3RoaXM7XG4gICAgICAgICAgICAgICAgX3RoaXMuc2NvcGUuJGFwcGx5KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMubWFwTGlua09iamVjdHMoZnVuY3Rpb24gKExpbmtPYmplY3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghTGlua09iamVjdC5yZWFkT25seVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICYmIExpbmtPYmplY3QucmVxdWlyZXNTQ29kZSgpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJiYgIUxpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5oYXMoJ3MnKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIExpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5hcHBlbmQoJ3M9ZW1haWwnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBMaW5rT2JqZWN0LmlzTGlua0NvbXBsZXRlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSwgXCJDVFJMICsgU0hJRlQgKyAyXCIsIFwiQWRkIHM9ZW1haWwgdG8gYWxsIGxpbmtzXCIpKTtcbiAgICAgICAgICAgIF90aGlzLmtleUJvYXJkU2hvcnRjdXRzLnB1c2gobmV3IEtleWJvYXJkU2hvcnRjdXQoZnVuY3Rpb24gKGUpIHsgcmV0dXJuIChlLmN0cmxLZXkgfHwgZS5tZXRhS2V5KSAmJiBlLnNoaWZ0S2V5ICYmIGUud2hpY2ggPT0gNDk7IH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAvL2RvdGhpcztcbiAgICAgICAgICAgICAgICBfdGhpcy5zY29wZS4kYXBwbHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5tYXBMaW5rT2JqZWN0cyhmdW5jdGlvbiAoTGlua09iamVjdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKExpbmtPYmplY3QucmVhZE9ubHkpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuZGVsZXRlKFwib1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIExpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5kZWxldGUoXCJvaW5cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICBMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuZGVsZXRlKFwidlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIExpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5kZWxldGUoXCJvaWV4XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLmRlbGV0ZShcImVscV9taWRcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICBMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuZGVsZXRlKFwiZWxxX2xpZFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIExpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5kZWxldGUoXCJlbHFUcmFja1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIExpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5kZWxldGUoXCJlbHFUcmFja0lkXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLmRlbGV0ZShcInNcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICBMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuZGVsZXRlKFwiczNcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICBMaW5rT2JqZWN0LmlzTGlua0NvbXBsZXRlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5hcmVMaW5rc0NvbXBsZXRlKCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSwgXCJDVFJMICsgU0hJRlQgKyAxXCIsIFwiUmVtb3ZlIGFsbCBxdWVyeSBzdHJpbmdzIGZyb20gZW1haWxcIikpO1xuICAgICAgICAgICAgZG9jdW1lbnQub25rZXl1cCA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IF90aGlzLmtleUJvYXJkU2hvcnRjdXRzOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgc2hvcnRjdXQgPSBfYVtfaV07XG4gICAgICAgICAgICAgICAgICAgIGlmIChzaG9ydGN1dC53aGVuICYmIHNob3J0Y3V0LndoZW4oZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNob3J0Y3V0LmRvVGhpcygpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfTtcbiAgICAgICAgRU1MV29ya3NwYWNlLnByb3RvdHlwZS5yZXBsYWNlU3BlY2lhbENoYXJhY3RlcnMgPSBmdW5jdGlvbiAodGV4dCkge1xuICAgICAgICAgICAgdmFyIHJlcGxhY2UgPSB7XG4gICAgICAgICAgICAgICAgMTc0OiBbXCImcmVnO1wiXSxcbiAgICAgICAgICAgICAgICAxNjk6IFtcIiZjb3B5O1wiXSxcbiAgICAgICAgICAgICAgICA4MjExOiBbXCImbmRhc2g7XCJdLFxuICAgICAgICAgICAgICAgIDgyMTI6IFtcIiZtZGFzaDtcIl0sXG4gICAgICAgICAgICAgICAgODIyMDogW1wiJmxkcXVvO1wiXSxcbiAgICAgICAgICAgICAgICA4MjIxOiBbXCImcmRxdW87XCJdLFxuICAgICAgICAgICAgICAgIDgyMTY6IFtcIiZsc3F1bztcIl0sXG4gICAgICAgICAgICAgICAgODIxNzogW1wiJnJzcXVvO1wiXSxcbiAgICAgICAgICAgICAgICA4NDgyOiBbXCImdHJhZGU7XCJdXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgZm9yICh2YXIgaSBpbiByZXBsYWNlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHJlcGxhY2UuaGFzT3duUHJvcGVydHkoaSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlZ2V4cCA9IG5ldyBSZWdFeHAoU3RyaW5nLmZyb21DaGFyQ29kZShwYXJzZUludChpKSksIFwiZ1wiKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJlZ2V4cC50ZXN0KHRleHQpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhcImZvdW5kIGNoYXJhY3RlclwiICsgU3RyaW5nLmZyb21DaGFyQ29kZShwYXJzZUludChpKSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCA9IHRleHQucmVwbGFjZShyZWdleHAsIHJlcGxhY2VbaV1bMF0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHRleHQ7XG4gICAgICAgIH07XG4gICAgICAgIEVNTFdvcmtzcGFjZS5wcm90b3R5cGUucHJvY2Vzc0h0bWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAvL2NyZWF0ZXMgYSBuZXcgd29ya3NwYWNlIGZyb20gaHRtbFxuICAgICAgICAgICAgdGhpcy5zZXRVcFNob3J0Y3V0S2V5cygpO1xuICAgICAgICAgICAgdGhpcy5saW5rRGF0YSA9IFtdO1xuICAgICAgICAgICAgdGhpcy5pbnRlbGxpZ2VuY2Uub3ZlcnJpZGRlbiA9IFtdO1xuICAgICAgICAgICAgdGhpcy5pbnRlbGxpZ2VuY2UuZXZhbHVhdGVSdWxlcygpO1xuICAgICAgICAgICAgd2luZG93LnNjcm9sbFRvKDAsIDApO1xuICAgICAgICAgICAgLy8gLnJlcGxhY2UobmV3IFJlZ0V4cChcIjwvYT5cIixcImlnXCIpLCBcIjwvYT5cXG5cIilcbiAgICAgICAgICAgIHRoaXMud29ya2luZ0NvZGUgPSB0aGlzLnJlcGxhY2VTcGVjaWFsQ2hhcmFjdGVycyh0aGlzLnNvdXJjZUNvZGUpO1xuICAgICAgICAgICAgLy9kZXRlcm1pbmUgZW1haWwgaGVhZGVyc1xuICAgICAgICAgICAgdGhpcy5fX2VtbEhlYWRlcnMgPSB0aGlzLl9fYnVpbGRIZWFkZXJzKCk7XG4gICAgICAgICAgICAvLyAgICRzY29wZS5kYXRhLmhlYWRlcixcbiAgICAgICAgICAgIC8vICAgJHNjb3BlLmRhdGEuYWxsb3dhYmxlSGVhZGVyRmllbGRzKTtcbiAgICAgICAgICAgIC8vcmVwbGFjZSBtZXJnZSBmaWVsZHNcbiAgICAgICAgICAgIGlmICh0aGlzLmZpbGVOYW1lID09IFwidW50aXRsZWRcIikge1xuICAgICAgICAgICAgICAgIHZhciB0aXRsZVJlZyA9IC88dGl0bGU+KFtePF0uKj8pPFxcL3RpdGxlPi9naTtcbiAgICAgICAgICAgICAgICBpZiAodGl0bGVSZWcudGVzdCh0aGlzLndvcmtpbmdDb2RlKSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdGl0bGVUYWcgPSB0aGlzLndvcmtpbmdDb2RlLm1hdGNoKHRpdGxlUmVnKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRpdGxlVGFnLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZU5hbWUgPSB0aGlzLl9fZm9ybWF0RmlsZU5hbWUodGl0bGVUYWdbMF0ucmVwbGFjZSh0aXRsZVJlZywgXCIkMVwiKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgX3N1cGVyID0gdGhpcztcbiAgICAgICAgICAgIHZhciByZTEgPSAvPGFcXGJbXj5dKj8+KFtcXHJcXG5dfC4pKj88XFwvYT4vZ20sIG4gPSAwO1xuICAgICAgICAgICAgdGhpcy53b3JraW5nQ29kZSA9IHRoaXMud29ya2luZ0NvZGUucmVwbGFjZShyZTEsIGZ1bmN0aW9uIChmb3VuZCkge1xuICAgICAgICAgICAgICAgIG4rKztcbiAgICAgICAgICAgICAgICByZXR1cm4gZm91bmQucmVwbGFjZShcIjxhXCIsIFwiPGEgZW1sLWlkPVxcXCJcIiArIG4gKyBcIlxcXCJcIik7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIG4gPSAwO1xuICAgICAgICAgICAgdGhpcy53b3JraW5nQ29kZSA9IHRoaXMud29ya2luZ0NvZGUucmVwbGFjZShyZTEsIGZ1bmN0aW9uIChjb250ZXh0KSB7XG4gICAgICAgICAgICAgICAgbisrO1xuICAgICAgICAgICAgICAgIC8vZ2V0IGxpbmVcbiAgICAgICAgICAgICAgICB2YXIgbGluZSA9IF9zdXBlci53b3JraW5nQ29kZS5zdWJzdHIoMCwgX3N1cGVyLndvcmtpbmdDb2RlLmluZGV4T2YoY29udGV4dCkpLnNwbGl0KFwiXFxuXCIpLmxlbmd0aCAtIDE7XG4gICAgICAgICAgICAgICAgaWYgKC8oaHJlZlxcPVxcXCIoW15cXFwiXFw+XSopXFxcIj8pL2cudGVzdChjb250ZXh0KSkge1xuICAgICAgICAgICAgICAgICAgICBuKys7XG4gICAgICAgICAgICAgICAgICAgIHZhciBhID0gbmV3IExpbmtPYmplY3QobGluZSwgY29udGV4dCwgX3N1cGVyKTtcbiAgICAgICAgICAgICAgICAgICAgYS5pZCA9IG47XG4gICAgICAgICAgICAgICAgICAgIGEucmVhZE9ubHkgPSAoYS5uZXcuY29udGFpbnMoXCIuY29tL2UvZXMuYXNweFwiKSAmJiBhLm5ldy5jb250YWlucyhcIn5+ZWxvcXVhXCIpKTtcbiAgICAgICAgICAgICAgICAgICAgX3N1cGVyLmxpbmtEYXRhLnB1c2goYSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBcInt7RU1MTWFrZXJfTGluazpcIiArIG4gKyBcIn19XCI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29udGV4dDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMubWFwTGlua09iamVjdHMoZnVuY3Rpb24gKExpbmtPYmplY3QpIHtcbiAgICAgICAgICAgICAgICBMaW5rT2JqZWN0LmlzTGlua0NvbXBsZXRlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMuaW50ZWxsaWdlbmNlKTtcbiAgICAgICAgICAgIC8vcmVkaXJlY3RcbiAgICAgICAgICAgIGxvY2F0aW9uLmhyZWYgPSBcIiMvbGlua3NcIjtcbiAgICAgICAgfTtcbiAgICAgICAgRU1MV29ya3NwYWNlLnByb3RvdHlwZS5hZGROZXdIZWFkZXJGaWVsZCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5oZWFkZXJbdmFsdWVdID0gXCJcIjtcbiAgICAgICAgfTtcbiAgICAgICAgRU1MV29ya3NwYWNlLnByb3RvdHlwZS5yZW1vdmVIZWFkZXJGaWVsZCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgZGVsZXRlIHRoaXMuaGVhZGVyW3ZhbHVlXTtcbiAgICAgICAgfTtcbiAgICAgICAgRU1MV29ya3NwYWNlLnByb3RvdHlwZS5pc0hlYWRlclNlbGVjdGVkID0gZnVuY3Rpb24gKGhlYWRlcikge1xuICAgICAgICAgICAgaWYgKCF0aGlzLmhlYWRlci5oYXNPd25Qcm9wZXJ0eShoZWFkZXIpIHx8IHRoaXMuaGVhZGVyID09IFwiXCIpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgRU1MV29ya3NwYWNlLnByb3RvdHlwZS52ZXJpZnlMaW5rU2VjdGlvbkNvbXBsZXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIG91dHB1dCA9IGZhbHNlO1xuICAgICAgICAgICAgaWYgKHRoaXMuaW50ZWxsaWdlbmNlICYmICF0aGlzLmludGVsbGlnZW5jZS5jYW5Db250aW51ZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIGFyZSB0aGVyZSBsaW5rIGlzc3Vlcz9cbiAgICAgICAgICAgIGlmICh0aGlzLmxpbmtEYXRhICYmIHRoaXMubGlua0RhdGEubGVuZ3RoID09IDApIHtcbiAgICAgICAgICAgICAgICBvdXRwdXQgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmFyZUxpbmtzQ29tcGxldGUoKSkge1xuICAgICAgICAgICAgICAgICAgICBvdXRwdXQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgb3V0cHV0ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICAgICAgfTtcbiAgICAgICAgRU1MV29ya3NwYWNlLnByb3RvdHlwZS5nZW5lcmF0ZU91dHB1dENvZGUgPSBmdW5jdGlvbiAodHlwZSwgY2xvbmUpIHtcbiAgICAgICAgICAgIGlmICh0eXBlID09PSB1bmRlZmluZWQpXG4gICAgICAgICAgICAgICAgdHlwZSA9IFwiZW1haWxcIjtcbiAgICAgICAgICAgIGlmIChjbG9uZSA9PT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgICAgIGNsb25lID0gdHJ1ZTtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICB2YXIgb3V0cHV0ID0gdGhpcy53b3JraW5nQ29kZTtcbiAgICAgICAgICAgIC8vcG9zdCBwcm9jZXNzaW5nLlxuICAgICAgICAgICAgLy9kbyBwb3N0IHByb2Nlc3NpbmcuXG4gICAgICAgICAgICAvL2V4cG9ydCBjb2RlP1xuICAgICAgICAgICAgdGhpcy5tYXBMaW5rT2JqZWN0cyhmdW5jdGlvbiAoTGlua09iamVjdCkge1xuICAgICAgICAgICAgICAgIGlmIChMaW5rT2JqZWN0Lmhhc093blByb3BlcnR5KFwiZGVsZXRlT25SZW5kZXJcIikgJiYgTGlua09iamVjdC5kZWxldGVPblJlbmRlcikge1xuICAgICAgICAgICAgICAgICAgICBvdXRwdXQgPSBvdXRwdXQucmVwbGFjZShuZXcgUmVnRXhwKFwie3tFTUxNYWtlcl9MaW5rOlwiICsgTGlua09iamVjdC5pZCArIFwifX1cIiwgXCJnaVwiKSwgXCJcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKExpbmtPYmplY3QucmVhZE9ubHkpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlYWRPbmx5VXJsID0gTGlua09iamVjdC5jb250ZXh0LnJlcGxhY2UoL2VtbFxcLWlkXFw9XFxcIlswLTldezEsfVxcXCJcXHMvZywgXCJcIik7XG4gICAgICAgICAgICAgICAgICAgIG91dHB1dCA9IG91dHB1dC5yZXBsYWNlKG5ldyBSZWdFeHAoXCJ7e0VNTE1ha2VyX0xpbms6XCIgKyBMaW5rT2JqZWN0LmlkICsgXCJ9fVwiLCBcImdpXCIpLCByZWFkT25seVVybCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YXIgc3RhcnQgPSBMaW5rT2JqZWN0LmNvbnRleHQuaW5kZXhPZihcImhyZWY9XFxcIlwiICsgTGlua09iamVjdC5vbGQudXJsKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gY29kZUxpbmVzW2xpbmVdID0gY29kZUxpbmVzW2xpbmVdLnN1YnN0cigwLCBzdGFydCkgKyBcImhyZWY9XFxcIlwiICsgTGlua09iamVjdC5uZXcudXJsICsgY29kZUxpbmVzW2xpbmVdLnN1YnN0cihzdGFydCs2K0xpbmtPYmplY3Qub2xkLnVybC5sZW5ndGgsIGNvZGVMaW5lc1tsaW5lXS5sZW5ndGgpO1xuICAgICAgICAgICAgICAgICAgICAvL3RoaXMgaXMgd2hlcmUgd2UgdXBkYXRlIHRoZSBjb250ZXh0O1xuICAgICAgICAgICAgICAgICAgICB2YXIgbmV3Q29udGV4dCA9IExpbmtPYmplY3QuY29udGV4dDtcbiAgICAgICAgICAgICAgICAgICAgbmV3Q29udGV4dCA9IG5ld0NvbnRleHQuc3Vic3RyKDAsIHN0YXJ0KSArIFwiaHJlZj1cXFwiXCIgKyBMaW5rT2JqZWN0Lm5ldy51cmwgKyBuZXdDb250ZXh0LnN1YnN0cihzdGFydCArIDYgKyBMaW5rT2JqZWN0Lm9sZC51cmwubGVuZ3RoLCBuZXdDb250ZXh0Lmxlbmd0aCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChMaW5rT2JqZWN0LkxpbmtlZEltYWdlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdDb250ZXh0ID0gTGlua09iamVjdC5MaW5rZWRJbWFnZS5nZW5lcmF0ZU91dHB1dChuZXdDb250ZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBuZXdDb250ZXh0ID0gbmV3Q29udGV4dC5yZXBsYWNlKC9cXHM/ZW1sXFwtaWRcXD1cXFwiWzAtOV0qXFxcIi9nLCBcIlwiKTtcbiAgICAgICAgICAgICAgICAgICAgLy90aGVuIHVwZGF0ZSB0aGUgd29ya2luZyBjb2RlIHdpdGggdGhlIG5ldyBjb250ZXh0O1xuICAgICAgICAgICAgICAgICAgICBvdXRwdXQgPSBvdXRwdXQucmVwbGFjZShuZXcgUmVnRXhwKFwie3tFTUxNYWtlcl9MaW5rOlwiICsgTGlua09iamVjdC5pZCArIFwifX1cIiwgXCJnaVwiKSwgbmV3Q29udGV4dCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAvL2ZpbmQgYWxsIGltYWdlcyB3aXRob3V0IGFsdCBhdHRyaWJ1dGUgYW5kIGFkZCBhbHQ9XCJcIjtcbiAgICAgICAgICAgIG91dHB1dCA9IG91dHB1dC5yZXBsYWNlKC9cXDxpbWdbXlxcPl0uKj9cXD4vZ2ksIGZ1bmN0aW9uIChmb3VuZCkge1xuICAgICAgICAgICAgICAgIGlmIChmb3VuZC5pbmRleE9mKFwiYWx0PVwiKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmb3VuZDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmb3VuZC5yZXBsYWNlKC9cXDxpbWcvZ2ksIFwiPGltZyBhbHQ9XFxcIlxcXCJcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIG91dHB1dCA9IG91dHB1dC5yZXBsYWNlKC88XFwvYT5cXG57MCw1fShcXC58LHxcXD98IXw6fDt8XFx8KS9nLCBcIjwvYT4kMVwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJlcnJvciBtZXJnaW5nIGxpbmVzIHdpdGggbGlua3MgdGhhdCBwcmV2aW91c2x5IGhhZCBwdW5jdHVhdGlvbi5cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gb3V0cHV0O1xuICAgICAgICB9O1xuICAgICAgICBFTUxXb3Jrc3BhY2UucHJvdG90eXBlLnVwZGF0ZUxpbmtzQW5kRXhwb3J0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLmFyZUxpbmtzQ29tcGxldGUoKSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGxvY2F0aW9uLmhyZWYgPSBcIiMvZXhwb3J0XCI7XG4gICAgICAgICAgICB3aW5kb3cuc2Nyb2xsVG8oMCwgMCk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfTtcbiAgICAgICAgRU1MV29ya3NwYWNlLnByb3RvdHlwZS5hcmVMaW5rc0NvbXBsZXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIG91dHB1dCA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLm1hcExpbmtPYmplY3RzKGZ1bmN0aW9uIChMaW5rT2JqZWN0KSB7XG4gICAgICAgICAgICAgICAgaWYgKCFMaW5rT2JqZWN0Ll9faXNDb21wbGV0ZSkge1xuICAgICAgICAgICAgICAgICAgICBvdXRwdXQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKExpbmtPYmplY3QubmVlZHNUcmFja2luZ0NvZGUoKSkge1xuICAgICAgICAgICAgICAgICAgICBvdXRwdXQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgICAgIH07XG4gICAgICAgIEVNTFdvcmtzcGFjZS5wcm90b3R5cGUuZ2V0TGlua3NTdW1tYXJ5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGRhdGEgPSB7XG4gICAgICAgICAgICAgICAgbmVlZHNUcmFja2luZzogMCxcbiAgICAgICAgICAgICAgICBpbnZhbGlkVXJsOiAwXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdGhpcy5tYXBMaW5rT2JqZWN0cyhmdW5jdGlvbiAoTGlua09iamVjdCkge1xuICAgICAgICAgICAgICAgIGlmIChMaW5rT2JqZWN0Lm5lZWRzVHJhY2tpbmdDb2RlKCkpXG4gICAgICAgICAgICAgICAgICAgIGRhdGEubmVlZHNUcmFja2luZysrO1xuICAgICAgICAgICAgICAgIGlmIChMaW5rT2JqZWN0LmlzTGlua0NvbXBsZXRlKCkpXG4gICAgICAgICAgICAgICAgICAgIGRhdGEuaW52YWxpZFVybCsrO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZGF0YTtcbiAgICAgICAgfTtcbiAgICAgICAgRU1MV29ya3NwYWNlLnByb3RvdHlwZS5pbXBvcnRIdG1sRnJvbUZpbGVEcm9wID0gZnVuY3Rpb24gKGV2dCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuc291cmNlQ29kZS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zb3VyY2VDb2RlID0gXCJcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBmaWxlcyA9IGV2dC5kYXRhVHJhbnNmZXIuZmlsZXM7XG4gICAgICAgICAgICBpZiAoZXZ0LmRhdGFUcmFuc2Zlci5maWxlcy5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICAgICAgYWxlcnQoJ3lvdSBjYW4gb25seSBpbXBvcnQgb25lIGZpbGUgYXQgYXQgdGltZS4nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpO1xuICAgICAgICAgICAgICAgIHZhciBXUyA9IHRoaXM7XG4gICAgICAgICAgICAgICAgcmVhZGVyLm9ubG9hZGVuZCA9IGZ1bmN0aW9uIChldnQpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRyb3BUZXh0ID0gZXZ0LnRhcmdldC5yZXN1bHQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciBuYW1lUGFydHMgPSBmaWxlc1swXS5uYW1lLnNwbGl0KFwiLlwiKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGV4dCA9IG5hbWVQYXJ0cy5wb3AoKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgICAgICAgICBXUy5maWxlTmFtZSA9IFdTLl9fZm9ybWF0RmlsZU5hbWUobmFtZVBhcnRzLmpvaW4oXCIuXCIpKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGV4dCA9PSAnZW1sJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgV1Muc291cmNlQ29kZSA9IFdTLl9fc3RyaXBIdG1sQW5kU3ViamVjdEZyb21FTUwoZHJvcFRleHQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgV1Muc291cmNlQ29kZSA9IGRyb3BUZXh0O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIFdTLnByb2Nlc3NIdG1sKCk7XG4gICAgICAgICAgICAgICAgICAgIC8vIFdTLmludGVsbGlnZW5jZSA9IEVNTE1ha2VyQUlFbmdpbmUuQ2hlY2tFbWFpbChXUyk7XG4gICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uLmhyZWYgPSBcIiMvbGlua3NcIjtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHJlYWRlci5yZWFkQXNUZXh0KGZpbGVzWzBdKTtcbiAgICAgICAgICAgICAgICB3aW5kb3cuZ2EoJ3NlbmQnLCAnZXZlbnQnLCBcIkhUTUxcIiwgXCJpbXBvcnRcIiwgXCJIVE1MIEltcG9ydCBGaWxlIERyb3BcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShFTUxXb3Jrc3BhY2UucHJvdG90eXBlLCBcImRlZmF1bHRTQ29kZVwiLCB7XG4gICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uIChuZXdWYWx1ZSkge1xuICAgICAgICAgICAgICAgIHZhciBvbGQgPSB0aGlzLl9kZWZhdWx0U0NvZGU7XG4gICAgICAgICAgICAgICAgaWYgKG9sZCAhPT0gbmV3VmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZGVmYXVsdFNDb2RlID0gbmV3VmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubWFwTGlua09iamVjdHMoZnVuY3Rpb24gKExpbmtPYmplY3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIExpbmtPYmplY3QuaXNMaW5rQ29tcGxldGUoKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgICAgfSk7XG4gICAgICAgIEVNTFdvcmtzcGFjZS5wcm90b3R5cGUuX19mb3JtYXRGaWxlTmFtZSA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICAgICAgICB2YXIgX3NsdWdpZnlfc3RyaXBfcmUgPSAvW15cXHdcXHMtXS9nO1xuICAgICAgICAgICAgdmFyIF9zbHVnaWZ5X2h5cGhlbmF0ZV9yZSA9IC9bLVxcc10rL2c7XG4gICAgICAgICAgICBuYW1lID0gbmFtZS5yZXBsYWNlKF9zbHVnaWZ5X3N0cmlwX3JlLCAnJykudHJpbSgpLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgICBuYW1lID0gbmFtZS5yZXBsYWNlKF9zbHVnaWZ5X2h5cGhlbmF0ZV9yZSwgJy0nKTtcbiAgICAgICAgICAgIHJldHVybiBuYW1lO1xuICAgICAgICB9O1xuICAgICAgICBFTUxXb3Jrc3BhY2UucHJvdG90eXBlLl9fcmVwbGFjZUVsb3F1YU1lcmdlRmllbGRzID0gZnVuY3Rpb24gKGNvbnRlbnQpIHtcbiAgICAgICAgICAgIHZhciByZTQgPSAvPHNwYW4oJTIwfFxccyljbGFzcz1cIj9lbG9xdWFlbWFpbFwiP1xccz8+KC4qPyk8XFwvc3Bhbj4vaWc7XG4gICAgICAgICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKHJlNCwgXCIjJDIjXCIpO1xuICAgICAgICAgICAgcmV0dXJuIGNvbnRlbnQ7XG4gICAgICAgIH07XG4gICAgICAgIEVNTFdvcmtzcGFjZS5wcm90b3R5cGUuX19zdHJpcEh0bWxBbmRTdWJqZWN0RnJvbUVNTCA9IGZ1bmN0aW9uIChjb2RlKSB7XG4gICAgICAgICAgICB2YXIgb3V0cHV0ID0gY29kZS5zcGxpdChcIlxcblwiKTtcbiAgICAgICAgICAgIHZhciBodG1sID0gb3V0cHV0LnBvcCgpO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBvdXRwdXQubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAob3V0cHV0W2ldLmluZGV4T2YoXCJTdWJqZWN0OlwiKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmhlYWRlciA9PT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5oZWFkZXIgPSB7fTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gaHRtbDtcbiAgICAgICAgfTtcbiAgICAgICAgRU1MV29ya3NwYWNlLnByb3RvdHlwZS5fX3JlbW92ZVdoaXRlU3BhY2UgPSBmdW5jdGlvbiAoY29kZSkge1xuICAgICAgICAgICAgdmFyIG91dHB1dCA9IGNvZGU7XG4gICAgICAgICAgICBvdXRwdXQgPSBvdXRwdXQucmVwbGFjZShuZXcgUmVnRXhwKFwiXFxuXCIsIFwiZ1wiKSwgXCIgXCIpO1xuICAgICAgICAgICAgb3V0cHV0ID0gb3V0cHV0LnJlcGxhY2UobmV3IFJlZ0V4cChcIlxcdFwiLCBcImdcIiksIFwiIFwiKTtcbiAgICAgICAgICAgIG91dHB1dCA9IG91dHB1dC5yZXBsYWNlKC9cXHN7Miw5OTk5OX0vZywgXCIgXCIpO1xuICAgICAgICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICAgICAgfTtcbiAgICAgICAgRU1MV29ya3NwYWNlLnByb3RvdHlwZS5fX2J1aWxkSGVhZGVycyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBoZWFkZXJzID0gW107XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuaGVhZGVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGhlYWRlcnMucHVzaCh0aGlzLmhlYWRlcnNbaV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGNoYXJzZXQgPSB0aGlzLl9fZ2V0Q2hhcnNldEZyb21IVE1MKHRoaXMuc291cmNlQ29kZSk7XG4gICAgICAgICAgICBpZiAoY2hhcnNldCA9PSBcIlwiKVxuICAgICAgICAgICAgICAgIGNoYXJzZXQgPSBcImNoYXJzZXQ9VVRGLThcIjtcbiAgICAgICAgICAgIGhlYWRlcnMucHVzaChcIkNvbnRlbnQtVHlwZTogdGV4dC9odG1sO1xcblxcdFwiICsgY2hhcnNldCk7XG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhoZWFkZXJzLCBhbGxvd2FibGVIZWFkZXJGaWVsZHMpO1xuICAgICAgICAgICAgZm9yICh2YXIgaV8xIGluIHRoaXMuaGVhZGVyKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaGVhZGVyLmhhc093blByb3BlcnR5KGlfMSkpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX19hbGxvd2FibGVIZWFkZXJGaWVsZHMuaGFzT3duUHJvcGVydHkoaV8xKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVycy5wdXNoKHRoaXMuX19hbGxvd2FibGVIZWFkZXJGaWVsZHNbaV8xXS5zeW50YXggKyBcIiBcIiArIHRoaXMuaGVhZGVyW2lfMV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5fX2VtbEhlYWRlcnMgPSBoZWFkZXJzLmpvaW4oXCJcXG5cIik7XG4gICAgICAgICAgICByZXR1cm4gaGVhZGVycy5qb2luKFwiXFxuXCIpO1xuICAgICAgICB9O1xuICAgICAgICBFTUxXb3Jrc3BhY2UucHJvdG90eXBlLl9fZ2V0Q2hhcnNldEZyb21IVE1MID0gZnVuY3Rpb24gKGNvbnRlbnQpIHtcbiAgICAgICAgICAgIHZhciByZTUgPSAvPG1ldGEuKj9jaGFyc2V0PShbXlxcc1wiXSopL2lnLCBjaGFyc2V0ID0gXCJcIjtcbiAgICAgICAgICAgIHZhciBtZXRhVGFncyA9IGNvbnRlbnQubWF0Y2gocmU1KTtcbiAgICAgICAgICAgIGlmIChtZXRhVGFncykge1xuICAgICAgICAgICAgICAgIG1ldGFUYWdzLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNoYXJzZXRWYWxzID0gaXRlbS5tYXRjaCgvY2hhcnNldD0oW15cXHNcIl0qKS9pZyk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjaGFyc2V0VmFscykge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2hhcnNldCA9IGNoYXJzZXRWYWxzWzBdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2hhcnNldCA9IFwiY2hhcnNldD1VVEYtOFwiO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gY2hhcnNldDtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIEVNTFdvcmtzcGFjZTtcbiAgICB9KCkpO1xuICAgIEVNTE1vZHVsZS5FTUxXb3Jrc3BhY2UgPSBFTUxXb3Jrc3BhY2U7XG4gICAgdmFyIEtleWJvYXJkU2hvcnRjdXQgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBLZXlib2FyZFNob3J0Y3V0KHdoZW4sIGRvVGhpcywga2V5cywgZGVzY3JpcHRpb24pIHtcbiAgICAgICAgICAgIHRoaXMud2hlbiA9IHdoZW47XG4gICAgICAgICAgICB0aGlzLmRvVGhpcyA9IGRvVGhpcztcbiAgICAgICAgICAgIHRoaXMua2V5cyA9IGtleXM7XG4gICAgICAgICAgICB0aGlzLmRlc2NyaXB0aW9uID0gZGVzY3JpcHRpb247XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIEtleWJvYXJkU2hvcnRjdXQ7XG4gICAgfSgpKTtcbiAgICBFTUxNb2R1bGUuS2V5Ym9hcmRTaG9ydGN1dCA9IEtleWJvYXJkU2hvcnRjdXQ7XG59KShFTUxNb2R1bGUgfHwgKEVNTE1vZHVsZSA9IHt9KSk7XG5cbnZhciBJbnRlbGxpZ2VuY2VBbGVydCA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gSW50ZWxsaWdlbmNlQWxlcnQoKSB7XG4gICAgICAgIHRoaXMub3ZlcnJpZGUgPSBmYWxzZTtcbiAgICB9XG4gICAgSW50ZWxsaWdlbmNlQWxlcnQucHJvdG90eXBlLmdlbmVyYXRlR3VpZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gczQoKSB7XG4gICAgICAgICAgICByZXR1cm4gTWF0aC5mbG9vcigoMSArIE1hdGgucmFuZG9tKCkpICogMHgxMDAwMClcbiAgICAgICAgICAgICAgICAudG9TdHJpbmcoMTYpXG4gICAgICAgICAgICAgICAgLnN1YnN0cmluZygxKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gczQoKSArIHM0KCkgKyAnLScgKyBzNCgpICsgJy0nICsgczQoKSArICctJyArIHM0KCkgKyAnLScgKyBzNCgpICsgczQoKSArIHM0KCk7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoSW50ZWxsaWdlbmNlQWxlcnQucHJvdG90eXBlLCBcInR5cGVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl90eXBlO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uIChuZXdWYWwpIHtcbiAgICAgICAgICAgIHRoaXMuX3R5cGUgPSBuZXdWYWw7XG4gICAgICAgICAgICB0aGlzLmNsZWFuVHlwZSA9IEVycm9yVHlwZVtuZXdWYWxdO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBJbnRlbGxpZ2VuY2VBbGVydC5wcm90b3R5cGUuc2V0T3ZlcnJpZGVTdGF0dXMgPSBmdW5jdGlvbiAodmFsKSB7XG4gICAgICAgIHRoaXMub3ZlcnJpZGUgPSB2YWw7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMuaWQgKyBcIiAtIG92ZXJyaWRkZW5cIik7XG4gICAgfTtcbiAgICByZXR1cm4gSW50ZWxsaWdlbmNlQWxlcnQ7XG59KCkpO1xudmFyIEVNTE1ha2VySW50ZWxsaWdlbmNlO1xuKGZ1bmN0aW9uIChFTUxNYWtlckludGVsbGlnZW5jZSkge1xuICAgIHZhciBJbnRlbGxpZ2VuY2VDZW50ZXIgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBJbnRlbGxpZ2VuY2VDZW50ZXIoJG1vbml0b3IsICRzY29wZSkge1xuICAgICAgICAgICAgdGhpcy5fc2NvcGUgPSAkc2NvcGU7XG4gICAgICAgICAgICB0aGlzLl9tb25pdG9yID0gJG1vbml0b3I7XG4gICAgICAgICAgICB0aGlzLnNlYXJjaFR5cGUgPSB0aGlzLmRlZmF1bHRTZWFyY2hUeXBlKCk7XG4gICAgICAgIH1cbiAgICAgICAgSW50ZWxsaWdlbmNlQ2VudGVyLnByb3RvdHlwZS5zZXRUeXBlID0gZnVuY3Rpb24gKHZhbCkge1xuICAgICAgICAgICAgdGhpcy5zZWFyY2hUeXBlID0gdmFsO1xuICAgICAgICB9O1xuICAgICAgICBJbnRlbGxpZ2VuY2VDZW50ZXIucHJvdG90eXBlLmRlZmF1bHRTZWFyY2hUeXBlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHR5cGVzID0gdGhpcy5fbW9uaXRvci50eXBlcztcbiAgICAgICAgICAgIHJldHVybiBPYmplY3Qua2V5cyh0aGlzLl9tb25pdG9yLnRhYnMpLmxlbmd0aCA+IDFcbiAgICAgICAgICAgICAgICA/IFwiXCJcbiAgICAgICAgICAgICAgICA6ICh0aGlzLl9tb25pdG9yLnRhYnMpWyhPYmplY3Qua2V5cyh0aGlzLl9tb25pdG9yLnRhYnMpWzBdKV07XG4gICAgICAgIH07XG4gICAgICAgIEludGVsbGlnZW5jZUNlbnRlci5wcm90b3R5cGUuY2FuVmlld0FsbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBPYmplY3Qua2V5cyh0aGlzLl9tb25pdG9yLnRhYnMpLmxlbmd0aCA+IDE7XG4gICAgICAgIH07XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbnRlbGxpZ2VuY2VDZW50ZXIucHJvdG90eXBlLCBcInNlYXJjaFwiLCB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgdHlwZXMgPSB0aGlzLl9tb25pdG9yLnR5cGVzO1xuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwic2VhcmNoVHlwZVwiLHRoaXMuc2VhcmNoVHlwZSk7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVzICYmIHRoaXMuc2VhcmNoVHlwZSBpbiB0eXBlcykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4geyB0eXBlOiB0aGlzLnNlYXJjaFR5cGUgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7IHR5cGU6IHRoaXMuZGVmYXVsdFNlYXJjaFR5cGUoKSB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gSW50ZWxsaWdlbmNlQ2VudGVyO1xuICAgIH0oKSk7XG4gICAgRU1MTWFrZXJJbnRlbGxpZ2VuY2UuSW50ZWxsaWdlbmNlQ2VudGVyID0gSW50ZWxsaWdlbmNlQ2VudGVyO1xuICAgIHZhciBJbnRlbGxpZ2VuY2VFbmdpbmUgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBJbnRlbGxpZ2VuY2VFbmdpbmUoKSB7XG4gICAgICAgICAgICB0aGlzLm1lc3NhZ2VzID0gW107XG4gICAgICAgICAgICB0aGlzLmNhbkNvbnRpbnVlID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMuY2FjaGVkUmVzdWx0cyA9IFtdO1xuICAgICAgICAgICAgdGhpcy5zY29wZXMgPSBbXTtcbiAgICAgICAgfVxuICAgICAgICBJbnRlbGxpZ2VuY2VFbmdpbmUucHJvdG90eXBlLl9fbG9jYXRlU2NvcGUgPSBmdW5jdGlvbiAoc2NvcGUpIHtcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSB0aGlzLnNjb3Blcy5maWx0ZXIoZnVuY3Rpb24gKG9iaikge1xuICAgICAgICAgICAgICAgIHJldHVybiBvYmouc2NvcGUgPT0gc2NvcGU7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmIChyZXN1bHQubGVuZ3RoID09IDApIHtcbiAgICAgICAgICAgICAgICB2YXIgYSA9IG5ldyBJbnRlbGxpZ2VuY2VNb2R1bGUoc2NvcGUpO1xuICAgICAgICAgICAgICAgIHZhciBiID0gdGhpcy5zY29wZXMucHVzaChhKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gYTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiByZXN1bHRbMF07XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIEludGVsbGlnZW5jZUVuZ2luZS5wcm90b3R5cGUucmVhZE91dFJ1bGVzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgLy8gdGhpcy5zY29wZXM7XG4gICAgICAgICAgICB0aGlzLnNjb3Blcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgLy9sZXQgdHJhc2hNb25pdG9yID0gbmV3IEludGVsbGlnZW5jZU1vbml0b3IoaXRlbS5zY29wZSk7XG4gICAgICAgICAgICAgICAgdmFyIHJ1bGVzID0gT2JqZWN0LmtleXMoaXRlbS5ydWxlcyk7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBydWxlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvLyB0cmFzaE1vbml0b3IgPSBudWxsO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAvL3J1biBlYWNoIG9mIHRoZSBmdW5jdGlvbnMgYW5kIHJldHVybiB0aGUgc3VicnQuXG4gICAgICAgIH07XG4gICAgICAgIEludGVsbGlnZW5jZUVuZ2luZS5wcm90b3R5cGUubW9kdWxlID0gZnVuY3Rpb24gKHNjb3BlKSB7XG4gICAgICAgICAgICB2YXIgbW9kdWxlID0gdGhpcy5fX2xvY2F0ZVNjb3BlKHNjb3BlKTtcbiAgICAgICAgICAgIHJldHVybiBtb2R1bGU7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBJbnRlbGxpZ2VuY2VFbmdpbmU7XG4gICAgfSgpKTtcbiAgICBFTUxNYWtlckludGVsbGlnZW5jZS5JbnRlbGxpZ2VuY2VFbmdpbmUgPSBJbnRlbGxpZ2VuY2VFbmdpbmU7XG4gICAgdmFyIEludGVsbGlnZW5jZU1vZHVsZSA9IChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIEludGVsbGlnZW5jZU1vZHVsZShzY29wZSkge1xuICAgICAgICAgICAgdGhpcy5zY29wZSA9IHNjb3BlO1xuICAgICAgICAgICAgdGhpcy5ydWxlcyA9IHt9O1xuICAgICAgICB9XG4gICAgICAgIEludGVsbGlnZW5jZU1vZHVsZS5wcm90b3R5cGUubW9uaXRvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgSW50ZWxsaWdlbmNlTW9uaXRvcih0aGlzKTtcbiAgICAgICAgfTtcbiAgICAgICAgSW50ZWxsaWdlbmNlTW9kdWxlLnByb3RvdHlwZS5yZWdpc3RlciA9IGZ1bmN0aW9uIChpZCwgcnVsZSkge1xuICAgICAgICAgICAgdGhpcy5ydWxlc1tpZF0gPSBydWxlO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBJbnRlbGxpZ2VuY2VNb2R1bGU7XG4gICAgfSgpKTtcbiAgICBFTUxNYWtlckludGVsbGlnZW5jZS5JbnRlbGxpZ2VuY2VNb2R1bGUgPSBJbnRlbGxpZ2VuY2VNb2R1bGU7XG4gICAgdmFyIEludGVsbGlnZW5jZU1vbml0b3IgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBJbnRlbGxpZ2VuY2VNb25pdG9yKHBhcmVudFNjb3BlKSB7XG4gICAgICAgICAgICB0aGlzLnJ1bGVzID0gcGFyZW50U2NvcGUucnVsZXM7XG4gICAgICAgICAgICB0aGlzLm92ZXJyaWRkZW4gPSBbXTtcbiAgICAgICAgICAgIHRoaXMudmFyaWFibGVzID0ge1xuICAgICAgICAgICAgICAgIFwiSW50ZWxsaWdlbmNlTW9uaXRvclwiOiB0aGlzXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdGhpcy5yZXNldCgpO1xuICAgICAgICB9XG4gICAgICAgIEludGVsbGlnZW5jZU1vbml0b3IucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5tZXNzYWdlcyA9IFtdO1xuICAgICAgICAgICAgdGhpcy5jYW5Db250aW51ZSA9IHRydWU7XG4gICAgICAgIH07XG4gICAgICAgIEludGVsbGlnZW5jZU1vbml0b3IucHJvdG90eXBlLmFzc29jaWF0ZVZhcmlhYmxlID0gZnVuY3Rpb24gKGFjY2Vzc29yLCB2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy52YXJpYWJsZXNbYWNjZXNzb3JdID0gdmFsdWU7XG4gICAgICAgIH07XG4gICAgICAgIEludGVsbGlnZW5jZU1vbml0b3IucHJvdG90eXBlLmV2YWx1YXRlUnVsZSA9IGZ1bmN0aW9uIChydWxlKSB7XG4gICAgICAgICAgICAvL2xvb2sgZm9yIGluamVjdGlvbiBwYXJhbWV0ZXJzXG4gICAgICAgICAgICB2YXIgcmVzdWx0O1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBydWxlID09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgICAgICAgICAvL2xhc3QgcGFyYW1ldGVyIGlzIHRoZSBmdXVuY3Rpb247XG4gICAgICAgICAgICAgICAgdmFyIGZ1bmMgPSBydWxlW3J1bGUubGVuZ3RoIC0gMV07XG4gICAgICAgICAgICAgICAgdmFyIHBhcmFtZXRlcnMgPSBydWxlLnNsaWNlKDAsIHJ1bGUubGVuZ3RoIC0gMSk7XG4gICAgICAgICAgICAgICAgdmFyIElNXzEgPSB0aGlzO1xuICAgICAgICAgICAgICAgIHZhciBhcmdzID0gcGFyYW1ldGVycy5tYXAoZnVuY3Rpb24gKGtleSkgeyByZXR1cm4gSU1fMS52YXJpYWJsZXNba2V5XTsgfSk7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gZnVuYy5hcHBseShudWxsLCBhcmdzKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBydWxlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9O1xuICAgICAgICBJbnRlbGxpZ2VuY2VNb25pdG9yLnByb3RvdHlwZS5ldmFsdWF0ZVJ1bGVzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5yZXNldCgpO1xuICAgICAgICAgICAgdmFyIHJ1bGVzID0gT2JqZWN0LmtleXModGhpcy5ydWxlcyk7XG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIHJ1bGVzXzEgPSBydWxlczsgX2kgPCBydWxlc18xLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgIHZhciBydWxlID0gcnVsZXNfMVtfaV07XG4gICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHRoaXMuZXZhbHVhdGVSdWxlKHRoaXMucnVsZXNbcnVsZV0pO1xuICAgICAgICAgICAgICAgIHZhciBwcm9jZWVkID0gcmVzdWx0Lmhhc093blByb3BlcnR5KFwid2hlblwiKSA/IHJlc3VsdC53aGVuLmFwcGx5KG51bGwpIDogZmFsc2U7XG4gICAgICAgICAgICAgICAgaWYgKHByb2NlZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gUFVTSCBBTEVSVCBNRVNTQUdFLlxuICAgICAgICAgICAgICAgICAgICB2YXIgSUEgPSBuZXcgSW50ZWxsaWdlbmNlQWxlcnQoKTtcbiAgICAgICAgICAgICAgICAgICAgSUEuaWQgPSByZXN1bHQuaWQgPT09IHVuZGVmaW5lZCB8fCByZXN1bHQuaWQgPT0gXCJcIiA/IElBLmdlbmVyYXRlR3VpZCgpIDogcmVzdWx0LmlkO1xuICAgICAgICAgICAgICAgICAgICBJQS50eXBlID0gcmVzdWx0LnR5cGUgPT09IHVuZGVmaW5lZCA/IEVycm9yVHlwZS5XYXJuIDogcmVzdWx0LnR5cGU7XG4gICAgICAgICAgICAgICAgICAgIElBLnNldmVyaXR5ID0gcmVzdWx0LnNldmVyaXR5ID09PSB1bmRlZmluZWQgPyBFcnJvclNldmVyaXR5Llplcm8gOiByZXN1bHQuc2V2ZXJpdHk7XG4gICAgICAgICAgICAgICAgICAgIElBLnRpdGxlID0gcmVzdWx0LnRpdGxlID09PSB1bmRlZmluZWQgPyBcIlwiIDogcmVzdWx0LnRpdGxlO1xuICAgICAgICAgICAgICAgICAgICBJQS5kZXNjcmlwdGlvbiA9IHJlc3VsdC5kZXNjcmlwdGlvbiA9PT0gdW5kZWZpbmVkID8gXCJcIiA6IHJlc3VsdC5kZXNjcmlwdGlvbjtcbiAgICAgICAgICAgICAgICAgICAgSUEucmVzb3VyY2UgPSByZXN1bHQucmVzb3VyY2UgPT09IHVuZGVmaW5lZCA/IFwiXCIgOiByZXN1bHQucmVzb3VyY2U7XG4gICAgICAgICAgICAgICAgICAgIElBLmN0YUhhbmRsZXIgPSByZXN1bHQuY3RhICYmIHJlc3VsdC5jdGEuaGFuZGxlciA/IHJlc3VsdC5jdGEuaGFuZGxlciA6IGZ1bmN0aW9uICgpIHsgfTtcbiAgICAgICAgICAgICAgICAgICAgSUEuY3RhTGFiZWwgPSByZXN1bHQuY3RhICYmIHJlc3VsdC5jdGEubGFiZWwgPyByZXN1bHQuY3RhLmxhYmVsIDogXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgSUEuY2FuQ29udGludWUgPSByZXN1bHQuaGFzT3duUHJvcGVydHkoXCJjYW5Db250aW51ZVwiKSA/IHJlc3VsdC5jYW5Db250aW51ZSA6IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubWVzc2FnZXMucHVzaChJQSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1lc3NhZ2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMub3ZlcnJpZGRlbi5pbmRleE9mKHRoaXMubWVzc2FnZXNbaV0uaWQpID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlc1tpXS5vdmVycmlkZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5tZXNzYWdlc1tpXS5jYW5Db250aW51ZSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMubWVzc2FnZXNbaV0ub3ZlcnJpZGUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2FuQ29udGludWUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMubWVzc2FnZXMuc29ydChmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICAgICAgICAgIGlmIChhLl90eXBlID4gYi5fdHlwZSlcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgICAgICAgICAgaWYgKGEuX3R5cGUgPCBiLl90eXBlKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEludGVsbGlnZW5jZU1vbml0b3IucHJvdG90eXBlLCBcInRhYnNcIiwge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIG91dHB1dCA9IHt9O1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tZXNzYWdlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBvdXRwdXRbdGhpcy5tZXNzYWdlc1tpXS5jbGVhblR5cGVdID0gdGhpcy5tZXNzYWdlc1tpXS50eXBlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gb3V0cHV0O1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbnRlbGxpZ2VuY2VNb25pdG9yLnByb3RvdHlwZSwgXCJ0eXBlc1wiLCB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgb3V0cHV0ID0ge307XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1lc3NhZ2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIG91dHB1dFt0aGlzLm1lc3NhZ2VzW2ldLnR5cGVdID0gRXJyb3JUeXBlW3RoaXMubWVzc2FnZXNbaV0udHlwZV07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEludGVsbGlnZW5jZU1vbml0b3IucHJvdG90eXBlLCBcImNvdW50XCIsIHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBvdXRwdXQgPSB7fTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubWVzc2FnZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG91dHB1dFtFcnJvclR5cGVbdGhpcy5tZXNzYWdlc1tpXS50eXBlXV0gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0W0Vycm9yVHlwZVt0aGlzLm1lc3NhZ2VzW2ldLnR5cGVdXSA9IDA7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgb3V0cHV0W0Vycm9yVHlwZVt0aGlzLm1lc3NhZ2VzW2ldLnR5cGVdXSsrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gb3V0cHV0O1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBJbnRlbGxpZ2VuY2VNb25pdG9yO1xuICAgIH0oKSk7XG4gICAgRU1MTWFrZXJJbnRlbGxpZ2VuY2UuSW50ZWxsaWdlbmNlTW9uaXRvciA9IEludGVsbGlnZW5jZU1vbml0b3I7XG59KShFTUxNYWtlckludGVsbGlnZW5jZSB8fCAoRU1MTWFrZXJJbnRlbGxpZ2VuY2UgPSB7fSkpO1xudmFyIEVNTEludGVsbGlnZW5jZSA9IG5ldyBFTUxNYWtlckludGVsbGlnZW5jZS5JbnRlbGxpZ2VuY2VFbmdpbmUoKTtcblxuZnVuY3Rpb24gZ2V0T2ZmbGluZVZlcnNpb25OdW1iZXIoKSB7XG4gICAgdmFyIG91dHB1dCA9IFwiXCI7XG4gICAgaWYgKHdpbmRvdy5sb2NhdGlvbi5zZWFyY2guaW5kZXhPZihcIm9mZmxpbmVfdmVyc2lvblwiKSkge1xuICAgICAgICB2YXIgcGFyYW1zID0gd2luZG93LmxvY2F0aW9uLnNlYXJjaC5zdWJzdHIoMSwgd2luZG93LmxvY2F0aW9uLnNlYXJjaC5sZW5ndGgpLnNwbGl0KFwiJlwiKTtcbiAgICAgICAgcGFyYW1zLmZvckVhY2goZnVuY3Rpb24gKHBhcmFtKSB7XG4gICAgICAgICAgICBpZiAocGFyYW0uaW5kZXhPZihcIm9mZmxpbmVfdmVyc2lvbj1cIikgPiAtMSkge1xuICAgICAgICAgICAgICAgIG91dHB1dCA9IHBhcmFtLnN1YnN0cihcIm9mZmxpbmVfdmVyc2lvbj1cIi5sZW5ndGgsIHBhcmFtLmxlbmd0aCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gb3V0cHV0O1xufVxudmFyIEFjY2Vzc09ubGluZVZlcnNpb24gPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEFjY2Vzc09ubGluZVZlcnNpb24oYXJncykge1xuICAgICAgICB0aGlzLmFuaW1hdGUgPSB0cnVlO1xuICAgICAgICB0aGlzLnN0YXR1cyA9IFwiYXR0ZW1wdGluZ1wiO1xuICAgICAgICB0aGlzLmhlYWRsaW5lID0gXCJDaGVja2luZyBhdmFpbGFiaWxpdHkgb2Ygb25saW5lIHZlcnNpb25cIjtcbiAgICAgICAgdGhpcy5tZXNzYWdlID0gXCJJZiB3ZSdyZSBhYmxlIHRvIGFjY2VzcyB0aGUgb25saW5lIHZlcnNpb24sIHlvdSB3aWxsIGJlIHJlZGlyZWN0ZWQuXCI7XG4gICAgICAgIGlmIChhcmdzLnN1Y2Nlc3MgPT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgIGFyZ3Muc3VjY2VzcyA9IGZ1bmN0aW9uICgpIHsgfTtcbiAgICAgICAgaWYgKGFyZ3Mub25lcnJvciA9PT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgYXJncy5vbmVycm9yID0gZnVuY3Rpb24gKCkgeyB9O1xuICAgICAgICB3aW5kb3cuTE9DQUxIT1NUID0gdGhpcy5pc0xvY2FsTWFjaGluZSgpO1xuICAgICAgICB3aW5kb3cuT0ZGTElORV9WRVJTSU9OID0gZ2V0T2ZmbGluZVZlcnNpb25OdW1iZXIoKTtcbiAgICAgICAgaWYgKHdpbmRvdy5MT0NBTEhPU1QpIHtcbiAgICAgICAgICAgIHdpbmRvdy5zY3JvbGxUbygwLCAwKTtcbiAgICAgICAgICAgIHRoaXMub2J0YWluS2V5RnJvbVNlcnZlcihhcmdzKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuc3RhdHVzID0gXCJmYWlsZWRcIjtcbiAgICAgICAgICAgIHRoaXMuYW5pbWF0ZSA9IGZhbHNlO1xuICAgICAgICAgICAgZG9jdW1lbnQudGl0bGUgPSB3aW5kb3cuUEFHRV9USVRMRTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBBY2Nlc3NPbmxpbmVWZXJzaW9uLnByb3RvdHlwZS5vYnRhaW5LZXlGcm9tU2VydmVyID0gZnVuY3Rpb24gKGFyZ3MpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNMb2NhbE1hY2hpbmUoKSkge1xuICAgICAgICAgICAgdmFyIHIsIGEsIG07XG4gICAgICAgICAgICB3aW5kb3cucmVkaXJlY3RKc29ucENhbGxiYWNrID0gZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGlmIChyZXN1bHQgPT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICBhcmdzLnN1Y2Nlc3MoKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJGT1VORD9cIik7XG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbG9jYXRpb24uaHJlZiA9IFwiaHR0cDovL2pvaG5wcm9lc3Rha2VzLmdpdGh1Yi5pby9lbWwtbWFrZXI/b2ZmbGluZV92ZXJzaW9uPVwiICsgd2luZG93LkNVUlJFTlRfVkVSU0lPTjtcbiAgICAgICAgICAgICAgICAgICAgfSwgNTAwKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdub3QgZ2l0aHViJyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKSxcbiAgICAgICAgICAgICAgICBhID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3NjcmlwdCcpWzBdO1xuICAgICAgICAgICAgci50eXBlID0gXCJ0ZXh0L2phdmFzY3JpcHRcIjtcbiAgICAgICAgICAgIHIub25lcnJvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBhcmdzLm9uZXJyb3IoKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByLnNyYyA9ICF0aGlzLmlzTG9jYWxNYWNoaW5lKCkgPyBcIlwiIDogXCJodHRwOi8vam9obnByb2VzdGFrZXMuZ2l0aHViLmlvL2VtbC1tYWtlci9wcm9kL2FwcC9jYW5yZWRpcmVjdC5qc1wiO1xuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgYS5wYXJlbnROb2RlLmluc2VydEJlZm9yZShyLCBtKTtcbiAgICAgICAgICAgIH0sIDIwMDApO1xuICAgICAgICAgICAgZG9jdW1lbnQudGl0bGUgPSB3aW5kb3cuUEFHRV9USVRMRSArIFwiIChPZmZsaW5lIE1vZGUpXCI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnN0YXR1cyA9IFwiZmFpbGVkXCI7XG4gICAgICAgICAgICB0aGlzLmFuaW1hdGUgPSBmYWxzZTtcbiAgICAgICAgICAgIGRvY3VtZW50LnRpdGxlID0gd2luZG93LlBBR0VfVElUTEU7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEFjY2Vzc09ubGluZVZlcnNpb24ucHJvdG90eXBlLmdldE9mZmxpbmVWZXJzaW9uTnVtYmVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgb3V0cHV0ID0gXCJcIjtcbiAgICAgICAgaWYgKHdpbmRvdy5sb2NhdGlvbi5zZWFyY2guaW5kZXhPZihcIm9mZmxpbmVfdmVyc2lvblwiKSkge1xuICAgICAgICAgICAgdmFyIHBhcmFtcyA9IHdpbmRvdy5sb2NhdGlvbi5zZWFyY2guc3Vic3RyKDEsIHdpbmRvdy5sb2NhdGlvbi5zZWFyY2gubGVuZ3RoKS5zcGxpdChcIiZcIik7XG4gICAgICAgICAgICBwYXJhbXMuZm9yRWFjaChmdW5jdGlvbiAocGFyYW0pIHtcbiAgICAgICAgICAgICAgICBpZiAocGFyYW0uaW5kZXhPZihcIm9mZmxpbmVfdmVyc2lvbj1cIikgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICBvdXRwdXQgPSBwYXJhbS5zdWJzdHIoXCJvZmZsaW5lX3ZlcnNpb249XCIubGVuZ3RoLCBwYXJhbS5sZW5ndGgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgfTtcbiAgICBBY2Nlc3NPbmxpbmVWZXJzaW9uLnByb3RvdHlwZS5pc0xvY2FsTWFjaGluZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy8gcmV0dXJuIGZhbHNlO1xuICAgICAgICByZXR1cm4gbG9jYXRpb24uaHJlZi5pbmRleE9mKCdqb2hucHJvZXN0YWtlcy5naXRodWIuaW8nKSA9PSAtMTtcbiAgICB9O1xuICAgIHJldHVybiBBY2Nlc3NPbmxpbmVWZXJzaW9uO1xufSgpKTtcbnZhciBVcGRhdGVNb2R1bGUgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFVwZGF0ZU1vZHVsZSgpIHtcbiAgICAgICAgdGhpcy51cGRhdGVWZXJzaW9uID0gZmFsc2U7XG4gICAgICAgIHRoaXMudXBkYXRlRm9yY2VkID0gZmFsc2U7XG4gICAgICAgIHRoaXMub2ZmbGluZVZlcnNpb24gPSB3aW5kb3cuT0ZGTElORV9WRVJTSU9OID09PSB1bmRlZmluZWQgPyBnZXRPZmZsaW5lVmVyc2lvbk51bWJlcigpIDogd2luZG93Lk9GRkxJTkVfVkVSU0lPTjtcbiAgICAgICAgdGhpcy5vbmxpbmVWZXJzaW9uID0gd2luZG93LkNVUlJFTlRfVkVSU0lPTjtcbiAgICAgICAgLy90cmVhdCBsb2NhbGhvc3Q6ODg4OCBhcyBpbnRlcm5ldFxuICAgICAgICBpZiAobG9jYXRpb24uaHJlZi5pbmRleE9mKFwibG9jYWxob3N0XCIpID4gLTEpIHtcbiAgICAgICAgICAgIHdpbmRvdy5MT0NBTEhPU1QgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAod2luZG93Lk9GRkxJTkVfVkVSU0lPTiA9PSBcIlwiKSB7XG4gICAgICAgICAgICB0aGlzLmFjY2Vzc2luZ0Zyb21PZmZsaW5lID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBpZiAod2luZG93Lk9GRkxJTkVfVkVSU0lPTiAmJiB3aW5kb3cuTE9DQUxIT1NUKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hY2Nlc3NpbmdGcm9tT2ZmbGluZSA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAod2luZG93Lk9GRkxJTkVfVkVSU0lPTiAmJiAod2luZG93Lk9GRkxJTkVfVkVSU0lPTiAhPT0gd2luZG93LkNVUlJFTlRfVkVSU0lPTikpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVZlcnNpb24gPSB0cnVlO1xuICAgICAgICAgICAgICAgIHZhciBvZlYgPSBuZXcgQXBwbGljYXRpb25WZXJzaW9uKHdpbmRvdy5PRkZMSU5FX1ZFUlNJT04pLCBvblYgPSBuZXcgQXBwbGljYXRpb25WZXJzaW9uKHdpbmRvdy5DVVJSRU5UX1ZFUlNJT04pO1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlRm9yY2VkID0gb2ZWLmNvbXBhcmVBZ2FpbnN0KG9uVikgPD0gQXBwVmVyc2lvbkRpZmZlcmVuY2VUeXBlLlBBVENIO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiVVBEQVRFRk9SQ0VEP1wiLCB0aGlzLnVwZGF0ZUZvcmNlZCwgb2ZWLCBvblYpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIFVwZGF0ZU1vZHVsZS5wcm90b3R5cGUuc2hvd01lc3NhZ2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnVwZGF0ZVZlcnNpb24gJiYgdGhpcy51cGRhdGVGb3JjZWQ7XG4gICAgfTtcbiAgICBVcGRhdGVNb2R1bGUucHJvdG90eXBlLnNob3dUZWFzZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm9mZmxpbmVWZXJzaW9uID09IFwiXCIgJiYgIXdpbmRvdy5MT0NBTEhPU1Q7XG4gICAgfTtcbiAgICBVcGRhdGVNb2R1bGUucHJvdG90eXBlLmZvcmNlVXBkYXRlID0gZnVuY3Rpb24gKG9mZmxpbmUsIG9ubGluZSkge1xuICAgICAgICB2YXIgb2ZmbGluZVZlcnNpb24gPSBvZmZsaW5lLnNwbGl0KFwiLlwiKSwgb25saW5lVmVyc2lvbiA9IG9ubGluZS5zcGxpdChcIi5cIiksIG1hdGNoID0gMCwgb3V0cHV0ID0gZmFsc2U7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgb25saW5lVmVyc2lvbi5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKG9ubGluZVZlcnNpb25baV0gPT0gb2ZmbGluZVZlcnNpb25baV0pXG4gICAgICAgICAgICAgICAgbWF0Y2grKztcbiAgICAgICAgfVxuICAgICAgICBpZiAobWF0Y2ggPCAzKSB7XG4gICAgICAgICAgICBvdXRwdXQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgfTtcbiAgICByZXR1cm4gVXBkYXRlTW9kdWxlO1xufSgpKTtcbnZhciBBcHBWZXJzaW9uRGlmZmVyZW5jZVR5cGU7XG4oZnVuY3Rpb24gKEFwcFZlcnNpb25EaWZmZXJlbmNlVHlwZSkge1xuICAgIEFwcFZlcnNpb25EaWZmZXJlbmNlVHlwZVtBcHBWZXJzaW9uRGlmZmVyZW5jZVR5cGVbXCJNQUpPUlwiXSA9IDBdID0gXCJNQUpPUlwiO1xuICAgIEFwcFZlcnNpb25EaWZmZXJlbmNlVHlwZVtBcHBWZXJzaW9uRGlmZmVyZW5jZVR5cGVbXCJNSU5PUlwiXSA9IDFdID0gXCJNSU5PUlwiO1xuICAgIEFwcFZlcnNpb25EaWZmZXJlbmNlVHlwZVtBcHBWZXJzaW9uRGlmZmVyZW5jZVR5cGVbXCJQQVRDSFwiXSA9IDJdID0gXCJQQVRDSFwiO1xuICAgIEFwcFZlcnNpb25EaWZmZXJlbmNlVHlwZVtBcHBWZXJzaW9uRGlmZmVyZW5jZVR5cGVbXCJTVUJQQVRDSFwiXSA9IDNdID0gXCJTVUJQQVRDSFwiO1xuICAgIEFwcFZlcnNpb25EaWZmZXJlbmNlVHlwZVtBcHBWZXJzaW9uRGlmZmVyZW5jZVR5cGVbXCJOT05FXCJdID0gNF0gPSBcIk5PTkVcIjtcbn0pKEFwcFZlcnNpb25EaWZmZXJlbmNlVHlwZSB8fCAoQXBwVmVyc2lvbkRpZmZlcmVuY2VUeXBlID0ge30pKTtcbnZhciBBcHBsaWNhdGlvblZlcnNpb24gPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEFwcGxpY2F0aW9uVmVyc2lvbih2ZXJzaW9uKSB7XG4gICAgICAgIHRoaXMuX3ZlcnNpb24gPSB2ZXJzaW9uO1xuICAgICAgICB0aGlzLnZlcnNpb25PYmplY3QgPSB0aGlzLl92ZXJzaW9uLnNwbGl0KFwiLlwiKS5tYXAoZnVuY3Rpb24gKG4pIHsgcmV0dXJuIHBhcnNlSW50KG4pOyB9KTtcbiAgICB9XG4gICAgQXBwbGljYXRpb25WZXJzaW9uLnByb3RvdHlwZS5jb21wYXJlQWdhaW5zdCA9IGZ1bmN0aW9uIChPdGhlclZlcnNpb24pIHtcbiAgICAgICAgdmFyIG1lID0gdGhpcy52ZXJzaW9uT2JqZWN0LCBvdGhlciA9IE90aGVyVmVyc2lvbi52ZXJzaW9uT2JqZWN0LCBtYXRjaCA9IDAsIG91dHB1dCA9IGZhbHNlO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IDQ7IGkrKykge1xuICAgICAgICAgICAgaWYgKG1lW2ldID09IG90aGVyW2ldKSB7XG4gICAgICAgICAgICAgICAgbWF0Y2grKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBBcHBWZXJzaW9uRGlmZmVyZW5jZVR5cGVbQXBwVmVyc2lvbkRpZmZlcmVuY2VUeXBlW21hdGNoXV07XG4gICAgfTtcbiAgICByZXR1cm4gQXBwbGljYXRpb25WZXJzaW9uO1xufSgpKTtcblxudmFyIFNlY3VyZUdhdGV3YXkgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFNlY3VyZUdhdGV3YXkobG9naW5DYWxsYmFjaywgJHNjb3BlKSB7XG4gICAgICAgIHRoaXMuY2FuTG9naW4gPSBmYWxzZTtcbiAgICAgICAgdGhpcy5sb2dpbkNhbGxiYWNrID0gbG9naW5DYWxsYmFjaztcbiAgICAgICAgdGhpcy5sb2dpblRpbWVyID0gbnVsbDtcbiAgICAgICAgdGhpcy5zZXNzaW9uVXNlckVtYWlsID0gXCJcIjtcbiAgICAgICAgdGhpcy50aW1lckRlbGF5ID0gNTAwO1xuICAgICAgICB0aGlzLnNhbHQgPSBcIjQ3ZGFmZWE5YWFlM2IyOGFiNWMzOWViN2Y3ZDJjOTI0XCI7XG4gICAgICAgIHRoaXMuZW1haWxSZWdleCA9IC9eKChbXjw+KClcXFtcXF1cXFxcLiw7Olxcc0BcIl0rKFxcLltePD4oKVxcW1xcXVxcXFwuLDs6XFxzQFwiXSspKil8KFwiLitcIikpQCgoXFxbWzAtOV17MSwzfVxcLlswLTldezEsM31cXC5bMC05XXsxLDN9XFwuWzAtOV17MSwzfV0pfCgoW2EtekEtWlxcLTAtOV0rXFwuKStbYS16QS1aXXsyLH0pKSQvO1xuICAgICAgICB0aGlzLnNlc3Npb25JZExvY2FsU3RvcmFnZUtleSA9IFwiRU1MTWFrZXIuZW1sU2Vzc2lvblVJRFwiO1xuICAgICAgICBpZiAoIXdpbmRvdy5wZXJzaXN0X3N0b3JlKSB7XG4gICAgICAgICAgICB3aW5kb3cucGVyc2lzdF9zdG9yZSA9IG5ldyB3aW5kb3cuUGVyc2lzdC5TdG9yZSgnRU1MTWFrZXInKTtcbiAgICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCd1bmxvYWQnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgd2luZG93LnBlcnNpc3Rfc3RvcmUuc2F2ZSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIFNHID0gdGhpcztcbiAgICAgICAgbG9jYXRpb24uaHJlZiA9IFwiIy9sb2dpblwiO1xuICAgIH1cbiAgICBTZWN1cmVHYXRld2F5LnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAodGhpcy5oYXNTYXZlZFNlc3Npb25JZCgpKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5pc1ZhbGlkRW1haWxBZGRyZXNzKHRoaXMuc2Vzc2lvbklkKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2Vzc2lvblVzZXJFbWFpbCA9IHRoaXMuc2Vzc2lvbklkO1xuICAgICAgICAgICAgICAgIC8vIGxvZ2luQ2FsbGJhY2soKTtcbiAgICAgICAgICAgICAgICBsb2NhdGlvbi5ocmVmID0gXCIjL2xvZ2luXCI7XG4gICAgICAgICAgICAgICAgLy9hdXRvIGxvZ3MgaW47XG4gICAgICAgICAgICAgICAgLy9pcyBvZmZsaW5lIC0+Z2V0IG9ubGluZSB2ZXJzaW9uLlxuICAgICAgICAgICAgICAgIHRoaXMubG9naW5UaW1lciA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbi5ocmVmID0gXCIjL21haW5cIjtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuc2V0Q3VycmVudFVzZXIoX3RoaXMuc2Vzc2lvblVzZXJFbWFpbCk7XG4gICAgICAgICAgICAgICAgfSwgdGhpcy50aW1lckRlbGF5KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGxvY2F0aW9uLmhyZWYgPSBcIiMvbG9naW5cIjtcbiAgICAgICAgICAgICAgICB0aGlzLnNlc3Npb25Vc2VyRW1haWwgPSBcIlwiO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgbG9jYXRpb24uaHJlZiA9IFwiIy9sb2dpblwiO1xuICAgICAgICAgICAgdGhpcy5zZXNzaW9uVXNlckVtYWlsID0gXCJcIjtcbiAgICAgICAgfVxuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignaGFzaGNoYW5nZScsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmIChfdGhpcy5zZXNzaW9uVXNlckVtYWlsID09IFwiXCIgfHwgIV90aGlzLmhhc1NhdmVkU2Vzc2lvbklkKCkpIHtcbiAgICAgICAgICAgICAgICBsb2NhdGlvbi5ocmVmID0gXCIjL2xvZ2luXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgU2VjdXJlR2F0ZXdheS5wcm90b3R5cGUubG9nT3V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmxvZ2luQXNPdGhlcigpO1xuICAgICAgICB0aGlzLnNlc3Npb25JZCA9IFwiXCI7XG4gICAgICAgIHRoaXMuc2Vzc2lvblVzZXJFbWFpbCA9IFwiXCI7XG4gICAgICAgIHdpbmRvdy5wZXJzaXN0X3N0b3JlLnJlbW92ZSh0aGlzLnNlc3Npb25JZExvY2FsU3RvcmFnZUtleSk7XG4gICAgICAgIGlmIChcInJlbG9hZFwiIGluIGxvY2F0aW9uKSB7XG4gICAgICAgICAgICBsb2NhdGlvbi5yZWxvYWQoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGRvY3VtZW50LmxvY2F0aW9uLmhyZWYgPSBkb2N1bWVudC5sb2NhdGlvbi5ocmVmO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTZWN1cmVHYXRld2F5LnByb3RvdHlwZS5sb2dpbkFzT3RoZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNsZWFyVGltZW91dCh0aGlzLmxvZ2luVGltZXIpO1xuICAgICAgICBkZWxldGUgdGhpcy5sb2dpblRpbWVyO1xuICAgIH07XG4gICAgU2VjdXJlR2F0ZXdheS5wcm90b3R5cGUuc2Vzc2lvblVwZGF0ZVVzZXJFbWFpbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5lcnJvck1lc3NhZ2UgPSBcIlwiO1xuICAgICAgICBpZiAodGhpcy5pc1ZhbGlkRW1haWxBZGRyZXNzKHRoaXMuc2Vzc2lvblVzZXJFbWFpbCkpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0Q3VycmVudFVzZXIodGhpcy5zZXNzaW9uVXNlckVtYWlsKTtcbiAgICAgICAgICAgIHRoaXMubG9naW5DYWxsYmFjaygpO1xuICAgICAgICAgICAgbG9jYXRpb24uaHJlZiA9IFwiIy9tYWluXCI7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyBFcnJvciBtZXNzYWdlXG4gICAgICAgICAgICB0aGlzLmVycm9yTWVzc2FnZSA9IFwiU29ycnkhIFlvdSBoYXZlIHRvIGVudGVyIGEgdmFsaWQgZW1haWwgYWRkcmVzcy5cIjtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU2VjdXJlR2F0ZXdheS5wcm90b3R5cGUuaGFzU2F2ZWRTZXNzaW9uSWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBzYXZlZEVtYWlsSWQgPSB3aW5kb3cucGVyc2lzdF9zdG9yZS5nZXQodGhpcy5zZXNzaW9uSWRMb2NhbFN0b3JhZ2VLZXkpO1xuICAgICAgICAvLyBjb25zb2xlLmxvZyhzYXZlZEVtYWlsSWQpO1xuICAgICAgICBpZiAoc2F2ZWRFbWFpbElkKSB7XG4gICAgICAgICAgICB0aGlzLnNlc3Npb25JZCA9IHRoaXMuZGVjcnlwdChzYXZlZEVtYWlsSWQpO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnNlc3Npb25JZCA9IFwiXCI7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFNlY3VyZUdhdGV3YXkucHJvdG90eXBlLmVuY3J5cHQgPSBmdW5jdGlvbiAodGV4dCkge1xuICAgICAgICB2YXIgb3V0cHV0ID0gdGV4dCArIFwiXCI7XG4gICAgICAgIG91dHB1dCA9IG91dHB1dC5yZXBsYWNlKC8uL2dpLCBmdW5jdGlvbiAoY2gpIHtcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coY2guY2hhckNvZGVBdCgwKSsxKTtcbiAgICAgICAgICAgIHJldHVybiBTdHJpbmcuZnJvbUNoYXJDb2RlKGNoLmNoYXJDb2RlQXQoMCkgKyAxKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgfTtcbiAgICBTZWN1cmVHYXRld2F5LnByb3RvdHlwZS5kZWNyeXB0ID0gZnVuY3Rpb24gKHRleHQpIHtcbiAgICAgICAgdmFyIG91dHB1dCA9IHRleHQgKyBcIlwiO1xuICAgICAgICBvdXRwdXQgPSBvdXRwdXQucmVwbGFjZSgvLi9naSwgZnVuY3Rpb24gKGNoKSB7XG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKGNoLmNoYXJDb2RlQXQoMCkrMSk7XG4gICAgICAgICAgICByZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZShjaC5jaGFyQ29kZUF0KDApIC0gMSk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gb3V0cHV0O1xuICAgIH07XG4gICAgU2VjdXJlR2F0ZXdheS5wcm90b3R5cGUuc2V0Q3VycmVudFVzZXIgPSBmdW5jdGlvbiAoZW1haWwpIHtcbiAgICAgICAgdmFyIGhhc2ggPSB3aW5kb3cuQ3J5cHRvSlMuTUQ1KGVtYWlsICsgdGhpcy5zYWx0KS50b1N0cmluZygpO1xuICAgICAgICB3aW5kb3cucGVyc2lzdF9zdG9yZS5zZXQodGhpcy5zZXNzaW9uSWRMb2NhbFN0b3JhZ2VLZXksIHRoaXMuZW5jcnlwdChlbWFpbCkpO1xuICAgICAgICB3aW5kb3cuZ2EoJ3NldCcsICd1c2VySWQnLCBoYXNoKTtcbiAgICB9O1xuICAgIFNlY3VyZUdhdGV3YXkucHJvdG90eXBlLmlzVmFsaWRFbWFpbEFkZHJlc3MgPSBmdW5jdGlvbiAoZW1haWwpIHtcbiAgICAgICAgaWYgKHRoaXMuZW1haWxSZWdleC50ZXN0KGVtYWlsKSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coZW1haWwsIFwiaXMgdmFsaWRcIik7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGVtYWlsLCBcImlzIG5vdCB2YWxpZFwiKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIFNlY3VyZUdhdGV3YXk7XG59KCkpO1xuIiwiXG5pbnRlcmZhY2UgSW50ZWxsaWdlbmNlQWxlcnRBcmdzIHtcbiAgaGFuZGxlcjogKCk9PnZvaWQsXG4gIGN0YUxhYmVsOiBzdHJpbmcsXG4gIHNldmVyaXR5OiBFcnJvclNldmVyaXR5LFxuICBpbnB1dE1vZGVsOiBzdHJpbmcsXG4gIGlucHV0TGFiZWw6IHN0cmluZ1xufVxuaW50ZXJmYWNlIEludGVsbGlnZW5jZVNjb3Ble1xuICBzY29wZTogc3RyaW5nO1xuICBydWxlOiBhbnlcbn1cbmludGVyZmFjZSBJbnRlbGxpZ2VuY2VTdWJ7XG4gIHdoZW46ICgpPT5ib29sZWFuLFxuICBpZDogc3RyaW5nLFxuICB0eXBlOiBFcnJvclR5cGUsXG4gIHNldmVyaXR5OiBFcnJvclNldmVyaXR5LFxuICB0aXRsZTogc3RyaW5nLFxuICBkZXNjcmlwdGlvbjogc3RyaW5nLFxuICByZXNvdXJjZTogc3RyaW5nLFxuICBjdGE6IHtcbiAgICBsYWJlbDogc3RyaW5nLFxuICAgIGhhbmRsZXI6ICgpPT52b2lkXG4gIH1cbiAgY2FuQ29udGludWU6IGJvb2xlYW5cblxufVxuY2xhc3MgSW50ZWxsaWdlbmNlQWxlcnQge1xuICBpZDogc3RyaW5nO1xuICBfdHlwZTogRXJyb3JUeXBlO1xuICBvdmVycmlkZTogYm9vbGVhbjtcbiAgdGl0bGU6IHN0cmluZztcbiAgZGVzY3JpcHRpb246IHN0cmluZztcbiAgcmVzb3VyY2U6IHN0cmluZztcbiAgY3RhTGFiZWw6IHN0cmluZztcbiAgY3RhSGFuZGxlcjogYW55O1xuICBjYW5Db250aW51ZTogYm9vbGVhbjtcbiAgc2V2ZXJpdHk6IEVycm9yU2V2ZXJpdHk7XG4gIGNsZWFuVHlwZTogc3RyaW5nO1xuICBhcmdzOiBJbnRlbGxpZ2VuY2VBbGVydEFyZ3M7XG5cbiAgZ2VuZXJhdGVHdWlkKCkge1xuICAgIGZ1bmN0aW9uIHM0KCkge1xuICAgICAgcmV0dXJuIE1hdGguZmxvb3IoKDEgKyBNYXRoLnJhbmRvbSgpKSAqIDB4MTAwMDApXG4gICAgICAgIC50b1N0cmluZygxNilcbiAgICAgICAgLnN1YnN0cmluZygxKTtcbiAgICB9XG4gICAgcmV0dXJuIHM0KCkgKyBzNCgpICsgJy0nICsgczQoKSArICctJyArIHM0KCkgKyAnLScgKyBzNCgpICsgJy0nICsgczQoKSArIHM0KCkgKyBzNCgpO1xuICB9XG4gIGNvbnN0cnVjdG9yKCl7XG4gICAgdGhpcy5vdmVycmlkZSA9IGZhbHNlO1xuICB9XG4gIGdldCB0eXBlKCl7XG4gICAgcmV0dXJuIHRoaXMuX3R5cGU7XG4gIH1cbiAgc2V0IHR5cGUobmV3VmFsKXtcbiAgICB0aGlzLl90eXBlID0gbmV3VmFsO1xuICAgIHRoaXMuY2xlYW5UeXBlID0gRXJyb3JUeXBlW25ld1ZhbF07XG4gIH1cbiAgc2V0T3ZlcnJpZGVTdGF0dXModmFsKXtcbiAgICB0aGlzLm92ZXJyaWRlID0gdmFsO1xuICAgIC8vIGNvbnNvbGUubG9nKHRoaXMuaWQgKyBcIiAtIG92ZXJyaWRkZW5cIik7XG4gIH1cbn1cbmludGVyZmFjZSBJbnRlbGxpZ2VuY2VDZW50ZXJGaWx0ZXIge1xuICB0eXBlOiBzdHJpbmc7XG59XG5tb2R1bGUgRU1MTWFrZXJJbnRlbGxpZ2VuY2Uge1xuXG4gIGV4cG9ydCBjbGFzcyBJbnRlbGxpZ2VuY2VDZW50ZXIge1xuICAgIF9zZWFyY2g6IGFueTtcbiAgICBfbW9uaXRvcjogSW50ZWxsaWdlbmNlTW9uaXRvcjtcbiAgICBfc2NvcGU6IGFueTtcbiAgICBzZWFyY2hUeXBlOiBzdHJpbmc7XG5cbiAgICBjb25zdHJ1Y3RvcigkbW9uaXRvciwgJHNjb3BlKXtcbiAgICAgIHRoaXMuX3Njb3BlID0gJHNjb3BlO1xuICAgICAgdGhpcy5fbW9uaXRvciA9ICRtb25pdG9yO1xuICAgICAgdGhpcy5zZWFyY2hUeXBlID0gdGhpcy5kZWZhdWx0U2VhcmNoVHlwZSgpO1xuICAgIH1cbiAgICBzZXRUeXBlKHZhbCl7XG4gICAgICB0aGlzLnNlYXJjaFR5cGUgPSB2YWw7XG4gICAgfVxuICAgIGRlZmF1bHRTZWFyY2hUeXBlKCl7XG4gICAgICB2YXIgdHlwZXMgPSB0aGlzLl9tb25pdG9yLnR5cGVzO1xuICAgICAgcmV0dXJuIE9iamVjdC5rZXlzKHRoaXMuX21vbml0b3IudGFicykubGVuZ3RoPjFcbiAgICAgID8gXCJcIlxuICAgICAgOiAodGhpcy5fbW9uaXRvci50YWJzKVsoT2JqZWN0LmtleXModGhpcy5fbW9uaXRvci50YWJzKVswXSldO1xuICAgIH1cbiAgICBjYW5WaWV3QWxsKCl7XG4gICAgICByZXR1cm4gT2JqZWN0LmtleXModGhpcy5fbW9uaXRvci50YWJzKS5sZW5ndGg+MTtcbiAgICB9XG4gICAgZ2V0IHNlYXJjaCgpOkludGVsbGlnZW5jZUNlbnRlckZpbHRlciB7XG5cbiAgICAgIHZhciB0eXBlcyA9IHRoaXMuX21vbml0b3IudHlwZXM7XG4gICAgICAvLyBjb25zb2xlLmxvZyhcInNlYXJjaFR5cGVcIix0aGlzLnNlYXJjaFR5cGUpO1xuICAgICAgaWYoIHR5cGVzICYmIHRoaXMuc2VhcmNoVHlwZSBpbiB0eXBlcyl7XG4gICAgICAgIHJldHVybiB7dHlwZTogdGhpcy5zZWFyY2hUeXBlIH07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4ge3R5cGU6IHRoaXMuZGVmYXVsdFNlYXJjaFR5cGUoKSB9O1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG5cbiAgZXhwb3J0IGNsYXNzIEludGVsbGlnZW5jZUVuZ2luZSB7XG4gICAgbWVzc2FnZXM6IEludGVsbGlnZW5jZUFsZXJ0W107XG4gICAgY2FuQ29udGludWU6IGJvb2xlYW47XG4gICAgY2FjaGVkUmVzdWx0czogSW50ZWxsaWdlbmNlQWxlcnRbXTtcbiAgICBvdmVycmlkZGVuOiBzdHJpbmdbXTtcbiAgICBzY29wZXM6IEludGVsbGlnZW5jZU1vZHVsZVtdO1xuXG4gICAgY29uc3RydWN0b3IoKXtcbiAgICAgIHRoaXMubWVzc2FnZXMgPSBbXTtcbiAgICAgIHRoaXMuY2FuQ29udGludWUgPSB0cnVlO1xuICAgICAgdGhpcy5jYWNoZWRSZXN1bHRzID0gW107XG4gICAgICB0aGlzLnNjb3BlcyA9IFtdO1xuXG4gICAgfVxuICAgIF9fbG9jYXRlU2NvcGUoc2NvcGUpIHtcbiAgICAgIHZhciByZXN1bHQgPSB0aGlzLnNjb3Blcy5maWx0ZXIoZnVuY3Rpb24ob2JqOkludGVsbGlnZW5jZU1vZHVsZSl7XG4gICAgICAgIHJldHVybiBvYmouc2NvcGUgPT0gc2NvcGU7XG4gICAgICAgfSk7XG5cbiAgICAgIGlmKHJlc3VsdC5sZW5ndGggPT0gMCl7XG4gICAgICAgIGxldCBhID0gbmV3IEludGVsbGlnZW5jZU1vZHVsZShzY29wZSk7XG4gICAgICAgIGxldCBiID0gdGhpcy5zY29wZXMucHVzaChhKTtcbiAgICAgICAgcmV0dXJuIGE7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gcmVzdWx0WzBdO1xuICAgICAgfVxuICAgIH1cbiAgICByZWFkT3V0UnVsZXMoKXtcbiAgICAgIC8vIHRoaXMuc2NvcGVzO1xuXG4gICAgICB0aGlzLnNjb3Blcy5mb3JFYWNoKChpdGVtOkludGVsbGlnZW5jZU1vZHVsZSk9PntcbiAgICAgICAgLy9sZXQgdHJhc2hNb25pdG9yID0gbmV3IEludGVsbGlnZW5jZU1vbml0b3IoaXRlbS5zY29wZSk7XG5cbiAgICAgICAgdmFyIHJ1bGVzID0gT2JqZWN0LmtleXMoaXRlbS5ydWxlcyk7XG4gICAgICAgIGZvcih2YXIgaT0wOyBpPHJ1bGVzLmxlbmd0aDsgaSsrKXtcblxuICAgICAgICAgIC8vIGlmKGl0ZW0ucnVsZXMuaGFzT3duUHJvcGVydHkocnVsZSkpe1xuICAgICAgICAgIC8vICAgY29uc29sZS5sb2codHJhc2hNb25pdG9yLmV2YWx1YXRlUnVsZShpdGVtLnJ1bGVzW3J1bGVdKSk7XG4gICAgICAgICAgLy8gfVxuICAgICAgICB9XG4gICAgICAgIC8vIHRyYXNoTW9uaXRvciA9IG51bGw7XG4gICAgICB9KTtcblxuXG5cbiAgICAgIC8vcnVuIGVhY2ggb2YgdGhlIGZ1bmN0aW9ucyBhbmQgcmV0dXJuIHRoZSBzdWJydC5cbiAgICB9XG4gICAgbW9kdWxlKHNjb3BlKXtcbiAgICAgIGxldCBtb2R1bGUgPSB0aGlzLl9fbG9jYXRlU2NvcGUoc2NvcGUpO1xuICAgICAgcmV0dXJuIG1vZHVsZTtcbiAgICB9XG4gIH1cblxuICBleHBvcnQgY2xhc3MgSW50ZWxsaWdlbmNlTW9kdWxlIHtcbiAgICBzY29wZTogc3RyaW5nO1xuICAgIHJ1bGVzOiB7c3RyaW5nPzogYW55W119O1xuICAgIG92ZXJyaWRkZW46IHN0cmluZ1tdO1xuICAgIGNhbkNvbnRpbnVlOiBib29sZWFuO1xuICAgIG1lc3NhZ2VzOiBJbnRlbGxpZ2VuY2VBbGVydFtdO1xuXG4gICAgY29uc3RydWN0b3Ioc2NvcGUpe1xuICAgICAgdGhpcy5zY29wZSA9IHNjb3BlO1xuICAgICAgdGhpcy5ydWxlcyA9IHt9O1xuICAgIH1cblxuXG4gICAgbW9uaXRvcigpe1xuICAgICAgcmV0dXJuIG5ldyBJbnRlbGxpZ2VuY2VNb25pdG9yKHRoaXMpO1xuICAgIH1cbiAgICByZWdpc3RlcihpZCwgcnVsZSk6SW50ZWxsaWdlbmNlTW9kdWxle1xuICAgICAgdGhpcy5ydWxlc1tpZF0gPSBydWxlO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICB9XG4gIGV4cG9ydCBjbGFzcyBJbnRlbGxpZ2VuY2VNb25pdG9yIHtcbiAgICBzY29wZTogc3RyaW5nO1xuICAgIHJ1bGVzOiBhbnlbXTtcbiAgICB2YXJpYWJsZXM6IHt9O1xuICAgIG92ZXJyaWRkZW46IHN0cmluZ1tdO1xuICAgIGNhbkNvbnRpbnVlOiBib29sZWFuO1xuICAgIG1lc3NhZ2VzOiBJbnRlbGxpZ2VuY2VBbGVydFtdO1xuXG4gICAgY29uc3RydWN0b3IocGFyZW50U2NvcGUpe1xuICAgICAgdGhpcy5ydWxlcyA9IHBhcmVudFNjb3BlLnJ1bGVzO1xuICAgICAgdGhpcy5vdmVycmlkZGVuID0gW107XG4gICAgICB0aGlzLnZhcmlhYmxlcyA9IHtcbiAgICAgICAgXCJJbnRlbGxpZ2VuY2VNb25pdG9yXCI6IHRoaXNcbiAgICAgIH07XG4gICAgICB0aGlzLnJlc2V0KCk7XG4gICAgfVxuICAgIHJlc2V0KCl7XG4gICAgICB0aGlzLm1lc3NhZ2VzID0gW107XG4gICAgICB0aGlzLmNhbkNvbnRpbnVlID0gdHJ1ZTtcbiAgICB9XG4gICAgYXNzb2NpYXRlVmFyaWFibGUoYWNjZXNzb3IsIHZhbHVlKXtcbiAgICAgIHRoaXMudmFyaWFibGVzW2FjY2Vzc29yXSA9IHZhbHVlO1xuICAgIH1cbiAgICBldmFsdWF0ZVJ1bGUocnVsZSk6SW50ZWxsaWdlbmNlU3Vie1xuICAgICAgLy9sb29rIGZvciBpbmplY3Rpb24gcGFyYW1ldGVyc1xuICAgICAgdmFyIHJlc3VsdDtcblxuICAgICAgaWYodHlwZW9mIHJ1bGUgPT0gXCJvYmplY3RcIil7XG4gICAgICAgIC8vbGFzdCBwYXJhbWV0ZXIgaXMgdGhlIGZ1dW5jdGlvbjtcbiAgICAgICAgdmFyIGZ1bmMgPSBydWxlW3J1bGUubGVuZ3RoLTFdO1xuICAgICAgICB2YXIgcGFyYW1ldGVycyA9IHJ1bGUuc2xpY2UoMCwgcnVsZS5sZW5ndGgtMSk7XG4gICAgICAgIGxldCBJTSA9IHRoaXM7XG5cbiAgICAgICAgdmFyIGFyZ3MgPSBwYXJhbWV0ZXJzLm1hcChmdW5jdGlvbihrZXk6c3RyaW5nKXtyZXR1cm4gSU0udmFyaWFibGVzW2tleV07IH0pO1xuICAgICAgICB0cnkge1xuICAgICAgICAgIHJlc3VsdCA9IGZ1bmMuYXBwbHkobnVsbCwgYXJncyk7XG4gICAgICAgIH0gY2F0Y2goZSl7XG4gICAgICAgICAgY29uc29sZS5lcnJvcihlKTtcbiAgICAgICAgfVxuXG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXN1bHQgPSBydWxlKCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgICBldmFsdWF0ZVJ1bGVzKCl7XG4gICAgICB0aGlzLnJlc2V0KCk7XG4gICAgICB2YXIgcnVsZXMgPSBPYmplY3Qua2V5cyh0aGlzLnJ1bGVzKTtcbiAgICAgIGZvcih2YXIgcnVsZSAgb2YgcnVsZXMpe1xuICAgICAgICB2YXIgcmVzdWx0ID0gdGhpcy5ldmFsdWF0ZVJ1bGUodGhpcy5ydWxlc1tydWxlXSk7XG5cbiAgICAgICAgdmFyIHByb2NlZWQgPSByZXN1bHQuaGFzT3duUHJvcGVydHkoXCJ3aGVuXCIpID8gcmVzdWx0LndoZW4uYXBwbHkobnVsbCkgOiBmYWxzZTtcblxuICAgICAgICBpZihwcm9jZWVkKXtcbiAgICAgICAgICAvLyBQVVNIIEFMRVJUIE1FU1NBR0UuXG4gICAgICAgICAgbGV0IElBID0gbmV3IEludGVsbGlnZW5jZUFsZXJ0KCk7XG4gICAgICAgICAgSUEuaWQgPSByZXN1bHQuaWQ9PT11bmRlZmluZWQgfHwgcmVzdWx0LmlkPT1cIlwiID8gSUEuZ2VuZXJhdGVHdWlkKCkgOiByZXN1bHQuaWQ7XG4gICAgICAgICAgSUEudHlwZSA9IHJlc3VsdC50eXBlID09PSB1bmRlZmluZWQgPyBFcnJvclR5cGUuV2FybiA6IHJlc3VsdC50eXBlO1xuICAgICAgICAgIElBLnNldmVyaXR5ID0gcmVzdWx0LnNldmVyaXR5ID09PSB1bmRlZmluZWQgPyBFcnJvclNldmVyaXR5Llplcm8gOiByZXN1bHQuc2V2ZXJpdHk7XG4gICAgICAgICAgSUEudGl0bGUgPSByZXN1bHQudGl0bGUgPT09IHVuZGVmaW5lZCA/IFwiXCIgOiByZXN1bHQudGl0bGU7XG4gICAgICAgICAgSUEuZGVzY3JpcHRpb24gPSByZXN1bHQuZGVzY3JpcHRpb24gPT09IHVuZGVmaW5lZCA/IFwiXCIgOiByZXN1bHQuZGVzY3JpcHRpb247XG4gICAgICAgICAgSUEucmVzb3VyY2UgPSByZXN1bHQucmVzb3VyY2UgPT09IHVuZGVmaW5lZCA/IFwiXCIgOiByZXN1bHQucmVzb3VyY2U7XG4gICAgICAgICAgSUEuY3RhSGFuZGxlciA9IHJlc3VsdC5jdGEgJiYgcmVzdWx0LmN0YS5oYW5kbGVyID8gcmVzdWx0LmN0YS5oYW5kbGVyIDogZnVuY3Rpb24oKXt9O1xuICAgICAgICAgIElBLmN0YUxhYmVsID0gcmVzdWx0LmN0YSAmJiByZXN1bHQuY3RhLmxhYmVsID8gcmVzdWx0LmN0YS5sYWJlbCA6IFwiXCI7XG4gICAgICAgICAgSUEuY2FuQ29udGludWUgPSByZXN1bHQuaGFzT3duUHJvcGVydHkoXCJjYW5Db250aW51ZVwiKSA/IHJlc3VsdC5jYW5Db250aW51ZSA6IHRydWU7XG4gICAgICAgICAgdGhpcy5tZXNzYWdlcy5wdXNoKElBKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBmb3IodmFyIGk9MDsgaSA8IHRoaXMubWVzc2FnZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYodGhpcy5vdmVycmlkZGVuLmluZGV4T2YoIHRoaXMubWVzc2FnZXNbaV0uaWQgKT4tMSl7XG4gICAgICAgICAgdGhpcy5tZXNzYWdlc1tpXS5vdmVycmlkZSA9IHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICBpZighdGhpcy5tZXNzYWdlc1tpXS5jYW5Db250aW51ZSkge1xuICAgICAgICAgIGlmKCF0aGlzLm1lc3NhZ2VzW2ldLm92ZXJyaWRlKSB7XG4gICAgICAgICAgICB0aGlzLmNhbkNvbnRpbnVlID0gZmFsc2U7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cblxuICAgICAgdGhpcy5tZXNzYWdlcy5zb3J0KChhOkludGVsbGlnZW5jZUFsZXJ0LCBiOkludGVsbGlnZW5jZUFsZXJ0KTpudW1iZXIgPT4ge1xuICAgICAgICAgIGlmKGEuX3R5cGU+Yi5fdHlwZSkgcmV0dXJuIDE7XG4gICAgICAgICAgaWYoYS5fdHlwZTxiLl90eXBlKSByZXR1cm4gLTE7XG4gICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBnZXQgdGFicygpe1xuICAgICAgbGV0IG91dHB1dCA9IHt9O1xuICAgICAgZm9yKGxldCBpID0gMDsgaTx0aGlzLm1lc3NhZ2VzLmxlbmd0aDsgaSsrKXtcbiAgICAgICAgb3V0cHV0W3RoaXMubWVzc2FnZXNbaV0uY2xlYW5UeXBlXSA9IHRoaXMubWVzc2FnZXNbaV0udHlwZTtcbiAgICAgICAgLy8gb3V0cHV0W3RoaXMubWVzc2FnZXNbaV0udHlwZV0gPSBFcnJvclR5cGVbdGhpcy5tZXNzYWdlc1tpXS50eXBlXTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgfVxuICAgIGdldCB0eXBlcygpe1xuICAgICAgbGV0IG91dHB1dCA9IHt9O1xuICAgICAgZm9yKGxldCBpID0gMDsgaTx0aGlzLm1lc3NhZ2VzLmxlbmd0aDsgaSsrKXtcbiAgICAgICAgb3V0cHV0W3RoaXMubWVzc2FnZXNbaV0udHlwZV0gPSBFcnJvclR5cGVbdGhpcy5tZXNzYWdlc1tpXS50eXBlXTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgfVxuICAgIGdldCBjb3VudCgpe1xuICAgICAgbGV0IG91dHB1dCA9IHt9O1xuICAgICAgZm9yKHZhciBpID0wOyBpIDwgdGhpcy5tZXNzYWdlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZihvdXRwdXRbRXJyb3JUeXBlW3RoaXMubWVzc2FnZXNbaV0udHlwZV1dID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICBvdXRwdXRbRXJyb3JUeXBlW3RoaXMubWVzc2FnZXNbaV0udHlwZV1dID0gMDtcbiAgICAgICAgfVxuICAgICAgICBvdXRwdXRbRXJyb3JUeXBlW3RoaXMubWVzc2FnZXNbaV0udHlwZV1dKys7XG4gICAgICB9XG4gICAgICByZXR1cm4gb3V0cHV0O1xuICAgIH1cbiAgfVxuXG59XG5cblxudmFyIEVNTEludGVsbGlnZW5jZSA9IG5ldyBFTUxNYWtlckludGVsbGlnZW5jZS5JbnRlbGxpZ2VuY2VFbmdpbmUoKTtcbiIsImludGVyZmFjZSBXaW5kb3cge1xuICAgIGdhKG9wdGlvbjEsIG9wdGlvbjIsIG9wdGlvbjMsIG9wdGlvbjQ/LCBvcHRpb241Pyk6IHZvaWQ7XG4gICAgUGVyc2lzdDogYW55O1xuICAgIENyeXB0b0pTOiBhbnk7XG4gICAgalF1ZXJ5KG9wdGlvbik6YW55O1xuICAgIGRlY29kZVVSSUNvbXBvbmVudChvcHRpb24pOiBzdHJpbmc7XG4gICAgZW5jb2RlVVJJQ29tcG9uZW50KG9wdGlvbik6IHN0cmluZztcbn1cblxuY2xhc3MgU2VjdXJlR2F0ZXdheXtcbiAgbG9naW5DYWxsYmFjazogKCk9Pnt9O1xuICBsb2dpblRpbWVyOiBhbnk7XG4gIGVycm9yTWVzc2FnZTogc3RyaW5nO1xuICBzZXNzaW9uSWQ6c3RyaW5nO1xuICBzZXNzaW9uSWRMb2NhbFN0b3JhZ2VLZXk6IHN0cmluZztcbiAgc2Vzc2lvblVzZXJFbWFpbDpzdHJpbmc7XG4gIHRpbWVyRGVsYXk6IG51bWJlcjtcbiAgc2FsdDogc3RyaW5nO1xuICBlbWFpbFJlZ2V4OiBSZWdFeHA7XG4gIGNhbkxvZ2luOiBib29sZWFuO1xuICBBT1Y6IEFjY2Vzc09ubGluZVZlcnNpb247XG5cblxuICBjb25zdHJ1Y3Rvcihsb2dpbkNhbGxiYWNrLCAkc2NvcGUpe1xuICAgIHRoaXMuY2FuTG9naW4gPSBmYWxzZTtcbiAgICB0aGlzLmxvZ2luQ2FsbGJhY2sgPSBsb2dpbkNhbGxiYWNrO1xuICAgIHRoaXMubG9naW5UaW1lciA9IG51bGw7XG4gICAgdGhpcy5zZXNzaW9uVXNlckVtYWlsID0gXCJcIjtcbiAgICB0aGlzLnRpbWVyRGVsYXkgPSA1MDA7XG4gICAgdGhpcy5zYWx0ID0gXCI0N2RhZmVhOWFhZTNiMjhhYjVjMzllYjdmN2QyYzkyNFwiO1xuICAgIHRoaXMuZW1haWxSZWdleCA9IC9eKChbXjw+KClcXFtcXF1cXFxcLiw7Olxcc0BcIl0rKFxcLltePD4oKVxcW1xcXVxcXFwuLDs6XFxzQFwiXSspKil8KFwiLitcIikpQCgoXFxbWzAtOV17MSwzfVxcLlswLTldezEsM31cXC5bMC05XXsxLDN9XFwuWzAtOV17MSwzfV0pfCgoW2EtekEtWlxcLTAtOV0rXFwuKStbYS16QS1aXXsyLH0pKSQvO1xuICAgIHRoaXMuc2Vzc2lvbklkTG9jYWxTdG9yYWdlS2V5ID0gXCJFTUxNYWtlci5lbWxTZXNzaW9uVUlEXCI7XG5cbiAgICBpZighd2luZG93LnBlcnNpc3Rfc3RvcmUpXG4gICAge3dpbmRvdy5wZXJzaXN0X3N0b3JlID0gbmV3IHdpbmRvdy5QZXJzaXN0LlN0b3JlKCdFTUxNYWtlcicpO1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCd1bmxvYWQnLCBmdW5jdGlvbigpe1xuICAgICAgd2luZG93LnBlcnNpc3Rfc3RvcmUuc2F2ZSgpO1xuICAgIH0pO31cbiAgICBsZXQgU0cgPSB0aGlzO1xuICAgIGxvY2F0aW9uLmhyZWY9XCIjL2xvZ2luXCI7XG4gIH1cbiAgaW5pdCgpe1xuXG4gICAgaWYodGhpcy5oYXNTYXZlZFNlc3Npb25JZCgpKXtcbiAgICAgIGlmKHRoaXMuaXNWYWxpZEVtYWlsQWRkcmVzcyh0aGlzLnNlc3Npb25JZCkpe1xuICAgICAgICB0aGlzLnNlc3Npb25Vc2VyRW1haWwgPSB0aGlzLnNlc3Npb25JZDtcbiAgICAgICAgLy8gbG9naW5DYWxsYmFjaygpO1xuICAgICAgICBsb2NhdGlvbi5ocmVmPVwiIy9sb2dpblwiO1xuXG4gICAgICAgIC8vYXV0byBsb2dzIGluO1xuICAgICAgICAvL2lzIG9mZmxpbmUgLT5nZXQgb25saW5lIHZlcnNpb24uXG4gICAgICAgIHRoaXMubG9naW5UaW1lciA9IHNldFRpbWVvdXQoKCk9PntcbiAgICAgICAgICBsb2NhdGlvbi5ocmVmPVwiIy9tYWluXCI7XG4gICAgICAgICAgdGhpcy5zZXRDdXJyZW50VXNlcih0aGlzLnNlc3Npb25Vc2VyRW1haWwpO1xuICAgICAgICB9LCB0aGlzLnRpbWVyRGVsYXkpO1xuXG5cblxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbG9jYXRpb24uaHJlZj1cIiMvbG9naW5cIjtcbiAgICAgICAgdGhpcy5zZXNzaW9uVXNlckVtYWlsID0gXCJcIjtcbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBsb2NhdGlvbi5ocmVmPVwiIy9sb2dpblwiO1xuICAgICAgdGhpcy5zZXNzaW9uVXNlckVtYWlsID0gXCJcIjtcbiAgICB9XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2hhc2hjaGFuZ2UnLCAoKT0+e1xuICAgICAgaWYoIHRoaXMuc2Vzc2lvblVzZXJFbWFpbCA9PSBcIlwiIHx8ICF0aGlzLmhhc1NhdmVkU2Vzc2lvbklkKCkpIHtcbiAgICAgICAgbG9jYXRpb24uaHJlZj1cIiMvbG9naW5cIjtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuICBsb2dPdXQoKTp2b2lkIHtcbiAgICB0aGlzLmxvZ2luQXNPdGhlcigpO1xuICAgIHRoaXMuc2Vzc2lvbklkID0gXCJcIjtcbiAgICB0aGlzLnNlc3Npb25Vc2VyRW1haWwgPSBcIlwiO1xuICAgIHdpbmRvdy5wZXJzaXN0X3N0b3JlLnJlbW92ZSh0aGlzLnNlc3Npb25JZExvY2FsU3RvcmFnZUtleSk7XG4gICAgaWYoXCJyZWxvYWRcIiBpbiBsb2NhdGlvbil7XG4gICAgICBsb2NhdGlvbi5yZWxvYWQoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZG9jdW1lbnQubG9jYXRpb24uaHJlZiA9IGRvY3VtZW50LmxvY2F0aW9uLmhyZWY7XG4gICAgfVxuICB9XG4gIGxvZ2luQXNPdGhlcigpOnZvaWQge1xuICAgIGNsZWFyVGltZW91dCh0aGlzLmxvZ2luVGltZXIpO1xuICAgIGRlbGV0ZSB0aGlzLmxvZ2luVGltZXI7XG4gIH1cbiAgc2Vzc2lvblVwZGF0ZVVzZXJFbWFpbCgpOnZvaWQge1xuICAgIHRoaXMuZXJyb3JNZXNzYWdlID0gXCJcIjtcblxuICAgIGlmKHRoaXMuaXNWYWxpZEVtYWlsQWRkcmVzcyh0aGlzLnNlc3Npb25Vc2VyRW1haWwpKSB7XG4gICAgICB0aGlzLnNldEN1cnJlbnRVc2VyKHRoaXMuc2Vzc2lvblVzZXJFbWFpbCk7XG4gICAgICB0aGlzLmxvZ2luQ2FsbGJhY2soKTtcbiAgICAgIGxvY2F0aW9uLmhyZWYgPSBcIiMvbWFpblwiO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBFcnJvciBtZXNzYWdlXG4gICAgICB0aGlzLmVycm9yTWVzc2FnZSA9IFwiU29ycnkhIFlvdSBoYXZlIHRvIGVudGVyIGEgdmFsaWQgZW1haWwgYWRkcmVzcy5cIjtcbiAgICB9XG4gIH1cbiAgaGFzU2F2ZWRTZXNzaW9uSWQoKTpib29sZWFuIHtcbiAgICB2YXIgc2F2ZWRFbWFpbElkID0gd2luZG93LnBlcnNpc3Rfc3RvcmUuZ2V0KHRoaXMuc2Vzc2lvbklkTG9jYWxTdG9yYWdlS2V5KTtcbiAgICAvLyBjb25zb2xlLmxvZyhzYXZlZEVtYWlsSWQpO1xuICAgIGlmKHNhdmVkRW1haWxJZCl7XG4gICAgICB0aGlzLnNlc3Npb25JZCA9IHRoaXMuZGVjcnlwdChzYXZlZEVtYWlsSWQpO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuc2Vzc2lvbklkID0gXCJcIjtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cbiAgZW5jcnlwdCh0ZXh0KXtcbiAgICB2YXIgb3V0cHV0PXRleHQrXCJcIjtcbiAgICBvdXRwdXQgPSBvdXRwdXQucmVwbGFjZSgvLi9naSxmdW5jdGlvbihjaCl7XG4gICAgLy9jb25zb2xlLmxvZyhjaC5jaGFyQ29kZUF0KDApKzEpO1xuICAgICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUoY2guY2hhckNvZGVBdCgwKSsxKTtcbiAgICB9KTtcbiAgICByZXR1cm4gb3V0cHV0O1xuXG4gIH1cbiAgZGVjcnlwdCh0ZXh0KXtcbiAgICB2YXIgb3V0cHV0PXRleHQrXCJcIjtcbiAgICBvdXRwdXQgPSBvdXRwdXQucmVwbGFjZSgvLi9naSxmdW5jdGlvbihjaCl7XG4gICAgLy9jb25zb2xlLmxvZyhjaC5jaGFyQ29kZUF0KDApKzEpO1xuICAgICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUoY2guY2hhckNvZGVBdCgwKS0xKTtcbiAgICB9KTtcbiAgICByZXR1cm4gb3V0cHV0O1xuXG4gIH1cbiAgc2V0Q3VycmVudFVzZXIoZW1haWwpe1xuICAgIHZhciBoYXNoID0gd2luZG93LkNyeXB0b0pTLk1ENShlbWFpbCArIHRoaXMuc2FsdCkudG9TdHJpbmcoKTtcbiAgICB3aW5kb3cucGVyc2lzdF9zdG9yZS5zZXQodGhpcy5zZXNzaW9uSWRMb2NhbFN0b3JhZ2VLZXksIHRoaXMuZW5jcnlwdChlbWFpbCkpO1xuICAgIHdpbmRvdy5nYSgnc2V0JywgJ3VzZXJJZCcsIGhhc2gpO1xuICB9XG4gIGlzVmFsaWRFbWFpbEFkZHJlc3MoZW1haWwpOmJvb2xlYW57XG4gICAgaWYodGhpcy5lbWFpbFJlZ2V4LnRlc3QoZW1haWwpKXtcbiAgICAgIGNvbnNvbGUubG9nKGVtYWlsLCBcImlzIHZhbGlkXCIpO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnNvbGUubG9nKGVtYWlsLCBcImlzIG5vdCB2YWxpZFwiKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cblxuXG59XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
