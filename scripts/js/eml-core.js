function getOfflineVersionNumber(){var e="";if(window.location.search.indexOf("offline_version")){var t=window.location.search.substr(1,window.location.search.length).split("&");t.forEach(function(t){t.indexOf("offline_version=")>-1&&(e=t.substr("offline_version=".length,t.length))})}return e}var ErrorSeverity;!function(e){e[e.High=1]="High",e[e.Medium=2]="Medium",e[e.Low=3]="Low",e[e.Zero=4]="Zero"}(ErrorSeverity||(ErrorSeverity={}));var ErrorType;!function(e){e[e.Fix=1]="Fix",e[e.Warn=2]="Warn",e[e.Suggestion=3]="Suggestion",e[e.QA=4]="QA",e[e.BestPractice=5]="BestPractice"}(ErrorType||(ErrorType={}));var GlobalVars;!function(e){e.landingPagePreferred=/(\.mp4|\.avi|\.mpeg|\.mp3|\.swf|\.mov|\.pdf)/i,e.extDoesNotrequireTrackingCode=/(\.pdf|\.oft|\.ics|\.png|\.jpeg|\.jpg)/i,e.linkEncapsulatedPunctuation=/([\.\?\,\:\*]+)((\n|\r|\s)+)?<\/a>$/,e.RequiresSCodeRegex=/http(.*)optum(.*)\/(campaign|resource)/i,e.RequiresTrackingCodeRegex=RegExp("^http(s)?://(.*?)?optum(.*?)?.co[m.]?"),e.TelephoneRegex=/(\+?\d{1,2}(\s|-|\.))?\(?\d{3}\)?[\s.-]\d{3,}[\s.-]\d{4,}/,e.TelephoneRegexGlobal=/(\+?\d{1,2}(\s|-|\.))?\(?\d{3}\)?[\s.-]\d{3,}[\s.-]\d{4,}/g,e.EmailRegex=/(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))/,e.EmailRegexGlobal=/(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))/g,e.UrlRegex=/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:[\/?#]\S*)?$/i,e.LinkHasTitleTagRegexGlobal=/<a\s([^<]*)title=\"(.*?)\">/gi,e.PreheaderRegexGlobal=/\<p\s[^\<]*class=\"preheader\"[^\>]*\>/gi,e.RequiredTrackingCodeWhitelist=[".pdf",".ics",".oft","optumsurveys.co","healthid.optum.com","learning.optum.com","app.info.optum.com","optum.webex.com","twitter.com","facebook.com","linkedin.com","info.optum"]}(GlobalVars||(GlobalVars={}));var EMLModule;!function(e){var t=function(){function e(e){this.parent=e,this.email="",this.subject="",this.body="",this.parent.isLinkType("mailto")&&this.initEmailEditor()}return e.prototype.has=function(e){return this.updateMailtoObj(),this[e]&&""!==this[e].trim()},e.prototype.isValidEmailAddress=function(){return GlobalVars.EmailRegex.test(this.email)},e.prototype.deinitEmailEditor=function(){this.email="",this.subject="",this.body=""},e.prototype.composeEmail=function(){this.parent["new"].url="mailto:"+this.email;for(var e=["subject","body"],t=0;t<e.length;t++)this[e[t]]&&""!==this[e[t]]?this.parent["new"].searchParams.set(e[t],this[e[t]]):""==this[e[t]]&&this.parent["new"].searchParams["delete"](e[t])},e.prototype.updateMailtoObj=function(){var e=this,t=this.parent["new"].url.substr(7,this.parent["new"].url.length-7),i=t.split("?");this.email=i[0],this.parent["new"].searchParams.updateEntries(),i.length>1?["subject","body"].forEach(function(t){e.parent["new"].searchParams.has(t)&&(e[t]=window.decodeURIComponent(e.parent["new"].searchParams.get(t)))}):(this.subject="",this.body="")},e.prototype.inputOnBlur=function(){this.parent["new"].searchParams.updateEntries(),this.parent["new"].searchParams.updateSearchProp()},e.prototype.openEditor=function(){this.initEmailEditor();var e=this.parent;console.log(e.id-1),e.showMailtoEditor=!0},e.prototype.initEmailEditor=function(){this.updateMailtoObj()},e}();e.MailtoLinkObject=t;var i=function(){function e(e){this.href="",this.search="",this.origin="",this.hash="",this.protocol="",this.url=e,this.searchParams=new r(this)}return e.prototype.prepareExport=function(){},e.prototype.isValid=function(){return GlobalVars.UrlRegex.test(this.url)},e.prototype.contains=function(e){return this.url.indexOf(e)>-1},Object.defineProperty(e.prototype,"url",{get:function(){this.prepareExport();var e=this.origin+this.search+this.hash;return e=e.replace("?undefined","")},set:function(e){this.search="",this.hash="";var t=/^(https?|mailto|ftp)\:/gi;if(t.test(e)){var i=e.match(t);this.protocol=i[0]}if(this.href=e,"#"==e.trim())this.hash="#";else if(e.trim().length>1&&e.indexOf("#")>-1){var r=e.split("#");this.hash="#"+r.pop();var n=r.join("#").split("?");this.origin=n[0],this.search=n.length>0?"?"+n[1]:""}else if(e.indexOf("?")>-1){var n=e.split("?");this.origin=n[0],this.search=n.length>0?"?"+n[1]:""}else this.origin=e},enumerable:!0,configurable:!0}),e}();e.URLObj=i;var r=function(){function e(e){this.parent=e,this.parent.search.length>0?this._entries=this.parent.search.substr(1,this.parent.search.length).split(/\&amp\;|\&/g):this._entries=[]}return Object.defineProperty(e.prototype,"entries",{get:function(){for(var e=[],t=0;t<this._entries.length;t++){var i=this._entries[t].split("=");i.length>1&&(i[1]=decodeURIComponent(i[1])),e.push(i.join("="))}return e},enumerable:!0,configurable:!0}),e.prototype.updateEntries=function(){if(this._entries=[],"?"!==this.parent.search&&this.parent.search.length>1)for(var e=this.parent.search.substr(1,this.parent.search.length).split(/\&amp\;|\&/g),t=0;t<e.length;t++)this._entries.push(e[t])},e.prototype.updateSearchProp=function(){var e=[];if(this._entries.length>0)for(var t=0;t<this._entries.length;t++){var i=this._entries[t].split("=");/[a-z]{1,4}=(.*?:){3,9}/gi.test(this._entries[t])?e.push(this._entries[t]):e.push(i[0]+(i.length>1?"="+encodeURIComponent(decodeURIComponent(i[1])):""))}this.parent.search=e.length>0?"?"+e.join("&"):""},e.prototype.has=function(e){for(var t=new RegExp("^"+e+"=","g"),i=!1,r=0;r<this._entries.length;r++)t.test(this._entries[r])&&(i=!0);return i},e.prototype.get=function(e){for(var t=new RegExp("^"+e+"=","g"),i=!1,r=0;r<this._entries.length;r++)t.test(this._entries[r])&&(i=this._entries[r].split("=").pop());return i},e.prototype.set=function(e,t){for(var i=new RegExp("^"+e+"=","g"),r=!1,n=0;n<this._entries.length;n++)i.test(this._entries[n])&&(this._entries[n]=e+"="+t,r=!0);r||this.append(e+"="+t),this.updateSearchProp()},e.prototype.append=function(e){this._entries.push(e),this.updateSearchProp()},e.prototype.deleteAll=function(){this._entries=[],this.updateSearchProp()},e.prototype.deleteAtIndex=function(e){this._entries.splice(e,1),this.updateSearchProp()},e.prototype["delete"]=function(e){for(var t=0;t<this._entries.length;t++)this._entries[t].substr(0,e.length+1)==e+"="&&this.deleteAtIndex(t)},e}();e.URLObjSearchParams=r;var n=function(){function e(e,t){this.context=t,this._super=e;for(var i=["src","alt","height","width"],r=0,n=i;r<n.length;r++){var s=n[r],o=new RegExp(s+'="([^"].*?)?"',"i");o.test(t)&&(this[s]=t.match(o)[1])}var a=this.width&&parseInt(this.width.toString()),h=this.height&&parseInt(this.height.toString());a&&h||"string"==typeof this.src&&this.preloadImage(this.src)}return e.prototype.preloadImage=function(e){var t=this,i=new Image;i.onload=function(){t.height=i.height,t.width=i.width,console.log(i.height,i.width),i.parentNode.removeChild(i)},i.src=t.src,console.log(i),document.body.appendChild(i)},e.prototype.generateOutput=function(e){var t=this;return e=this.context.indexOf("alt")>-1?e.replace(this.context,function(e){return e.replace(/alt\=\"([^\"].*?)?\"/g,'alt="'+(void 0===t.alt?"":t.alt)+'"')}):e.replace(this.context,function(e){return e.replace("<img",'<img alt="'+(void 0===t.alt?"":t.alt)+'"')})},e}();e.LinkedImage=n;var s=function(){function e(e,i,r){this.__isComplete=!1,this._super=r,this.showQueryStringEditor=!1,this.showMailtoEditor=!1,this.id=0,this.line=e+1,this.context=i,this.queryStrings=[],this.ChangeMonitor=new o(this),this.errors=EMLIntelligence.module("hyperlink").monitor(),this.errors.associateVariable("LinkObject",this),this.whiteListedUrl="~~whitelist~~",this.__locateHref(i),this.__locateLinkedImage(i),this.mailto=new t(this),this.isLinkComplete()}return e.prototype.__locateHref=function(e){var t=/href\=\"([^\"\>]*)\"/g,r=e.match(t);r.length>0&&('href=""'==r[0]?(this["new"]=new i("#"),this.old=new i("#"),this.context=this.context.replace(new RegExp('href=""',"g"),'href="#"')):(this["new"]=new i(r[0].substr(6,r[0].length-7).trim()),this.old=new i(r[0].substr(6,r[0].length-7).trim())))},e.prototype.__locateLinkedImage=function(e){if(/\<img([^>].*?)\>/.test(e)){var t=e.match(/\<img([^>].*?)\>/);t.length>0&&(this.LinkedImage=new n(this,t[0]),this.LinkedImageOld=new n(this,t[0]))}},e.prototype.hasDuplicateQueryStrings=function(){var e=[],t=[];if(this["new"].searchParams.entries.length>0)for(var i=0,r=this["new"].searchParams.entries;i<r.length;i++){var n=r[i],s=n.split("=").shift();t.indexOf(s)>-1&&e.push(s),t.push(s)}return e.length>0&&e},e.prototype.overrideTrackingRequirements=function(){this.whiteListedUrl=this["new"].url},e.prototype.displayFormattedURL=function(){var e=this.context;e=e.replace(/\seml\-id\=\"([0-9]*)\"/,"");var t='href="',i=e.indexOf(t);return e=e.replace(new RegExp('href=""',"g"),'href="#"'),this.LinkedImage&&(e=this.LinkedImage.generateOutput(e)),e=e.substr(0,i)+t+"|||a.href|||"+e.substr(i+(t.length+this.old.url.length),e.length),e=e.replace(new RegExp('"',"g"),"&quot;"),e=e.replace(new RegExp("/","g"),"&#47;"),e=e.replace(new RegExp(">","g"),"&gt;"),e=e.replace(new RegExp("<","g"),"&lt;"),e=e.replace(/([^\s]*?)\=/g,'<span class="attr">$1</span><span class="keyword">=</span>'),e=e.replace(/\&quot\;\&gt\;/g,'&quot;<span class="tag">&gt;</span>'),e=e.replace(/\&\#47\;\&gt\;/g,'<span class="tag">&#47;&gt;</span>'),e=e.replace(/\&quot\;(.*?)\&quot\;/g,'<span class="value">"$1"</span>'),e=e.replace(/\&lt\;([a-z]+\s?)/g,'<span class="tag">&lt;$1</span>'),e=e.replace(/\&lt\;\&\#47\;([a-z]+\s?)\&gt\;/g,'<span class="tag">&lt;&#47;$1&gt;</span>'),e=e.replace(/\n/g,"<br>"),e=e.replace(/\&gt\;/g,'<span class="tag">&gt;</span>'),e=e.replace(/\s{3}/g,"&nbsp;&nbsp;&nbsp"),e=e.replace(/\|\|\|a\.href\|\|\|/g,"<strong>"+(this.hasOwnProperty("deleteOnRender")&&this.deleteOnRender?this.old.url:this["new"].url)+"</strong>")},e.prototype.isLinkComplete=function(){return this._super.intelligence.evaluateRules(),this.errors.evaluateRules(),this.ChangeMonitor.update(),this.__isComplete=this.errors.canContinue,this.hasOwnProperty("deleteOnRender")&&this.deleteOnRender&&(this.__isComplete=!0),this.__isComplete},e.prototype.isLinkType=function(e){var t=!1;switch(e){case"http":"http:"!=this["new"].protocol&&"https:"!=this["new"].protocol||(t=!0);break;case"mailto":"mailto:"==this["new"].protocol&&(t=!0)}return t},e.prototype.hasTrackingCode=function(e){void 0===e&&(e=this["new"].url);var t=/[a-z]{1,4}=(.*?:){3,9}/gi;return t.test(e)},e.prototype.requiresTrackingCode=function(e){var t=!1;if(GlobalVars.RequiresTrackingCodeRegex.test(this["new"].url)){t=!0;for(var i=0;i<GlobalVars.RequiredTrackingCodeWhitelist.length;i++)GlobalVars.RequiredTrackingCodeWhitelist[i]instanceof RegExp?GlobalVars.RequiredTrackingCodeWhitelist[i].test(this["new"].url)&&(t=!1):this["new"].url.indexOf(GlobalVars.RequiredTrackingCodeWhitelist[i])>-1&&(t=!1)}return t},e.prototype.requiresSCode=function(){return!!GlobalVars.RequiresSCodeRegex.test(this["new"].url)},e.prototype.needsTrackingCode=function(){var e=this.requiresTrackingCode();return this.whiteListedUrl!=this["new"].url&&(this.hasTrackingCode()&&(e=!1),e)},e.prototype.updateInput=function(){this.isLinkType("mailto")?this.mailto.updateMailtoObj():this["new"].searchParams.updateEntries(),this.isLinkComplete()},e}();e.LinkObject=s;var o=function(){function e(e){this.visible=!1,this._super=e,this.messages=[]}return e.prototype.compareOldAndNew=function(){var e=["protocol","origin","search","hash"],t=[],i=this._super;return e.forEach(function(e){i.old.hasOwnProperty(e)&&i.old[e]!==i["new"][e]&&t.push(e)}),i.LinkedImage&&i.LinkedImage.alt!==i.LinkedImageOld.alt&&t.push("alt"),t},e.prototype.beforeDidReturnChanges=function(){},e.prototype.afterDidReturnChanges=function(){},e.prototype.update=function(){if(0==this._super.readOnly){var e=[],t=this.compareOldAndNew(),i=this;t.forEach(function(t){e.push(i.articulateChanges(t,{}))}),this.messages=e}},e.prototype.compareSearchStrings=function(e,t){var i={added:[],updated:[],removed:[]};for(var r in e)t.indexOf(e[r])===-1&&i.removed.push(e[r]);for(r in t)e.indexOf(t[r])===-1&&i.added.push(t[r]);var n=function(e,t){for(var i=-1,r=0;r<t.length;r++)e.test(t[r])&&(i=r);return i};for(r in e){var s=new RegExp(e[r].split("=")[0]+"="),o=n(s,i.added);if(o>-1){i.updated.push(i.added[o]);var a=n(s,i.removed);i.removed.splice(a,1),i.added.splice(o,1)}}return i},e.prototype.articulateChanges=function(e,t){if("protocol"==e)return"mailto:"==this._super["new"].protocol?{message:"Changed to mailto link.",data:[]}:{message:(""==this._super.old.protocol?"Updated":"Changed")+" protocol to "+this._super["new"].protocol,data:[]};if("origin"==e)return"mailto:"==this._super["new"].protocol?{message:"Changed mailto link to "+this._super["new"].origin,data:[]}:{message:"Changed link URL to "+this._super["new"].origin,data:[]};if("alt"==e)return""==this._super.LinkedImage.alt?{message:"Removed linked image ALT text",data:[]}:{message:"Updated linked image ALT text to <b>"+this._super.LinkedImage.alt+"</b>",data:[]};if("search"==e){var i=this._super.old.searchParams._entries,r=this._super["new"].searchParams._entries,n=this.compareSearchStrings(i,r),s="",o=this._super;return["updated","added","removed"].forEach(function(e){n[e].length>0&&(s=s+e[0].toUpperCase()+e.substr(1,e.length)+" "+("mailto:"==o["new"].protocol?"parameter":"query string")+(n[e].length>1?"s":"")+": <b>"+n[e].join(", ")+"</b><br>")}),{message:s,data:[]}}return"hash"==e?""==this._super.old.hash?{message:"You added the hash "+this._super["new"].hash,data:[]}:""==this._super["new"].hash?{message:"You removed the hash "+this._super.old.hash,data:[]}:{message:"You changed the hash from "+this._super.old.hash+" to "+this._super["new"].hash,data:[]}:void 0},e}();e.ChangeMonitor=o;var a=function(){function e(e,t){this.overriddenIds=[],void 0===e&&(e=""),void 0===t&&(t="");this.buffer=null,this.scope=t,this.linksView="experimental",this.sourceCode=e,this.workingCode="",this.fileName="eml-maker-untitled",this.linkData=[],this._defaultSCode="s=email",this.header={subject:""},this.messages=[],this.exportForEloqua="Yes",this.__emlHeaders="",this.keyBoardShortcuts=[],this.__allowableHeaderFields={to:{syntax:"To: ",label:"To",instructions:"A list of email addresses separated by commas."},subject:{syntax:"Subject: ",label:"Subject",instructions:""},cc:{syntax:"Cc: ",label:"CC",instructions:"A list of email addresses separated by commas."},replyto:{syntax:"Reply-to: ",label:"Reply to",instructions:"A list of email addresses separated by commas."}},this.headers=["X-Unsent: 1","Mime-Version: 1.0 (Mac OS X Mail 10.1 (3251))","X-Uniform-Type-Identifier: com.apple.mail-draft","Content-Transfer-Encoding: 7bit"],this.intelligence=EMLIntelligence.module("email").monitor(),this.intelligence.associateVariable("EMLWorkspace",this)}return e.prototype.mapLinkObjects=function(e){if(this.linkData.length>0)for(var t=0;t<this.linkData.length;t++)e(this.linkData[t])},e.prototype.composeEML=function(){location.href="#/export-compose-eml"},e.prototype.downloadEml=function(){this.beforeDidDownloadEml();var e=this.__emlHeaders+"\n\n"+this.__removeWhiteSpace(this.__replaceEloquaMergeFields(this.generateOutputCode("oft")));this.fileName=this.__formatFileName(this.fileName),window.saveAs(new Blob([e],{type:"text/html"}),this.fileName+".eml"),this.afterDidDownloadEml()},e.prototype.beforeDidDownloadEml=function(){this.mapLinkObjects(function(e){if(e["new"].searchParams.has("elqTrack")){var t=e["new"].searchParams.entries.indexOf("elqTrack=true");t>-1&&e["new"].searchParams.deleteAtIndex(t)}!e["new"].searchParams.has("s")&&e.requiresSCode()?e["new"].searchParams.append("s=oft"):"email"==e["new"].searchParams.get("s")&&e["new"].searchParams.set("s","oft")}),this.mapLinkObjects(function(e){e.ChangeMonitor.update()})},e.prototype.afterDidDownloadEml=function(){window.ga("send","event","EML","download","EML Export"),location.href="#/export-eml"},e.prototype.downloadCsv=function(){var e="Context,Original URL,Modified URL\n";this.mapLinkObjects(function(t){e+=t.context.replace(/,/g,"(comma)")+","+t.old.url+","+t["new"].url+"\n"}),this.fileName=this.__formatFileName(this.fileName),window.saveAs(new Blob([e],{type:"text/csv"}),this.fileName+"_links.csv"),window.ga("send","event","CSV","download","CSV Export")},e.prototype.downloadHtml=function(){var e=this.beforeDidDownloadHtml(this.generateOutputCode("email"));this.fileName=this.__formatFileName(this.fileName),window.saveAs(new Blob([e],{type:"text/html"}),this.fileName+".html"),this.afterDidDownloadHtml()},e.prototype.beforeDidDownloadHtml=function(e){return e},e.prototype.afterDidDownloadHtml=function(){window.ga("send","event","HTML","download","HTML Export")},e.prototype.exportCodeToHTML=function(){this.beforeDidExportCodeToHTML(),this.outputCode=this.generateOutputCode("email"),this.afterDidExportCodeToHTML()},e.prototype.beforeDidExportCodeToHTML=function(){var e=!1;this.exportForEloqua&&"Yes"==this.exportForEloqua?(window.ga("send","event","HTML","Add Eloqua Tracking","Add Eloqua Tracking"),this.mapLinkObjects(function(t){e=t.whiteListedUrl==t["new"].url,t.isLinkType("mailto")||t["new"].searchParams.has("elqTrack")||/app\.info\.optum\.com/gi.test(t["new"].url)||(t["new"].searchParams.append("elqTrack=true"),e&&(t.whiteListedUrl=t["new"].url))})):this.mapLinkObjects(function(e){if(e["new"].searchParams.has("elqTrack")){var t=e["new"].searchParams.entries.indexOf("elqTrack=true");t>-1&&e["new"].searchParams.deleteAtIndex(t),e.isLinkComplete()}e.ChangeMonitor.update()}),this.mapLinkObjects(function(e){!e["new"].searchParams.has("s")&&e.requiresSCode()?e["new"].searchParams.append("s=email"):e["new"].searchParams.has("s")&&"oft"==e["new"].searchParams.get("s")&&e["new"].searchParams.set("s","email"),e.ChangeMonitor.update()}),this.mapLinkObjects(function(e){e.ChangeMonitor.update()})},e.prototype.afterDidExportCodeToHTML=function(){this.mapLinkObjects(function(e){e.whiteListedUrl==e["new"].url&&window.ga("send","event","Tracking-Optout","override",e["new"].url)}),window.ga("send","event","HTML","view sourcecode","Export/View HTML"),location.href="#/export-html"},e.prototype.setUpShortcutKeys=function(){var e=this;this.keyBoardShortcuts=[],e.keyBoardShortcuts.push(new h(function(e){return(e.ctrlKey||e.metaKey)&&e.shiftKey&&52==e.which},function(){e.scope.$apply(function(){console.log("downloading file"),e.downloadHtml()})},"CTRL + SHIFT + 4","Download HTML")),e.keyBoardShortcuts.push(new h(function(e){return(e.ctrlKey||e.metaKey)&&e.shiftKey&&51==e.which},function(){e.scope.$apply(function(){e.mapLinkObjects(function(e){e.errors.messages.length>0&&(e.errors.messages.forEach(function(e){e.type==ErrorType.Suggestion&&e.ctaHandler()}),e.isLinkComplete())})})},"CTRL + SHIFT + 3","Apply all suggestions")),e.keyBoardShortcuts.push(new h(function(e){return(e.ctrlKey||e.metaKey)&&e.shiftKey&&50==e.which},function(){e.scope.$apply(function(){e.mapLinkObjects(function(e){e.readOnly||!e.requiresSCode()||e["new"].searchParams.has("s")||(e["new"].searchParams.append("s=email"),e.isLinkComplete())})})},"CTRL + SHIFT + 2","Add s=email to all links")),e.keyBoardShortcuts.push(new h(function(e){return(e.ctrlKey||e.metaKey)&&e.shiftKey&&49==e.which},function(){e.scope.$apply(function(){e.mapLinkObjects(function(t){return!!t.readOnly||(t["new"].searchParams["delete"]("o"),t["new"].searchParams["delete"]("oin"),t["new"].searchParams["delete"]("v"),t["new"].searchParams["delete"]("oiex"),t["new"].searchParams["delete"]("elq_mid"),t["new"].searchParams["delete"]("elq_lid"),t["new"].searchParams["delete"]("elqTrack"),t["new"].searchParams["delete"]("elqTrackId"),t["new"].searchParams["delete"]("s"),t["new"].searchParams["delete"]("s3"),t.isLinkComplete(),void e.areLinksComplete())})})},"CTRL + SHIFT + 1","Remove all query strings from email")),document.onkeyup=function(t){for(var i=0,r=e.keyBoardShortcuts;i<r.length;i++){var n=r[i];n.when&&n.when(t)&&n.doThis()}}},e.prototype.replaceSpecialCharacters=function(e){var t={174:["&reg;"],169:["&copy;"],8211:["&ndash;"],8212:["&mdash;"],8220:["&ldquo;"],8221:["&rdquo;"],8216:["&lsquo;"],8217:["&rsquo;"],8482:["&trade;"]};for(var i in t)if(t.hasOwnProperty(i)){var r=new RegExp(String.fromCharCode(parseInt(i)),"g");r.test(e)&&(e=e.replace(r,t[i][0]))}return e},e.prototype.processHtml=function(){if(this.setUpShortcutKeys(),this.linkData=[],this.intelligence.overridden=[],this.intelligence.evaluateRules(),window.scrollTo(0,0),this.workingCode=this.replaceSpecialCharacters(this.sourceCode),this.__emlHeaders=this.__buildHeaders(),"untitled"==this.fileName){var e=/<title>([^<].*?)<\/title>/gi;if(e.test(this.workingCode)){var t=this.workingCode.match(e);t.length>0&&(this.fileName=this.__formatFileName(t[0].replace(e,"$1")))}}var i=this,r=/<a\b[^>]*?>([\r\n]|.)*?<\/a>/gm,n=0;this.workingCode=this.workingCode.replace(r,function(e){return n++,e.replace("<a",'<a eml-id="'+n+'"')}),n=0,this.workingCode=this.workingCode.replace(r,function(e){n++;var t=i.workingCode.substr(0,i.workingCode.indexOf(e)).split("\n").length-1;if(/(href\=\"([^\"\>]*)\"?)/g.test(e)){n++;var r=new s(t,e,i);return r.id=n,r.readOnly=r["new"].contains(".com/e/es.aspx")&&r["new"].contains("~~eloqua"),i.linkData.push(r),"{{EMLMaker_Link:"+n+"}}"}return e}),this.mapLinkObjects(function(e){e.isLinkComplete()}),location.href="#/links"},e.prototype.addNewHeaderField=function(e){this.header[e]=""},e.prototype.removeHeaderField=function(e){delete this.header[e]},e.prototype.isHeaderSelected=function(e){return!this.header.hasOwnProperty(e)||""==this.header},e.prototype.verifyLinkSectionComplete=function(){var e=!1;return!(this.intelligence&&!this.intelligence.canContinue)&&(e=(!this.linkData||0!=this.linkData.length)&&!!this.areLinksComplete())},e.prototype.generateOutputCode=function(e,t){void 0===e&&(e="email"),void 0===t&&(t=!0);var i=this.workingCode;this.mapLinkObjects(function(e){if(e.hasOwnProperty("deleteOnRender")&&e.deleteOnRender)i=i.replace(new RegExp("{{EMLMaker_Link:"+e.id+"}}","gi"),"");else if(e.readOnly){var t=e.context.replace(/eml\-id\=\"[0-9]{1,}\"\s/g,"");i=i.replace(new RegExp("{{EMLMaker_Link:"+e.id+"}}","gi"),t)}else{var r=e.context.indexOf('href="'+e.old.url),n=e.context;n=n.substr(0,r)+'href="'+e["new"].url+n.substr(r+6+e.old.url.length,n.length),e.LinkedImage&&(n=e.LinkedImage.generateOutput(n)),n=n.replace(/\s?eml\-id\=\"[0-9]*\"/g,""),i=i.replace(new RegExp("{{EMLMaker_Link:"+e.id+"}}","gi"),n)}}),i=i.replace(/\<img[^\>].*?\>/gi,function(e){return e.indexOf("alt=")>-1?e:e.replace(/\<img/gi,'<img alt=""')});try{i=i.replace(/<\/a>\n{0,5}(\.|,|\?|!|:|;|\|)/g,"</a>$1")}catch(r){console.log("error merging lines with links that previously had punctuation.")}return i},e.prototype.updateLinksAndExport=function(){return!!this.areLinksComplete()&&(location.href="#/export",window.scrollTo(0,0),!0)},e.prototype.areLinksComplete=function(){var e=!0;return this.mapLinkObjects(function(t){t.__isComplete||(e=!1),t.needsTrackingCode()&&(e=!1)}),e},e.prototype.getLinksSummary=function(){var e={needsTracking:0,invalidUrl:0};return this.mapLinkObjects(function(t){t.needsTrackingCode()&&e.needsTracking++,t.isLinkComplete()&&e.invalidUrl++}),e},e.prototype.importHtmlFromFileDrop=function(e){this.sourceCode.length>0&&(this.sourceCode="");var t=e.dataTransfer.files;if(e.dataTransfer.files.length>1)alert("you can only import one file at at time.");else{var i=new FileReader,r=this;i.onloadend=function(e){var i=e.target.result,n=t[0].name.split("."),s=n.pop().toLowerCase();r.fileName=r.__formatFileName(n.join(".")),"eml"==s?r.sourceCode=r.__stripHtmlAndSubjectFromEML(i):r.sourceCode=i,r.processHtml(),location.href="#/links"},i.readAsText(t[0]),window.ga("send","event","HTML","import","HTML Import File Drop")}},Object.defineProperty(e.prototype,"defaultSCode",{set:function(e){var t=this._defaultSCode;t!==e&&(this._defaultSCode=e,this.mapLinkObjects(function(e){e.isLinkComplete()}))},enumerable:!0,configurable:!0}),e.prototype.__formatFileName=function(e){var t=/[^\w\s-]/g,i=/[-\s]+/g;return e=e.replace(t,"").trim().toLowerCase(),e=e.replace(i,"-")},e.prototype.__replaceEloquaMergeFields=function(e){var t=/<span(%20|\s)class="?eloquaemail"?\s?>(.*?)<\/span>/gi;return e=e.replace(t,"#$2#")},e.prototype.__stripHtmlAndSubjectFromEML=function(e){for(var t=e.split("\n"),i=t.pop(),r=0;r<t.length;r++)t[r].indexOf("Subject:")>-1&&void 0===this.header&&(this.header={});return i},e.prototype.__removeWhiteSpace=function(e){var t=e;return t=t.replace(new RegExp("\n","g")," "),t=t.replace(new RegExp("\t","g")," "),t=t.replace(/\s{2,99999}/g," ")},e.prototype.__buildHeaders=function(){for(var e=[],t=0;t<this.headers.length;t++)e.push(this.headers[t]);var i=this.__getCharsetFromHTML(this.sourceCode);""==i&&(i="charset=UTF-8"),e.push("Content-Type: text/html;\n\t"+i);for(var r in this.header)this.header.hasOwnProperty(r)&&this.__allowableHeaderFields.hasOwnProperty(r)&&e.push(this.__allowableHeaderFields[r].syntax+" "+this.header[r]);return this.__emlHeaders=e.join("\n"),e.join("\n")},e.prototype.__getCharsetFromHTML=function(e){var t=/<meta.*?charset=([^\s"]*)/gi,i="",r=e.match(t);return r&&r.forEach(function(e){var t=e.match(/charset=([^\s"]*)/gi);i=t?t[0]:"charset=UTF-8"}),i},e}();e.EMLWorkspace=a;var h=function(){function e(e,t,i,r){this.when=e,this.doThis=t,this.keys=i,this.description=r}return e}();e.KeyboardShortcut=h}(EMLModule||(EMLModule={}));var IntelligenceAlert=function(){function e(){this.override=!1}return e.prototype.generateGuid=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(e){this._type=e,this.cleanType=ErrorType[e]},enumerable:!0,configurable:!0}),e.prototype.setOverrideStatus=function(e){this.override=e},e}(),EMLMakerIntelligence;!function(e){var t=function(){function e(e,t){this._scope=t,this._monitor=e,this.searchType=this.defaultSearchType()}return e.prototype.setType=function(e){this.searchType=e},e.prototype.defaultSearchType=function(){this._monitor.types;return Object.keys(this._monitor.tabs).length>1?"":this._monitor.tabs[Object.keys(this._monitor.tabs)[0]]},e.prototype.canViewAll=function(){return Object.keys(this._monitor.tabs).length>1},Object.defineProperty(e.prototype,"search",{get:function(){var e=this._monitor.types;return e&&this.searchType in e?{type:this.searchType}:{type:this.defaultSearchType()}},enumerable:!0,configurable:!0}),e}();e.IntelligenceCenter=t;var i=function(){function e(){this.messages=[],this.canContinue=!0,this.cachedResults=[],this.scopes=[]}return e.prototype.__locateScope=function(e){var t=this.scopes.filter(function(t){return t.scope==e});if(0==t.length){var i=new r(e);this.scopes.push(i);return i}return t[0]},e.prototype.readOutRules=function(){this.scopes.forEach(function(e){for(var t=Object.keys(e.rules),i=0;i<t.length;i++);})},e.prototype.module=function(e){var t=this.__locateScope(e);return t},e}();e.IntelligenceEngine=i;var r=function(){function e(e){this.scope=e,this.rules={}}return e.prototype.monitor=function(){return new n(this)},e.prototype.register=function(e,t){return this.rules[e]=t,this},e}();e.IntelligenceModule=r;var n=function(){function e(e){this.rules=e.rules,this.overridden=[],this.variables={IntelligenceMonitor:this},this.reset()}return e.prototype.reset=function(){this.messages=[],this.canContinue=!0},e.prototype.associateVariable=function(e,t){this.variables[e]=t},e.prototype.evaluateRule=function(e){var t;if("object"==typeof e){var i=e[e.length-1],r=e.slice(0,e.length-1),n=this,s=r.map(function(e){return n.variables[e]});try{t=i.apply(null,s)}catch(o){console.error(o)}}else t=e();return t},e.prototype.evaluateRules=function(){this.reset();for(var e=Object.keys(this.rules),t=0,i=e;t<i.length;t++){var r=i[t],n=this.evaluateRule(this.rules[r]),s=!!n.hasOwnProperty("when")&&n.when.apply(null);if(s){var o=new IntelligenceAlert;o.id=void 0===n.id||""==n.id?o.generateGuid():n.id,o.type=void 0===n.type?ErrorType.Warn:n.type,o.severity=void 0===n.severity?ErrorSeverity.Zero:n.severity,o.title=void 0===n.title?"":n.title,o.description=void 0===n.description?"":n.description,o.resource=void 0===n.resource?"":n.resource,o.ctaHandler=n.cta&&n.cta.handler?n.cta.handler:function(){},o.ctaLabel=n.cta&&n.cta.label?n.cta.label:"",o.canContinue=!n.hasOwnProperty("canContinue")||n.canContinue,this.messages.push(o)}}for(var a=0;a<this.messages.length;a++)this.overridden.indexOf(this.messages[a].id)>-1&&(this.messages[a].override=!0),this.messages[a].canContinue||this.messages[a].override||(this.canContinue=!1);this.messages.sort(function(e,t){return e._type>t._type?1:e._type<t._type?-1:0})},Object.defineProperty(e.prototype,"tabs",{get:function(){for(var e={},t=0;t<this.messages.length;t++)e[this.messages[t].cleanType]=this.messages[t].type;return e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"types",{get:function(){for(var e={},t=0;t<this.messages.length;t++)e[this.messages[t].type]=ErrorType[this.messages[t].type];return e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"count",{get:function(){for(var e={},t=0;t<this.messages.length;t++)void 0===e[ErrorType[this.messages[t].type]]&&(e[ErrorType[this.messages[t].type]]=0),e[ErrorType[this.messages[t].type]]++;return e},enumerable:!0,configurable:!0}),e}();e.IntelligenceMonitor=n}(EMLMakerIntelligence||(EMLMakerIntelligence={}));var EMLIntelligence=new EMLMakerIntelligence.IntelligenceEngine,AccessOnlineVersion=function(){function e(e){this.animate=!0,this.status="attempting",this.headline="Checking availability of online version",this.message="If we're able to access the online version, you will be redirected.",void 0===e.success&&(e.success=function(){}),void 0===e.onerror&&(e.onerror=function(){}),window.LOCALHOST=this.isLocalMachine(),window.OFFLINE_VERSION=getOfflineVersionNumber(),window.LOCALHOST?(window.scrollTo(0,0),this.obtainKeyFromServer(e)):(this.status="failed",this.animate=!1,document.title=window.PAGE_TITLE)}return e.prototype.obtainKeyFromServer=function(e){if(this.isLocalMachine()){var t,i,r;window.redirectJsonpCallback=function(t){1==t?(e.success(),console.log("FOUND?"),setTimeout(function(){location.href="http://johnproestakes.github.io/eml-maker?offline_version="+window.CURRENT_VERSION},500)):console.log("not github")},t=document.createElement("script"),i=document.getElementsByTagName("script")[0],t.type="text/javascript",t.onerror=function(){e.onerror()},t.src=this.isLocalMachine()?"http://johnproestakes.github.io/eml-maker/prod/app/canredirect.js":"",setTimeout(function(){i.parentNode.insertBefore(t,r)},2e3),document.title=window.PAGE_TITLE+" (Offline Mode)"}else this.status="failed",this.animate=!1,document.title=window.PAGE_TITLE},e.prototype.getOfflineVersionNumber=function(){var e="";if(window.location.search.indexOf("offline_version")){var t=window.location.search.substr(1,window.location.search.length).split("&");t.forEach(function(t){t.indexOf("offline_version=")>-1&&(e=t.substr("offline_version=".length,t.length))})}return e},e.prototype.isLocalMachine=function(){return location.href.indexOf("johnproestakes.github.io")==-1},e}(),UpdateModule=function(){function e(){if(this.updateVersion=!1,this.updateForced=!1,this.offlineVersion=void 0===window.OFFLINE_VERSION?getOfflineVersionNumber():window.OFFLINE_VERSION,this.onlineVersion=window.CURRENT_VERSION,location.href.indexOf("localhost")>-1&&(window.LOCALHOST=!1),""==this.offlineVersion)this.accessingFromOffline=!1;else if(this.offlineVersion&&window.LOCALHOST&&(this.accessingFromOffline=!0),
this.offlineVersion&&this.offlineVersion!==this.onlineVersion){this.updateVersion=!0;var e=new ApplicationVersion(this.offlineVersion),t=new ApplicationVersion(this.onlineVersion);this.updateForced=e.compareAgainst(t)<=AppVersionDifferenceType.PATCH,console.log("UPDATEFORCED?",this.updateForced,e,t)}}return e.prototype.showMessage=function(){return this.updateVersion&&this.updateForced},e.prototype.showTeaser=function(){return""==this.offlineVersion&&!window.LOCALHOST},e.prototype.forceUpdate=function(e,t){for(var i=e.split("."),r=t.split("."),n=0,s=!1,o=0;o<r.length;o++)r[o]==i[o]&&n++;return n<3&&(s=!0),s},e}(),AppVersionDifferenceType;!function(e){e[e.MAJOR=0]="MAJOR",e[e.MINOR=1]="MINOR",e[e.PATCH=2]="PATCH",e[e.SUBPATCH=3]="SUBPATCH",e[e.NONE=4]="NONE"}(AppVersionDifferenceType||(AppVersionDifferenceType={}));var ApplicationVersion=function(){function e(e){this._version=e,this.versionObject=this._version.split(".").map(function(e){return parseInt(e)})}return e.prototype.compareAgainst=function(e){for(var t=this.versionObject,i=e.versionObject,r=0,n=0;n<4&&t[n]==i[n];n++)r++;return AppVersionDifferenceType[AppVersionDifferenceType[r]]},e}(),SecureGateway=function(){function e(e,t){this.canLogin=!1,this.loginCallback=e,this.loginTimer=null,this.sessionUserEmail="",this.timerDelay=500,this.salt="47dafea9aae3b28ab5c39eb7f7d2c924",this.emailRegex=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,this.sessionIdLocalStorageKey="EMLMaker.emlSessionUID",window.persist_store||(window.persist_store=new window.Persist.Store("EMLMaker"),window.addEventListener("unload",function(){window.persist_store.save()}));location.href="#/login"}return e.prototype.init=function(){var e=this;this.hasSavedSessionId()&&this.isValidEmailAddress(this.sessionId)?(this.sessionUserEmail=this.sessionId,location.href="#/login",this.loginTimer=setTimeout(function(){location.href="#/main",e.setCurrentUser(e.sessionUserEmail)},this.timerDelay)):(location.href="#/login",this.sessionUserEmail=""),window.addEventListener("hashchange",function(){""!=e.sessionUserEmail&&e.hasSavedSessionId()||(location.href="#/login")})},e.prototype.logOut=function(){this.loginAsOther(),this.sessionId="",this.sessionUserEmail="",window.persist_store.remove(this.sessionIdLocalStorageKey),"reload"in location?location.reload():document.location.href=document.location.href},e.prototype.loginAsOther=function(){clearTimeout(this.loginTimer),delete this.loginTimer},e.prototype.sessionUpdateUserEmail=function(){this.errorMessage="",this.isValidEmailAddress(this.sessionUserEmail)?(this.setCurrentUser(this.sessionUserEmail),this.loginCallback(),location.href="#/main"):this.errorMessage="Sorry! You have to enter a valid email address."},e.prototype.hasSavedSessionId=function(){var e=window.persist_store.get(this.sessionIdLocalStorageKey);return e?(this.sessionId=this.decrypt(e),!0):(this.sessionId="",!1)},e.prototype.encrypt=function(e){var t=e+"";return t=t.replace(/./gi,function(e){return String.fromCharCode(e.charCodeAt(0)+1)})},e.prototype.decrypt=function(e){var t=e+"";return t=t.replace(/./gi,function(e){return String.fromCharCode(e.charCodeAt(0)-1)})},e.prototype.setCurrentUser=function(e){var t=window.CryptoJS.MD5(e+this.salt).toString();window.persist_store.set(this.sessionIdLocalStorageKey,this.encrypt(e)),window.ga("set","userId",t)},e.prototype.isValidEmailAddress=function(e){return this.emailRegex.test(e)?(console.log(e,"is valid"),!0):(console.log(e,"is not valid"),!1)},e}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlVwZGF0ZU1vZHVsZS50cyIsIkVNTE1vZHVsZS50cyIsImVtbC1jb3JlLmpzIiwiSW50ZWxsaWdlbmNlRW5naW5lLnRzIiwiVXNlck1hbmFnZW1lbnQudHMiXSwibmFtZXMiOlsiZ2V0T2ZmbGluZVZlcnNpb25OdW1iZXIiLCJvdXRwdXQiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsInNlYXJjaCIsImluZGV4T2YiLCJwYXJhbXMiLCJzdWJzdHIiLCJsZW5ndGgiLCJzcGxpdCIsImZvckVhY2giLCJwYXJhbSIsIkVycm9yU2V2ZXJpdHkiLCJFcnJvclR5cGUiLCJHbG9iYWxWYXJzIiwibGFuZGluZ1BhZ2VQcmVmZXJyZWQiLCJleHREb2VzTm90cmVxdWlyZVRyYWNraW5nQ29kZSIsImxpbmtFbmNhcHN1bGF0ZWRQdW5jdHVhdGlvbiIsIlJlcXVpcmVzU0NvZGVSZWdleCIsIlJlcXVpcmVzVHJhY2tpbmdDb2RlUmVnZXgiLCJSZWdFeHAiLCJUZWxlcGhvbmVSZWdleCIsIlRlbGVwaG9uZVJlZ2V4R2xvYmFsIiwiRW1haWxSZWdleCIsIkVtYWlsUmVnZXhHbG9iYWwiLCJVcmxSZWdleCIsIkxpbmtIYXNUaXRsZVRhZ1JlZ2V4R2xvYmFsIiwiUHJlaGVhZGVyUmVnZXhHbG9iYWwiLCJSZXF1aXJlZFRyYWNraW5nQ29kZVdoaXRlbGlzdCIsIkVNTE1vZHVsZSIsIk1haWx0b0xpbmtPYmplY3QiLCJMaW5rT2JqZWN0IiwidGhpcyIsInBhcmVudCIsImVtYWlsIiwic3ViamVjdCIsImJvZHkiLCJpc0xpbmtUeXBlIiwiaW5pdEVtYWlsRWRpdG9yIiwicHJvdG90eXBlIiwiaGFzIiwib3B0aW9uIiwidXBkYXRlTWFpbHRvT2JqIiwidHJpbSIsImlzVmFsaWRFbWFpbEFkZHJlc3MiLCJ0ZXN0IiwiZGVpbml0RW1haWxFZGl0b3IiLCJjb21wb3NlRW1haWwiLCJ1cmwiLCJvcHRpb25zIiwiaSIsInNlYXJjaFBhcmFtcyIsInNldCIsIl90aGlzIiwiYSIsImIiLCJ1cGRhdGVFbnRyaWVzIiwiZGVjb2RlVVJJQ29tcG9uZW50IiwiZ2V0IiwiaW5wdXRPbkJsdXIiLCJ1cGRhdGVTZWFyY2hQcm9wIiwib3BlbkVkaXRvciIsIkxPIiwiY29uc29sZSIsImxvZyIsImlkIiwic2hvd01haWx0b0VkaXRvciIsIlVSTE9iaiIsImhyZWYiLCJvcmlnaW4iLCJoYXNoIiwicHJvdG9jb2wiLCJVUkxPYmpTZWFyY2hQYXJhbXMiLCJwcmVwYXJlRXhwb3J0IiwiaXNWYWxpZCIsImNvbnRhaW5zIiwic3RyIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJ1IiwicmVwbGFjZSIsInByb3RvY29sVHlwZSIsIm1hdGNoIiwidXJsUGFydHMiLCJwb3AiLCJwYXJ0cyIsImpvaW4iLCJlbnVtZXJhYmxlIiwiY29uZmlndXJhYmxlIiwiX2VudHJpZXMiLCJwdXNoIiwicHJvcHMiLCJwcm9wIiwiZW5jb2RlVVJJQ29tcG9uZW50IiwicmVnZXgiLCJ2YWx1ZSIsImFwcGVuZCIsInZhbHVlUGFpciIsImRlbGV0ZUFsbCIsImRlbGV0ZUF0SW5kZXgiLCJpbmRleCIsInNwbGljZSIsIkxpbmtlZEltYWdlIiwiX3N1cGVyIiwiY29kZSIsImNvbnRleHQiLCJ0YWdzIiwiX2kiLCJ0YWdzXzEiLCJ0YWciLCJoYXNXaWR0aCIsIndpZHRoIiwicGFyc2VJbnQiLCJ0b1N0cmluZyIsImhhc0hlaWdodCIsImhlaWdodCIsInNyYyIsInByZWxvYWRJbWFnZSIsIkxJIiwiaW1nIiwiSW1hZ2UiLCJvbmxvYWQiLCJwYXJlbnROb2RlIiwicmVtb3ZlQ2hpbGQiLCJkb2N1bWVudCIsImFwcGVuZENoaWxkIiwiZ2VuZXJhdGVPdXRwdXQiLCJjb250ZW50IiwiZiIsInVuZGVmaW5lZCIsImFsdCIsImxpbmUiLCJfX2lzQ29tcGxldGUiLCJzaG93UXVlcnlTdHJpbmdFZGl0b3IiLCJxdWVyeVN0cmluZ3MiLCJDaGFuZ2VNb25pdG9yIiwiZXJyb3JzIiwiRU1MSW50ZWxsaWdlbmNlIiwibW9kdWxlIiwibW9uaXRvciIsImFzc29jaWF0ZVZhcmlhYmxlIiwid2hpdGVMaXN0ZWRVcmwiLCJfX2xvY2F0ZUhyZWYiLCJfX2xvY2F0ZUxpbmtlZEltYWdlIiwibWFpbHRvIiwiaXNMaW5rQ29tcGxldGUiLCJyZTIiLCJvbGQiLCJmb3VuZCIsIkxpbmtlZEltYWdlT2xkIiwiaGFzRHVwbGljYXRlUXVlcnlTdHJpbmdzIiwicmVzdWx0IiwidXNlZFN0cmluZ3MiLCJlbnRyaWVzIiwiX2EiLCJzaGlmdCIsIm92ZXJyaWRlVHJhY2tpbmdSZXF1aXJlbWVudHMiLCJkaXNwbGF5Rm9ybWF0dGVkVVJMIiwiZmluZFN0YXJ0Iiwic3RhcnQiLCJoYXNPd25Qcm9wZXJ0eSIsImRlbGV0ZU9uUmVuZGVyIiwiaW50ZWxsaWdlbmNlIiwiZXZhbHVhdGVSdWxlcyIsInVwZGF0ZSIsImNhbkNvbnRpbnVlIiwidHlwZSIsImhhc1RyYWNraW5nQ29kZSIsIm9iaiIsInJlcXVpcmVzVHJhY2tpbmdDb2RlIiwicmVxdWlyZXNTQ29kZSIsIm5lZWRzVHJhY2tpbmdDb2RlIiwidXBkYXRlSW5wdXQiLCJ2aXNpYmxlIiwibWVzc2FnZXMiLCJjb21wYXJlT2xkQW5kTmV3IiwidXJsUGFyYW1zIiwiY2hhbmdlZCIsImJlZm9yZURpZFJldHVybkNoYW5nZXMiLCJhZnRlckRpZFJldHVybkNoYW5nZXMiLCJyZWFkT25seSIsImNoYW5nZXMiLCJDTSIsInNjb3BlIiwiYXJ0aWN1bGF0ZUNoYW5nZXMiLCJjb21wYXJlU2VhcmNoU3RyaW5ncyIsIm9sZFAiLCJuZXdQIiwicGF5bG9hZCIsImFkZGVkIiwidXBkYXRlZCIsInJlbW92ZWQiLCJmaW5kX3BhdHRlcm5faW5BcnJheSIsInBhdHRlcm4iLCJhcnIiLCJ5IiwicmUiLCJvdGhlciIsImFyZ3MiLCJtZXNzYWdlIiwiZGF0YSIsIm9sZFBhcmFtcyIsIm5ld1BhcmFtcyIsInNlYXJjaENoYW5nZXNfMSIsImtleSIsInRvVXBwZXJDYXNlIiwiRU1MV29ya3NwYWNlIiwiaHRtbCIsIiRzY29wZSIsIm92ZXJyaWRkZW5JZHMiLCJidWZmZXIiLCJsaW5rc1ZpZXciLCJzb3VyY2VDb2RlIiwid29ya2luZ0NvZGUiLCJmaWxlTmFtZSIsImxpbmtEYXRhIiwiX2RlZmF1bHRTQ29kZSIsImhlYWRlciIsImV4cG9ydEZvckVsb3F1YSIsIl9fZW1sSGVhZGVycyIsImtleUJvYXJkU2hvcnRjdXRzIiwiX19hbGxvd2FibGVIZWFkZXJGaWVsZHMiLCJ0byIsInN5bnRheCIsImxhYmVsIiwiaW5zdHJ1Y3Rpb25zIiwiY2MiLCJyZXBseXRvIiwiaGVhZGVycyIsIm1hcExpbmtPYmplY3RzIiwiY2FsbGJhY2siLCJjb21wb3NlRU1MIiwiZG93bmxvYWRFbWwiLCJiZWZvcmVEaWREb3dubG9hZEVtbCIsIl9fcmVtb3ZlV2hpdGVTcGFjZSIsIl9fcmVwbGFjZUVsb3F1YU1lcmdlRmllbGRzIiwiZ2VuZXJhdGVPdXRwdXRDb2RlIiwiX19mb3JtYXRGaWxlTmFtZSIsInNhdmVBcyIsIkJsb2IiLCJhZnRlckRpZERvd25sb2FkRW1sIiwiZ2EiLCJkb3dubG9hZENzdiIsImRvd25sb2FkSHRtbCIsImJlZm9yZURpZERvd25sb2FkSHRtbCIsImFmdGVyRGlkRG93bmxvYWRIdG1sIiwiZXhwb3J0Q29kZVRvSFRNTCIsImJlZm9yZURpZEV4cG9ydENvZGVUb0hUTUwiLCJvdXRwdXRDb2RlIiwiYWZ0ZXJEaWRFeHBvcnRDb2RlVG9IVE1MIiwidHJhY2tpbmdPcHRPdXQiLCJzZXRVcFNob3J0Y3V0S2V5cyIsIktleWJvYXJkU2hvcnRjdXQiLCJlIiwiY3RybEtleSIsIm1ldGFLZXkiLCJzaGlmdEtleSIsIndoaWNoIiwiJGFwcGx5IiwiTWVzc2FnZU9iamVjdCIsIlN1Z2dlc3Rpb24iLCJjdGFIYW5kbGVyIiwiYXJlTGlua3NDb21wbGV0ZSIsIm9ua2V5dXAiLCJzaG9ydGN1dCIsIndoZW4iLCJkb1RoaXMiLCJyZXBsYWNlU3BlY2lhbENoYXJhY3RlcnMiLCJ0ZXh0IiwiMTc0IiwiMTY5IiwiODIxMSIsIjgyMTIiLCI4MjIwIiwiODIyMSIsIjgyMTYiLCI4MjE3IiwiODQ4MiIsInJlZ2V4cCIsIlN0cmluZyIsImZyb21DaGFyQ29kZSIsInByb2Nlc3NIdG1sIiwib3ZlcnJpZGRlbiIsInNjcm9sbFRvIiwiX19idWlsZEhlYWRlcnMiLCJ0aXRsZVJlZyIsInRpdGxlVGFnIiwicmUxIiwibiIsImFkZE5ld0hlYWRlckZpZWxkIiwicmVtb3ZlSGVhZGVyRmllbGQiLCJpc0hlYWRlclNlbGVjdGVkIiwidmVyaWZ5TGlua1NlY3Rpb25Db21wbGV0ZSIsImNsb25lIiwicmVhZE9ubHlVcmwiLCJuZXdDb250ZXh0IiwidXBkYXRlTGlua3NBbmRFeHBvcnQiLCJnZXRMaW5rc1N1bW1hcnkiLCJuZWVkc1RyYWNraW5nIiwiaW52YWxpZFVybCIsImltcG9ydEh0bWxGcm9tRmlsZURyb3AiLCJldnQiLCJmaWxlcyIsImRhdGFUcmFuc2ZlciIsImFsZXJ0IiwicmVhZGVyIiwiRmlsZVJlYWRlciIsIldTIiwib25sb2FkZW5kIiwiZHJvcFRleHQiLCJ0YXJnZXQiLCJuYW1lUGFydHMiLCJuYW1lIiwiZXh0IiwidG9Mb3dlckNhc2UiLCJfX3N0cmlwSHRtbEFuZFN1YmplY3RGcm9tRU1MIiwicmVhZEFzVGV4dCIsIm5ld1ZhbHVlIiwiX3NsdWdpZnlfc3RyaXBfcmUiLCJfc2x1Z2lmeV9oeXBoZW5hdGVfcmUiLCJyZTQiLCJjaGFyc2V0IiwiX19nZXRDaGFyc2V0RnJvbUhUTUwiLCJpXzEiLCJyZTUiLCJtZXRhVGFncyIsIml0ZW0iLCJjaGFyc2V0VmFscyIsImtleXMiLCJkZXNjcmlwdGlvbiIsIkludGVsbGlnZW5jZUFsZXJ0Iiwib3ZlcnJpZGUiLCJnZW5lcmF0ZUd1aWQiLCJzNCIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsInN1YnN0cmluZyIsIl90eXBlIiwibmV3VmFsIiwiY2xlYW5UeXBlIiwic2V0T3ZlcnJpZGVTdGF0dXMiLCJ2YWwiLCJFTUxNYWtlckludGVsbGlnZW5jZSIsIkludGVsbGlnZW5jZUNlbnRlciIsIiRtb25pdG9yIiwiX3Njb3BlIiwiX21vbml0b3IiLCJzZWFyY2hUeXBlIiwiZGVmYXVsdFNlYXJjaFR5cGUiLCJzZXRUeXBlIiwidHlwZXMiLCJ0YWJzIiwiY2FuVmlld0FsbCIsIkludGVsbGlnZW5jZUVuZ2luZSIsImNhY2hlZFJlc3VsdHMiLCJzY29wZXMiLCJfX2xvY2F0ZVNjb3BlIiwiZmlsdGVyIiwiSW50ZWxsaWdlbmNlTW9kdWxlIiwicmVhZE91dFJ1bGVzIiwicnVsZXMiLCJJbnRlbGxpZ2VuY2VNb25pdG9yIiwicmVnaXN0ZXIiLCJydWxlIiwicGFyZW50U2NvcGUiLCJ2YXJpYWJsZXMiLCJyZXNldCIsImFjY2Vzc29yIiwiZXZhbHVhdGVSdWxlIiwiZnVuYyIsInBhcmFtZXRlcnMiLCJzbGljZSIsIklNXzEiLCJtYXAiLCJhcHBseSIsImVycm9yIiwicnVsZXNfMSIsInByb2NlZWQiLCJJQSIsIldhcm4iLCJzZXZlcml0eSIsIlplcm8iLCJ0aXRsZSIsInJlc291cmNlIiwiY3RhIiwiaGFuZGxlciIsImN0YUxhYmVsIiwic29ydCIsIkFjY2Vzc09ubGluZVZlcnNpb24iLCJhbmltYXRlIiwic3RhdHVzIiwiaGVhZGxpbmUiLCJzdWNjZXNzIiwib25lcnJvciIsIkxPQ0FMSE9TVCIsImlzTG9jYWxNYWNoaW5lIiwiT0ZGTElORV9WRVJTSU9OIiwib2J0YWluS2V5RnJvbVNlcnZlciIsIlBBR0VfVElUTEUiLCJyIiwibSIsInJlZGlyZWN0SnNvbnBDYWxsYmFjayIsInNldFRpbWVvdXQiLCJDVVJSRU5UX1ZFUlNJT04iLCJjcmVhdGVFbGVtZW50IiwiZ2V0RWxlbWVudHNCeVRhZ05hbWUiLCJpbnNlcnRCZWZvcmUiLCJVcGRhdGVNb2R1bGUiLCJ1cGRhdGVWZXJzaW9uIiwidXBkYXRlRm9yY2VkIiwib2ZmbGluZVZlcnNpb24iLCJvbmxpbmVWZXJzaW9uIiwiYWNjZXNzaW5nRnJvbU9mZmxpbmUiLCJvZlYiLCJBcHBsaWNhdGlvblZlcnNpb24iLCJvblYiLCJjb21wYXJlQWdhaW5zdCIsIkFwcFZlcnNpb25EaWZmZXJlbmNlVHlwZSIsIlBBVENIIiwic2hvd01lc3NhZ2UiLCJzaG93VGVhc2VyIiwiZm9yY2VVcGRhdGUiLCJvZmZsaW5lIiwib25saW5lIiwidmVyc2lvbiIsIl92ZXJzaW9uIiwidmVyc2lvbk9iamVjdCIsIk90aGVyVmVyc2lvbiIsIm1lIiwiU2VjdXJlR2F0ZXdheSIsImxvZ2luQ2FsbGJhY2siLCJjYW5Mb2dpbiIsImxvZ2luVGltZXIiLCJzZXNzaW9uVXNlckVtYWlsIiwidGltZXJEZWxheSIsInNhbHQiLCJlbWFpbFJlZ2V4Iiwic2Vzc2lvbklkTG9jYWxTdG9yYWdlS2V5IiwicGVyc2lzdF9zdG9yZSIsIlBlcnNpc3QiLCJTdG9yZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJzYXZlIiwiaW5pdCIsImhhc1NhdmVkU2Vzc2lvbklkIiwic2Vzc2lvbklkIiwic2V0Q3VycmVudFVzZXIiLCJsb2dPdXQiLCJsb2dpbkFzT3RoZXIiLCJyZW1vdmUiLCJyZWxvYWQiLCJjbGVhclRpbWVvdXQiLCJzZXNzaW9uVXBkYXRlVXNlckVtYWlsIiwiZXJyb3JNZXNzYWdlIiwic2F2ZWRFbWFpbElkIiwiZGVjcnlwdCIsImVuY3J5cHQiLCJjaCIsImNoYXJDb2RlQXQiLCJDcnlwdG9KUyIsIk1ENSJdLCJtYXBwaW5ncyI6IkFBU0EsUUFBQUEsMkJBQ0UsR0FBSUMsR0FBUyxFQUNiLElBQUdDLE9BQU9DLFNBQVNDLE9BQU9DLFFBQVEsbUJBQW9CLENBQ3BELEdBQUlDLEdBQVNKLE9BQU9DLFNBQVNDLE9BQU9HLE9BQU8sRUFBRUwsT0FBT0MsU0FBU0MsT0FBT0ksUUFBUUMsTUFBTSxJQUNsRkgsR0FBT0ksUUFBUSxTQUFTQyxHQUNuQkEsRUFBTU4sUUFBUSx5QkFDZkosRUFBU1UsRUFBTUosT0FBTyxtQkFBbUJDLE9BQVFHLEVBQU1ILFdBSTdELE1BQU9QLEdDUVQsR0FBS1csZ0JBQUwsU0FBS0EsR0FDSEEsRUFBQUEsRUFBQSxLQUFBLEdBQUEsT0FDQUEsRUFBQUEsRUFBQSxPQUFBLEdBQUEsU0FDQUEsRUFBQUEsRUFBQSxJQUFBLEdBQUEs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TUFLaEQ3QixFQUFBdlksVUFBQWlhLFFBQUEsU0FBUTVMLEdBQ04sR0FBSTNRLEdBQU8yUSxFQUFLLEVBS2hCLE9BSkEzUSxHQUFTQSxFQUFPK0UsUUFBUSxNQUFNLFNBQVMwWCxHQUVyQyxNQUFPbkwsUUFBT0MsYUFBYWtMLEVBQUdDLFdBQVcsR0FBRyxNQUtoRDdCLEVBQUF2WSxVQUFBd1osZUFBQSxTQUFlN1osR0FDYixHQUFJb0MsR0FBT3BFLE9BQU8wYyxTQUFTQyxJQUFJM2EsRUFBUUYsS0FBS29aLE1BQU1uVSxVQUNsRC9HLFFBQU9xYixjQUFjblksSUFBSXBCLEtBQUtzWix5QkFBMEJ0WixLQUFLeWEsUUFBUXZhLElBQ3JFaEMsT0FBTytPLEdBQUcsTUFBTyxTQUFVM0ssSUFFN0J3VyxFQUFBdlksVUFBQUssb0JBQUEsU0FBb0JWLEdBQ2xCLE1BQUdGLE1BQUtxWixXQUFXeFksS0FBS1gsSUFDdEI2QixRQUFRQyxJQUFJOUIsRUFBTyxhQUNaLElBRVA2QixRQUFRQyxJQUFJOUIsRUFBTyxpQkFDWixJQUtiNFkiLCJmaWxlIjoiZW1sLWNvcmUuanMiLCJzb3VyY2VzQ29udGVudCI6WyJcbmludGVyZmFjZSBXaW5kb3cge1xuICBPRkZMSU5FX1ZFUlNJT046IHN0cmluZztcbiAgQ1VSUkVOVF9WRVJTSU9OOiBzdHJpbmc7XG4gIHBlcnNpc3Rfc3RvcmU6IGFueTtcbiAgTE9DQUxIT1NUOiBib29sZWFuO1xuICBQQUdFX1RJVExFOiBzdHJpbmc7XG4gIHJlZGlyZWN0SnNvbnBDYWxsYmFjazogKHN0cmluZyk9PnZvaWQ7XG59XG5mdW5jdGlvbiBnZXRPZmZsaW5lVmVyc2lvbk51bWJlcigpe1xuICB2YXIgb3V0cHV0ID0gXCJcIjtcbiAgaWYod2luZG93LmxvY2F0aW9uLnNlYXJjaC5pbmRleE9mKFwib2ZmbGluZV92ZXJzaW9uXCIpKSB7XG4gICAgdmFyIHBhcmFtcyA9IHdpbmRvdy5sb2NhdGlvbi5zZWFyY2guc3Vic3RyKDEsd2luZG93LmxvY2F0aW9uLnNlYXJjaC5sZW5ndGgpLnNwbGl0KFwiJlwiKTtcbiAgICBwYXJhbXMuZm9yRWFjaChmdW5jdGlvbihwYXJhbSl7XG4gICAgICBpZihwYXJhbS5pbmRleE9mKFwib2ZmbGluZV92ZXJzaW9uPVwiKT4tMSl7XG4gICAgICAgIG91dHB1dCA9IHBhcmFtLnN1YnN0cihcIm9mZmxpbmVfdmVyc2lvbj1cIi5sZW5ndGgsIHBhcmFtLmxlbmd0aCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbiAgcmV0dXJuIG91dHB1dDtcbn1cbmNsYXNzIEFjY2Vzc09ubGluZVZlcnNpb24ge1xuICBoZWFkbGluZTogc3RyaW5nO1xuICBtZXNzYWdlOiBzdHJpbmc7XG4gIHN0YXR1czogc3RyaW5nO1xuICBhbmltYXRlOiBib29sZWFuO1xuICBzdWNjZXNzOigpPT52b2lkO1xuICBvbmVycm9yOigpPT52b2lkO1xuICBjb25zdHJ1Y3RvcihhcmdzKXtcblxuICAgIHRoaXMuYW5pbWF0ZT0gdHJ1ZTtcbiAgICB0aGlzLnN0YXR1cz0gXCJhdHRlbXB0aW5nXCI7XG4gICAgdGhpcy5oZWFkbGluZT0gXCJDaGVja2luZyBhdmFpbGFiaWxpdHkgb2Ygb25saW5lIHZlcnNpb25cIjtcbiAgICB0aGlzLm1lc3NhZ2U9IFwiSWYgd2UncmUgYWJsZSB0byBhY2Nlc3MgdGhlIG9ubGluZSB2ZXJzaW9uLCB5b3Ugd2lsbCBiZSByZWRpcmVjdGVkLlwiO1xuXG4gICAgaWYoYXJncy5zdWNjZXNzID09PSB1bmRlZmluZWQpIGFyZ3Muc3VjY2Vzcz1mdW5jdGlvbigpe307XG4gICAgaWYoYXJncy5vbmVycm9yID09PSB1bmRlZmluZWQpIGFyZ3Mub25lcnJvcj1mdW5jdGlvbigpe307XG5cbiAgICB3aW5kb3cuTE9DQUxIT1NUID0gdGhpcy5pc0xvY2FsTWFjaGluZSgpO1xuICAgIHdpbmRvdy5PRkZMSU5FX1ZFUlNJT04gPSBnZXRPZmZsaW5lVmVyc2lvbk51bWJlcigpO1xuXG4gICAgaWYod2luZG93LkxPQ0FMSE9TVCl7XG4gICAgICB3aW5kb3cuc2Nyb2xsVG8oMCwgMCk7XG4gICAgICB0aGlzLm9idGFpbktleUZyb21TZXJ2ZXIoYXJncyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuc3RhdHVzID0gXCJmYWlsZWRcIjtcbiAgICAgIHRoaXMuYW5pbWF0ZSA9IGZhbHNlO1xuICAgICAgZG9jdW1lbnQudGl0bGUgPSB3aW5kb3cuUEFHRV9USVRMRTtcbiAgICB9XG5cblxuICB9XG4gIG9idGFpbktleUZyb21TZXJ2ZXIoYXJncyl7XG5cbiAgICBpZih0aGlzLmlzTG9jYWxNYWNoaW5lKCkpe1xuICAgICAgdmFyIHIsIGEsIG07XG4gICAgICAgIHdpbmRvdy5yZWRpcmVjdEpzb25wQ2FsbGJhY2sgPSBmdW5jdGlvbihyZXN1bHQpe1xuICAgICAgICAgIGlmKHJlc3VsdCA9PSB0cnVlKSB7XG4gICAgICAgICAgICBhcmdzLnN1Y2Nlc3MoKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRk9VTkQ/XCIpO1xuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xuICAgICAgICAgICAgICBsb2NhdGlvbi5ocmVmPVwiaHR0cDovL2pvaG5wcm9lc3Rha2VzLmdpdGh1Yi5pby9lbWwtbWFrZXI/b2ZmbGluZV92ZXJzaW9uPVwiK3dpbmRvdy5DVVJSRU5UX1ZFUlNJT047XG4gICAgICAgICAgICB9LCA1MDApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNvbnNvbGUubG9nKCdub3QgZ2l0aHViJyk7XG5cbiAgICAgIH19O1xuICAgICAgciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpLFxuICAgICAgYSA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdzY3JpcHQnKVswXTtcbiAgICAgIHIudHlwZT1cInRleHQvamF2YXNjcmlwdFwiO1xuICAgICAgci5vbmVycm9yID0gZnVuY3Rpb24oKXtcbiAgICAgICAgYXJncy5vbmVycm9yKCk7XG4gICAgICAgfTtcblxuICAgICAgci5zcmM9ICF0aGlzLmlzTG9jYWxNYWNoaW5lKCkgPyBcIlwiIDogXCJodHRwOi8vam9obnByb2VzdGFrZXMuZ2l0aHViLmlvL2VtbC1tYWtlci9wcm9kL2FwcC9jYW5yZWRpcmVjdC5qc1wiO1xuICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xuICAgICAgICBhLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKHIsbSk7XG4gICAgICB9LDIwMDApO1xuICAgICAgZG9jdW1lbnQudGl0bGUgPSB3aW5kb3cuUEFHRV9USVRMRSArIFwiIChPZmZsaW5lIE1vZGUpXCI7XG4gICB9IGVsc2Uge1xuICAgICAgdGhpcy5zdGF0dXMgPSBcImZhaWxlZFwiO1xuICAgICAgdGhpcy5hbmltYXRlID0gZmFsc2U7XG4gICAgICBkb2N1bWVudC50aXRsZSA9IHdpbmRvdy5QQUdFX1RJVExFO1xuXG4gICB9XG4gIH1cbiAgZ2V0T2ZmbGluZVZlcnNpb25OdW1iZXIoKTpzdHJpbmd7XG4gICAgdmFyIG91dHB1dCA9IFwiXCI7XG4gICAgaWYod2luZG93LmxvY2F0aW9uLnNlYXJjaC5pbmRleE9mKFwib2ZmbGluZV92ZXJzaW9uXCIpKSB7XG4gICAgICB2YXIgcGFyYW1zID0gd2luZG93LmxvY2F0aW9uLnNlYXJjaC5zdWJzdHIoMSx3aW5kb3cubG9jYXRpb24uc2VhcmNoLmxlbmd0aCkuc3BsaXQoXCImXCIpO1xuICAgICAgcGFyYW1zLmZvckVhY2goZnVuY3Rpb24ocGFyYW0pe1xuICAgICAgICBpZihwYXJhbS5pbmRleE9mKFwib2ZmbGluZV92ZXJzaW9uPVwiKT4tMSl7XG4gICAgICAgICAgb3V0cHV0ID0gcGFyYW0uc3Vic3RyKFwib2ZmbGluZV92ZXJzaW9uPVwiLmxlbmd0aCwgcGFyYW0ubGVuZ3RoKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiBvdXRwdXQ7XG4gIH1cbiAgaXNMb2NhbE1hY2hpbmUoKXtcbiAgICAvLyByZXR1cm4gZmFsc2U7XG4gICAgcmV0dXJuIGxvY2F0aW9uLmhyZWYuaW5kZXhPZignam9obnByb2VzdGFrZXMuZ2l0aHViLmlvJyk9PS0xO1xuICB9XG59XG5cblxuY2xhc3MgVXBkYXRlTW9kdWxlIHtcblxuICB1cGRhdGVWZXJzaW9uOiBib29sZWFuO1xuICB1cGRhdGVGb3JjZWQ6IGJvb2xlYW47XG4gIG9mZmxpbmVWZXJzaW9uOiBzdHJpbmc7XG4gIG9ubGluZVZlcnNpb246IHN0cmluZztcbiAgYWNjZXNzaW5nRnJvbU9mZmxpbmU6IGJvb2xlYW47XG5cbiAgY29uc3RydWN0b3IoKXtcblxuICAgIHRoaXMudXBkYXRlVmVyc2lvbiA9IGZhbHNlO1xuICAgIHRoaXMudXBkYXRlRm9yY2VkID0gZmFsc2U7XG4gICAgdGhpcy5vZmZsaW5lVmVyc2lvbiA9IHdpbmRvdy5PRkZMSU5FX1ZFUlNJT04gPT09IHVuZGVmaW5lZCA/IGdldE9mZmxpbmVWZXJzaW9uTnVtYmVyKCkgOiB3aW5kb3cuT0ZGTElORV9WRVJTSU9OIDtcbiAgICB0aGlzLm9ubGluZVZlcnNpb24gPSB3aW5kb3cuQ1VSUkVOVF9WRVJTSU9OO1xuXG4gICAgLy90cmVhdCBsb2NhbGhvc3Q6ODg4OCBhcyBpbnRlcm5ldFxuICAgIGlmKGxvY2F0aW9uLmhyZWYuaW5kZXhPZihcImxvY2FsaG9zdFwiKT4tMSl7IHdpbmRvdy5MT0NBTEhPU1QgPSBmYWxzZTt9XG5cbiAgICBpZih0aGlzLm9mZmxpbmVWZXJzaW9uID09IFwiXCIpe1xuICAgICAgdGhpcy5hY2Nlc3NpbmdGcm9tT2ZmbGluZSA9IGZhbHNlO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZih0aGlzLm9mZmxpbmVWZXJzaW9uICYmIHdpbmRvdy5MT0NBTEhPU1Qpe1xuICAgICAgICB0aGlzLmFjY2Vzc2luZ0Zyb21PZmZsaW5lID0gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIGlmKHRoaXMub2ZmbGluZVZlcnNpb24gJiYgKHRoaXMub2ZmbGluZVZlcnNpb24gIT09IHRoaXMub25saW5lVmVyc2lvbikpe1xuICAgICAgICB0aGlzLnVwZGF0ZVZlcnNpb24gPSB0cnVlO1xuICAgICAgICBsZXQgb2ZWID0gbmV3IEFwcGxpY2F0aW9uVmVyc2lvbih0aGlzLm9mZmxpbmVWZXJzaW9uKSxcbiAgICAgICAgICBvblYgPSBuZXcgQXBwbGljYXRpb25WZXJzaW9uKHRoaXMub25saW5lVmVyc2lvbik7XG4gICAgICAgIHRoaXMudXBkYXRlRm9yY2VkID0gb2ZWLmNvbXBhcmVBZ2FpbnN0KG9uVikgPD0gQXBwVmVyc2lvbkRpZmZlcmVuY2VUeXBlLlBBVENIO1xuICAgICAgICBjb25zb2xlLmxvZyhcIlVQREFURUZPUkNFRD9cIiwgdGhpcy51cGRhdGVGb3JjZWQsIG9mVixvblYpO1xuICAgICAgfVxuICAgIH1cblxuICB9XG4gIHNob3dNZXNzYWdlKCl7XG4gICAgcmV0dXJuIHRoaXMudXBkYXRlVmVyc2lvbiAmJiB0aGlzLnVwZGF0ZUZvcmNlZDtcbiAgfVxuICBzaG93VGVhc2VyKCl7XG4gICAgcmV0dXJuIHRoaXMub2ZmbGluZVZlcnNpb249PVwiXCIgJiYgIXdpbmRvdy5MT0NBTEhPU1Q7XG4gIH1cbiAgZm9yY2VVcGRhdGUob2ZmbGluZSwgb25saW5lKXtcbiAgICB2YXIgb2ZmbGluZVZlcnNpb24gPSBvZmZsaW5lLnNwbGl0KFwiLlwiKSxcbiAgICBvbmxpbmVWZXJzaW9uID0gb25saW5lLnNwbGl0KFwiLlwiKSxcbiAgICBtYXRjaCA9IDAsIG91dHB1dCA9IGZhbHNlO1xuICAgIGZvcih2YXIgaT0wOyBpPG9ubGluZVZlcnNpb24ubGVuZ3RoO2krKyl7XG4gICAgICBpZihvbmxpbmVWZXJzaW9uW2ldPT0gb2ZmbGluZVZlcnNpb25baV0pIG1hdGNoKys7XG4gICAgfVxuICAgIGlmKG1hdGNoPDMpe1xuICAgICAgb3V0cHV0ID0gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIG91dHB1dDtcbiAgfVxufVxuXG5lbnVtIEFwcFZlcnNpb25EaWZmZXJlbmNlVHlwZXtcbiAgTUFKT1I9MCxcbiAgTUlOT1IsXG4gIFBBVENILFxuICBTVUJQQVRDSCxcbiAgTk9ORVxufVxuY2xhc3MgQXBwbGljYXRpb25WZXJzaW9uIHtcbiAgX3ZlcnNpb246IHN0cmluZztcbiAgdmVyc2lvbk9iamVjdDogbnVtYmVyW107XG4gIGNvbnN0cnVjdG9yKHZlcnNpb246c3RyaW5nKXtcbiAgICB0aGlzLl92ZXJzaW9uID0gdmVyc2lvbjtcbiAgICB0aGlzLnZlcnNpb25PYmplY3QgPSB0aGlzLl92ZXJzaW9uLnNwbGl0KFwiLlwiKS5tYXAoKG46c3RyaW5nKT0+cGFyc2VJbnQobikpO1xuICB9XG4gIGNvbXBhcmVBZ2FpbnN0KE90aGVyVmVyc2lvbjpBcHBsaWNhdGlvblZlcnNpb24pOkFwcFZlcnNpb25EaWZmZXJlbmNlVHlwZXtcbiAgICB2YXIgbWUgPSB0aGlzLnZlcnNpb25PYmplY3QsXG4gICAgICBvdGhlciA9IE90aGVyVmVyc2lvbi52ZXJzaW9uT2JqZWN0LFxuICAgICAgbWF0Y2ggPSAwLFxuICAgICAgb3V0cHV0ID0gZmFsc2U7XG5cbiAgICBmb3IodmFyIGk9MDsgaTw0O2krKyl7XG4gICAgICBpZihtZVtpXT09IG90aGVyW2ldKXtcbiAgICAgICAgIG1hdGNoKys7XG4gICAgICAgfSBlbHNlIHtcbiAgICAgICAgIGJyZWFrO1xuICAgICAgIH1cbiAgICAgfVxuXG4gICAgcmV0dXJuIEFwcFZlcnNpb25EaWZmZXJlbmNlVHlwZVtBcHBWZXJzaW9uRGlmZmVyZW5jZVR5cGVbbWF0Y2hdXTtcbiAgfVxufVxuIiwiXG5pbnRlcmZhY2UgV2luZG93IHtcbiAgICBnYShvcHRpb24xLCBvcHRpb24yLCBvcHRpb24zLCBvcHRpb240LCBvcHRpb241KTogdm9pZDtcbiAgICBzYXZlQXMob3B0aW9uMT8sIG9wdGlvbjI/KTogdm9pZDtcbiAgICBqUXVlcnkob3B0aW9uKTphbnk7XG4gICAgZGVjb2RlVVJJQ29tcG9uZW50KG9wdGlvbik6IHN0cmluZztcbiAgICBlbmNvZGVVUklDb21wb25lbnQob3B0aW9uKTogc3RyaW5nO1xufVxuaW50ZXJmYWNlIEV2ZW50VGFyZ2V0IHtcbiAgcmVzdWx0Pzphbnk7XG59XG4vLyBkZWNsYXJlIHZhciB3aW5kb3c6IE15V2luZG93O1xuXG5pbnRlcmZhY2UgJFNjZSB7XG4gIHRydXN0QXNIdG1sKHN0cjogc3RyaW5nKTogYW55O1xufVxuXG5pbnRlcmZhY2UgU2VhcmNoU3RyaW5nUGF5bG9hZCB7XG4gIGFkZGVkOiBzdHJpbmdbXSxcbiAgdXBkYXRlZDogc3RyaW5nW10sXG4gIHJlbW92ZWQ6IHN0cmluZ1tdLFxufVxuaW50ZXJmYWNlIENoYW5nZU1vbml0b3JNc2cge1xuICBtZXNzYWdlOiBzdHJpbmcsXG4gIGRhdGE6IGFueVtdXG59XG5cbmVudW0gRXJyb3JTZXZlcml0eSB7XG4gIEhpZ2g9MSxcbiAgTWVkaXVtLFxuICBMb3csXG4gIFplcm9cbn1cbmVudW0gRXJyb3JUeXBlIHtcbiAgRml4PTEsXG4gIFdhcm4sXG4gIFN1Z2dlc3Rpb24sXG4gIFFBLFxuICBCZXN0UHJhY3RpY2Vcbn1cblxuXG5uYW1lc3BhY2UgR2xvYmFsVmFycyB7XG4gIGV4cG9ydCBsZXQgbGFuZGluZ1BhZ2VQcmVmZXJyZWQgPSAvKFxcLm1wNHxcXC5hdml8XFwubXBlZ3xcXC5tcDN8XFwuc3dmfFxcLm1vdnxcXC5wZGYpL2k7XG4gIGV4cG9ydCBsZXQgZXh0RG9lc05vdHJlcXVpcmVUcmFja2luZ0NvZGUgPSAvKFxcLnBkZnxcXC5vZnR8XFwuaWNzfFxcLnBuZ3xcXC5qcGVnfFxcLmpwZykvaTtcbiAgZXhwb3J0IGxldCBsaW5rRW5jYXBzdWxhdGVkUHVuY3R1YXRpb24gPSAvKFtcXC5cXD9cXCxcXDpcXCpdKykoKFxcbnxcXHJ8XFxzKSspPzxcXC9hPiQvO1xuXG4gIGV4cG9ydCBsZXQgUmVxdWlyZXNTQ29kZVJlZ2V4ID0gL2h0dHAoLiopb3B0dW0oLiopXFwvKGNhbXBhaWdufHJlc291cmNlKS9pO1xuICBleHBvcnQgbGV0IFJlcXVpcmVzVHJhY2tpbmdDb2RlUmVnZXggPSBSZWdFeHAoXCJeaHR0cChzKT86XFwvXFwvKC4qPyk/b3B0dW0oLio/KT9cXC5jb1ttXFwuXT9cIik7XG4gIGV4cG9ydCBsZXQgVGVsZXBob25lUmVnZXggPSAvKFxcKz9cXGR7MSwyfShcXHN8LXxcXC4pKT9cXCg/XFxkezN9XFwpP1tcXHMuLV1cXGR7Myx9W1xccy4tXVxcZHs0LH0vO1xuICBleHBvcnQgbGV0IFRlbGVwaG9uZVJlZ2V4R2xvYmFsID0gLyhcXCs/XFxkezEsMn0oXFxzfC18XFwuKSk/XFwoP1xcZHszfVxcKT9bXFxzLi1dXFxkezMsfVtcXHMuLV1cXGR7NCx9L2c7XG4gIGV4cG9ydCBsZXQgRW1haWxSZWdleCA9IC8oKFtePD4oKVxcW1xcXVxcXFwuLDs6XFxzQFwiXSsoXFwuW148PigpXFxbXFxdXFxcXC4sOzpcXHNAXCJdKykqKXwoXCIuK1wiKSlAKChcXFtbMC05XXsxLDN9XFwuWzAtOV17MSwzfVxcLlswLTldezEsM31cXC5bMC05XXsxLDN9XFxdKXwoKFthLXpBLVpcXC0wLTldK1xcLikrW2EtekEtWl17Mix9KSkvO1xuICBleHBvcnQgbGV0IEVtYWlsUmVnZXhHbG9iYWwgPSAvKChbXjw+KClcXFtcXF1cXFxcLiw7Olxcc0BcIl0rKFxcLltePD4oKVxcW1xcXVxcXFwuLDs6XFxzQFwiXSspKil8KFwiLitcIikpQCgoXFxbWzAtOV17MSwzfVxcLlswLTldezEsM31cXC5bMC05XXsxLDN9XFwuWzAtOV17MSwzfVxcXSl8KChbYS16QS1aXFwtMC05XStcXC4pK1thLXpBLVpdezIsfSkpL2c7XG4gIGV4cG9ydCBsZXQgVXJsUmVnZXggPSAvXig/Oig/Oig/Omh0dHBzP3xmdHApOik/XFwvXFwvKSg/OlxcUysoPzo6XFxTKik/QCk/KD86KD8hKD86MTB8MTI3KSg/OlxcLlxcZHsxLDN9KXszfSkoPyEoPzoxNjlcXC4yNTR8MTkyXFwuMTY4KSg/OlxcLlxcZHsxLDN9KXsyfSkoPyExNzJcXC4oPzoxWzYtOV18MlxcZHwzWzAtMV0pKD86XFwuXFxkezEsM30pezJ9KSg/OlsxLTldXFxkP3wxXFxkXFxkfDJbMDFdXFxkfDIyWzAtM10pKD86XFwuKD86MT9cXGR7MSwyfXwyWzAtNF1cXGR8MjVbMC01XSkpezJ9KD86XFwuKD86WzEtOV1cXGQ/fDFcXGRcXGR8MlswLTRdXFxkfDI1WzAtNF0pKXwoPzooPzpbYS16XFx1MDBhMS1cXHVmZmZmMC05XS0qKSpbYS16XFx1MDBhMS1cXHVmZmZmMC05XSspKD86XFwuKD86W2EtelxcdTAwYTEtXFx1ZmZmZjAtOV0tKikqW2EtelxcdTAwYTEtXFx1ZmZmZjAtOV0rKSooPzpcXC4oPzpbYS16XFx1MDBhMS1cXHVmZmZmXXsyLH0pKSkoPzo6XFxkezIsNX0pPyg/OlsvPyNdXFxTKik/JC9pO1xuICBleHBvcnQgbGV0IExpbmtIYXNUaXRsZVRhZ1JlZ2V4R2xvYmFsID0gLzxhXFxzKFtePF0qKXRpdGxlPVxcXCIoLio/KVxcXCI+L2dpO1xuICBleHBvcnQgbGV0IFByZWhlYWRlclJlZ2V4R2xvYmFsID0gL1xcPHBcXHNbXlxcPF0qY2xhc3M9XFxcInByZWhlYWRlclxcXCJbXlxcPl0qXFw+L2dpO1xuICBleHBvcnQgbGV0IFJlcXVpcmVkVHJhY2tpbmdDb2RlV2hpdGVsaXN0OiBhbnlbXSA9IFtcbiAgICAnLnBkZicsJy5pY3MnLCcub2Z0Jywnb3B0dW1zdXJ2ZXlzLmNvJywnaGVhbHRoaWQub3B0dW0uY29tJywnbGVhcm5pbmcub3B0dW0uY29tJywnYXBwLmluZm8ub3B0dW0uY29tJyxcbiAgICAnb3B0dW0ud2ViZXguY29tJywndHdpdHRlci5jb20nLCdmYWNlYm9vay5jb20nLCdsaW5rZWRpbi5jb20nLCdpbmZvLm9wdHVtJ1xuICBdO1xufVxuXG5cbm5hbWVzcGFjZSBFTUxNb2R1bGUge1xuXG5cblxuICBleHBvcnQgY2xhc3MgTWFpbHRvTGlua09iamVjdCB7XG4gICAgIHBhcmVudDogTGlua09iamVjdDtcbiAgICAgZW1haWw6IHN0cmluZztcbiAgICAgc3ViamVjdDogc3RyaW5nO1xuICAgICBib2R5OiBzdHJpbmc7XG5cbiAgICAgY29uc3RydWN0b3IoTGlua09iamVjdCl7XG4gICAgICAgdGhpcy5wYXJlbnQgPSBMaW5rT2JqZWN0O1xuICAgICAgIHRoaXMuZW1haWwgPSBcIlwiO1xuICAgICAgIHRoaXMuc3ViamVjdCA9IFwiXCI7XG4gICAgICAgdGhpcy5ib2R5ID0gXCJcIjtcblxuICAgICAgIGlmKHRoaXMucGFyZW50LmlzTGlua1R5cGUoJ21haWx0bycpKXtcbiAgICAgICAgIHRoaXMuaW5pdEVtYWlsRWRpdG9yKCk7XG4gICAgICAgfVxuICAgICB9XG4gICAgIGhhcyhvcHRpb24pOmJvb2xlYW57XG4gICAgICAgdGhpcy51cGRhdGVNYWlsdG9PYmooKTtcbiAgICAgICByZXR1cm4gdGhpc1tvcHRpb25dICYmIHRoaXNbb3B0aW9uXS50cmltKCkhPT1cIlwiO1xuICAgICB9XG4gICAgIGlzVmFsaWRFbWFpbEFkZHJlc3MoKXtcbiAgICAgICByZXR1cm4gR2xvYmFsVmFycy5FbWFpbFJlZ2V4LnRlc3QodGhpcy5lbWFpbCk7XG4gICAgIH1cbiAgICAgZGVpbml0RW1haWxFZGl0b3IoKXtcbiAgICAgICB0aGlzLmVtYWlsID0gXCJcIjtcbiAgICAgICB0aGlzLnN1YmplY3QgPSBcIlwiO1xuICAgICAgIHRoaXMuYm9keSA9IFwiXCI7XG4gICAgIH1cbiAgICAgY29tcG9zZUVtYWlsKCl7XG4gICAgICAgdGhpcy5wYXJlbnQubmV3LnVybCA9IFwibWFpbHRvOlwiICsgdGhpcy5lbWFpbDtcbiAgICAgICB2YXIgb3B0aW9ucyA9IFtcInN1YmplY3RcIixcImJvZHlcIl07XG4gICAgICAgZm9yKHZhciBpID0wOyBpPG9wdGlvbnMubGVuZ3RoOyBpKyspe1xuICAgICAgICAgaWYodGhpc1tvcHRpb25zW2ldXSAmJiB0aGlzW29wdGlvbnNbaV1dICE9PSBcIlwiKSB7XG4gICAgICAgICAgIHRoaXMucGFyZW50Lm5ldy5zZWFyY2hQYXJhbXMuc2V0KG9wdGlvbnNbaV0sIHRoaXNbb3B0aW9uc1tpXV0pO1xuICAgICAgICAgfSBlbHNlIGlmKHRoaXNbb3B0aW9uc1tpXV09PVwiXCIpe1xuICAgICAgICAgICB0aGlzLnBhcmVudC5uZXcuc2VhcmNoUGFyYW1zLmRlbGV0ZShvcHRpb25zW2ldKTtcbiAgICAgICAgICAgLy8gW1wic3ViamVjdFwiLFwiYm9keVwiXS5mb3JFYWNoKChvcHRpb24pPT57XG4gICAgICAgICAgIC8vICAgaWYodGhpc1tvcHRpb25dID09IFwiXCIpIHtcbiAgICAgICAgICAgLy9cbiAgICAgICAgICAgLy8gICAgfVxuICAgICAgICAgICAvLyAgfSk7XG4gICAgICAgICAgIC8vIC8vZGVsZXRlIGl0O1xuICAgICAgICAgICAvLyB0aGlzLnBhcmVudC5uZXcuc2VhcmNoUGFyYW1zLmRlbGV0ZShvcHRpb25zW2ldKTtcbiAgICAgICAgIH1cbiAgICAgICB9XG4gICAgIH1cbiAgICAgdXBkYXRlTWFpbHRvT2JqKCl7XG5cbiAgICAgICB2YXIgYSA9IHRoaXMucGFyZW50Lm5ldy51cmwuc3Vic3RyKDcsIHRoaXMucGFyZW50Lm5ldy51cmwubGVuZ3RoLTcpO1xuICAgICAgIHZhciBiID0gYS5zcGxpdChcIj9cIik7XG4gICAgICAgdGhpcy5lbWFpbCA9IGJbMF07XG5cbiAgICAgICB0aGlzLnBhcmVudC5uZXcuc2VhcmNoUGFyYW1zLnVwZGF0ZUVudHJpZXMoKTtcbiAgICAgICBpZihiLmxlbmd0aD4xKXtcbiAgICAgICAgIFtcInN1YmplY3RcIixcImJvZHlcIl0uZm9yRWFjaCgob3B0aW9uKT0+e1xuICAgICAgICAgICBpZih0aGlzLnBhcmVudC5uZXcuc2VhcmNoUGFyYW1zLmhhcyhvcHRpb24pKXtcbiAgICAgICAgICAgICB0aGlzW29wdGlvbl0gPSB3aW5kb3cuZGVjb2RlVVJJQ29tcG9uZW50KHRoaXMucGFyZW50Lm5ldy5zZWFyY2hQYXJhbXMuZ2V0KG9wdGlvbikpO1xuICAgICAgICAgICB9XG4gICAgICAgICB9KTtcbiAgICAgICB9IGVsc2Uge1xuICAgICAgICAgdGhpcy5zdWJqZWN0PSBcIlwiO1xuICAgICAgICAgdGhpcy5ib2R5ID0gXCJcIjtcbiAgICAgICB9XG4gICAgIH1cbiAgICAgaW5wdXRPbkJsdXIoKXtcbiAgICAgICAvL2RlY29kZWQgdXJsIGFsbCB0aGUgZW50cmllcztcbiAgICAgICAvL3JlZW5jb2RlIHRoZW0uXG5cbiAgICAgICB0aGlzLnBhcmVudC5uZXcuc2VhcmNoUGFyYW1zLnVwZGF0ZUVudHJpZXMoKTtcbiAgICAgICB0aGlzLnBhcmVudC5uZXcuc2VhcmNoUGFyYW1zLnVwZGF0ZVNlYXJjaFByb3AoKTtcblxuXG4gICAgIH1cbiAgICAgb3BlbkVkaXRvcigpe1xuICAgICAgIHRoaXMuaW5pdEVtYWlsRWRpdG9yKCk7XG4gICAgICAgLy8gd2luZG93LmpRdWVyeShcImh0bWwsYm9keVwiKVxuICAgICAgIC8vIC5hbmltYXRlKHtzY3JvbGxUb3A6IHdpbmRvdy5qUXVlcnkoJyNsaW5rLScrKHRoaXMucGFyZW50LmlkLTEpKS5vZmZzZXQoKS50b3AgLSA3NX0sIDMwMCk7XG4gICAgICAgdmFyIExPID0gdGhpcy5wYXJlbnQ7XG4gICAgICAgICBjb25zb2xlLmxvZyhMTy5pZC0xKTtcbiAgICAgICAgIExPLnNob3dNYWlsdG9FZGl0b3IgPSB0cnVlO1xuICAgICB9XG4gICAgIGluaXRFbWFpbEVkaXRvcigpe1xuICAgICAgIHRoaXMudXBkYXRlTWFpbHRvT2JqKCk7XG4gICAgIH1cbiAgIH1cblxuICBleHBvcnQgY2xhc3MgVVJMT2JqIHtcbiAgICBzZWFyY2g6IHN0cmluZztcbiAgICBocmVmOiBzdHJpbmc7XG4gICAgb3JpZ2luOiBzdHJpbmc7XG4gICAgaGFzaDogc3RyaW5nO1xuICAgIHByb3RvY29sOiBzdHJpbmc7XG4gICAgc2VhcmNoUGFyYW1zOiBVUkxPYmpTZWFyY2hQYXJhbXM7XG5cbiAgICBjb25zdHJ1Y3Rvcih1cmwpe1xuICAgICAgdGhpcy5ocmVmID0gXCJcIjtcbiAgICAgIHRoaXMuc2VhcmNoID0gXCJcIjtcbiAgICAgIHRoaXMub3JpZ2luID0gXCJcIjtcbiAgICAgIHRoaXMuaGFzaCA9IFwiXCI7XG4gICAgICB0aGlzLnByb3RvY29sID0gXCJcIjtcbiAgICAgIHRoaXMudXJsID0gdXJsO1xuICAgICAgdGhpcy5zZWFyY2hQYXJhbXMgPSBuZXcgVVJMT2JqU2VhcmNoUGFyYW1zKHRoaXMpO1xuICAgIH1cbiAgICBwcmVwYXJlRXhwb3J0KCl7XG4gICAgLy9kbyBzb21ldGhpbmcgaGVyZT9cbiAgICAgIC8vdGhpcy5zZWFyY2hQYXJhbXMudXBkYXRlU2VhcmNoUHJvcCgpO1xuICAgIH1cbiAgICBpc1ZhbGlkKCk6Ym9vbGVhbiB7XG4gICAgICByZXR1cm4gR2xvYmFsVmFycy5VcmxSZWdleC50ZXN0KHRoaXMudXJsKTtcbiAgICB9XG4gICAgY29udGFpbnMoc3RyOnN0cmluZyk6IGJvb2xlYW57XG4gICAgICBpZih0aGlzLnVybC5pbmRleE9mKHN0cik+LTEpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuICAgIGdldCB1cmwoKXtcbiAgICAgIHRoaXMucHJlcGFyZUV4cG9ydCgpO1xuICAgICAgdmFyIHUgPSB0aGlzLm9yaWdpbiArIHRoaXMuc2VhcmNoICsgdGhpcy5oYXNoO1xuICAgICAgdSA9IHUucmVwbGFjZShcIj91bmRlZmluZWRcIixcIlwiKTtcbiAgICAgIHJldHVybiB1O1xuICAgIH1cbiAgICBzZXQgdXJsKHVybCl7XG4gICAgICB0aGlzLnNlYXJjaCA9IFwiXCI7XG4gICAgICB0aGlzLmhhc2ggPSBcIlwiO1xuICAgICAgdmFyIHByb3RvY29sVHlwZSA9IC9eKGh0dHBzP3xtYWlsdG98ZnRwKVxcOi9naTtcbiAgICAgIGlmKHByb3RvY29sVHlwZS50ZXN0KHVybCkpe1xuICAgICAgICB2YXIgYSA9IHVybC5tYXRjaChwcm90b2NvbFR5cGUpO1xuICAgICAgICB0aGlzLnByb3RvY29sID0gYVswXTtcbiAgICAgIH1cbiAgICAgIHRoaXMuaHJlZiA9IHVybDtcbiAgICAgIGlmKHVybC50cmltKCk9PVwiI1wiKXtcbiAgICAgICAgdGhpcy5oYXNoID0gXCIjXCI7XG4gICAgICB9XG4gICAgICBlbHNlIGlmKHVybC50cmltKCkubGVuZ3RoPjEgJiYgdXJsLmluZGV4T2YoXCIjXCIpPi0xKXtcbiAgICAgICAgdmFyIHVybFBhcnRzID0gdXJsLnNwbGl0KFwiI1wiKTtcbiAgICAgICAgdGhpcy5oYXNoID0gXCIjXCIgKyB1cmxQYXJ0cy5wb3AoKTsgLy9qdW1wIGxpbmsuLiBuZWVkIHRvIHJlbW92ZSBpdCBmcm9tIHRoZSBvdGhlciBzdHVmZi5cbiAgICAgICAgdmFyIHBhcnRzID0gKHVybFBhcnRzLmpvaW4oXCIjXCIpKS5zcGxpdChcIj9cIik7XG4gICAgICAgIHRoaXMub3JpZ2luID0gcGFydHNbMF07XG4gICAgICAgIHRoaXMuc2VhcmNoID0gcGFydHMubGVuZ3RoPjAgPyBcIj9cIitwYXJ0c1sxXTpcIlwiO1xuICAgICAgfVxuICAgICAgZWxzZSB7XG5cbiAgICAgICAgaWYodXJsLmluZGV4T2YoXCI/XCIpPi0xKXtcbiAgICAgICAgICB2YXIgcGFydHMgPSB1cmwuc3BsaXQoXCI/XCIpO1xuICAgICAgICAgIHRoaXMub3JpZ2luID0gcGFydHNbMF07XG4gICAgICAgICAgdGhpcy5zZWFyY2ggPSAocGFydHMubGVuZ3RoID4gMCkgPyBcIj9cIitwYXJ0c1sxXTpcIlwiO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMub3JpZ2luID0gdXJsO1xuICAgICAgICB9XG5cbiAgICAgIH1cbiAgICAgIC8vdGhpcy5zZWFyY2hQYXJhbXMudXBkYXRlU2VhcmNoUHJvcCgpO1xuICAgIH1cblxuICB9XG5cbiAgZXhwb3J0IGNsYXNzIFVSTE9ialNlYXJjaFBhcmFtcyB7XG4gICAgX2VudHJpZXMgOiBhbnlbXTtcbiAgICBwYXJlbnQ6IFVSTE9iajtcblxuICAgIGNvbnN0cnVjdG9yKHBhcmVudDpVUkxPYmope1xuXG4gICAgICB0aGlzLnBhcmVudCA9IHBhcmVudDtcbiAgICAgIGlmKHRoaXMucGFyZW50LnNlYXJjaC5sZW5ndGg+MCl7XG4gICAgICAgIHRoaXMuX2VudHJpZXMgPSAodGhpcy5wYXJlbnQuc2VhcmNoLnN1YnN0cigxLHRoaXMucGFyZW50LnNlYXJjaC5sZW5ndGgpKS5zcGxpdCgvXFwmYW1wXFw7fFxcJi9nKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuX2VudHJpZXM9W107XG4gICAgICB9XG5cblxuICAgIH1cbiAgICBnZXQgZW50cmllcygpe1xuICAgICAgbGV0IG91dHB1dCA9IFtdO1xuICAgICAgZm9yKGxldCBpID0gMDsgaTx0aGlzLl9lbnRyaWVzLmxlbmd0aDtpKyspe1xuICAgICAgICB2YXIgYSA9IHRoaXMuX2VudHJpZXNbaV0uc3BsaXQoXCI9XCIpO1xuICAgICAgICBpZihhLmxlbmd0aD4xKXtcbiAgICAgICAgICBhWzFdID0gZGVjb2RlVVJJQ29tcG9uZW50KGFbMV0pO1xuICAgICAgICB9XG4gICAgICAgIG91dHB1dC5wdXNoKGEuam9pbihcIj1cIikpO1xuICAgICAgfVxuXG5cbiAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgfVxuICAgIHVwZGF0ZUVudHJpZXMoKTp2b2lkIHtcbiAgICAgIHRoaXMuX2VudHJpZXMgPSBbXTtcbiAgICAgIGlmKHRoaXMucGFyZW50LnNlYXJjaCE9PSBcIj9cIiAmJiB0aGlzLnBhcmVudC5zZWFyY2gubGVuZ3RoPjEpe1xuICAgICAgICB2YXIgcHJvcHMgPSAodGhpcy5wYXJlbnQuc2VhcmNoLnN1YnN0cigxLHRoaXMucGFyZW50LnNlYXJjaC5sZW5ndGgpKS5zcGxpdCgvXFwmYW1wXFw7fFxcJi9nKTtcbiAgICAgICAgZm9yKGxldCBpID0gMDsgaTxwcm9wcy5sZW5ndGg7aSsrKXtcbiAgICAgICAgICB0aGlzLl9lbnRyaWVzLnB1c2gocHJvcHNbaV0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHVwZGF0ZVNlYXJjaFByb3AoKTp2b2lke1xuICAgICAgdmFyIG91dHB1dCA9IFtdO1xuICAgICAgaWYodGhpcy5fZW50cmllcy5sZW5ndGg+MCl7XG4gICAgICAgIGZvcih2YXIgaSA9MDtpPHRoaXMuX2VudHJpZXMubGVuZ3RoO2krKyl7XG4gICAgICAgICAgdmFyIHByb3AgPXRoaXMuX2VudHJpZXNbaV0uc3BsaXQoXCI9XCIpO1xuICAgICAgICAgIGlmKC9bYS16XXsxLDR9PSguKj86KXszLDl9L2dpLnRlc3QodGhpcy5fZW50cmllc1tpXSkpIHtcbiAgICAgICAgICAgIG91dHB1dC5wdXNoKHRoaXMuX2VudHJpZXNbaV0pO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBvdXRwdXQucHVzaChwcm9wWzBdKyhwcm9wLmxlbmd0aD4xID8gXCI9XCIrIGVuY29kZVVSSUNvbXBvbmVudChkZWNvZGVVUklDb21wb25lbnQocHJvcFsxXSkpIDogXCJcIikpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICB0aGlzLnBhcmVudC5zZWFyY2ggPSBvdXRwdXQubGVuZ3RoPjAgPyBcIj9cIitvdXRwdXQuam9pbihcIiZcIikgOiBcIlwiO1xuICAgIH1cbiAgICBoYXMocGFyYW0pOmJvb2xlYW57XG4gICAgICB2YXIgcmVnZXggPSBuZXcgUmVnRXhwKFwiXlwiICsgcGFyYW0gKyBcIlxcPVwiLFwiZ1wiKTtcbiAgICAgIHZhciBvdXRwdXQgPSBmYWxzZTtcbiAgICAgIGZvcih2YXIgaT0wO2k8dGhpcy5fZW50cmllcy5sZW5ndGg7aSsrKXtcbiAgICAgICAgaWYocmVnZXgudGVzdCh0aGlzLl9lbnRyaWVzW2ldKSkgb3V0cHV0ID0gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgfVxuICAgIGdldChwYXJhbSl7XG4gICAgICB2YXIgcmVnZXggPSBuZXcgUmVnRXhwKFwiXlwiICsgcGFyYW0gKyBcIlxcPVwiLFwiZ1wiKSxcbiAgICAgICAgICBvdXRwdXQgPSBmYWxzZTtcbiAgICAgIGZvcih2YXIgaT0wO2k8dGhpcy5fZW50cmllcy5sZW5ndGg7aSsrKXtcbiAgICAgICAgaWYocmVnZXgudGVzdCh0aGlzLl9lbnRyaWVzW2ldKSkge1xuICAgICAgICAgIG91dHB1dCA9ICh0aGlzLl9lbnRyaWVzW2ldLnNwbGl0KFwiPVwiKSkucG9wKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgfVxuICAgIHNldChwYXJhbSwgdmFsdWUpOnZvaWR7XG4gICAgICB2YXIgcmVnZXggPSBuZXcgUmVnRXhwKFwiXlwiICsgcGFyYW0gKyBcIlxcPVwiLFwiZ1wiKSxcbiAgICAgICAgICBvdXRwdXQgPSBmYWxzZTtcbiAgICAgIGZvcih2YXIgaT0wO2k8dGhpcy5fZW50cmllcy5sZW5ndGg7aSsrKXtcbiAgICAgICAgaWYocmVnZXgudGVzdCh0aGlzLl9lbnRyaWVzW2ldKSkge1xuICAgICAgICAgIHRoaXMuX2VudHJpZXNbaV0gPSBwYXJhbSArIFwiPVwiICsgdmFsdWU7XG4gICAgICAgICAgb3V0cHV0ID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYoIW91dHB1dCl7XG4gICAgICAgIHRoaXMuYXBwZW5kKHBhcmFtICsgXCI9XCIgKyB2YWx1ZSk7XG4gICAgICB9XG4gICAgICB0aGlzLnVwZGF0ZVNlYXJjaFByb3AoKTtcbiAgICB9XG4gICAgYXBwZW5kKHZhbHVlUGFpcil7XG4gICAgICB0aGlzLl9lbnRyaWVzLnB1c2godmFsdWVQYWlyKTtcbiAgICAgIHRoaXMudXBkYXRlU2VhcmNoUHJvcCgpO1xuICAgIH1cbiAgICBkZWxldGVBbGwoKXtcbiAgICAgIHRoaXMuX2VudHJpZXMgPSBbXTtcbiAgICAgIHRoaXMudXBkYXRlU2VhcmNoUHJvcCgpO1xuICAgIH1cbiAgICBkZWxldGVBdEluZGV4KGluZGV4KXtcbiAgICAgIHRoaXMuX2VudHJpZXMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgIHRoaXMudXBkYXRlU2VhcmNoUHJvcCgpO1xuICAgIH1cbiAgICBkZWxldGUocGFyYW0pe1xuICAgICAgLy9kb2VzbnQgZG8gYW55dGhpbmcgeWV0LlxuICAgICAgZm9yKGxldCBpPTA7aSA8IHRoaXMuX2VudHJpZXMubGVuZ3RoO2krKyl7XG4gICAgICAgIGlmKHRoaXMuX2VudHJpZXNbaV0uc3Vic3RyKDAscGFyYW0ubGVuZ3RoKzEpPT1wYXJhbStcIj1cIil7XG4gICAgICAgICAgdGhpcy5kZWxldGVBdEluZGV4KGkpO1xuICAgICAgICAgIC8vIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZXhwb3J0IGNsYXNzIExpbmtlZEltYWdlIHtcbiAgICBzcmM6IHN0cmluZ3xib29sZWFuO1xuICAgIGFsdDogc3RyaW5nfGJvb2xlYW47XG4gICAgaGVpZ2h0OiBudW1iZXJ8Ym9vbGVhbjtcbiAgICB3aWR0aDogbnVtYmVyfGJvb2xlYW47XG4gICAgY29udGV4dDogc3RyaW5nO1xuICAgIF9zdXBlcjogTGlua09iamVjdDtcblxuXG4gICAgY29uc3RydWN0b3IgKF9zdXBlciwgY29kZSkge1xuICAgICAgdGhpcy5jb250ZXh0ID0gY29kZTtcbiAgICAgIHRoaXMuX3N1cGVyID0gX3N1cGVyO1xuICAgICAgdmFyIHRhZ3MgPSBbXCJzcmNcIiwgXCJhbHRcIiwgXCJoZWlnaHRcIiwgXCJ3aWR0aFwiXTtcbiAgICAgIGZvcihsZXQgdGFnIG9mIHRhZ3Mpe1xuICAgICAgICB2YXIgcmVnZXggPSBuZXcgUmVnRXhwKHRhZytcIj1cXFwiKFteXFxcIl0uKj8pP1xcXCJcIixcImlcIik7XG4gICAgICAgIGlmKHJlZ2V4LnRlc3QoY29kZSkpe1xuICAgICAgICAgIHRoaXNbdGFnXSA9IGNvZGUubWF0Y2gocmVnZXgpWzFdO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBsZXQgaGFzV2lkdGggPSB0aGlzLndpZHRoICYmIHBhcnNlSW50KHRoaXMud2lkdGgudG9TdHJpbmcoKSk7XG4gICAgICBsZXQgaGFzSGVpZ2h0ID0gdGhpcy5oZWlnaHQgJiYgcGFyc2VJbnQodGhpcy5oZWlnaHQudG9TdHJpbmcoKSk7XG5cbiAgICAgIGlmKCFoYXNXaWR0aCB8fCAhaGFzSGVpZ2h0KXtcbiAgICAgICAgaWYodHlwZW9mIHRoaXMuc3JjID09PSBcInN0cmluZ1wiKXtcbiAgICAgICAgICB0aGlzLnByZWxvYWRJbWFnZSh0aGlzLnNyYyk7XG4gICAgICAgIH1cbiAgICAgIH0gLy9laXRoZXIgaXMgbm90IHNldFxuXG4gICAgfVxuICAgIHByZWxvYWRJbWFnZShzcmMpe1xuICAgICAgdmFyIExJID0gdGhpcztcbiAgICAgICAgdmFyIGltZyA9IG5ldyBJbWFnZSgpO1xuICAgICAgICAvLyBpbWcuc3R5bGUudmlzaWJpbGl0eSA9IFwiaGlkZGVuXCI7XG4gICAgICAgIGltZy5vbmxvYWQ9ZnVuY3Rpb24oKXtcbiAgICAgICAgICBMSS5oZWlnaHQgPSBpbWcuaGVpZ2h0O1xuICAgICAgICAgIExJLndpZHRoID0gaW1nLndpZHRoO1xuICAgICAgICAgIGNvbnNvbGUubG9nKGltZy5oZWlnaHQsaW1nLndpZHRoKTtcbiAgICAgICAgICBpbWcucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChpbWcpO1xuICAgICAgICB9O1xuXG5cbiAgICAgICAgaW1nLnNyYyA9IDxzdHJpbmc+TEkuc3JjO1xuICAgICAgICBjb25zb2xlLmxvZyhpbWcpO1xuICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGltZyk7XG4gICAgfVxuICAgIGdlbmVyYXRlT3V0cHV0KGNvbnRlbnQpOnN0cmluZyB7XG4gICAgICB2YXIgX3RoaXM9IHRoaXM7XG4gICAgICBpZih0aGlzLmNvbnRleHQuaW5kZXhPZihcImFsdFwiKT4tMSl7XG4gICAgICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UodGhpcy5jb250ZXh0LCBmdW5jdGlvbihmKXtcbiAgICAgICAgICByZXR1cm4gZi5yZXBsYWNlKC9hbHRcXD1cXFwiKFteXFxcIl0uKj8pP1xcXCIvZywgXCJhbHQ9XFxcIlwiICsgKF90aGlzLmFsdD09PXVuZGVmaW5lZD9cIlwiOl90aGlzLmFsdCkgKyBcIlxcXCJcIik7XG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSh0aGlzLmNvbnRleHQsIGZ1bmN0aW9uKGYpe1xuICAgICAgICAgIHJldHVybiBmLnJlcGxhY2UoXCI8aW1nXCIsIFwiPGltZyBhbHQ9XFxcIlwiKyhfdGhpcy5hbHQ9PT11bmRlZmluZWQ/XCJcIjpfdGhpcy5hbHQpK1wiXFxcIlwiKTt9KTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBjb250ZW50O1xuICAgIH1cbiAgfVxuXG4gIGV4cG9ydCBjbGFzcyBMaW5rT2JqZWN0IHtcbiAgICBfc3VwZXI6IEVNTFdvcmtzcGFjZTtcbiAgICBfX2lzQ29tcGxldGU6IGJvb2xlYW47XG5cblxuICAgIHJlYWRPbmx5OiBib29sZWFuO1xuICAgIGNvbnRleHQ6IHN0cmluZztcbiAgICBkZWxldGVPblJlbmRlcjogYm9vbGVhbjtcbiAgICBlbWFpbFJlZ2V4OiBSZWdFeHA7XG4gICAgZXJyb3JzOiBhbnk7XG4gICAgaWQ6IG51bWJlcjtcbiAgICBsaW5lOiBudW1iZXI7XG4gICAgTGlua2VkSW1hZ2U6IExpbmtlZEltYWdlO1xuICAgIExpbmtlZEltYWdlT2xkOiBMaW5rZWRJbWFnZTtcbiAgICBtYWlsdG86IE1haWx0b0xpbmtPYmplY3Q7XG4gICAgbmV3OiBVUkxPYmo7XG4gICAgb2xkOiBVUkxPYmo7XG4gICAgQ2hhbmdlTW9uaXRvcjogQ2hhbmdlTW9uaXRvcjtcbiAgICBzaG93TWFpbHRvRWRpdG9yOiBib29sZWFuO1xuICAgIHNob3dRdWVyeVN0cmluZ0VkaXRvcjogYm9vbGVhbjtcbiAgICBxdWVyeVN0cmluZ3M6IHN0cmluZ1tdO1xuICAgIC8vIHVybFJlZ2V4OiBSZWdFeHA7XG4gICAgd2hpdGVMaXN0ZWRVcmw6IHN0cmluZztcblxuXG4gICAgY29uc3RydWN0b3IobGluZTogbnVtYmVyLCBjb250ZXh0OiBzdHJpbmcsIHBhcmVudDogRU1MV29ya3NwYWNlKXtcbiAgICAgIHRoaXMuX19pc0NvbXBsZXRlID0gZmFsc2U7XG4gICAgICB0aGlzLl9zdXBlciA9IHBhcmVudDtcblxuICAgICAgdGhpcy5zaG93UXVlcnlTdHJpbmdFZGl0b3IgPSBmYWxzZTtcbiAgICAgIHRoaXMuc2hvd01haWx0b0VkaXRvciA9IGZhbHNlO1xuXG4gICAgICB0aGlzLmlkID0gMDtcbiAgICAgIHRoaXMubGluZSA9IGxpbmUgKyAxO1xuICAgICAgdGhpcy5jb250ZXh0ID0gY29udGV4dDtcbiAgICAgIHRoaXMucXVlcnlTdHJpbmdzID0gW107XG5cbiAgICAgIHRoaXMuQ2hhbmdlTW9uaXRvciA9IG5ldyBDaGFuZ2VNb25pdG9yKHRoaXMpO1xuICAgICAgdGhpcy5lcnJvcnMgPSBFTUxJbnRlbGxpZ2VuY2UubW9kdWxlKFwiaHlwZXJsaW5rXCIpLm1vbml0b3IoKTtcbiAgICAgIHRoaXMuZXJyb3JzLmFzc29jaWF0ZVZhcmlhYmxlKFwiTGlua09iamVjdFwiLCB0aGlzKTtcblxuICAgICAgdGhpcy53aGl0ZUxpc3RlZFVybCA9IFwifn53aGl0ZWxpc3R+flwiO1xuXG4gICAgICAvL2ZpbmQgaHJlZlxuICAgICAgdGhpcy5fX2xvY2F0ZUhyZWYoY29udGV4dCk7XG4gICAgICAvL2ZpbmQgaW1hZ2VcbiAgICAgIHRoaXMuX19sb2NhdGVMaW5rZWRJbWFnZShjb250ZXh0KTtcblxuICAgICAgLy9uZWVkIHRvIHNldCB0aGUgdXJsIGJlZm9yZSB5b3UgZG8gdGhpcztcbiAgICAgIHRoaXMubWFpbHRvID0gbmV3IE1haWx0b0xpbmtPYmplY3QodGhpcyk7XG4gICAgICB0aGlzLmlzTGlua0NvbXBsZXRlKCk7XG4gICAgfVxuICAgIF9fbG9jYXRlSHJlZihjb250ZXh0KXtcbiAgICAgIHZhciByZTIgPSAvaHJlZlxcPVxcXCIoW15cXFwiXFw+XSopXFxcIi9nO1xuICAgICAgdmFyIGhyZWYgPSBjb250ZXh0Lm1hdGNoKHJlMik7XG4gICAgICBpZihocmVmLmxlbmd0aD4wKXtcbiAgICAgICAgaWYoaHJlZlswXT09XCJocmVmPVxcXCJcXFwiXCIpIHtcbiAgICAgICAgICB0aGlzLm5ldyA9ICBuZXcgVVJMT2JqKFwiI1wiKTtcbiAgICAgICAgICB0aGlzLm9sZCA9IG5ldyBVUkxPYmooXCIjXCIpO1xuICAgICAgICAgIHRoaXMuY29udGV4dCA9IHRoaXMuY29udGV4dC5yZXBsYWNlKG5ldyBSZWdFeHAoXCJocmVmPVxcXCJcXFwiXCIsXCJnXCIpLFwiaHJlZj1cXFwiI1xcXCJcIik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5uZXcgPSBuZXcgVVJMT2JqKChocmVmWzBdLnN1YnN0cig2LCBocmVmWzBdLmxlbmd0aC03KSkudHJpbSgpKTtcbiAgICAgICAgICB0aGlzLm9sZCA9IG5ldyBVUkxPYmooKGhyZWZbMF0uc3Vic3RyKDYsIGhyZWZbMF0ubGVuZ3RoLTcpKS50cmltKCkpO1xuICAgICAgICB9XG5cbiAgICAgIH1cbiAgICB9XG4gICAgX19sb2NhdGVMaW5rZWRJbWFnZShjb250ZXh0KXtcbiAgICAgIGlmKC9cXDxpbWcoW14+XS4qPylcXD4vLnRlc3QoY29udGV4dCkpe1xuICAgICAgICB2YXIgZm91bmQgPSBjb250ZXh0Lm1hdGNoKC9cXDxpbWcoW14+XS4qPylcXD4vKTtcbiAgICAgICAgaWYoZm91bmQubGVuZ3RoPjApe1xuICAgICAgICAgIHRoaXMuTGlua2VkSW1hZ2UgPSBuZXcgTGlua2VkSW1hZ2UodGhpcywgZm91bmRbMF0pO1xuICAgICAgICAgIHRoaXMuTGlua2VkSW1hZ2VPbGQgPSBuZXcgTGlua2VkSW1hZ2UodGhpcywgZm91bmRbMF0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgaGFzRHVwbGljYXRlUXVlcnlTdHJpbmdzKCk6IHN0cmluZ1tdfGJvb2xlYW4ge1xuICAgICAgdmFyIHJlc3VsdCA9IFtdLFxuICAgICAgICAgIHVzZWRTdHJpbmdzID0gW107XG5cbiAgICAgIGlmKHRoaXMubmV3LnNlYXJjaFBhcmFtcy5lbnRyaWVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgZm9yKGxldCBhIG9mIHRoaXMubmV3LnNlYXJjaFBhcmFtcy5lbnRyaWVzKXtcbiAgICAgICAgICB2YXIgcGFyYW0gPSBhLnNwbGl0KFwiPVwiKS5zaGlmdCgpO1xuICAgICAgICAgIGlmKHVzZWRTdHJpbmdzLmluZGV4T2YocGFyYW0pPi0xKXtcbiAgICAgICAgICAgIHJlc3VsdC5wdXNoKHBhcmFtKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdXNlZFN0cmluZ3MucHVzaChwYXJhbSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYocmVzdWx0Lmxlbmd0aD4wKXtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cblxuICAgIH1cblxuICAgIG92ZXJyaWRlVHJhY2tpbmdSZXF1aXJlbWVudHMoKXtcbiAgICAgIHRoaXMud2hpdGVMaXN0ZWRVcmwgPSB0aGlzLm5ldy51cmw7XG4gICAgfVxuICAgIGRpc3BsYXlGb3JtYXR0ZWRVUkwoKXtcbiAgICAgIC8vZGlzcGxheXMgdXJsO1xuICAgICAgdmFyIGNvbnRlbnQgPSB0aGlzLmNvbnRleHQ7XG4gICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC9cXHNlbWxcXC1pZFxcPVxcXCIoWzAtOV0qKVxcXCIvLCBcIlwiKTtcblxuICAgICAgdmFyIGZpbmRTdGFydCA9IFwiaHJlZj1cXFwiXCI7XG4gICAgICB2YXIgc3RhcnQgPSBjb250ZW50LmluZGV4T2YoZmluZFN0YXJ0KTtcbiAgICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UobmV3IFJlZ0V4cChcImhyZWY9XFxcIlxcXCJcIixcImdcIiksIFwiaHJlZj1cXFwiI1xcXCJcIik7XG4gICAgICAvLyB2YXIgaW1nUmVnID0gL1xcPGltZyhbXj5dLio/KVxcPi9nO1xuICAgICAgaWYodGhpcy5MaW5rZWRJbWFnZSl7XG4gICAgICAgIGNvbnRlbnQgPSB0aGlzLkxpbmtlZEltYWdlLmdlbmVyYXRlT3V0cHV0KGNvbnRlbnQpO1xuICAgICAgfVxuICAgICAgY29udGVudCA9IGNvbnRlbnQuc3Vic3RyKDAsIHN0YXJ0KSArIGZpbmRTdGFydCsgXCJ8fHxhLmhyZWZ8fHxcIiArIGNvbnRlbnQuc3Vic3RyKHN0YXJ0ICsgKGZpbmRTdGFydC5sZW5ndGgrKHRoaXMub2xkLnVybC5sZW5ndGgpKSwgY29udGVudC5sZW5ndGggKSA7XG4gICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKG5ldyBSZWdFeHAoXCJcXFwiXCIsXCJnXCIpLCBcIiZxdW90O1wiKTtcbiAgICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UobmV3IFJlZ0V4cChcIi9cIixcImdcIiksIFwiJiM0NztcIik7XG4gICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKG5ldyBSZWdFeHAoXCI+XCIsXCJnXCIpLCBcIiZndDtcIik7XG4gICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKG5ldyBSZWdFeHAoXCI8XCIsXCJnXCIpLCBcIiZsdDtcIik7XG5cblxuICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvKFteXFxzXSo/KVxcPS9nLFwiPHNwYW4gY2xhc3M9XFxcImF0dHJcXFwiPiQxPC9zcGFuPjxzcGFuIGNsYXNzPVxcXCJrZXl3b3JkXFxcIj49PC9zcGFuPlwiKTtcbiAgICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoL1xcJnF1b3RcXDtcXCZndFxcOy9nLFwiJnF1b3Q7PHNwYW4gY2xhc3M9XFxcInRhZ1xcXCI+Jmd0Ozwvc3Bhbj5cIik7XG4gICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC9cXCZcXCM0N1xcO1xcJmd0XFw7L2csXCI8c3BhbiBjbGFzcz1cXFwidGFnXFxcIj4mIzQ3OyZndDs8L3NwYW4+XCIpO1xuICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvXFwmcXVvdFxcOyguKj8pXFwmcXVvdFxcOy9nLFwiPHNwYW4gY2xhc3M9XFxcInZhbHVlXFxcIj5cXFwiJDFcXFwiPC9zcGFuPlwiKTtcbiAgICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoL1xcJmx0XFw7KFthLXpdK1xccz8pL2csXCI8c3BhbiBjbGFzcz1cXFwidGFnXFxcIj4mbHQ7JDE8L3NwYW4+XCIpO1xuICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvXFwmbHRcXDtcXCZcXCM0N1xcOyhbYS16XStcXHM/KVxcJmd0XFw7L2csXCI8c3BhbiBjbGFzcz1cXFwidGFnXFxcIj4mbHQ7JiM0NzskMSZndDs8L3NwYW4+XCIpO1xuICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvXFxuL2csXCI8YnI+XCIpO1xuXG4gICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC9cXCZndFxcOy9nLFwiPHNwYW4gY2xhc3M9XFxcInRhZ1xcXCI+Jmd0Ozwvc3Bhbj5cIik7XG4gICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC9cXHN7M30vZyxcIiZuYnNwOyZuYnNwOyZuYnNwXCIpO1xuXG4gICAgICAvLyBpZih0aGlzLkxpbmtlZEltYWdlKSB7XG4gICAgICAvLyAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoL1xcfFxcfFxcfGltZ1xcLmFsdFxcfFxcfFxcfC9nLCB0aGlzLkxpbmtlZEltYWdlLmFsdCA9PT0gdW5kZWZpbmVkID8gXCJcIiA6IHRoaXMuTGlua2VkSW1hZ2UuYWx0KTtcbiAgICAgIC8vIH1cblxuICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvXFx8XFx8XFx8YVxcLmhyZWZcXHxcXHxcXHwvZywgXCI8c3Ryb25nPlwiKyh0aGlzLmhhc093blByb3BlcnR5KFwiZGVsZXRlT25SZW5kZXJcIikgJiYgdGhpcy5kZWxldGVPblJlbmRlciA/IHRoaXMub2xkLnVybCA6IHRoaXMubmV3LnVybCkrXCI8L3N0cm9uZz5cIik7XG5cblxuXG5cblxuICAgICAgcmV0dXJuIGNvbnRlbnQ7XG4gICAgfVxuXG4gICAgaXNMaW5rQ29tcGxldGUoKXtcbiAgICAgIC8vaW50ZWxsaWdlbmNlIHNjYW5zOlxuICAgICAgdGhpcy5fc3VwZXIuaW50ZWxsaWdlbmNlLmV2YWx1YXRlUnVsZXMoKTtcbiAgICAgIHRoaXMuZXJyb3JzLmV2YWx1YXRlUnVsZXMoKTtcbiAgICAgIC8vdHJhY2sgY2hhbmdlczpcbiAgICAgIHRoaXMuQ2hhbmdlTW9uaXRvci51cGRhdGUoKTtcblxuICAgICAgdGhpcy5fX2lzQ29tcGxldGU9IHRoaXMuZXJyb3JzLmNhbkNvbnRpbnVlO1xuICAgICAgaWYodGhpcy5oYXNPd25Qcm9wZXJ0eShcImRlbGV0ZU9uUmVuZGVyXCIpJiYgdGhpcy5kZWxldGVPblJlbmRlcikgdGhpcy5fX2lzQ29tcGxldGUgPSB0cnVlO1xuICAgICAgcmV0dXJuIHRoaXMuX19pc0NvbXBsZXRlO1xuICAgIH1cblxuICAgIGlzTGlua1R5cGUodHlwZSk6IGJvb2xlYW4ge1xuICAgICAgdmFyIG91dHB1dCA9IGZhbHNlO1xuICAgICAgc3dpdGNoICh0eXBlKSB7XG4gICAgICAgIGNhc2UgXCJodHRwXCI6XG4gICAgICAgICAgaWYodGhpcy5uZXcucHJvdG9jb2w9PVwiaHR0cDpcIiB8fCB0aGlzLm5ldy5wcm90b2NvbD09XCJodHRwczpcIil7XG4gICAgICAgICAgICBvdXRwdXQgPSB0cnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBcIm1haWx0b1wiOlxuICAgICAgICAgIGlmKHRoaXMubmV3LnByb3RvY29sPT1cIm1haWx0bzpcIil7XG4gICAgICAgICAgICBvdXRwdXQgPSB0cnVlO1xuICAgICAgICAgIH1cbiAgICAgICAgICBicmVhaztcbiAgICAgICAgZGVmYXVsdDpcblxuICAgICAgfVxuICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICB9XG5cbiAgICBoYXNUcmFja2luZ0NvZGUob2JqPyk6IGJvb2xlYW4gey8vc3VzcGVjdFxuICAgICAgaWYob2JqPT09dW5kZWZpbmVkKSBvYmogPSB0aGlzLm5ldy51cmw7XG4gICAgICAvLyBpZih0aGlzLndoaXRlTGlzdGVkVXJsPT10aGlzLm5ldykgcmV0dXJuIHRydWU7XG4gICAgICB2YXIgYSA9IC9bYS16XXsxLDR9PSguKj86KXszLDl9L2lnO1xuICAgICAgcmV0dXJuIGEudGVzdChvYmopO1xuICAgIH1cbiAgICByZXF1aXJlc1RyYWNraW5nQ29kZShvYmo/KTogYm9vbGVhbiB7XG4gICAgICB2YXIgb3V0cHV0OiBib29sZWFuID0gZmFsc2U7XG4gICAgICBpZihHbG9iYWxWYXJzLlJlcXVpcmVzVHJhY2tpbmdDb2RlUmVnZXgudGVzdCh0aGlzLm5ldy51cmwpKSB7XG4gICAgICAgIG91dHB1dCA9IHRydWU7XG4gICAgICAgIC8vIGl0ZXJhdGUgb2ZlciB3aGl0ZWxpc3RcbiAgICAgICAgZm9yKHZhciBpID0wOyBpIDwgR2xvYmFsVmFycy5SZXF1aXJlZFRyYWNraW5nQ29kZVdoaXRlbGlzdC5sZW5ndGg7IGkrKyl7XG4gICAgICAgICAgaWYoIEdsb2JhbFZhcnMuUmVxdWlyZWRUcmFja2luZ0NvZGVXaGl0ZWxpc3RbaV0gaW5zdGFuY2VvZiBSZWdFeHApIHtcbiAgICAgICAgICAgIGlmKEdsb2JhbFZhcnMuUmVxdWlyZWRUcmFja2luZ0NvZGVXaGl0ZWxpc3RbaV1bXCJ0ZXN0XCJdKHRoaXMubmV3LnVybCkpIHsgb3V0cHV0ID0gZmFsc2U7IH1cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYodGhpcy5uZXcudXJsLmluZGV4T2YoR2xvYmFsVmFycy5SZXF1aXJlZFRyYWNraW5nQ29kZVdoaXRlbGlzdFtpXSk+LTEpIHsgb3V0cHV0ID0gZmFsc2U7IH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgfVxuICAgIHJlcXVpcmVzU0NvZGUoKTogYm9vbGVhbiB7XG4gICAgICBpZihHbG9iYWxWYXJzLlJlcXVpcmVzU0NvZGVSZWdleC50ZXN0KHRoaXMubmV3LnVybCkpe1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9XG4gICAgbmVlZHNUcmFja2luZ0NvZGUoKTogYm9vbGVhbiB7XG4gICAgICB2YXIgb3V0cHV0OiBib29sZWFuID0gdGhpcy5yZXF1aXJlc1RyYWNraW5nQ29kZSgpO1xuICAgICAgaWYodGhpcy53aGl0ZUxpc3RlZFVybD09dGhpcy5uZXcudXJsKSByZXR1cm4gZmFsc2U7XG4gICAgICAvLyBkZXRlcm1pbmUgbGlua3MgdGhhdCBuZWVkIHNwZWNpYWwgdHJhY2tpbmdcbiAgICAgIGlmKHRoaXMuaGFzVHJhY2tpbmdDb2RlKCkgKXtcbiAgICAgICAgb3V0cHV0ID0gZmFsc2U7XG4gICAgICB9XG4gICAgICByZXR1cm4gb3V0cHV0O1xuICAgIH1cbiAgICB1cGRhdGVJbnB1dCgpe1xuICAgICAgaWYodGhpcy5pc0xpbmtUeXBlKCdtYWlsdG8nKSl7XG4gICAgICAgIHRoaXMubWFpbHRvLnVwZGF0ZU1haWx0b09iaigpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5uZXcuc2VhcmNoUGFyYW1zLnVwZGF0ZUVudHJpZXMoKVxuICAgICAgfVxuICAgICAgdGhpcy5pc0xpbmtDb21wbGV0ZSgpO1xuICAgIH1cblxuICB9XG5cblxuXG5cbiAgZXhwb3J0IGNsYXNzIENoYW5nZU1vbml0b3J7XG4gICAgX3N1cGVyOiBMaW5rT2JqZWN0O1xuICAgIG1lc3NhZ2VzOiBDaGFuZ2VNb25pdG9yTXNnW107XG4gICAgdmlzaWJsZTogYm9vbGVhbjtcblxuICAgIGNvbnN0cnVjdG9yKF9zdXBlcil7XG4gICAgICB0aGlzLnZpc2libGUgPSBmYWxzZTtcbiAgICAgIHRoaXMuX3N1cGVyID0gX3N1cGVyO1xuICAgICAgdGhpcy5tZXNzYWdlcyA9IFtdO1xuICAgIH1cbiAgICBjb21wYXJlT2xkQW5kTmV3KCk6IHN0cmluZ1tde1xuICAgICAgbGV0IHVybFBhcmFtcyA9IFtcInByb3RvY29sXCIsXCJvcmlnaW5cIixcInNlYXJjaFwiLFwiaGFzaFwiXTtcbiAgICAgIHZhciBjaGFuZ2VkID0gW107XG4gICAgICB2YXIgX3N1cGVyID0gdGhpcy5fc3VwZXI7XG4gICAgICB1cmxQYXJhbXMuZm9yRWFjaChmdW5jdGlvbihwYXJhbSl7XG4gICAgICAgIGlmKF9zdXBlci5vbGQuaGFzT3duUHJvcGVydHkocGFyYW0pICYmIF9zdXBlci5vbGRbcGFyYW1dIT09IF9zdXBlci5uZXdbcGFyYW1dKXtcbiAgICAgICAgICBjaGFuZ2VkLnB1c2gocGFyYW0pO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIGlmKF9zdXBlci5MaW5rZWRJbWFnZSAmJiBfc3VwZXIuTGlua2VkSW1hZ2UuYWx0IT09X3N1cGVyLkxpbmtlZEltYWdlT2xkLmFsdCl7XG4gICAgICAgIGNoYW5nZWQucHVzaChcImFsdFwiKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBjaGFuZ2VkO1xuICAgIH1cbiAgICBiZWZvcmVEaWRSZXR1cm5DaGFuZ2VzKCl7IH1cbiAgICBhZnRlckRpZFJldHVybkNoYW5nZXMoKXsgfVxuICAgIHVwZGF0ZSgpe1xuICAgICAgaWYodGhpcy5fc3VwZXIucmVhZE9ubHkgPT0gZmFsc2Upe1xuICAgICAgICB2YXIgb3V0cHV0ID0gW107XG4gICAgICAgIGxldCBjaGFuZ2VzID0gdGhpcy5jb21wYXJlT2xkQW5kTmV3KCk7XG4gICAgICAgIHZhciBDTSA9IHRoaXM7XG4gICAgICAgIGNoYW5nZXMuZm9yRWFjaChmdW5jdGlvbihzY29wZSl7XG4gICAgICAgICAgb3V0cHV0LnB1c2goQ00uYXJ0aWN1bGF0ZUNoYW5nZXMoc2NvcGUsIHt9KSk7XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLm1lc3NhZ2VzID0gb3V0cHV0O1xuICAgICAgfVxuICAgIH1cblxuICAgIGNvbXBhcmVTZWFyY2hTdHJpbmdzKG9sZFAsIG5ld1ApOiBTZWFyY2hTdHJpbmdQYXlsb2FkIHtcbiAgICAgIHZhciBwYXlsb2FkOiBTZWFyY2hTdHJpbmdQYXlsb2FkID0ge1xuICAgICAgICBhZGRlZDogW10sXG4gICAgICAgIHVwZGF0ZWQ6IFtdLFxuICAgICAgICByZW1vdmVkOltdXG4gICAgICB9O1xuICAgICAgZm9yKHZhciBpIGluIG9sZFApe1xuICAgICAgICBpZihuZXdQLmluZGV4T2Yob2xkUFtpXSk9PT0tMSl7IHBheWxvYWQucmVtb3ZlZC5wdXNoKG9sZFBbaV0pIH1cbiAgICAgIH1cbiAgICAgIGZvcihpIGluIG5ld1Ape1xuICAgICAgICBpZihvbGRQLmluZGV4T2YobmV3UFtpXSk9PT0tMSl7IHBheWxvYWQuYWRkZWQucHVzaChuZXdQW2ldKSB9XG4gICAgICB9XG4gICAgICBsZXQgZmluZF9wYXR0ZXJuX2luQXJyYXkgPSBmdW5jdGlvbihwYXR0ZXJuOlJlZ0V4cCwgYXJyOiBzdHJpbmdbXSl7XG4gICAgICAgIHZhciBvdXRwdXQ6IG51bWJlciA9IC0xO1xuICAgICAgICAgZm9yKHZhciB5PTA7eTxhcnIubGVuZ3RoO3krKyl7XG4gICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwidXVwZGF0cmVkP1wiLHkpO1xuICAgICAgICAgICBpZihwYXR0ZXJuLnRlc3QoYXJyW3ldKSl7XG4gICAgICAgICAgICAgb3V0cHV0ID0geTtcbiAgICAgICAgICAgfVxuICAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0cHV0O1xuICAgICAgfTtcbiAgICAgIGZvcihpIGluIG9sZFApe1xuICAgICAgICB2YXIgcmUgPSBuZXcgUmVnRXhwKG9sZFBbaV0uc3BsaXQoXCI9XCIpWzBdK1wiPVwiKTtcbiAgICAgICAgdmFyIGZvdW5kID0gZmluZF9wYXR0ZXJuX2luQXJyYXkocmUsIHBheWxvYWQuYWRkZWQpO1xuICAgICAgICBpZihmb3VuZD4tMSl7XG4gICAgICAgICAgcGF5bG9hZC51cGRhdGVkLnB1c2gocGF5bG9hZC5hZGRlZFtmb3VuZF0pO1xuICAgICAgICAgIHZhciBvdGhlciA9IGZpbmRfcGF0dGVybl9pbkFycmF5KHJlLCBwYXlsb2FkLnJlbW92ZWQpO1xuICAgICAgICAgIHBheWxvYWQucmVtb3ZlZC5zcGxpY2Uob3RoZXIsMSk7XG4gICAgICAgICAgcGF5bG9hZC5hZGRlZC5zcGxpY2UoZm91bmQsMSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBwYXlsb2FkO1xuICAgIH1cbiAgICBhcnRpY3VsYXRlQ2hhbmdlcyhzY29wZSwgYXJncyk6IHttZXNzYWdlOiBzdHJpbmcsIGRhdGE6IGFueX0ge1xuICAgICAgaWYoc2NvcGU9PVwicHJvdG9jb2xcIil7XG4gICAgICAgIGlmKHRoaXMuX3N1cGVyLm5ldy5wcm90b2NvbCA9PSBcIm1haWx0bzpcIil7XG4gICAgICAgICAgcmV0dXJuIHttZXNzYWdlOiBcIkNoYW5nZWQgdG8gbWFpbHRvIGxpbmsuXCIsIGRhdGE6IFtdfTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgbWVzc2FnZTogKHRoaXMuX3N1cGVyLm9sZC5wcm90b2NvbD09XCJcIiA/IFwiVXBkYXRlZFwiIDogXCJDaGFuZ2VkXCIpK1wiIHByb3RvY29sIHRvIFwiICsgdGhpcy5fc3VwZXIubmV3LnByb3RvY29sLFxuICAgICAgICAgICAgZGF0YTogW11cbiAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYoc2NvcGU9PVwib3JpZ2luXCIpe1xuICAgICAgICBpZih0aGlzLl9zdXBlci5uZXcucHJvdG9jb2wgPT0gXCJtYWlsdG86XCIpe1xuICAgICAgICAgIHJldHVybiB7bWVzc2FnZTogXCJDaGFuZ2VkIG1haWx0byBsaW5rIHRvIFwiICsgdGhpcy5fc3VwZXIubmV3Lm9yaWdpbiwgZGF0YTogW119O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiB7bWVzc2FnZTogXCJDaGFuZ2VkIGxpbmsgVVJMIHRvIFwiICsgdGhpcy5fc3VwZXIubmV3Lm9yaWdpbiwgZGF0YTogW119O1xuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYoc2NvcGU9PVwiYWx0XCIpIHtcbiAgICAgICAgaWYodGhpcy5fc3VwZXIuTGlua2VkSW1hZ2UuYWx0ID09IFwiXCIpe1xuICAgICAgICAgIHJldHVybiB7bWVzc2FnZTogXCJSZW1vdmVkIGxpbmtlZCBpbWFnZSBBTFQgdGV4dFwiLCBkYXRhOiBbXX07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIHttZXNzYWdlOiBcIlVwZGF0ZWQgbGlua2VkIGltYWdlIEFMVCB0ZXh0IHRvIDxiPlwiICsgdGhpcy5fc3VwZXIuTGlua2VkSW1hZ2UuYWx0ICsgXCI8L2I+XCIsIGRhdGE6IFtdfTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmKHNjb3BlPT1cInNlYXJjaFwiKSB7XG5cbiAgICAgICAgbGV0IG9sZFBhcmFtcyA9IHRoaXMuX3N1cGVyLm9sZC5zZWFyY2hQYXJhbXMuX2VudHJpZXM7XG4gICAgICAgIGxldCBuZXdQYXJhbXMgPSB0aGlzLl9zdXBlci5uZXcuc2VhcmNoUGFyYW1zLl9lbnRyaWVzO1xuXG4gICAgICAgIGxldCBzZWFyY2hDaGFuZ2VzID0gdGhpcy5jb21wYXJlU2VhcmNoU3RyaW5ncyhvbGRQYXJhbXMsIG5ld1BhcmFtcyk7XG5cbiAgICAgICAgdmFyIG1lc3NhZ2UgPSBcIlwiO1xuICAgICAgICB2YXIgX3N1cGVyID0gdGhpcy5fc3VwZXI7XG4gICAgICAgIFtcInVwZGF0ZWRcIixcImFkZGVkXCIsXCJyZW1vdmVkXCJdLmZvckVhY2goZnVuY3Rpb24oa2V5KXtcbiAgICAgICAgICBpZihzZWFyY2hDaGFuZ2VzW2tleV0ubGVuZ3RoPjApe1xuICAgICAgICAgICAgbWVzc2FnZSA9IG1lc3NhZ2UgKyBrZXlbMF0udG9VcHBlckNhc2UoKStrZXkuc3Vic3RyKDEsa2V5Lmxlbmd0aCkgKyBcIiBcIisoX3N1cGVyLm5ldy5wcm90b2NvbD09XCJtYWlsdG86XCIgPyBcInBhcmFtZXRlclwiIDogXCJxdWVyeSBzdHJpbmdcIikrKHNlYXJjaENoYW5nZXNba2V5XS5sZW5ndGg+MSA/IFwic1wiOiBcIlwiKSArIFwiOiA8Yj5cIiArIHNlYXJjaENoYW5nZXNba2V5XS5qb2luKFwiLCBcIikgKyBcIjwvYj48YnI+XCI7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4geyBtZXNzYWdlOiBtZXNzYWdlLCBkYXRhOiBbXSB9O1xuXG5cbiAgICAgIH0gZWxzZSBpZihzY29wZT09XCJoYXNoXCIpIHtcbiAgICAgICAgaWYodGhpcy5fc3VwZXIub2xkLmhhc2ggPT1cIlwiKSB7XG4gICAgICAgICAgcmV0dXJuIHttZXNzYWdlOiBcIllvdSBhZGRlZCB0aGUgaGFzaCBcIiArIHRoaXMuX3N1cGVyLm5ldy5oYXNoLCBkYXRhOltdfTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpZih0aGlzLl9zdXBlci5uZXcuaGFzaCA9PVwiXCIpe1xuICAgICAgICAgICAgcmV0dXJuIHttZXNzYWdlOiBcIllvdSByZW1vdmVkIHRoZSBoYXNoIFwiICsgdGhpcy5fc3VwZXIub2xkLmhhc2gsIGRhdGE6W119O1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4ge21lc3NhZ2U6IFwiWW91IGNoYW5nZWQgdGhlIGhhc2ggZnJvbSBcIiArIHRoaXMuX3N1cGVyLm9sZC5oYXNoICsgXCIgdG8gXCIgKyB0aGlzLl9zdXBlci5uZXcuaGFzaCwgZGF0YTpbXX07XG4gICAgICAgICAgfVxuXG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgIH1cbiAgfVxuICBleHBvcnQgY2xhc3MgRU1MV29ya3NwYWNlIHtcblxuICAgIHNjb3BlOiBhbnk7XG4gICAgYnVmZmVyOiBhbnk7XG4gICAgbGlua3NWaWV3OiBzdHJpbmc7XG4gICAgc291cmNlQ29kZTogc3RyaW5nO1xuICAgIHdvcmtpbmdDb2RlOiBzdHJpbmc7XG4gICAgb3V0cHV0Q29kZTogc3RyaW5nO1xuICAgIGludGVsbGlnZW5jZTogYW55O1xuICAgIG92ZXJyaWRkZW5JZHM6c3RyaW5nW107XG4gICAga2V5Qm9hcmRTaG9ydGN1dHM6IGFueVtdO1xuICAgIG1lc3NhZ2VzOiBhbnlbXTtcbiAgICBmaWxlTmFtZTogc3RyaW5nO1xuICAgIGxpbmtEYXRhOiBMaW5rT2JqZWN0W107XG4gICAgX2RlZmF1bHRTQ29kZTogc3RyaW5nO1xuICAgIGhlYWRlcjogYW55O1xuICAgIGVycm9yczogYW55O1xuICAgIGV4cG9ydEZvckVsb3F1YTogc3RyaW5nO1xuICAgIF9fZW1sSGVhZGVyczogc3RyaW5nO1xuICAgIF9fYWxsb3dhYmxlSGVhZGVyRmllbGRzOiBhbnk7XG4gICAgaGVhZGVyczogc3RyaW5nW107XG5cbiAgICBjb25zdHJ1Y3RvcihodG1sOiBzdHJpbmcsICRzY29wZTogYW55KXtcbiAgICAgIHRoaXMub3ZlcnJpZGRlbklkcyA9IFtdO1xuICAgICAgaWYoIGh0bWwgPT09IHVuZGVmaW5lZCkgaHRtbCA9IFwiXCI7XG4gICAgICBpZiggJHNjb3BlID09PSB1bmRlZmluZWQpICRzY29wZSA9IFwiXCI7XG4gICAgICB2YXIgV29ya3NwYWNlID0gdGhpcztcbiAgICAgIHRoaXMuYnVmZmVyID0gbnVsbDtcbiAgICAgIHRoaXMuc2NvcGUgPSAkc2NvcGU7XG4gICAgICB0aGlzLmxpbmtzVmlldyA9ICdleHBlcmltZW50YWwnOyAvL2FkdmFuY2VkIHNob3dzIGFsbFxuICAgICAgdGhpcy5zb3VyY2VDb2RlID0gaHRtbDsgLy9pbml0YWxcbiAgICAgIHRoaXMud29ya2luZ0NvZGUgPSBcIlwiO1xuICAgICAgdGhpcy5maWxlTmFtZSA9IFwiZW1sLW1ha2VyLXVudGl0bGVkXCI7XG4gICAgICB0aGlzLmxpbmtEYXRhID0gW107XG4gICAgICB0aGlzLl9kZWZhdWx0U0NvZGUgPSBcInM9ZW1haWxcIjtcbiAgICAgIHRoaXMuaGVhZGVyID0ge1wic3ViamVjdFwiOlwiXCJ9O1xuICAgICAgdGhpcy5tZXNzYWdlcyA9IFtdO1xuICAgICAgdGhpcy5leHBvcnRGb3JFbG9xdWEgID0gXCJZZXNcIjtcblxuICAgICAgdGhpcy5fX2VtbEhlYWRlcnMgPSBcIlwiO1xuICAgICAgdGhpcy5rZXlCb2FyZFNob3J0Y3V0cyA9IFtdO1xuICAgICAgdGhpcy5fX2FsbG93YWJsZUhlYWRlckZpZWxkcyA9IHtcbiAgICAgICAgXCJ0b1wiOiB7c3ludGF4OlwiVG86IFwiLCBsYWJlbDpcIlRvXCIsIGluc3RydWN0aW9uczogXCJBIGxpc3Qgb2YgZW1haWwgYWRkcmVzc2VzIHNlcGFyYXRlZCBieSBjb21tYXMuXCJ9LFxuICAgICAgICBcInN1YmplY3RcIjoge3N5bnRheDogXCJTdWJqZWN0OiBcIiwgbGFiZWw6XCJTdWJqZWN0XCIsIGluc3RydWN0aW9uczogXCJcIn0sXG4gICAgICAgIFwiY2NcIiA6IHtzeW50YXg6XCJDYzogXCIsIGxhYmVsOlwiQ0NcIiwgaW5zdHJ1Y3Rpb25zOiBcIkEgbGlzdCBvZiBlbWFpbCBhZGRyZXNzZXMgc2VwYXJhdGVkIGJ5IGNvbW1hcy5cIn0sXG4gICAgICAgIFwicmVwbHl0b1wiOiB7IHN5bnRheDpcIlJlcGx5LXRvOiBcIiwgbGFiZWw6XCJSZXBseSB0b1wiLCBpbnN0cnVjdGlvbnM6IFwiQSBsaXN0IG9mIGVtYWlsIGFkZHJlc3NlcyBzZXBhcmF0ZWQgYnkgY29tbWFzLlwifVxuICAgICAgfTtcbiAgICAgIHRoaXMuaGVhZGVycyA9IFtcbiAgICAgICAgXCJYLVVuc2VudDogMVwiLFxuICAgICAgICBcIk1pbWUtVmVyc2lvbjogMS4wIChNYWMgT1MgWCBNYWlsIDEwLjEgXFwoMzI1MVxcKSlcIixcbiAgICAgICAgXCJYLVVuaWZvcm0tVHlwZS1JZGVudGlmaWVyOiBjb20uYXBwbGUubWFpbC1kcmFmdFwiLFxuICAgICAgICBcIkNvbnRlbnQtVHJhbnNmZXItRW5jb2Rpbmc6IDdiaXRcIlxuICAgICAgXTtcbiAgICAgIHRoaXMuaW50ZWxsaWdlbmNlID0gRU1MSW50ZWxsaWdlbmNlLm1vZHVsZShcImVtYWlsXCIpLm1vbml0b3IoKTtcbiAgICAgIHRoaXMuaW50ZWxsaWdlbmNlLmFzc29jaWF0ZVZhcmlhYmxlKFwiRU1MV29ya3NwYWNlXCIsIHRoaXMpO1xuICAgIH1cbiAgICBtYXBMaW5rT2JqZWN0cyhjYWxsYmFjayl7XG4gICAgICBpZih0aGlzLmxpbmtEYXRhLmxlbmd0aD4wKXtcbiAgICAgICAgZm9yKHZhciBpPTA7IGk8dGhpcy5saW5rRGF0YS5sZW5ndGg7IGkrKyl7XG4gICAgICAgICAgY2FsbGJhY2sodGhpcy5saW5rRGF0YVtpXSk7XG4gICAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBjb21wb3NlRU1MKCk6dm9pZHtcbiAgICAgIGxvY2F0aW9uLmhyZWY9IFwiIy9leHBvcnQtY29tcG9zZS1lbWxcIjtcbiAgICB9XG5cbiAgICBkb3dubG9hZEVtbCgpOnZvaWR7XG4gICAgICB0aGlzLmJlZm9yZURpZERvd25sb2FkRW1sKCk7XG4gICAgICB2YXIgb3V0cHV0ID0gdGhpcy5fX2VtbEhlYWRlcnMgKyBcIlxcblxcblwiICsgdGhpcy5fX3JlbW92ZVdoaXRlU3BhY2UodGhpcy5fX3JlcGxhY2VFbG9xdWFNZXJnZUZpZWxkcyh0aGlzLmdlbmVyYXRlT3V0cHV0Q29kZShcIm9mdFwiKSkpO1xuICAgICAgdGhpcy5maWxlTmFtZSA9IHRoaXMuX19mb3JtYXRGaWxlTmFtZSh0aGlzLmZpbGVOYW1lKTtcbiAgICAgIHdpbmRvdy5zYXZlQXMobmV3IEJsb2IoW291dHB1dF0sIHt0eXBlOlwidGV4dC9odG1sXCJ9KSwgdGhpcy5maWxlTmFtZStcIi5lbWxcIik7XG4gICAgICB0aGlzLmFmdGVyRGlkRG93bmxvYWRFbWwoKTtcbiAgICB9XG4gICAgYmVmb3JlRGlkRG93bmxvYWRFbWwoKXtcbiAgICAgIHRoaXMubWFwTGlua09iamVjdHMoZnVuY3Rpb24oTGlua09iamVjdCl7XG4gICAgICAgIGlmKExpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5oYXMoXCJlbHFUcmFja1wiKSl7XG4gICAgICAgICAgbGV0IGluZGV4ID0gTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLmVudHJpZXMuaW5kZXhPZihcImVscVRyYWNrPXRydWVcIik7XG4gICAgICAgICAgaWYoaW5kZXg+LTEpe1xuICAgICAgICAgICAgTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLmRlbGV0ZUF0SW5kZXgoaW5kZXgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZighTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLmhhcyhcInNcIikmJiBMaW5rT2JqZWN0LnJlcXVpcmVzU0NvZGUoKSl7XG4gICAgICAgICAgTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLmFwcGVuZChcInM9b2Z0XCIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmKExpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5nZXQoXCJzXCIpPT1cImVtYWlsXCIpe1xuICAgICAgICAgICAgTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLnNldChcInNcIixcIm9mdFwiKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgdGhpcy5tYXBMaW5rT2JqZWN0cyhmdW5jdGlvbihMaW5rT2JqZWN0KXtcbiAgICAgICAgTGlua09iamVjdC5DaGFuZ2VNb25pdG9yLnVwZGF0ZSgpO1xuICAgICAgfSk7XG4gICAgfVxuICAgIGFmdGVyRGlkRG93bmxvYWRFbWwoKXtcbiAgICAgIHdpbmRvdy5nYSgnc2VuZCcsICdldmVudCcsIFwiRU1MXCIsIFwiZG93bmxvYWRcIiwgXCJFTUwgRXhwb3J0XCIpO1xuICAgICAgbG9jYXRpb24uaHJlZj0gXCIjL2V4cG9ydC1lbWxcIjtcbiAgICB9XG5cbiAgICBkb3dubG9hZENzdigpOnZvaWR7XG4gICAgICB2YXIgb3V0cHV0ID0gXCJDb250ZXh0LE9yaWdpbmFsIFVSTCxNb2RpZmllZCBVUkxcXG5cIjtcbiAgICAgIHRoaXMubWFwTGlua09iamVjdHMoZnVuY3Rpb24oTGlua09iamVjdCkge1xuICAgICAgICBvdXRwdXQgKz0gTGlua09iamVjdC5jb250ZXh0LnJlcGxhY2UoLywvZywgXCIoY29tbWEpXCIpICsgXCIsXCIgKyBMaW5rT2JqZWN0Lm9sZC51cmwgKyBcIixcIiArTGlua09iamVjdC5uZXcudXJsICsgXCJcXG5cIjtcbiAgICAgIH0pO1xuICAgICAgdGhpcy5maWxlTmFtZSA9IHRoaXMuX19mb3JtYXRGaWxlTmFtZSh0aGlzLmZpbGVOYW1lKTtcbiAgICAgIHdpbmRvdy5zYXZlQXMobmV3IEJsb2IoW291dHB1dF0sIHt0eXBlOlwidGV4dC9jc3ZcIn0pLCB0aGlzLmZpbGVOYW1lK1wiX2xpbmtzLmNzdlwiKTtcbiAgICAgIHdpbmRvdy5nYSgnc2VuZCcsICdldmVudCcsIFwiQ1NWXCIsIFwiZG93bmxvYWRcIiwgXCJDU1YgRXhwb3J0XCIpO1xuICAgIH1cblxuICAgIGRvd25sb2FkSHRtbCgpOnZvaWR7XG4gICAgICB2YXIgb3V0cHV0ID0gdGhpcy5iZWZvcmVEaWREb3dubG9hZEh0bWwodGhpcy5nZW5lcmF0ZU91dHB1dENvZGUoXCJlbWFpbFwiKSk7XG4gICAgICB0aGlzLmZpbGVOYW1lID0gdGhpcy5fX2Zvcm1hdEZpbGVOYW1lKHRoaXMuZmlsZU5hbWUpO1xuICAgICAgd2luZG93LnNhdmVBcyhuZXcgQmxvYihbb3V0cHV0XSwge3R5cGU6XCJ0ZXh0L2h0bWxcIn0pLCB0aGlzLmZpbGVOYW1lK1wiLmh0bWxcIik7XG4gICAgICB0aGlzLmFmdGVyRGlkRG93bmxvYWRIdG1sKCk7XG4gICAgfVxuICAgIGJlZm9yZURpZERvd25sb2FkSHRtbChjb2RlKXtcbiAgICAgIHJldHVybiBjb2RlO1xuICAgIH1cbiAgICBhZnRlckRpZERvd25sb2FkSHRtbCgpe1xuICAgICAgd2luZG93LmdhKCdzZW5kJywgJ2V2ZW50JywgXCJIVE1MXCIsIFwiZG93bmxvYWRcIiwgXCJIVE1MIEV4cG9ydFwiKTtcbiAgICB9XG5cblxuICAgIGV4cG9ydENvZGVUb0hUTUwoKTp2b2lke1xuICAgICAgdGhpcy5iZWZvcmVEaWRFeHBvcnRDb2RlVG9IVE1MKCk7XG4gICAgICB0aGlzLm91dHB1dENvZGUgPSB0aGlzLmdlbmVyYXRlT3V0cHV0Q29kZShcImVtYWlsXCIpO1xuICAgICAgdGhpcy5hZnRlckRpZEV4cG9ydENvZGVUb0hUTUwoKTtcbiAgICB9XG4gICAgYmVmb3JlRGlkRXhwb3J0Q29kZVRvSFRNTCgpe1xuICAgICAgbGV0IHRyYWNraW5nT3B0T3V0ID0gZmFsc2U7XG4gICAgICBpZih0aGlzLmV4cG9ydEZvckVsb3F1YSAmJiB0aGlzLmV4cG9ydEZvckVsb3F1YSA9PSBcIlllc1wiKSB7XG4gICAgICAgIHdpbmRvdy5nYSgnc2VuZCcsICdldmVudCcsIFwiSFRNTFwiLCBcIkFkZCBFbG9xdWEgVHJhY2tpbmdcIiwgXCJBZGQgRWxvcXVhIFRyYWNraW5nXCIpO1xuICAgICAgICB0aGlzLm1hcExpbmtPYmplY3RzKGZ1bmN0aW9uKExpbmtPYmplY3Qpe1xuICAgICAgICAgIHRyYWNraW5nT3B0T3V0ID0gTGlua09iamVjdC53aGl0ZUxpc3RlZFVybCA9PSBMaW5rT2JqZWN0Lm5ldy51cmw7XG4gICAgICAgICAgaWYoIUxpbmtPYmplY3QuaXNMaW5rVHlwZShcIm1haWx0b1wiKVxuICAgICAgICAgICYmICFMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuaGFzKFwiZWxxVHJhY2tcIilcbiAgICAgICAgICAmJiAhL2FwcFxcLmluZm9cXC5vcHR1bVxcLmNvbS9naS50ZXN0KExpbmtPYmplY3QubmV3LnVybCkpe1xuICAgICAgICAgICAgTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLmFwcGVuZChcImVscVRyYWNrPXRydWVcIik7XG5cbiAgICAgICAgICAgIGlmKHRyYWNraW5nT3B0T3V0KSB7XG4gICAgICAgICAgICAgIExpbmtPYmplY3Qud2hpdGVMaXN0ZWRVcmwgPSBMaW5rT2JqZWN0Lm5ldy51cmw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG5cbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLm1hcExpbmtPYmplY3RzKGZ1bmN0aW9uKExpbmtPYmplY3Qpe1xuICAgICAgICAgIGlmKExpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5oYXMoXCJlbHFUcmFja1wiKSl7XG4gICAgICAgICAgICBsZXQgaW5kZXggPSBMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuZW50cmllcy5pbmRleE9mKFwiZWxxVHJhY2s9dHJ1ZVwiKTtcbiAgICAgICAgICAgIGlmKGluZGV4Pi0xKXtcbiAgICAgICAgICAgICAgTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLmRlbGV0ZUF0SW5kZXgoaW5kZXgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgTGlua09iamVjdC5pc0xpbmtDb21wbGV0ZSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBMaW5rT2JqZWN0LkNoYW5nZU1vbml0b3IudXBkYXRlKCk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICB0aGlzLm1hcExpbmtPYmplY3RzKGZ1bmN0aW9uKExpbmtPYmplY3Qpe1xuICAgICAgICBpZighTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLmhhcyhcInNcIikgJiYgTGlua09iamVjdC5yZXF1aXJlc1NDb2RlKCkpe1xuICAgICAgICAgIExpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5hcHBlbmQoXCJzPWVtYWlsXCIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmKExpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5oYXMoXCJzXCIpICYmIExpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5nZXQoXCJzXCIpPT1cIm9mdFwiKXtcbiAgICAgICAgICAgIExpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5zZXQoXCJzXCIsXCJlbWFpbFwiKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgTGlua09iamVjdC5DaGFuZ2VNb25pdG9yLnVwZGF0ZSgpO1xuICAgICAgfSk7XG5cbiAgICAgIHRoaXMubWFwTGlua09iamVjdHMoZnVuY3Rpb24oTGlua09iamVjdCl7XG4gICAgICAgIExpbmtPYmplY3QuQ2hhbmdlTW9uaXRvci51cGRhdGUoKTtcbiAgICAgIH0pO1xuXG4gICAgfVxuICAgIGFmdGVyRGlkRXhwb3J0Q29kZVRvSFRNTCgpe1xuICAgICAgdGhpcy5tYXBMaW5rT2JqZWN0cyhmdW5jdGlvbihMaW5rT2JqZWN0KXtcbiAgICAgICAgaWYoTGlua09iamVjdC53aGl0ZUxpc3RlZFVybD09TGlua09iamVjdC5uZXcudXJsKXtcbiAgICAgICAgICAvL3JlcG9ydCB0aGUgbm9uIHRyYWNrZWQgbGluaztcbiAgICAgICAgICB3aW5kb3cuZ2EoJ3NlbmQnLCAnZXZlbnQnLCBcIlRyYWNraW5nLU9wdG91dFwiLCBcIm92ZXJyaWRlXCIsIExpbmtPYmplY3QubmV3LnVybCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgd2luZG93LmdhKCdzZW5kJywgJ2V2ZW50JywgXCJIVE1MXCIsIFwidmlldyBzb3VyY2Vjb2RlXCIsIFwiRXhwb3J0L1ZpZXcgSFRNTFwiKTtcbiAgICAgIGxvY2F0aW9uLmhyZWY9IFwiIy9leHBvcnQtaHRtbFwiO1xuICAgIH1cblxuXG4gICAgc2V0VXBTaG9ydGN1dEtleXMoKTp2b2lke1xuICAgICAgdmFyIF90aGlzPSB0aGlzO1xuICAgICAgdGhpcy5rZXlCb2FyZFNob3J0Y3V0cyA9IFtdO1xuXG4gICAgICBfdGhpcy5rZXlCb2FyZFNob3J0Y3V0cy5wdXNoKFxuICAgICAgICBuZXcgS2V5Ym9hcmRTaG9ydGN1dChcbiAgICAgICAgICBmdW5jdGlvbihlKXsgcmV0dXJuIChlLmN0cmxLZXl8fGUubWV0YUtleSkgJiYgZS5zaGlmdEtleSAmJiBlLndoaWNoID09IDUyOyB9LFxuICAgICAgICAgIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAvL2RvdGhpcztcbiAgICAgICAgICAgIF90aGlzLnNjb3BlLiRhcHBseShmdW5jdGlvbigpe1xuICAgICAgICAgICAgICBjb25zb2xlLmxvZygnZG93bmxvYWRpbmcgZmlsZScpO1xuICAgICAgICAgICAgICBfdGhpcy5kb3dubG9hZEh0bWwoKTtcblxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBcIkNUUkwgKyBTSElGVCArIDRcIixcbiAgICAgICAgICBcIkRvd25sb2FkIEhUTUxcIlxuICAgICAgICApXG4gICAgICApO1xuXG4gICAgICBfdGhpcy5rZXlCb2FyZFNob3J0Y3V0cy5wdXNoKFxuICAgICAgICBuZXcgS2V5Ym9hcmRTaG9ydGN1dChcbiAgICAgICAgICBmdW5jdGlvbihlKXsgcmV0dXJuIChlLmN0cmxLZXl8fGUubWV0YUtleSkgJiYgZS5zaGlmdEtleSAmJiBlLndoaWNoID09IDUxOyB9LFxuICAgICAgICAgIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAvL2RvdGhpcztcbiAgICAgICAgICAgIF90aGlzLnNjb3BlLiRhcHBseShmdW5jdGlvbigpe1xuICAgICAgICAgICAgICBfdGhpcy5tYXBMaW5rT2JqZWN0cyhmdW5jdGlvbihMaW5rT2JqZWN0KXtcbiAgICAgICAgICAgICAgICBpZihMaW5rT2JqZWN0LmVycm9ycy5tZXNzYWdlcy5sZW5ndGg+MCl7XG4gICAgICAgICAgICAgICAgICBMaW5rT2JqZWN0LmVycm9ycy5tZXNzYWdlcy5mb3JFYWNoKGZ1bmN0aW9uKE1lc3NhZ2VPYmplY3Qpe1xuICAgICAgICAgICAgICAgICAgICBpZihNZXNzYWdlT2JqZWN0LnR5cGUgPT0gRXJyb3JUeXBlLlN1Z2dlc3Rpb24pe1xuICAgICAgICAgICAgICAgICAgICAgIE1lc3NhZ2VPYmplY3QuY3RhSGFuZGxlcigpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgIExpbmtPYmplY3QuaXNMaW5rQ29tcGxldGUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBcIkNUUkwgKyBTSElGVCArIDNcIixcbiAgICAgICAgICBcIkFwcGx5IGFsbCBzdWdnZXN0aW9uc1wiXG4gICAgICAgIClcbiAgICAgICk7XG5cbiAgICAgIF90aGlzLmtleUJvYXJkU2hvcnRjdXRzLnB1c2goXG4gICAgICAgIG5ldyBLZXlib2FyZFNob3J0Y3V0KFxuICAgICAgICAgIGZ1bmN0aW9uKGUpeyByZXR1cm4gKGUuY3RybEtleXx8ZS5tZXRhS2V5KSAmJiBlLnNoaWZ0S2V5ICYmIGUud2hpY2ggPT0gNTA7IH0sXG4gICAgICAgICAgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIC8vZG90aGlzO1xuICAgICAgICAgICAgX3RoaXMuc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgIF90aGlzLm1hcExpbmtPYmplY3RzKGZ1bmN0aW9uKExpbmtPYmplY3Qpe1xuICAgICAgICAgICAgICAgIGlmKCFMaW5rT2JqZWN0LnJlYWRPbmx5XG4gICAgICAgICAgICAgICAgICAmJiBMaW5rT2JqZWN0LnJlcXVpcmVzU0NvZGUoKVxuICAgICAgICAgICAgICAgICYmICFMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuaGFzKCdzJykpe1xuICAgICAgICAgICAgICAgICAgTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLmFwcGVuZCgncz1lbWFpbCcpO1xuICAgICAgICAgICAgICAgICAgTGlua09iamVjdC5pc0xpbmtDb21wbGV0ZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiQ1RSTCArIFNISUZUICsgMlwiLFxuICAgICAgICAgIFwiQWRkIHM9ZW1haWwgdG8gYWxsIGxpbmtzXCJcbiAgICAgICAgKVxuICAgICAgKTtcblxuICAgICAgX3RoaXMua2V5Qm9hcmRTaG9ydGN1dHMucHVzaChcbiAgICAgICAgbmV3IEtleWJvYXJkU2hvcnRjdXQoXG4gICAgICAgICAgZnVuY3Rpb24oZSl7IHJldHVybiAoZS5jdHJsS2V5fHxlLm1ldGFLZXkpICYmIGUuc2hpZnRLZXkgJiYgZS53aGljaCA9PSA0OTsgfSxcbiAgICAgICAgICBmdW5jdGlvbigpe1xuICAgICAgICAgICAgLy9kb3RoaXM7XG4gICAgICAgICAgICBfdGhpcy5zY29wZS4kYXBwbHkoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgX3RoaXMubWFwTGlua09iamVjdHMoZnVuY3Rpb24oTGlua09iamVjdCl7XG4gICAgICAgICAgICAgICAgaWYoTGlua09iamVjdC5yZWFkT25seSkgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICAgICAgTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLmRlbGV0ZShcIm9cIik7XG4gICAgICAgICAgICAgICAgTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLmRlbGV0ZShcIm9pblwiKTtcbiAgICAgICAgICAgICAgICBMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuZGVsZXRlKFwidlwiKTtcbiAgICAgICAgICAgICAgICBMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuZGVsZXRlKFwib2lleFwiKTtcbiAgICAgICAgICAgICAgICBMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuZGVsZXRlKFwiZWxxX21pZFwiKTtcbiAgICAgICAgICAgICAgICBMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuZGVsZXRlKFwiZWxxX2xpZFwiKTtcbiAgICAgICAgICAgICAgICBMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuZGVsZXRlKFwiZWxxVHJhY2tcIik7XG4gICAgICAgICAgICAgICAgTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLmRlbGV0ZShcImVscVRyYWNrSWRcIik7XG4gICAgICAgICAgICAgICAgTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLmRlbGV0ZShcInNcIik7XG4gICAgICAgICAgICAgICAgTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLmRlbGV0ZShcInMzXCIpO1xuXG4gICAgICAgICAgICAgICAgTGlua09iamVjdC5pc0xpbmtDb21wbGV0ZSgpO1xuICAgICAgICAgICAgICAgIF90aGlzLmFyZUxpbmtzQ29tcGxldGUoKTtcbiAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJDVFJMICsgU0hJRlQgKyAxXCIsXG4gICAgICAgICAgXCJSZW1vdmUgYWxsIHF1ZXJ5IHN0cmluZ3MgZnJvbSBlbWFpbFwiXG4gICAgICAgIClcbiAgICAgICk7XG5cblxuXG4gICAgICBkb2N1bWVudC5vbmtleXVwID0gZnVuY3Rpb24oZSl7XG4gICAgICAgIGZvcihsZXQgc2hvcnRjdXQgb2YgX3RoaXMua2V5Qm9hcmRTaG9ydGN1dHMpe1xuICAgICAgICAgIGlmKHNob3J0Y3V0LndoZW4gJiYgc2hvcnRjdXQud2hlbihlKSl7XG4gICAgICAgICAgICBzaG9ydGN1dC5kb1RoaXMoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfVxuICAgIHJlcGxhY2VTcGVjaWFsQ2hhcmFjdGVycyh0ZXh0KTpzdHJpbmd7XG4gICAgICB2YXIgcmVwbGFjZSA9IHtcbiAgICAgICAgMTc0OiBbXCImcmVnO1wiXSxcbiAgICAgICAgMTY5OiBbXCImY29weTtcIl0sXG4gICAgICAgIDgyMTEgOiBbXCImbmRhc2g7XCJdLFxuICAgICAgICA4MjEyIDogW1wiJm1kYXNoO1wiXSxcbiAgICAgICAgODIyMCA6IFtcIiZsZHF1bztcIl0sXG4gICAgICAgIDgyMjEgOiBbXCImcmRxdW87XCJdLFxuICAgICAgICA4MjE2IDogW1wiJmxzcXVvO1wiXSxcbiAgICAgICAgODIxNyA6IFtcIiZyc3F1bztcIl0sXG4gICAgICAgIDg0ODIgOiBbXCImdHJhZGU7XCJdXG4gICAgICB9O1xuICAgICAgZm9yKGxldCBpIGluIHJlcGxhY2Upe1xuICAgICAgICBpZihyZXBsYWNlLmhhc093blByb3BlcnR5KGkpKXtcbiAgICAgICAgICB2YXIgcmVnZXhwID0gbmV3IFJlZ0V4cChTdHJpbmcuZnJvbUNoYXJDb2RlKHBhcnNlSW50KGkpKSxcImdcIik7XG4gICAgICAgICAgaWYocmVnZXhwLnRlc3QodGV4dCkpe1xuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coXCJmb3VuZCBjaGFyYWN0ZXJcIiArIFN0cmluZy5mcm9tQ2hhckNvZGUocGFyc2VJbnQoaSkpKTtcbiAgICAgICAgICAgIHRleHQgPSB0ZXh0LnJlcGxhY2UocmVnZXhwLCByZXBsYWNlW2ldWzBdKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiB0ZXh0O1xuICAgIH1cbiAgICBwcm9jZXNzSHRtbCgpOnZvaWR7XG4gICAgICAvL2NyZWF0ZXMgYSBuZXcgd29ya3NwYWNlIGZyb20gaHRtbFxuICAgICAgdGhpcy5zZXRVcFNob3J0Y3V0S2V5cygpO1xuICAgICAgdGhpcy5saW5rRGF0YSA9IFtdO1xuICAgICAgdGhpcy5pbnRlbGxpZ2VuY2Uub3ZlcnJpZGRlbiA9IFtdO1xuICAgICAgdGhpcy5pbnRlbGxpZ2VuY2UuZXZhbHVhdGVSdWxlcygpO1xuICAgICAgd2luZG93LnNjcm9sbFRvKDAsMCk7XG4gICAgICAvLyAucmVwbGFjZShuZXcgUmVnRXhwKFwiPC9hPlwiLFwiaWdcIiksIFwiPC9hPlxcblwiKVxuICAgICAgdGhpcy53b3JraW5nQ29kZSA9IHRoaXMucmVwbGFjZVNwZWNpYWxDaGFyYWN0ZXJzKHRoaXMuc291cmNlQ29kZSk7XG4gICAgICAvL2RldGVybWluZSBlbWFpbCBoZWFkZXJzXG4gICAgICB0aGlzLl9fZW1sSGVhZGVycyA9IHRoaXMuX19idWlsZEhlYWRlcnMoKTtcbiAgICAgIC8vICAgJHNjb3BlLmRhdGEuaGVhZGVyLFxuICAgICAgLy8gICAkc2NvcGUuZGF0YS5hbGxvd2FibGVIZWFkZXJGaWVsZHMpO1xuXG4gICAgICAvL3JlcGxhY2UgbWVyZ2UgZmllbGRzXG4gICAgICBpZih0aGlzLmZpbGVOYW1lPT1cInVudGl0bGVkXCIpe1xuICAgICAgICB2YXIgdGl0bGVSZWcgPSAvPHRpdGxlPihbXjxdLio/KTxcXC90aXRsZT4vZ2k7XG4gICAgICAgIGlmKHRpdGxlUmVnLnRlc3QodGhpcy53b3JraW5nQ29kZSkpe1xuICAgICAgICAgIHZhciB0aXRsZVRhZyA9IHRoaXMud29ya2luZ0NvZGUubWF0Y2godGl0bGVSZWcpO1xuICAgICAgICAgIGlmKHRpdGxlVGFnLmxlbmd0aD4wKXtcbiAgICAgICAgICAgIHRoaXMuZmlsZU5hbWUgPSB0aGlzLl9fZm9ybWF0RmlsZU5hbWUodGl0bGVUYWdbMF0ucmVwbGFjZSh0aXRsZVJlZywgXCIkMVwiKSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICB2YXIgX3N1cGVyID0gdGhpcztcbiAgICAgIHZhciByZTEgPSAvPGFcXGJbXj5dKj8+KFtcXHJcXG5dfC4pKj88XFwvYT4vZ20sIG4gPSAwO1xuICAgICAgdGhpcy53b3JraW5nQ29kZSA9IHRoaXMud29ya2luZ0NvZGUucmVwbGFjZShyZTEsIGZ1bmN0aW9uKGZvdW5kKXtcbiAgICAgICAgbisrOyByZXR1cm4gZm91bmQucmVwbGFjZShcIjxhXCIsIFwiPGEgZW1sLWlkPVxcXCJcIituK1wiXFxcIlwiKTtcbiAgICAgIH0pO1xuXG4gICAgICBuID0gMDtcbiAgICAgIHRoaXMud29ya2luZ0NvZGUgPSB0aGlzLndvcmtpbmdDb2RlLnJlcGxhY2UocmUxLCBmdW5jdGlvbihjb250ZXh0KXtcbiAgICAgICAgbisrO1xuICAgICAgICAvL2dldCBsaW5lXG4gICAgICAgIHZhciBsaW5lID0gX3N1cGVyLndvcmtpbmdDb2RlLnN1YnN0cigwLCBfc3VwZXIud29ya2luZ0NvZGUuaW5kZXhPZihjb250ZXh0KSkuc3BsaXQoXCJcXG5cIikubGVuZ3RoLTE7XG5cbiAgICAgICAgaWYoLyhocmVmXFw9XFxcIihbXlxcXCJcXD5dKilcXFwiPykvZy50ZXN0KGNvbnRleHQpKXtcbiAgICAgICAgICBuKys7XG4gICAgICAgICAgdmFyIGEgPSBuZXcgTGlua09iamVjdChsaW5lLCBjb250ZXh0LCBfc3VwZXIpO1xuICAgICAgICAgIGEuaWQgPSBuO1xuICAgICAgICAgIGEucmVhZE9ubHkgPSAoYS5uZXcuY29udGFpbnMoXCIuY29tL2UvZXMuYXNweFwiKSAmJiBhLm5ldy5jb250YWlucyhcIn5+ZWxvcXVhXCIpKTtcbiAgICAgICAgICBfc3VwZXIubGlua0RhdGEucHVzaChhKTtcbiAgICAgICAgICByZXR1cm4gXCJ7e0VNTE1ha2VyX0xpbms6XCIrbitcIn19XCI7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIGNvbnRleHQ7XG4gICAgICAgIH1cblxuICAgICAgfSk7XG5cblxuICAgICAgdGhpcy5tYXBMaW5rT2JqZWN0cyhmdW5jdGlvbihMaW5rT2JqZWN0KXtcbiAgICAgICAgTGlua09iamVjdC5pc0xpbmtDb21wbGV0ZSgpO1xuICAgICAgfSk7XG5cblxuICAgICAgLy8gY29uc29sZS5sb2codGhpcy5pbnRlbGxpZ2VuY2UpO1xuICAgICAgLy9yZWRpcmVjdFxuXG4gICAgICBsb2NhdGlvbi5ocmVmPVwiIy9saW5rc1wiO1xuICAgIH1cbiAgICBhZGROZXdIZWFkZXJGaWVsZCh2YWx1ZSl7XG4gICAgICB0aGlzLmhlYWRlclt2YWx1ZV0gPSBcIlwiO1xuICAgIH1cbiAgICByZW1vdmVIZWFkZXJGaWVsZCh2YWx1ZSl7XG4gICAgICBkZWxldGUgdGhpcy5oZWFkZXJbdmFsdWVdO1xuICAgIH1cbiAgICBpc0hlYWRlclNlbGVjdGVkKGhlYWRlcik6Ym9vbGVhbntcbiAgICAgIGlmKCF0aGlzLmhlYWRlci5oYXNPd25Qcm9wZXJ0eShoZWFkZXIpIHx8IHRoaXMuaGVhZGVyPT1cIlwiICApIHsgcmV0dXJuIHRydWU7IH1cbiAgICAgIGVsc2UgeyByZXR1cm4gZmFsc2U7IH1cbiAgICB9XG4gICAgdmVyaWZ5TGlua1NlY3Rpb25Db21wbGV0ZSgpOmJvb2xlYW57XG4gICAgICB2YXIgb3V0cHV0ID0gZmFsc2U7XG5cbiAgICAgIGlmKHRoaXMuaW50ZWxsaWdlbmNlICYmICF0aGlzLmludGVsbGlnZW5jZS5jYW5Db250aW51ZSl7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAvLyBhcmUgdGhlcmUgbGluayBpc3N1ZXM/XG4gICAgICBpZiAodGhpcy5saW5rRGF0YSAmJiB0aGlzLmxpbmtEYXRhLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgIG91dHB1dCA9IGZhbHNlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKHRoaXMuYXJlTGlua3NDb21wbGV0ZSgpKSB7XG4gICAgICAgICAgb3V0cHV0ID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICBvdXRwdXQgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICB9XG5cblxuICAgIGdlbmVyYXRlT3V0cHV0Q29kZSh0eXBlPywgY2xvbmU/KTpzdHJpbmd7XG4gICAgICBpZih0eXBlID09PSB1bmRlZmluZWQpIHR5cGUgPSBcImVtYWlsXCI7XG4gICAgICBpZihjbG9uZSA9PT0gdW5kZWZpbmVkKSBjbG9uZSA9IHRydWU7XG4gICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgdmFyIG91dHB1dDpzdHJpbmcgPSB0aGlzLndvcmtpbmdDb2RlO1xuXG4gICAgICAvL3Bvc3QgcHJvY2Vzc2luZy5cbiAgICAgIC8vZG8gcG9zdCBwcm9jZXNzaW5nLlxuICAgICAgLy9leHBvcnQgY29kZT9cbiAgICAgIHRoaXMubWFwTGlua09iamVjdHMoZnVuY3Rpb24oTGlua09iamVjdCl7XG5cbiAgICAgICAgaWYoTGlua09iamVjdC5oYXNPd25Qcm9wZXJ0eShcImRlbGV0ZU9uUmVuZGVyXCIpJiZMaW5rT2JqZWN0LmRlbGV0ZU9uUmVuZGVyKXtcbiAgICAgICAgICBvdXRwdXQgPSBvdXRwdXQucmVwbGFjZShuZXcgUmVnRXhwKFwie3tFTUxNYWtlcl9MaW5rOlwiK0xpbmtPYmplY3QuaWQrXCJ9fVwiLCBcImdpXCIpLCBcIlwiKTtcbiAgICAgICAgfSBlbHNlIGlmKExpbmtPYmplY3QucmVhZE9ubHkpIHtcbiAgICAgICAgICBsZXQgcmVhZE9ubHlVcmwgPSBMaW5rT2JqZWN0LmNvbnRleHQucmVwbGFjZSgvZW1sXFwtaWRcXD1cXFwiWzAtOV17MSx9XFxcIlxccy9nLFwiXCIpO1xuICAgICAgICAgIG91dHB1dCA9IG91dHB1dC5yZXBsYWNlKG5ldyBSZWdFeHAoXCJ7e0VNTE1ha2VyX0xpbms6XCIrTGlua09iamVjdC5pZCtcIn19XCIsIFwiZ2lcIiksIHJlYWRPbmx5VXJsKTtcbiAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgIHZhciBzdGFydCA9IExpbmtPYmplY3QuY29udGV4dC5pbmRleE9mKFwiaHJlZj1cXFwiXCIgKyBMaW5rT2JqZWN0Lm9sZC51cmwpO1xuICAgICAgICAgIC8vIGNvZGVMaW5lc1tsaW5lXSA9IGNvZGVMaW5lc1tsaW5lXS5zdWJzdHIoMCwgc3RhcnQpICsgXCJocmVmPVxcXCJcIiArIExpbmtPYmplY3QubmV3LnVybCArIGNvZGVMaW5lc1tsaW5lXS5zdWJzdHIoc3RhcnQrNitMaW5rT2JqZWN0Lm9sZC51cmwubGVuZ3RoLCBjb2RlTGluZXNbbGluZV0ubGVuZ3RoKTtcbiAgICAgICAgICAvL3RoaXMgaXMgd2hlcmUgd2UgdXBkYXRlIHRoZSBjb250ZXh0O1xuICAgICAgICAgIHZhciBuZXdDb250ZXh0ID0gTGlua09iamVjdC5jb250ZXh0O1xuICAgICAgICAgIG5ld0NvbnRleHQgPSBuZXdDb250ZXh0LnN1YnN0cigwLHN0YXJ0KSArIFwiaHJlZj1cXFwiXCIgKyBMaW5rT2JqZWN0Lm5ldy51cmwgKyBuZXdDb250ZXh0LnN1YnN0cihzdGFydCs2K0xpbmtPYmplY3Qub2xkLnVybC5sZW5ndGgsIG5ld0NvbnRleHQubGVuZ3RoKTtcbiAgICAgICAgICBpZihMaW5rT2JqZWN0LkxpbmtlZEltYWdlKXtcbiAgICAgICAgICAgIG5ld0NvbnRleHQgPSBMaW5rT2JqZWN0LkxpbmtlZEltYWdlLmdlbmVyYXRlT3V0cHV0KG5ld0NvbnRleHQpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBuZXdDb250ZXh0ID0gbmV3Q29udGV4dC5yZXBsYWNlKC9cXHM/ZW1sXFwtaWRcXD1cXFwiWzAtOV0qXFxcIi9nLFwiXCIpO1xuICAgICAgICAgIC8vdGhlbiB1cGRhdGUgdGhlIHdvcmtpbmcgY29kZSB3aXRoIHRoZSBuZXcgY29udGV4dDtcbiAgICAgICAgICBvdXRwdXQgPSBvdXRwdXQucmVwbGFjZShuZXcgUmVnRXhwKFwie3tFTUxNYWtlcl9MaW5rOlwiK0xpbmtPYmplY3QuaWQrXCJ9fVwiLCBcImdpXCIpLCBuZXdDb250ZXh0KTtcbiAgICAgICAgfVxuXG4gICAgICB9KTtcblxuICAgICAgLy9maW5kIGFsbCBpbWFnZXMgd2l0aG91dCBhbHQgYXR0cmlidXRlIGFuZCBhZGQgYWx0PVwiXCI7XG4gICAgICBvdXRwdXQgPSBvdXRwdXQucmVwbGFjZSgvXFw8aW1nW15cXD5dLio/XFw+L2dpLCBmdW5jdGlvbihmb3VuZCl7XG4gICAgICAgIGlmKGZvdW5kLmluZGV4T2YoXCJhbHQ9XCIpPi0xKXtcbiAgICAgICAgICByZXR1cm4gZm91bmQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIGZvdW5kLnJlcGxhY2UoL1xcPGltZy9naSwgXCI8aW1nIGFsdD1cXFwiXFxcIlwiKTtcbiAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgdHJ5IHtcbiAgICAgICAgb3V0cHV0ID0gb3V0cHV0LnJlcGxhY2UoLzxcXC9hPlxcbnswLDV9KFxcLnwsfFxcP3whfDp8O3xcXHwpL2csIFwiPC9hPiQxXCIpO1xuICAgICAgfSBjYXRjaChlKXtcbiAgICAgICAgY29uc29sZS5sb2coXCJlcnJvciBtZXJnaW5nIGxpbmVzIHdpdGggbGlua3MgdGhhdCBwcmV2aW91c2x5IGhhZCBwdW5jdHVhdGlvbi5cIik7XG4gICAgICB9XG4gICAgICByZXR1cm4gb3V0cHV0O1xuICAgIH1cbiAgICB1cGRhdGVMaW5rc0FuZEV4cG9ydCgpOmJvb2xlYW57XG4gICAgICBpZighdGhpcy5hcmVMaW5rc0NvbXBsZXRlKCkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuXG5cbiAgICAgIGxvY2F0aW9uLmhyZWY9XCIjL2V4cG9ydFwiO1xuICAgICAgd2luZG93LnNjcm9sbFRvKDAsMCk7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgYXJlTGlua3NDb21wbGV0ZSgpOmJvb2xlYW57XG4gICAgICB2YXIgb3V0cHV0ID0gdHJ1ZTtcblxuICAgICAgdGhpcy5tYXBMaW5rT2JqZWN0cyhmdW5jdGlvbihMaW5rT2JqZWN0KXtcblxuICAgICAgICBpZighTGlua09iamVjdC5fX2lzQ29tcGxldGUpe1xuICAgICAgICAgIG91dHB1dCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGlmKExpbmtPYmplY3QubmVlZHNUcmFja2luZ0NvZGUoKSl7XG4gICAgICAgICAgb3V0cHV0ID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICByZXR1cm4gb3V0cHV0O1xuICAgIH1cbiAgICBnZXRMaW5rc1N1bW1hcnkoKTphbnl7XG4gICAgICB2YXIgZGF0YSA9IHtcbiAgICAgICAgbmVlZHNUcmFja2luZzogMCxcbiAgICAgICAgaW52YWxpZFVybDogMFxuICAgICAgfTtcbiAgICAgIHRoaXMubWFwTGlua09iamVjdHMoZnVuY3Rpb24oTGlua09iamVjdCl7XG4gICAgICAgIGlmKExpbmtPYmplY3QubmVlZHNUcmFja2luZ0NvZGUoKSkgZGF0YS5uZWVkc1RyYWNraW5nKys7XG4gICAgICAgIGlmKExpbmtPYmplY3QuaXNMaW5rQ29tcGxldGUoKSkgZGF0YS5pbnZhbGlkVXJsKys7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBkYXRhO1xuICAgIH1cbiAgICBpbXBvcnRIdG1sRnJvbUZpbGVEcm9wKGV2dCk6dm9pZHtcbiAgICAgIGlmKHRoaXMuc291cmNlQ29kZS5sZW5ndGg+MCkgeyB0aGlzLnNvdXJjZUNvZGUgPSBcIlwiOyB9XG4gICAgICB2YXIgZmlsZXMgPSBldnQuZGF0YVRyYW5zZmVyLmZpbGVzO1xuICAgICAgaWYoZXZ0LmRhdGFUcmFuc2Zlci5maWxlcy5sZW5ndGg+MSl7XG4gICAgICAgIGFsZXJ0KCd5b3UgY2FuIG9ubHkgaW1wb3J0IG9uZSBmaWxlIGF0IGF0IHRpbWUuJyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB2YXIgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcbiAgICAgICAgdmFyIFdTID0gdGhpcztcbiAgICAgICAgcmVhZGVyLm9ubG9hZGVuZCA9IGZ1bmN0aW9uKGV2dCl7XG4gICAgICAgICAgdmFyIGRyb3BUZXh0ID0gZXZ0LnRhcmdldC5yZXN1bHQ7XG5cbiAgICAgICAgICB2YXIgbmFtZVBhcnRzID0gZmlsZXNbMF0ubmFtZS5zcGxpdChcIi5cIik7XG4gICAgICAgICAgdmFyIGV4dCA9IG5hbWVQYXJ0cy5wb3AoKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgIFdTLmZpbGVOYW1lID0gV1MuX19mb3JtYXRGaWxlTmFtZShuYW1lUGFydHMuam9pbihcIi5cIikpO1xuXG4gICAgICAgICAgaWYoZXh0PT0nZW1sJyl7XG4gICAgICAgICAgICBXUy5zb3VyY2VDb2RlID0gV1MuX19zdHJpcEh0bWxBbmRTdWJqZWN0RnJvbUVNTChkcm9wVGV4dCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIFdTLnNvdXJjZUNvZGUgPSBkcm9wVGV4dDtcbiAgICAgICAgICB9XG4gICAgICAgICAgV1MucHJvY2Vzc0h0bWwoKTtcbiAgICAgICAgICAvLyBXUy5pbnRlbGxpZ2VuY2UgPSBFTUxNYWtlckFJRW5naW5lLkNoZWNrRW1haWwoV1MpO1xuICAgICAgICAgIGxvY2F0aW9uLmhyZWYgPSBcIiMvbGlua3NcIjtcbiAgICAgICAgfTtcbiAgICAgICAgcmVhZGVyLnJlYWRBc1RleHQoZmlsZXNbMF0pO1xuICAgICAgICB3aW5kb3cuZ2EoJ3NlbmQnLCAnZXZlbnQnLCBcIkhUTUxcIiwgXCJpbXBvcnRcIiwgXCJIVE1MIEltcG9ydCBGaWxlIERyb3BcIik7XG4gICAgICB9XG4gICAgfVxuXG4gICAgc2V0IGRlZmF1bHRTQ29kZShuZXdWYWx1ZSl7XG4gICAgICBsZXQgb2xkID10aGlzLl9kZWZhdWx0U0NvZGU7XG5cbiAgICAgIGlmKG9sZCE9PW5ld1ZhbHVlKXtcbiAgICAgICAgdGhpcy5fZGVmYXVsdFNDb2RlID0gbmV3VmFsdWU7XG4gICAgICAgIHRoaXMubWFwTGlua09iamVjdHMoZnVuY3Rpb24oTGlua09iamVjdCl7XG4gICAgICAgICAgTGlua09iamVjdC5pc0xpbmtDb21wbGV0ZSgpO1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgIH1cblxuXG4gICAgX19mb3JtYXRGaWxlTmFtZShuYW1lKTpzdHJpbmcge1xuICAgICAgbGV0IF9zbHVnaWZ5X3N0cmlwX3JlID0gL1teXFx3XFxzLV0vZztcbiAgICAgIGxldCBfc2x1Z2lmeV9oeXBoZW5hdGVfcmUgPSAvWy1cXHNdKy9nO1xuICAgICAgbmFtZSA9IG5hbWUucmVwbGFjZShfc2x1Z2lmeV9zdHJpcF9yZSwgJycpLnRyaW0oKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgbmFtZSA9IG5hbWUucmVwbGFjZShfc2x1Z2lmeV9oeXBoZW5hdGVfcmUsICctJyk7XG4gICAgICByZXR1cm4gbmFtZTtcbiAgICB9XG4gICAgX19yZXBsYWNlRWxvcXVhTWVyZ2VGaWVsZHMoY29udGVudCk6c3RyaW5ne1xuICAgICAgdmFyIHJlNCA9IC88c3BhbiglMjB8XFxzKWNsYXNzPVwiP2Vsb3F1YWVtYWlsXCI/XFxzPz4oLio/KTxcXC9zcGFuPi9pZztcbiAgICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UocmU0LCBcIiMkMiNcIik7XG4gICAgICByZXR1cm4gY29udGVudDtcbiAgICB9XG4gICAgX19zdHJpcEh0bWxBbmRTdWJqZWN0RnJvbUVNTChjb2RlKTpzdHJpbmd7XG4gICAgICB2YXIgb3V0cHV0ID0gY29kZS5zcGxpdChcIlxcblwiKTtcbiAgICAgIHZhciBodG1sID0gb3V0cHV0LnBvcCgpO1xuXG4gICAgICBmb3IodmFyIGkgPTA7IGk8IG91dHB1dC5sZW5ndGg7IGkrKyl7XG5cbiAgICAgICAgaWYob3V0cHV0W2ldLmluZGV4T2YoXCJTdWJqZWN0OlwiKT4tMSl7XG4gICAgICAgICAgaWYodGhpcy5oZWFkZXIgPT09IHVuZGVmaW5lZCkgdGhpcy5oZWFkZXIgPSB7fTtcblxuICAgICAgICAgIC8vICRzY29wZS4kYXBwbHkoZnVuY3Rpb24oKXtcbiAgICAgICAgICAvLyAgICAgdGhpcy5oZWFkZXJbXCJzdWJqZWN0XCJdID0gIG91dHB1dFtpXS5zdWJzdHIoOCxvdXRwdXRbaV0ubGVuZ3RoKS50cmltKCk7XG4gICAgICAgICAgLy8gfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBodG1sO1xuICAgIH1cbiAgICBfX3JlbW92ZVdoaXRlU3BhY2UoY29kZSk6c3RyaW5nIHtcbiAgICAgIHZhciBvdXRwdXQgPSBjb2RlO1xuICAgICAgb3V0cHV0ID0gb3V0cHV0LnJlcGxhY2UobmV3IFJlZ0V4cChcIlxcblwiLCBcImdcIiksIFwiIFwiKTtcbiAgICAgIG91dHB1dCA9IG91dHB1dC5yZXBsYWNlKG5ldyBSZWdFeHAoXCJcXHRcIiwgXCJnXCIpLCBcIiBcIik7XG4gICAgICBvdXRwdXQgPSBvdXRwdXQucmVwbGFjZSgvXFxzezIsOTk5OTl9L2csIFwiIFwiKTtcbiAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgfVxuICAgIF9fYnVpbGRIZWFkZXJzKCk6c3RyaW5ne1xuICAgICAgdmFyIGhlYWRlcnM6c3RyaW5nW10gPSBbXTtcbiAgICAgIGZvcih2YXIgaT0wOyBpPHRoaXMuaGVhZGVycy5sZW5ndGg7IGkrKyl7IGhlYWRlcnMucHVzaCh0aGlzLmhlYWRlcnNbaV0pOyB9XG4gICAgICB2YXIgY2hhcnNldCA9IHRoaXMuX19nZXRDaGFyc2V0RnJvbUhUTUwodGhpcy5zb3VyY2VDb2RlKTtcbiAgICAgIGlmKGNoYXJzZXQgPT0gXCJcIikgY2hhcnNldCA9IFwiY2hhcnNldD1VVEYtOFwiO1xuICAgICAgaGVhZGVycy5wdXNoKFwiQ29udGVudC1UeXBlOiB0ZXh0L2h0bWw7XFxuXFx0XCIgKyBjaGFyc2V0KTtcblxuICAgICAgLy8gY29uc29sZS5sb2coaGVhZGVycywgYWxsb3dhYmxlSGVhZGVyRmllbGRzKTtcbiAgICAgIGZvcihsZXQgaSBpbiB0aGlzLmhlYWRlcil7XG4gICAgICAgIGlmKHRoaXMuaGVhZGVyLmhhc093blByb3BlcnR5KGkpKXtcbiAgICAgICAgICBpZih0aGlzLl9fYWxsb3dhYmxlSGVhZGVyRmllbGRzLmhhc093blByb3BlcnR5KGkpKXtcbiAgICAgICAgICAgIGhlYWRlcnMucHVzaChcbiAgICAgICAgICAgICAgdGhpcy5fX2FsbG93YWJsZUhlYWRlckZpZWxkc1tpXS5zeW50YXggKyBcIiBcIiArIHRoaXMuaGVhZGVyW2ldXG4gICAgICAgICAgICApO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgdGhpcy5fX2VtbEhlYWRlcnMgPSBoZWFkZXJzLmpvaW4oXCJcXG5cIik7XG4gICAgICByZXR1cm4gaGVhZGVycy5qb2luKFwiXFxuXCIpO1xuICAgIH1cbiAgICBfX2dldENoYXJzZXRGcm9tSFRNTChjb250ZW50KTpzdHJpbmd7XG4gICAgICB2YXIgcmU1ID0gLzxtZXRhLio/Y2hhcnNldD0oW15cXHNcIl0qKS9pZywgY2hhcnNldCA9XCJcIjtcblxuICAgICAgdmFyIG1ldGFUYWdzID0gY29udGVudC5tYXRjaChyZTUpO1xuICAgICAgaWYobWV0YVRhZ3Mpe1xuICAgICAgICBtZXRhVGFncy5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pe1xuICAgICAgICAgIHZhciBjaGFyc2V0VmFscyA9IGl0ZW0ubWF0Y2goL2NoYXJzZXQ9KFteXFxzXCJdKikvaWcpO1xuICAgICAgICAgIGlmKGNoYXJzZXRWYWxzKXtcbiAgICAgICAgICAgIGNoYXJzZXQgPSBjaGFyc2V0VmFsc1swXTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY2hhcnNldCA9IFwiY2hhcnNldD1VVEYtOFwiO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBjaGFyc2V0O1xuICAgIH1cblxuICB9XG5cblxuICBleHBvcnQgY2xhc3MgS2V5Ym9hcmRTaG9ydGN1dCB7XG5cbiAgICB3aGVuIDogKCk9PmJvb2xlYW47XG4gICAgZG9UaGlzIDogKCk9PnZvaWQ7XG4gICAgZGVzY3JpcHRpb246IHN0cmluZztcbiAgICBrZXlzOiBzdHJpbmc7XG5cbiAgICBjb25zdHJ1Y3Rvcih3aGVuLCBkb1RoaXMsIGtleXMsIGRlc2NyaXB0aW9uKXtcblxuICAgICAgdGhpcy53aGVuID0gd2hlbjtcbiAgICAgIHRoaXMuZG9UaGlzID0gZG9UaGlzO1xuICAgICAgdGhpcy5rZXlzID0ga2V5cztcbiAgICAgIHRoaXMuZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbjtcbiAgICB9XG4gIH1cblxuXG59XG4iLCJ2YXIgRXJyb3JTZXZlcml0eTtcbihmdW5jdGlvbiAoRXJyb3JTZXZlcml0eSkge1xuICAgIEVycm9yU2V2ZXJpdHlbRXJyb3JTZXZlcml0eVtcIkhpZ2hcIl0gPSAxXSA9IFwiSGlnaFwiO1xuICAgIEVycm9yU2V2ZXJpdHlbRXJyb3JTZXZlcml0eVtcIk1lZGl1bVwiXSA9IDJdID0gXCJNZWRpdW1cIjtcbiAgICBFcnJvclNldmVyaXR5W0Vycm9yU2V2ZXJpdHlbXCJMb3dcIl0gPSAzXSA9IFwiTG93XCI7XG4gICAgRXJyb3JTZXZlcml0eVtFcnJvclNldmVyaXR5W1wiWmVyb1wiXSA9IDRdID0gXCJaZXJvXCI7XG59KShFcnJvclNldmVyaXR5IHx8IChFcnJvclNldmVyaXR5ID0ge30pKTtcbnZhciBFcnJvclR5cGU7XG4oZnVuY3Rpb24gKEVycm9yVHlwZSkge1xuICAgIEVycm9yVHlwZVtFcnJvclR5cGVbXCJGaXhcIl0gPSAxXSA9IFwiRml4XCI7XG4gICAgRXJyb3JUeXBlW0Vycm9yVHlwZVtcIldhcm5cIl0gPSAyXSA9IFwiV2FyblwiO1xuICAgIEVycm9yVHlwZVtFcnJvclR5cGVbXCJTdWdnZXN0aW9uXCJdID0gM10gPSBcIlN1Z2dlc3Rpb25cIjtcbiAgICBFcnJvclR5cGVbRXJyb3JUeXBlW1wiUUFcIl0gPSA0XSA9IFwiUUFcIjtcbiAgICBFcnJvclR5cGVbRXJyb3JUeXBlW1wiQmVzdFByYWN0aWNlXCJdID0gNV0gPSBcIkJlc3RQcmFjdGljZVwiO1xufSkoRXJyb3JUeXBlIHx8IChFcnJvclR5cGUgPSB7fSkpO1xudmFyIEdsb2JhbFZhcnM7XG4oZnVuY3Rpb24gKEdsb2JhbFZhcnMpIHtcbiAgICBHbG9iYWxWYXJzLmxhbmRpbmdQYWdlUHJlZmVycmVkID0gLyhcXC5tcDR8XFwuYXZpfFxcLm1wZWd8XFwubXAzfFxcLnN3ZnxcXC5tb3Z8XFwucGRmKS9pO1xuICAgIEdsb2JhbFZhcnMuZXh0RG9lc05vdHJlcXVpcmVUcmFja2luZ0NvZGUgPSAvKFxcLnBkZnxcXC5vZnR8XFwuaWNzfFxcLnBuZ3xcXC5qcGVnfFxcLmpwZykvaTtcbiAgICBHbG9iYWxWYXJzLmxpbmtFbmNhcHN1bGF0ZWRQdW5jdHVhdGlvbiA9IC8oW1xcLlxcP1xcLFxcOlxcKl0rKSgoXFxufFxccnxcXHMpKyk/PFxcL2E+JC87XG4gICAgR2xvYmFsVmFycy5SZXF1aXJlc1NDb2RlUmVnZXggPSAvaHR0cCguKilvcHR1bSguKilcXC8oY2FtcGFpZ258cmVzb3VyY2UpL2k7XG4gICAgR2xvYmFsVmFycy5SZXF1aXJlc1RyYWNraW5nQ29kZVJlZ2V4ID0gUmVnRXhwKFwiXmh0dHAocyk/OlxcL1xcLyguKj8pP29wdHVtKC4qPyk/XFwuY29bbVxcLl0/XCIpO1xuICAgIEdsb2JhbFZhcnMuVGVsZXBob25lUmVnZXggPSAvKFxcKz9cXGR7MSwyfShcXHN8LXxcXC4pKT9cXCg/XFxkezN9XFwpP1tcXHMuLV1cXGR7Myx9W1xccy4tXVxcZHs0LH0vO1xuICAgIEdsb2JhbFZhcnMuVGVsZXBob25lUmVnZXhHbG9iYWwgPSAvKFxcKz9cXGR7MSwyfShcXHN8LXxcXC4pKT9cXCg/XFxkezN9XFwpP1tcXHMuLV1cXGR7Myx9W1xccy4tXVxcZHs0LH0vZztcbiAgICBHbG9iYWxWYXJzLkVtYWlsUmVnZXggPSAvKChbXjw+KClcXFtcXF1cXFxcLiw7Olxcc0BcIl0rKFxcLltePD4oKVxcW1xcXVxcXFwuLDs6XFxzQFwiXSspKil8KFwiLitcIikpQCgoXFxbWzAtOV17MSwzfVxcLlswLTldezEsM31cXC5bMC05XXsxLDN9XFwuWzAtOV17MSwzfVxcXSl8KChbYS16QS1aXFwtMC05XStcXC4pK1thLXpBLVpdezIsfSkpLztcbiAgICBHbG9iYWxWYXJzLkVtYWlsUmVnZXhHbG9iYWwgPSAvKChbXjw+KClcXFtcXF1cXFxcLiw7Olxcc0BcIl0rKFxcLltePD4oKVxcW1xcXVxcXFwuLDs6XFxzQFwiXSspKil8KFwiLitcIikpQCgoXFxbWzAtOV17MSwzfVxcLlswLTldezEsM31cXC5bMC05XXsxLDN9XFwuWzAtOV17MSwzfVxcXSl8KChbYS16QS1aXFwtMC05XStcXC4pK1thLXpBLVpdezIsfSkpL2c7XG4gICAgR2xvYmFsVmFycy5VcmxSZWdleCA9IC9eKD86KD86KD86aHR0cHM/fGZ0cCk6KT9cXC9cXC8pKD86XFxTKyg/OjpcXFMqKT9AKT8oPzooPyEoPzoxMHwxMjcpKD86XFwuXFxkezEsM30pezN9KSg/ISg/OjE2OVxcLjI1NHwxOTJcXC4xNjgpKD86XFwuXFxkezEsM30pezJ9KSg/ITE3MlxcLig/OjFbNi05XXwyXFxkfDNbMC0xXSkoPzpcXC5cXGR7MSwzfSl7Mn0pKD86WzEtOV1cXGQ/fDFcXGRcXGR8MlswMV1cXGR8MjJbMC0zXSkoPzpcXC4oPzoxP1xcZHsxLDJ9fDJbMC00XVxcZHwyNVswLTVdKSl7Mn0oPzpcXC4oPzpbMS05XVxcZD98MVxcZFxcZHwyWzAtNF1cXGR8MjVbMC00XSkpfCg/Oig/OlthLXpcXHUwMGExLVxcdWZmZmYwLTldLSopKlthLXpcXHUwMGExLVxcdWZmZmYwLTldKykoPzpcXC4oPzpbYS16XFx1MDBhMS1cXHVmZmZmMC05XS0qKSpbYS16XFx1MDBhMS1cXHVmZmZmMC05XSspKig/OlxcLig/OlthLXpcXHUwMGExLVxcdWZmZmZdezIsfSkpKSg/OjpcXGR7Miw1fSk/KD86Wy8/I11cXFMqKT8kL2k7XG4gICAgR2xvYmFsVmFycy5MaW5rSGFzVGl0bGVUYWdSZWdleEdsb2JhbCA9IC88YVxccyhbXjxdKil0aXRsZT1cXFwiKC4qPylcXFwiPi9naTtcbiAgICBHbG9iYWxWYXJzLlByZWhlYWRlclJlZ2V4R2xvYmFsID0gL1xcPHBcXHNbXlxcPF0qY2xhc3M9XFxcInByZWhlYWRlclxcXCJbXlxcPl0qXFw+L2dpO1xuICAgIEdsb2JhbFZhcnMuUmVxdWlyZWRUcmFja2luZ0NvZGVXaGl0ZWxpc3QgPSBbXG4gICAgICAgICcucGRmJywgJy5pY3MnLCAnLm9mdCcsICdvcHR1bXN1cnZleXMuY28nLCAnaGVhbHRoaWQub3B0dW0uY29tJywgJ2xlYXJuaW5nLm9wdHVtLmNvbScsICdhcHAuaW5mby5vcHR1bS5jb20nLFxuICAgICAgICAnb3B0dW0ud2ViZXguY29tJywgJ3R3aXR0ZXIuY29tJywgJ2ZhY2Vib29rLmNvbScsICdsaW5rZWRpbi5jb20nLCAnaW5mby5vcHR1bSdcbiAgICBdO1xufSkoR2xvYmFsVmFycyB8fCAoR2xvYmFsVmFycyA9IHt9KSk7XG52YXIgRU1MTW9kdWxlO1xuKGZ1bmN0aW9uIChFTUxNb2R1bGUpIHtcbiAgICB2YXIgTWFpbHRvTGlua09iamVjdCA9IChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIE1haWx0b0xpbmtPYmplY3QoTGlua09iamVjdCkge1xuICAgICAgICAgICAgdGhpcy5wYXJlbnQgPSBMaW5rT2JqZWN0O1xuICAgICAgICAgICAgdGhpcy5lbWFpbCA9IFwiXCI7XG4gICAgICAgICAgICB0aGlzLnN1YmplY3QgPSBcIlwiO1xuICAgICAgICAgICAgdGhpcy5ib2R5ID0gXCJcIjtcbiAgICAgICAgICAgIGlmICh0aGlzLnBhcmVudC5pc0xpbmtUeXBlKCdtYWlsdG8nKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuaW5pdEVtYWlsRWRpdG9yKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgTWFpbHRvTGlua09iamVjdC5wcm90b3R5cGUuaGFzID0gZnVuY3Rpb24gKG9wdGlvbikge1xuICAgICAgICAgICAgdGhpcy51cGRhdGVNYWlsdG9PYmooKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzW29wdGlvbl0gJiYgdGhpc1tvcHRpb25dLnRyaW0oKSAhPT0gXCJcIjtcbiAgICAgICAgfTtcbiAgICAgICAgTWFpbHRvTGlua09iamVjdC5wcm90b3R5cGUuaXNWYWxpZEVtYWlsQWRkcmVzcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBHbG9iYWxWYXJzLkVtYWlsUmVnZXgudGVzdCh0aGlzLmVtYWlsKTtcbiAgICAgICAgfTtcbiAgICAgICAgTWFpbHRvTGlua09iamVjdC5wcm90b3R5cGUuZGVpbml0RW1haWxFZGl0b3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLmVtYWlsID0gXCJcIjtcbiAgICAgICAgICAgIHRoaXMuc3ViamVjdCA9IFwiXCI7XG4gICAgICAgICAgICB0aGlzLmJvZHkgPSBcIlwiO1xuICAgICAgICB9O1xuICAgICAgICBNYWlsdG9MaW5rT2JqZWN0LnByb3RvdHlwZS5jb21wb3NlRW1haWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLnBhcmVudC5uZXcudXJsID0gXCJtYWlsdG86XCIgKyB0aGlzLmVtYWlsO1xuICAgICAgICAgICAgdmFyIG9wdGlvbnMgPSBbXCJzdWJqZWN0XCIsIFwiYm9keVwiXTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgb3B0aW9ucy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzW29wdGlvbnNbaV1dICYmIHRoaXNbb3B0aW9uc1tpXV0gIT09IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXJlbnQubmV3LnNlYXJjaFBhcmFtcy5zZXQob3B0aW9uc1tpXSwgdGhpc1tvcHRpb25zW2ldXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHRoaXNbb3B0aW9uc1tpXV0gPT0gXCJcIikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBhcmVudC5uZXcuc2VhcmNoUGFyYW1zLmRlbGV0ZShvcHRpb25zW2ldKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIE1haWx0b0xpbmtPYmplY3QucHJvdG90eXBlLnVwZGF0ZU1haWx0b09iaiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICB2YXIgYSA9IHRoaXMucGFyZW50Lm5ldy51cmwuc3Vic3RyKDcsIHRoaXMucGFyZW50Lm5ldy51cmwubGVuZ3RoIC0gNyk7XG4gICAgICAgICAgICB2YXIgYiA9IGEuc3BsaXQoXCI/XCIpO1xuICAgICAgICAgICAgdGhpcy5lbWFpbCA9IGJbMF07XG4gICAgICAgICAgICB0aGlzLnBhcmVudC5uZXcuc2VhcmNoUGFyYW1zLnVwZGF0ZUVudHJpZXMoKTtcbiAgICAgICAgICAgIGlmIChiLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgICAgICBbXCJzdWJqZWN0XCIsIFwiYm9keVwiXS5mb3JFYWNoKGZ1bmN0aW9uIChvcHRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKF90aGlzLnBhcmVudC5uZXcuc2VhcmNoUGFyYW1zLmhhcyhvcHRpb24pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfdGhpc1tvcHRpb25dID0gd2luZG93LmRlY29kZVVSSUNvbXBvbmVudChfdGhpcy5wYXJlbnQubmV3LnNlYXJjaFBhcmFtcy5nZXQob3B0aW9uKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuc3ViamVjdCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgdGhpcy5ib2R5ID0gXCJcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgTWFpbHRvTGlua09iamVjdC5wcm90b3R5cGUuaW5wdXRPbkJsdXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAvL2RlY29kZWQgdXJsIGFsbCB0aGUgZW50cmllcztcbiAgICAgICAgICAgIC8vcmVlbmNvZGUgdGhlbS5cbiAgICAgICAgICAgIHRoaXMucGFyZW50Lm5ldy5zZWFyY2hQYXJhbXMudXBkYXRlRW50cmllcygpO1xuICAgICAgICAgICAgdGhpcy5wYXJlbnQubmV3LnNlYXJjaFBhcmFtcy51cGRhdGVTZWFyY2hQcm9wKCk7XG4gICAgICAgIH07XG4gICAgICAgIE1haWx0b0xpbmtPYmplY3QucHJvdG90eXBlLm9wZW5FZGl0b3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLmluaXRFbWFpbEVkaXRvcigpO1xuICAgICAgICAgICAgLy8gd2luZG93LmpRdWVyeShcImh0bWwsYm9keVwiKVxuICAgICAgICAgICAgLy8gLmFuaW1hdGUoe3Njcm9sbFRvcDogd2luZG93LmpRdWVyeSgnI2xpbmstJysodGhpcy5wYXJlbnQuaWQtMSkpLm9mZnNldCgpLnRvcCAtIDc1fSwgMzAwKTtcbiAgICAgICAgICAgIHZhciBMTyA9IHRoaXMucGFyZW50O1xuICAgICAgICAgICAgY29uc29sZS5sb2coTE8uaWQgLSAxKTtcbiAgICAgICAgICAgIExPLnNob3dNYWlsdG9FZGl0b3IgPSB0cnVlO1xuICAgICAgICB9O1xuICAgICAgICBNYWlsdG9MaW5rT2JqZWN0LnByb3RvdHlwZS5pbml0RW1haWxFZGl0b3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZU1haWx0b09iaigpO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gTWFpbHRvTGlua09iamVjdDtcbiAgICB9KCkpO1xuICAgIEVNTE1vZHVsZS5NYWlsdG9MaW5rT2JqZWN0ID0gTWFpbHRvTGlua09iamVjdDtcbiAgICB2YXIgVVJMT2JqID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gVVJMT2JqKHVybCkge1xuICAgICAgICAgICAgdGhpcy5ocmVmID0gXCJcIjtcbiAgICAgICAgICAgIHRoaXMuc2VhcmNoID0gXCJcIjtcbiAgICAgICAgICAgIHRoaXMub3JpZ2luID0gXCJcIjtcbiAgICAgICAgICAgIHRoaXMuaGFzaCA9IFwiXCI7XG4gICAgICAgICAgICB0aGlzLnByb3RvY29sID0gXCJcIjtcbiAgICAgICAgICAgIHRoaXMudXJsID0gdXJsO1xuICAgICAgICAgICAgdGhpcy5zZWFyY2hQYXJhbXMgPSBuZXcgVVJMT2JqU2VhcmNoUGFyYW1zKHRoaXMpO1xuICAgICAgICB9XG4gICAgICAgIFVSTE9iai5wcm90b3R5cGUucHJlcGFyZUV4cG9ydCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIC8vZG8gc29tZXRoaW5nIGhlcmU/XG4gICAgICAgICAgICAvL3RoaXMuc2VhcmNoUGFyYW1zLnVwZGF0ZVNlYXJjaFByb3AoKTtcbiAgICAgICAgfTtcbiAgICAgICAgVVJMT2JqLnByb3RvdHlwZS5pc1ZhbGlkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIEdsb2JhbFZhcnMuVXJsUmVnZXgudGVzdCh0aGlzLnVybCk7XG4gICAgICAgIH07XG4gICAgICAgIFVSTE9iai5wcm90b3R5cGUuY29udGFpbnMgPSBmdW5jdGlvbiAoc3RyKSB7XG4gICAgICAgICAgICBpZiAodGhpcy51cmwuaW5kZXhPZihzdHIpID4gLTEpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFVSTE9iai5wcm90b3R5cGUsIFwidXJsXCIsIHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHRoaXMucHJlcGFyZUV4cG9ydCgpO1xuICAgICAgICAgICAgICAgIHZhciB1ID0gdGhpcy5vcmlnaW4gKyB0aGlzLnNlYXJjaCArIHRoaXMuaGFzaDtcbiAgICAgICAgICAgICAgICB1ID0gdS5yZXBsYWNlKFwiP3VuZGVmaW5lZFwiLCBcIlwiKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uICh1cmwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNlYXJjaCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgdGhpcy5oYXNoID0gXCJcIjtcbiAgICAgICAgICAgICAgICB2YXIgcHJvdG9jb2xUeXBlID0gL14oaHR0cHM/fG1haWx0b3xmdHApXFw6L2dpO1xuICAgICAgICAgICAgICAgIGlmIChwcm90b2NvbFR5cGUudGVzdCh1cmwpKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBhID0gdXJsLm1hdGNoKHByb3RvY29sVHlwZSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJvdG9jb2wgPSBhWzBdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLmhyZWYgPSB1cmw7XG4gICAgICAgICAgICAgICAgaWYgKHVybC50cmltKCkgPT0gXCIjXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oYXNoID0gXCIjXCI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHVybC50cmltKCkubGVuZ3RoID4gMSAmJiB1cmwuaW5kZXhPZihcIiNcIikgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdXJsUGFydHMgPSB1cmwuc3BsaXQoXCIjXCIpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmhhc2ggPSBcIiNcIiArIHVybFBhcnRzLnBvcCgpOyAvL2p1bXAgbGluay4uIG5lZWQgdG8gcmVtb3ZlIGl0IGZyb20gdGhlIG90aGVyIHN0dWZmLlxuICAgICAgICAgICAgICAgICAgICB2YXIgcGFydHMgPSAodXJsUGFydHMuam9pbihcIiNcIikpLnNwbGl0KFwiP1wiKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vcmlnaW4gPSBwYXJ0c1swXTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWFyY2ggPSBwYXJ0cy5sZW5ndGggPiAwID8gXCI/XCIgKyBwYXJ0c1sxXSA6IFwiXCI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAodXJsLmluZGV4T2YoXCI/XCIpID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXJ0cyA9IHVybC5zcGxpdChcIj9cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9yaWdpbiA9IHBhcnRzWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWFyY2ggPSAocGFydHMubGVuZ3RoID4gMCkgPyBcIj9cIiArIHBhcnRzWzFdIDogXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub3JpZ2luID0gdXJsO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vdGhpcy5zZWFyY2hQYXJhbXMudXBkYXRlU2VhcmNoUHJvcCgpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBVUkxPYmo7XG4gICAgfSgpKTtcbiAgICBFTUxNb2R1bGUuVVJMT2JqID0gVVJMT2JqO1xuICAgIHZhciBVUkxPYmpTZWFyY2hQYXJhbXMgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBVUkxPYmpTZWFyY2hQYXJhbXMocGFyZW50KSB7XG4gICAgICAgICAgICB0aGlzLnBhcmVudCA9IHBhcmVudDtcbiAgICAgICAgICAgIGlmICh0aGlzLnBhcmVudC5zZWFyY2gubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX2VudHJpZXMgPSAodGhpcy5wYXJlbnQuc2VhcmNoLnN1YnN0cigxLCB0aGlzLnBhcmVudC5zZWFyY2gubGVuZ3RoKSkuc3BsaXQoL1xcJmFtcFxcO3xcXCYvZyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9lbnRyaWVzID0gW107XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFVSTE9ialNlYXJjaFBhcmFtcy5wcm90b3R5cGUsIFwiZW50cmllc1wiLCB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgb3V0cHV0ID0gW107XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLl9lbnRyaWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBhID0gdGhpcy5fZW50cmllc1tpXS5zcGxpdChcIj1cIik7XG4gICAgICAgICAgICAgICAgICAgIGlmIChhLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGFbMV0gPSBkZWNvZGVVUklDb21wb25lbnQoYVsxXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgb3V0cHV0LnB1c2goYS5qb2luKFwiPVwiKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgICB9KTtcbiAgICAgICAgVVJMT2JqU2VhcmNoUGFyYW1zLnByb3RvdHlwZS51cGRhdGVFbnRyaWVzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5fZW50cmllcyA9IFtdO1xuICAgICAgICAgICAgaWYgKHRoaXMucGFyZW50LnNlYXJjaCAhPT0gXCI/XCIgJiYgdGhpcy5wYXJlbnQuc2VhcmNoLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgICAgICB2YXIgcHJvcHMgPSAodGhpcy5wYXJlbnQuc2VhcmNoLnN1YnN0cigxLCB0aGlzLnBhcmVudC5zZWFyY2gubGVuZ3RoKSkuc3BsaXQoL1xcJmFtcFxcO3xcXCYvZyk7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9lbnRyaWVzLnB1c2gocHJvcHNbaV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgVVJMT2JqU2VhcmNoUGFyYW1zLnByb3RvdHlwZS51cGRhdGVTZWFyY2hQcm9wID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIG91dHB1dCA9IFtdO1xuICAgICAgICAgICAgaWYgKHRoaXMuX2VudHJpZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5fZW50cmllcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcHJvcCA9IHRoaXMuX2VudHJpZXNbaV0uc3BsaXQoXCI9XCIpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoL1thLXpdezEsNH09KC4qPzopezMsOX0vZ2kudGVzdCh0aGlzLl9lbnRyaWVzW2ldKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0LnB1c2godGhpcy5fZW50cmllc1tpXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXQucHVzaChwcm9wWzBdICsgKHByb3AubGVuZ3RoID4gMSA/IFwiPVwiICsgZW5jb2RlVVJJQ29tcG9uZW50KGRlY29kZVVSSUNvbXBvbmVudChwcm9wWzFdKSkgOiBcIlwiKSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnBhcmVudC5zZWFyY2ggPSBvdXRwdXQubGVuZ3RoID4gMCA/IFwiP1wiICsgb3V0cHV0LmpvaW4oXCImXCIpIDogXCJcIjtcbiAgICAgICAgfTtcbiAgICAgICAgVVJMT2JqU2VhcmNoUGFyYW1zLnByb3RvdHlwZS5oYXMgPSBmdW5jdGlvbiAocGFyYW0pIHtcbiAgICAgICAgICAgIHZhciByZWdleCA9IG5ldyBSZWdFeHAoXCJeXCIgKyBwYXJhbSArIFwiXFw9XCIsIFwiZ1wiKTtcbiAgICAgICAgICAgIHZhciBvdXRwdXQgPSBmYWxzZTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5fZW50cmllcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmIChyZWdleC50ZXN0KHRoaXMuX2VudHJpZXNbaV0pKVxuICAgICAgICAgICAgICAgICAgICBvdXRwdXQgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICAgICAgfTtcbiAgICAgICAgVVJMT2JqU2VhcmNoUGFyYW1zLnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiAocGFyYW0pIHtcbiAgICAgICAgICAgIHZhciByZWdleCA9IG5ldyBSZWdFeHAoXCJeXCIgKyBwYXJhbSArIFwiXFw9XCIsIFwiZ1wiKSwgb3V0cHV0ID0gZmFsc2U7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuX2VudHJpZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAocmVnZXgudGVzdCh0aGlzLl9lbnRyaWVzW2ldKSkge1xuICAgICAgICAgICAgICAgICAgICBvdXRwdXQgPSAodGhpcy5fZW50cmllc1tpXS5zcGxpdChcIj1cIikpLnBvcCgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgICAgIH07XG4gICAgICAgIFVSTE9ialNlYXJjaFBhcmFtcy5wcm90b3R5cGUuc2V0ID0gZnVuY3Rpb24gKHBhcmFtLCB2YWx1ZSkge1xuICAgICAgICAgICAgdmFyIHJlZ2V4ID0gbmV3IFJlZ0V4cChcIl5cIiArIHBhcmFtICsgXCJcXD1cIiwgXCJnXCIpLCBvdXRwdXQgPSBmYWxzZTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5fZW50cmllcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmIChyZWdleC50ZXN0KHRoaXMuX2VudHJpZXNbaV0pKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2VudHJpZXNbaV0gPSBwYXJhbSArIFwiPVwiICsgdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIG91dHB1dCA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCFvdXRwdXQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFwcGVuZChwYXJhbSArIFwiPVwiICsgdmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy51cGRhdGVTZWFyY2hQcm9wKCk7XG4gICAgICAgIH07XG4gICAgICAgIFVSTE9ialNlYXJjaFBhcmFtcy5wcm90b3R5cGUuYXBwZW5kID0gZnVuY3Rpb24gKHZhbHVlUGFpcikge1xuICAgICAgICAgICAgdGhpcy5fZW50cmllcy5wdXNoKHZhbHVlUGFpcik7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVNlYXJjaFByb3AoKTtcbiAgICAgICAgfTtcbiAgICAgICAgVVJMT2JqU2VhcmNoUGFyYW1zLnByb3RvdHlwZS5kZWxldGVBbGwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLl9lbnRyaWVzID0gW107XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVNlYXJjaFByb3AoKTtcbiAgICAgICAgfTtcbiAgICAgICAgVVJMT2JqU2VhcmNoUGFyYW1zLnByb3RvdHlwZS5kZWxldGVBdEluZGV4ID0gZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICAgICAgICB0aGlzLl9lbnRyaWVzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVNlYXJjaFByb3AoKTtcbiAgICAgICAgfTtcbiAgICAgICAgVVJMT2JqU2VhcmNoUGFyYW1zLnByb3RvdHlwZS5kZWxldGUgPSBmdW5jdGlvbiAocGFyYW0pIHtcbiAgICAgICAgICAgIC8vZG9lc250IGRvIGFueXRoaW5nIHlldC5cbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5fZW50cmllcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9lbnRyaWVzW2ldLnN1YnN0cigwLCBwYXJhbS5sZW5ndGggKyAxKSA9PSBwYXJhbSArIFwiPVwiKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGVsZXRlQXRJbmRleChpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBVUkxPYmpTZWFyY2hQYXJhbXM7XG4gICAgfSgpKTtcbiAgICBFTUxNb2R1bGUuVVJMT2JqU2VhcmNoUGFyYW1zID0gVVJMT2JqU2VhcmNoUGFyYW1zO1xuICAgIHZhciBMaW5rZWRJbWFnZSA9IChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIExpbmtlZEltYWdlKF9zdXBlciwgY29kZSkge1xuICAgICAgICAgICAgdGhpcy5jb250ZXh0ID0gY29kZTtcbiAgICAgICAgICAgIHRoaXMuX3N1cGVyID0gX3N1cGVyO1xuICAgICAgICAgICAgdmFyIHRhZ3MgPSBbXCJzcmNcIiwgXCJhbHRcIiwgXCJoZWlnaHRcIiwgXCJ3aWR0aFwiXTtcbiAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgdGFnc18xID0gdGFnczsgX2kgPCB0YWdzXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRhZyA9IHRhZ3NfMVtfaV07XG4gICAgICAgICAgICAgICAgdmFyIHJlZ2V4ID0gbmV3IFJlZ0V4cCh0YWcgKyBcIj1cXFwiKFteXFxcIl0uKj8pP1xcXCJcIiwgXCJpXCIpO1xuICAgICAgICAgICAgICAgIGlmIChyZWdleC50ZXN0KGNvZGUpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXNbdGFnXSA9IGNvZGUubWF0Y2gocmVnZXgpWzFdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBoYXNXaWR0aCA9IHRoaXMud2lkdGggJiYgcGFyc2VJbnQodGhpcy53aWR0aC50b1N0cmluZygpKTtcbiAgICAgICAgICAgIHZhciBoYXNIZWlnaHQgPSB0aGlzLmhlaWdodCAmJiBwYXJzZUludCh0aGlzLmhlaWdodC50b1N0cmluZygpKTtcbiAgICAgICAgICAgIGlmICghaGFzV2lkdGggfHwgIWhhc0hlaWdodCkge1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgdGhpcy5zcmMgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcmVsb2FkSW1hZ2UodGhpcy5zcmMpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gLy9laXRoZXIgaXMgbm90IHNldFxuICAgICAgICB9XG4gICAgICAgIExpbmtlZEltYWdlLnByb3RvdHlwZS5wcmVsb2FkSW1hZ2UgPSBmdW5jdGlvbiAoc3JjKSB7XG4gICAgICAgICAgICB2YXIgTEkgPSB0aGlzO1xuICAgICAgICAgICAgdmFyIGltZyA9IG5ldyBJbWFnZSgpO1xuICAgICAgICAgICAgLy8gaW1nLnN0eWxlLnZpc2liaWxpdHkgPSBcImhpZGRlblwiO1xuICAgICAgICAgICAgaW1nLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBMSS5oZWlnaHQgPSBpbWcuaGVpZ2h0O1xuICAgICAgICAgICAgICAgIExJLndpZHRoID0gaW1nLndpZHRoO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGltZy5oZWlnaHQsIGltZy53aWR0aCk7XG4gICAgICAgICAgICAgICAgaW1nLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoaW1nKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBpbWcuc3JjID0gTEkuc3JjO1xuICAgICAgICAgICAgY29uc29sZS5sb2coaW1nKTtcbiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoaW1nKTtcbiAgICAgICAgfTtcbiAgICAgICAgTGlua2VkSW1hZ2UucHJvdG90eXBlLmdlbmVyYXRlT3V0cHV0ID0gZnVuY3Rpb24gKGNvbnRlbnQpIHtcbiAgICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgICAgICBpZiAodGhpcy5jb250ZXh0LmluZGV4T2YoXCJhbHRcIikgPiAtMSkge1xuICAgICAgICAgICAgICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UodGhpcy5jb250ZXh0LCBmdW5jdGlvbiAoZikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZi5yZXBsYWNlKC9hbHRcXD1cXFwiKFteXFxcIl0uKj8pP1xcXCIvZywgXCJhbHQ9XFxcIlwiICsgKF90aGlzLmFsdCA9PT0gdW5kZWZpbmVkID8gXCJcIiA6IF90aGlzLmFsdCkgKyBcIlxcXCJcIik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKHRoaXMuY29udGV4dCwgZnVuY3Rpb24gKGYpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGYucmVwbGFjZShcIjxpbWdcIiwgXCI8aW1nIGFsdD1cXFwiXCIgKyAoX3RoaXMuYWx0ID09PSB1bmRlZmluZWQgPyBcIlwiIDogX3RoaXMuYWx0KSArIFwiXFxcIlwiKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBjb250ZW50O1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gTGlua2VkSW1hZ2U7XG4gICAgfSgpKTtcbiAgICBFTUxNb2R1bGUuTGlua2VkSW1hZ2UgPSBMaW5rZWRJbWFnZTtcbiAgICB2YXIgTGlua09iamVjdCA9IChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIExpbmtPYmplY3QobGluZSwgY29udGV4dCwgcGFyZW50KSB7XG4gICAgICAgICAgICB0aGlzLl9faXNDb21wbGV0ZSA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5fc3VwZXIgPSBwYXJlbnQ7XG4gICAgICAgICAgICB0aGlzLnNob3dRdWVyeVN0cmluZ0VkaXRvciA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5zaG93TWFpbHRvRWRpdG9yID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLmlkID0gMDtcbiAgICAgICAgICAgIHRoaXMubGluZSA9IGxpbmUgKyAxO1xuICAgICAgICAgICAgdGhpcy5jb250ZXh0ID0gY29udGV4dDtcbiAgICAgICAgICAgIHRoaXMucXVlcnlTdHJpbmdzID0gW107XG4gICAgICAgICAgICB0aGlzLkNoYW5nZU1vbml0b3IgPSBuZXcgQ2hhbmdlTW9uaXRvcih0aGlzKTtcbiAgICAgICAgICAgIHRoaXMuZXJyb3JzID0gRU1MSW50ZWxsaWdlbmNlLm1vZHVsZShcImh5cGVybGlua1wiKS5tb25pdG9yKCk7XG4gICAgICAgICAgICB0aGlzLmVycm9ycy5hc3NvY2lhdGVWYXJpYWJsZShcIkxpbmtPYmplY3RcIiwgdGhpcyk7XG4gICAgICAgICAgICB0aGlzLndoaXRlTGlzdGVkVXJsID0gXCJ+fndoaXRlbGlzdH5+XCI7XG4gICAgICAgICAgICAvL2ZpbmQgaHJlZlxuICAgICAgICAgICAgdGhpcy5fX2xvY2F0ZUhyZWYoY29udGV4dCk7XG4gICAgICAgICAgICAvL2ZpbmQgaW1hZ2VcbiAgICAgICAgICAgIHRoaXMuX19sb2NhdGVMaW5rZWRJbWFnZShjb250ZXh0KTtcbiAgICAgICAgICAgIC8vbmVlZCB0byBzZXQgdGhlIHVybCBiZWZvcmUgeW91IGRvIHRoaXM7XG4gICAgICAgICAgICB0aGlzLm1haWx0byA9IG5ldyBNYWlsdG9MaW5rT2JqZWN0KHRoaXMpO1xuICAgICAgICAgICAgdGhpcy5pc0xpbmtDb21wbGV0ZSgpO1xuICAgICAgICB9XG4gICAgICAgIExpbmtPYmplY3QucHJvdG90eXBlLl9fbG9jYXRlSHJlZiA9IGZ1bmN0aW9uIChjb250ZXh0KSB7XG4gICAgICAgICAgICB2YXIgcmUyID0gL2hyZWZcXD1cXFwiKFteXFxcIlxcPl0qKVxcXCIvZztcbiAgICAgICAgICAgIHZhciBocmVmID0gY29udGV4dC5tYXRjaChyZTIpO1xuICAgICAgICAgICAgaWYgKGhyZWYubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGlmIChocmVmWzBdID09IFwiaHJlZj1cXFwiXFxcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubmV3ID0gbmV3IFVSTE9iaihcIiNcIik7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMub2xkID0gbmV3IFVSTE9iaihcIiNcIik7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY29udGV4dCA9IHRoaXMuY29udGV4dC5yZXBsYWNlKG5ldyBSZWdFeHAoXCJocmVmPVxcXCJcXFwiXCIsIFwiZ1wiKSwgXCJocmVmPVxcXCIjXFxcIlwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubmV3ID0gbmV3IFVSTE9iaigoaHJlZlswXS5zdWJzdHIoNiwgaHJlZlswXS5sZW5ndGggLSA3KSkudHJpbSgpKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vbGQgPSBuZXcgVVJMT2JqKChocmVmWzBdLnN1YnN0cig2LCBocmVmWzBdLmxlbmd0aCAtIDcpKS50cmltKCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgTGlua09iamVjdC5wcm90b3R5cGUuX19sb2NhdGVMaW5rZWRJbWFnZSA9IGZ1bmN0aW9uIChjb250ZXh0KSB7XG4gICAgICAgICAgICBpZiAoL1xcPGltZyhbXj5dLio/KVxcPi8udGVzdChjb250ZXh0KSkge1xuICAgICAgICAgICAgICAgIHZhciBmb3VuZCA9IGNvbnRleHQubWF0Y2goL1xcPGltZyhbXj5dLio/KVxcPi8pO1xuICAgICAgICAgICAgICAgIGlmIChmb3VuZC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuTGlua2VkSW1hZ2UgPSBuZXcgTGlua2VkSW1hZ2UodGhpcywgZm91bmRbMF0pO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLkxpbmtlZEltYWdlT2xkID0gbmV3IExpbmtlZEltYWdlKHRoaXMsIGZvdW5kWzBdKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIExpbmtPYmplY3QucHJvdG90eXBlLmhhc0R1cGxpY2F0ZVF1ZXJ5U3RyaW5ncyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSBbXSwgdXNlZFN0cmluZ3MgPSBbXTtcbiAgICAgICAgICAgIGlmICh0aGlzLm5ldy5zZWFyY2hQYXJhbXMuZW50cmllcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBfYSA9IHRoaXMubmV3LnNlYXJjaFBhcmFtcy5lbnRyaWVzOyBfaSA8IF9hLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgYSA9IF9hW19pXTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBhcmFtID0gYS5zcGxpdChcIj1cIikuc2hpZnQoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHVzZWRTdHJpbmdzLmluZGV4T2YocGFyYW0pID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKHBhcmFtKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB1c2VkU3RyaW5ncy5wdXNoKHBhcmFtKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocmVzdWx0Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBMaW5rT2JqZWN0LnByb3RvdHlwZS5vdmVycmlkZVRyYWNraW5nUmVxdWlyZW1lbnRzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy53aGl0ZUxpc3RlZFVybCA9IHRoaXMubmV3LnVybDtcbiAgICAgICAgfTtcbiAgICAgICAgTGlua09iamVjdC5wcm90b3R5cGUuZGlzcGxheUZvcm1hdHRlZFVSTCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIC8vZGlzcGxheXMgdXJsO1xuICAgICAgICAgICAgdmFyIGNvbnRlbnQgPSB0aGlzLmNvbnRleHQ7XG4gICAgICAgICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC9cXHNlbWxcXC1pZFxcPVxcXCIoWzAtOV0qKVxcXCIvLCBcIlwiKTtcbiAgICAgICAgICAgIHZhciBmaW5kU3RhcnQgPSBcImhyZWY9XFxcIlwiO1xuICAgICAgICAgICAgdmFyIHN0YXJ0ID0gY29udGVudC5pbmRleE9mKGZpbmRTdGFydCk7XG4gICAgICAgICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKG5ldyBSZWdFeHAoXCJocmVmPVxcXCJcXFwiXCIsIFwiZ1wiKSwgXCJocmVmPVxcXCIjXFxcIlwiKTtcbiAgICAgICAgICAgIC8vIHZhciBpbWdSZWcgPSAvXFw8aW1nKFtePl0uKj8pXFw+L2c7XG4gICAgICAgICAgICBpZiAodGhpcy5MaW5rZWRJbWFnZSkge1xuICAgICAgICAgICAgICAgIGNvbnRlbnQgPSB0aGlzLkxpbmtlZEltYWdlLmdlbmVyYXRlT3V0cHV0KGNvbnRlbnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29udGVudCA9IGNvbnRlbnQuc3Vic3RyKDAsIHN0YXJ0KSArIGZpbmRTdGFydCArIFwifHx8YS5ocmVmfHx8XCIgKyBjb250ZW50LnN1YnN0cihzdGFydCArIChmaW5kU3RhcnQubGVuZ3RoICsgKHRoaXMub2xkLnVybC5sZW5ndGgpKSwgY29udGVudC5sZW5ndGgpO1xuICAgICAgICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZShuZXcgUmVnRXhwKFwiXFxcIlwiLCBcImdcIiksIFwiJnF1b3Q7XCIpO1xuICAgICAgICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZShuZXcgUmVnRXhwKFwiL1wiLCBcImdcIiksIFwiJiM0NztcIik7XG4gICAgICAgICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKG5ldyBSZWdFeHAoXCI+XCIsIFwiZ1wiKSwgXCImZ3Q7XCIpO1xuICAgICAgICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZShuZXcgUmVnRXhwKFwiPFwiLCBcImdcIiksIFwiJmx0O1wiKTtcbiAgICAgICAgICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoLyhbXlxcc10qPylcXD0vZywgXCI8c3BhbiBjbGFzcz1cXFwiYXR0clxcXCI+JDE8L3NwYW4+PHNwYW4gY2xhc3M9XFxcImtleXdvcmRcXFwiPj08L3NwYW4+XCIpO1xuICAgICAgICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvXFwmcXVvdFxcO1xcJmd0XFw7L2csIFwiJnF1b3Q7PHNwYW4gY2xhc3M9XFxcInRhZ1xcXCI+Jmd0Ozwvc3Bhbj5cIik7XG4gICAgICAgICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC9cXCZcXCM0N1xcO1xcJmd0XFw7L2csIFwiPHNwYW4gY2xhc3M9XFxcInRhZ1xcXCI+JiM0NzsmZ3Q7PC9zcGFuPlwiKTtcbiAgICAgICAgICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoL1xcJnF1b3RcXDsoLio/KVxcJnF1b3RcXDsvZywgXCI8c3BhbiBjbGFzcz1cXFwidmFsdWVcXFwiPlxcXCIkMVxcXCI8L3NwYW4+XCIpO1xuICAgICAgICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvXFwmbHRcXDsoW2Etel0rXFxzPykvZywgXCI8c3BhbiBjbGFzcz1cXFwidGFnXFxcIj4mbHQ7JDE8L3NwYW4+XCIpO1xuICAgICAgICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvXFwmbHRcXDtcXCZcXCM0N1xcOyhbYS16XStcXHM/KVxcJmd0XFw7L2csIFwiPHNwYW4gY2xhc3M9XFxcInRhZ1xcXCI+Jmx0OyYjNDc7JDEmZ3Q7PC9zcGFuPlwiKTtcbiAgICAgICAgICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoL1xcbi9nLCBcIjxicj5cIik7XG4gICAgICAgICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC9cXCZndFxcOy9nLCBcIjxzcGFuIGNsYXNzPVxcXCJ0YWdcXFwiPiZndDs8L3NwYW4+XCIpO1xuICAgICAgICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvXFxzezN9L2csIFwiJm5ic3A7Jm5ic3A7Jm5ic3BcIik7XG4gICAgICAgICAgICAvLyBpZih0aGlzLkxpbmtlZEltYWdlKSB7XG4gICAgICAgICAgICAvLyAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoL1xcfFxcfFxcfGltZ1xcLmFsdFxcfFxcfFxcfC9nLCB0aGlzLkxpbmtlZEltYWdlLmFsdCA9PT0gdW5kZWZpbmVkID8gXCJcIiA6IHRoaXMuTGlua2VkSW1hZ2UuYWx0KTtcbiAgICAgICAgICAgIC8vIH1cbiAgICAgICAgICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoL1xcfFxcfFxcfGFcXC5ocmVmXFx8XFx8XFx8L2csIFwiPHN0cm9uZz5cIiArICh0aGlzLmhhc093blByb3BlcnR5KFwiZGVsZXRlT25SZW5kZXJcIikgJiYgdGhpcy5kZWxldGVPblJlbmRlciA/IHRoaXMub2xkLnVybCA6IHRoaXMubmV3LnVybCkgKyBcIjwvc3Ryb25nPlwiKTtcbiAgICAgICAgICAgIHJldHVybiBjb250ZW50O1xuICAgICAgICB9O1xuICAgICAgICBMaW5rT2JqZWN0LnByb3RvdHlwZS5pc0xpbmtDb21wbGV0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIC8vaW50ZWxsaWdlbmNlIHNjYW5zOlxuICAgICAgICAgICAgdGhpcy5fc3VwZXIuaW50ZWxsaWdlbmNlLmV2YWx1YXRlUnVsZXMoKTtcbiAgICAgICAgICAgIHRoaXMuZXJyb3JzLmV2YWx1YXRlUnVsZXMoKTtcbiAgICAgICAgICAgIC8vdHJhY2sgY2hhbmdlczpcbiAgICAgICAgICAgIHRoaXMuQ2hhbmdlTW9uaXRvci51cGRhdGUoKTtcbiAgICAgICAgICAgIHRoaXMuX19pc0NvbXBsZXRlID0gdGhpcy5lcnJvcnMuY2FuQ29udGludWU7XG4gICAgICAgICAgICBpZiAodGhpcy5oYXNPd25Qcm9wZXJ0eShcImRlbGV0ZU9uUmVuZGVyXCIpICYmIHRoaXMuZGVsZXRlT25SZW5kZXIpXG4gICAgICAgICAgICAgICAgdGhpcy5fX2lzQ29tcGxldGUgPSB0cnVlO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX19pc0NvbXBsZXRlO1xuICAgICAgICB9O1xuICAgICAgICBMaW5rT2JqZWN0LnByb3RvdHlwZS5pc0xpbmtUeXBlID0gZnVuY3Rpb24gKHR5cGUpIHtcbiAgICAgICAgICAgIHZhciBvdXRwdXQgPSBmYWxzZTtcbiAgICAgICAgICAgIHN3aXRjaCAodHlwZSkge1xuICAgICAgICAgICAgICAgIGNhc2UgXCJodHRwXCI6XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm5ldy5wcm90b2NvbCA9PSBcImh0dHA6XCIgfHwgdGhpcy5uZXcucHJvdG9jb2wgPT0gXCJodHRwczpcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIFwibWFpbHRvXCI6XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm5ldy5wcm90b2NvbCA9PSBcIm1haWx0bzpcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICAgICAgfTtcbiAgICAgICAgTGlua09iamVjdC5wcm90b3R5cGUuaGFzVHJhY2tpbmdDb2RlID0gZnVuY3Rpb24gKG9iaikge1xuICAgICAgICAgICAgaWYgKG9iaiA9PT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgICAgIG9iaiA9IHRoaXMubmV3LnVybDtcbiAgICAgICAgICAgIC8vIGlmKHRoaXMud2hpdGVMaXN0ZWRVcmw9PXRoaXMubmV3KSByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIHZhciBhID0gL1thLXpdezEsNH09KC4qPzopezMsOX0vaWc7XG4gICAgICAgICAgICByZXR1cm4gYS50ZXN0KG9iaik7XG4gICAgICAgIH07XG4gICAgICAgIExpbmtPYmplY3QucHJvdG90eXBlLnJlcXVpcmVzVHJhY2tpbmdDb2RlID0gZnVuY3Rpb24gKG9iaikge1xuICAgICAgICAgICAgdmFyIG91dHB1dCA9IGZhbHNlO1xuICAgICAgICAgICAgaWYgKEdsb2JhbFZhcnMuUmVxdWlyZXNUcmFja2luZ0NvZGVSZWdleC50ZXN0KHRoaXMubmV3LnVybCkpIHtcbiAgICAgICAgICAgICAgICBvdXRwdXQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIC8vIGl0ZXJhdGUgb2ZlciB3aGl0ZWxpc3RcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IEdsb2JhbFZhcnMuUmVxdWlyZWRUcmFja2luZ0NvZGVXaGl0ZWxpc3QubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKEdsb2JhbFZhcnMuUmVxdWlyZWRUcmFja2luZ0NvZGVXaGl0ZWxpc3RbaV0gaW5zdGFuY2VvZiBSZWdFeHApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChHbG9iYWxWYXJzLlJlcXVpcmVkVHJhY2tpbmdDb2RlV2hpdGVsaXN0W2ldW1widGVzdFwiXSh0aGlzLm5ldy51cmwpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5uZXcudXJsLmluZGV4T2YoR2xvYmFsVmFycy5SZXF1aXJlZFRyYWNraW5nQ29kZVdoaXRlbGlzdFtpXSkgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG91dHB1dCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICAgICAgfTtcbiAgICAgICAgTGlua09iamVjdC5wcm90b3R5cGUucmVxdWlyZXNTQ29kZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmIChHbG9iYWxWYXJzLlJlcXVpcmVzU0NvZGVSZWdleC50ZXN0KHRoaXMubmV3LnVybCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgTGlua09iamVjdC5wcm90b3R5cGUubmVlZHNUcmFja2luZ0NvZGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgb3V0cHV0ID0gdGhpcy5yZXF1aXJlc1RyYWNraW5nQ29kZSgpO1xuICAgICAgICAgICAgaWYgKHRoaXMud2hpdGVMaXN0ZWRVcmwgPT0gdGhpcy5uZXcudXJsKVxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIC8vIGRldGVybWluZSBsaW5rcyB0aGF0IG5lZWQgc3BlY2lhbCB0cmFja2luZ1xuICAgICAgICAgICAgaWYgKHRoaXMuaGFzVHJhY2tpbmdDb2RlKCkpIHtcbiAgICAgICAgICAgICAgICBvdXRwdXQgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgICAgIH07XG4gICAgICAgIExpbmtPYmplY3QucHJvdG90eXBlLnVwZGF0ZUlucHV0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuaXNMaW5rVHlwZSgnbWFpbHRvJykpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm1haWx0by51cGRhdGVNYWlsdG9PYmooKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMubmV3LnNlYXJjaFBhcmFtcy51cGRhdGVFbnRyaWVzKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmlzTGlua0NvbXBsZXRlKCk7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBMaW5rT2JqZWN0O1xuICAgIH0oKSk7XG4gICAgRU1MTW9kdWxlLkxpbmtPYmplY3QgPSBMaW5rT2JqZWN0O1xuICAgIHZhciBDaGFuZ2VNb25pdG9yID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gQ2hhbmdlTW9uaXRvcihfc3VwZXIpIHtcbiAgICAgICAgICAgIHRoaXMudmlzaWJsZSA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5fc3VwZXIgPSBfc3VwZXI7XG4gICAgICAgICAgICB0aGlzLm1lc3NhZ2VzID0gW107XG4gICAgICAgIH1cbiAgICAgICAgQ2hhbmdlTW9uaXRvci5wcm90b3R5cGUuY29tcGFyZU9sZEFuZE5ldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciB1cmxQYXJhbXMgPSBbXCJwcm90b2NvbFwiLCBcIm9yaWdpblwiLCBcInNlYXJjaFwiLCBcImhhc2hcIl07XG4gICAgICAgICAgICB2YXIgY2hhbmdlZCA9IFtdO1xuICAgICAgICAgICAgdmFyIF9zdXBlciA9IHRoaXMuX3N1cGVyO1xuICAgICAgICAgICAgdXJsUGFyYW1zLmZvckVhY2goZnVuY3Rpb24gKHBhcmFtKSB7XG4gICAgICAgICAgICAgICAgaWYgKF9zdXBlci5vbGQuaGFzT3duUHJvcGVydHkocGFyYW0pICYmIF9zdXBlci5vbGRbcGFyYW1dICE9PSBfc3VwZXIubmV3W3BhcmFtXSkge1xuICAgICAgICAgICAgICAgICAgICBjaGFuZ2VkLnB1c2gocGFyYW0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKF9zdXBlci5MaW5rZWRJbWFnZSAmJiBfc3VwZXIuTGlua2VkSW1hZ2UuYWx0ICE9PSBfc3VwZXIuTGlua2VkSW1hZ2VPbGQuYWx0KSB7XG4gICAgICAgICAgICAgICAgY2hhbmdlZC5wdXNoKFwiYWx0XCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGNoYW5nZWQ7XG4gICAgICAgIH07XG4gICAgICAgIENoYW5nZU1vbml0b3IucHJvdG90eXBlLmJlZm9yZURpZFJldHVybkNoYW5nZXMgPSBmdW5jdGlvbiAoKSB7IH07XG4gICAgICAgIENoYW5nZU1vbml0b3IucHJvdG90eXBlLmFmdGVyRGlkUmV0dXJuQ2hhbmdlcyA9IGZ1bmN0aW9uICgpIHsgfTtcbiAgICAgICAgQ2hhbmdlTW9uaXRvci5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX3N1cGVyLnJlYWRPbmx5ID09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgdmFyIG91dHB1dCA9IFtdO1xuICAgICAgICAgICAgICAgIHZhciBjaGFuZ2VzID0gdGhpcy5jb21wYXJlT2xkQW5kTmV3KCk7XG4gICAgICAgICAgICAgICAgdmFyIENNID0gdGhpcztcbiAgICAgICAgICAgICAgICBjaGFuZ2VzLmZvckVhY2goZnVuY3Rpb24gKHNjb3BlKSB7XG4gICAgICAgICAgICAgICAgICAgIG91dHB1dC5wdXNoKENNLmFydGljdWxhdGVDaGFuZ2VzKHNjb3BlLCB7fSkpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRoaXMubWVzc2FnZXMgPSBvdXRwdXQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIENoYW5nZU1vbml0b3IucHJvdG90eXBlLmNvbXBhcmVTZWFyY2hTdHJpbmdzID0gZnVuY3Rpb24gKG9sZFAsIG5ld1ApIHtcbiAgICAgICAgICAgIHZhciBwYXlsb2FkID0ge1xuICAgICAgICAgICAgICAgIGFkZGVkOiBbXSxcbiAgICAgICAgICAgICAgICB1cGRhdGVkOiBbXSxcbiAgICAgICAgICAgICAgICByZW1vdmVkOiBbXVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgaW4gb2xkUCkge1xuICAgICAgICAgICAgICAgIGlmIChuZXdQLmluZGV4T2Yob2xkUFtpXSkgPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHBheWxvYWQucmVtb3ZlZC5wdXNoKG9sZFBbaV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAoaSBpbiBuZXdQKSB7XG4gICAgICAgICAgICAgICAgaWYgKG9sZFAuaW5kZXhPZihuZXdQW2ldKSA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgcGF5bG9hZC5hZGRlZC5wdXNoKG5ld1BbaV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBmaW5kX3BhdHRlcm5faW5BcnJheSA9IGZ1bmN0aW9uIChwYXR0ZXJuLCBhcnIpIHtcbiAgICAgICAgICAgICAgICB2YXIgb3V0cHV0ID0gLTE7XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgeSA9IDA7IHkgPCBhcnIubGVuZ3RoOyB5KyspIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coXCJ1dXBkYXRyZWQ/XCIseSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChwYXR0ZXJuLnRlc3QoYXJyW3ldKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0ID0geTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gb3V0cHV0O1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGZvciAoaSBpbiBvbGRQKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlID0gbmV3IFJlZ0V4cChvbGRQW2ldLnNwbGl0KFwiPVwiKVswXSArIFwiPVwiKTtcbiAgICAgICAgICAgICAgICB2YXIgZm91bmQgPSBmaW5kX3BhdHRlcm5faW5BcnJheShyZSwgcGF5bG9hZC5hZGRlZCk7XG4gICAgICAgICAgICAgICAgaWYgKGZvdW5kID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgcGF5bG9hZC51cGRhdGVkLnB1c2gocGF5bG9hZC5hZGRlZFtmb3VuZF0pO1xuICAgICAgICAgICAgICAgICAgICB2YXIgb3RoZXIgPSBmaW5kX3BhdHRlcm5faW5BcnJheShyZSwgcGF5bG9hZC5yZW1vdmVkKTtcbiAgICAgICAgICAgICAgICAgICAgcGF5bG9hZC5yZW1vdmVkLnNwbGljZShvdGhlciwgMSk7XG4gICAgICAgICAgICAgICAgICAgIHBheWxvYWQuYWRkZWQuc3BsaWNlKGZvdW5kLCAxKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcGF5bG9hZDtcbiAgICAgICAgfTtcbiAgICAgICAgQ2hhbmdlTW9uaXRvci5wcm90b3R5cGUuYXJ0aWN1bGF0ZUNoYW5nZXMgPSBmdW5jdGlvbiAoc2NvcGUsIGFyZ3MpIHtcbiAgICAgICAgICAgIGlmIChzY29wZSA9PSBcInByb3RvY29sXCIpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fc3VwZXIubmV3LnByb3RvY29sID09IFwibWFpbHRvOlwiKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7IG1lc3NhZ2U6IFwiQ2hhbmdlZCB0byBtYWlsdG8gbGluay5cIiwgZGF0YTogW10gfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiAodGhpcy5fc3VwZXIub2xkLnByb3RvY29sID09IFwiXCIgPyBcIlVwZGF0ZWRcIiA6IFwiQ2hhbmdlZFwiKSArIFwiIHByb3RvY29sIHRvIFwiICsgdGhpcy5fc3VwZXIubmV3LnByb3RvY29sLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogW11cbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChzY29wZSA9PSBcIm9yaWdpblwiKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX3N1cGVyLm5ldy5wcm90b2NvbCA9PSBcIm1haWx0bzpcIikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4geyBtZXNzYWdlOiBcIkNoYW5nZWQgbWFpbHRvIGxpbmsgdG8gXCIgKyB0aGlzLl9zdXBlci5uZXcub3JpZ2luLCBkYXRhOiBbXSB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsgbWVzc2FnZTogXCJDaGFuZ2VkIGxpbmsgVVJMIHRvIFwiICsgdGhpcy5fc3VwZXIubmV3Lm9yaWdpbiwgZGF0YTogW10gfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChzY29wZSA9PSBcImFsdFwiKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX3N1cGVyLkxpbmtlZEltYWdlLmFsdCA9PSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7IG1lc3NhZ2U6IFwiUmVtb3ZlZCBsaW5rZWQgaW1hZ2UgQUxUIHRleHRcIiwgZGF0YTogW10gfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7IG1lc3NhZ2U6IFwiVXBkYXRlZCBsaW5rZWQgaW1hZ2UgQUxUIHRleHQgdG8gPGI+XCIgKyB0aGlzLl9zdXBlci5MaW5rZWRJbWFnZS5hbHQgKyBcIjwvYj5cIiwgZGF0YTogW10gfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChzY29wZSA9PSBcInNlYXJjaFwiKSB7XG4gICAgICAgICAgICAgICAgdmFyIG9sZFBhcmFtcyA9IHRoaXMuX3N1cGVyLm9sZC5zZWFyY2hQYXJhbXMuX2VudHJpZXM7XG4gICAgICAgICAgICAgICAgdmFyIG5ld1BhcmFtcyA9IHRoaXMuX3N1cGVyLm5ldy5zZWFyY2hQYXJhbXMuX2VudHJpZXM7XG4gICAgICAgICAgICAgICAgdmFyIHNlYXJjaENoYW5nZXNfMSA9IHRoaXMuY29tcGFyZVNlYXJjaFN0cmluZ3Mob2xkUGFyYW1zLCBuZXdQYXJhbXMpO1xuICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlID0gXCJcIjtcbiAgICAgICAgICAgICAgICB2YXIgX3N1cGVyID0gdGhpcy5fc3VwZXI7XG4gICAgICAgICAgICAgICAgW1widXBkYXRlZFwiLCBcImFkZGVkXCIsIFwicmVtb3ZlZFwiXS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNlYXJjaENoYW5nZXNfMVtrZXldLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2UgPSBtZXNzYWdlICsga2V5WzBdLnRvVXBwZXJDYXNlKCkgKyBrZXkuc3Vic3RyKDEsIGtleS5sZW5ndGgpICsgXCIgXCIgKyAoX3N1cGVyLm5ldy5wcm90b2NvbCA9PSBcIm1haWx0bzpcIiA/IFwicGFyYW1ldGVyXCIgOiBcInF1ZXJ5IHN0cmluZ1wiKSArIChzZWFyY2hDaGFuZ2VzXzFba2V5XS5sZW5ndGggPiAxID8gXCJzXCIgOiBcIlwiKSArIFwiOiA8Yj5cIiArIHNlYXJjaENoYW5nZXNfMVtrZXldLmpvaW4oXCIsIFwiKSArIFwiPC9iPjxicj5cIjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiB7IG1lc3NhZ2U6IG1lc3NhZ2UsIGRhdGE6IFtdIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChzY29wZSA9PSBcImhhc2hcIikge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9zdXBlci5vbGQuaGFzaCA9PSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7IG1lc3NhZ2U6IFwiWW91IGFkZGVkIHRoZSBoYXNoIFwiICsgdGhpcy5fc3VwZXIubmV3Lmhhc2gsIGRhdGE6IFtdIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fc3VwZXIubmV3Lmhhc2ggPT0gXCJcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsgbWVzc2FnZTogXCJZb3UgcmVtb3ZlZCB0aGUgaGFzaCBcIiArIHRoaXMuX3N1cGVyLm9sZC5oYXNoLCBkYXRhOiBbXSB9O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsgbWVzc2FnZTogXCJZb3UgY2hhbmdlZCB0aGUgaGFzaCBmcm9tIFwiICsgdGhpcy5fc3VwZXIub2xkLmhhc2ggKyBcIiB0byBcIiArIHRoaXMuX3N1cGVyLm5ldy5oYXNoLCBkYXRhOiBbXSB9O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gQ2hhbmdlTW9uaXRvcjtcbiAgICB9KCkpO1xuICAgIEVNTE1vZHVsZS5DaGFuZ2VNb25pdG9yID0gQ2hhbmdlTW9uaXRvcjtcbiAgICB2YXIgRU1MV29ya3NwYWNlID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gRU1MV29ya3NwYWNlKGh0bWwsICRzY29wZSkge1xuICAgICAgICAgICAgdGhpcy5vdmVycmlkZGVuSWRzID0gW107XG4gICAgICAgICAgICBpZiAoaHRtbCA9PT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgICAgIGh0bWwgPSBcIlwiO1xuICAgICAgICAgICAgaWYgKCRzY29wZSA9PT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgICAgICRzY29wZSA9IFwiXCI7XG4gICAgICAgICAgICB2YXIgV29ya3NwYWNlID0gdGhpcztcbiAgICAgICAgICAgIHRoaXMuYnVmZmVyID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuc2NvcGUgPSAkc2NvcGU7XG4gICAgICAgICAgICB0aGlzLmxpbmtzVmlldyA9ICdleHBlcmltZW50YWwnOyAvL2FkdmFuY2VkIHNob3dzIGFsbFxuICAgICAgICAgICAgdGhpcy5zb3VyY2VDb2RlID0gaHRtbDsgLy9pbml0YWxcbiAgICAgICAgICAgIHRoaXMud29ya2luZ0NvZGUgPSBcIlwiO1xuICAgICAgICAgICAgdGhpcy5maWxlTmFtZSA9IFwiZW1sLW1ha2VyLXVudGl0bGVkXCI7XG4gICAgICAgICAgICB0aGlzLmxpbmtEYXRhID0gW107XG4gICAgICAgICAgICB0aGlzLl9kZWZhdWx0U0NvZGUgPSBcInM9ZW1haWxcIjtcbiAgICAgICAgICAgIHRoaXMuaGVhZGVyID0geyBcInN1YmplY3RcIjogXCJcIiB9O1xuICAgICAgICAgICAgdGhpcy5tZXNzYWdlcyA9IFtdO1xuICAgICAgICAgICAgdGhpcy5leHBvcnRGb3JFbG9xdWEgPSBcIlllc1wiO1xuICAgICAgICAgICAgdGhpcy5fX2VtbEhlYWRlcnMgPSBcIlwiO1xuICAgICAgICAgICAgdGhpcy5rZXlCb2FyZFNob3J0Y3V0cyA9IFtdO1xuICAgICAgICAgICAgdGhpcy5fX2FsbG93YWJsZUhlYWRlckZpZWxkcyA9IHtcbiAgICAgICAgICAgICAgICBcInRvXCI6IHsgc3ludGF4OiBcIlRvOiBcIiwgbGFiZWw6IFwiVG9cIiwgaW5zdHJ1Y3Rpb25zOiBcIkEgbGlzdCBvZiBlbWFpbCBhZGRyZXNzZXMgc2VwYXJhdGVkIGJ5IGNvbW1hcy5cIiB9LFxuICAgICAgICAgICAgICAgIFwic3ViamVjdFwiOiB7IHN5bnRheDogXCJTdWJqZWN0OiBcIiwgbGFiZWw6IFwiU3ViamVjdFwiLCBpbnN0cnVjdGlvbnM6IFwiXCIgfSxcbiAgICAgICAgICAgICAgICBcImNjXCI6IHsgc3ludGF4OiBcIkNjOiBcIiwgbGFiZWw6IFwiQ0NcIiwgaW5zdHJ1Y3Rpb25zOiBcIkEgbGlzdCBvZiBlbWFpbCBhZGRyZXNzZXMgc2VwYXJhdGVkIGJ5IGNvbW1hcy5cIiB9LFxuICAgICAgICAgICAgICAgIFwicmVwbHl0b1wiOiB7IHN5bnRheDogXCJSZXBseS10bzogXCIsIGxhYmVsOiBcIlJlcGx5IHRvXCIsIGluc3RydWN0aW9uczogXCJBIGxpc3Qgb2YgZW1haWwgYWRkcmVzc2VzIHNlcGFyYXRlZCBieSBjb21tYXMuXCIgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMuaGVhZGVycyA9IFtcbiAgICAgICAgICAgICAgICBcIlgtVW5zZW50OiAxXCIsXG4gICAgICAgICAgICAgICAgXCJNaW1lLVZlcnNpb246IDEuMCAoTWFjIE9TIFggTWFpbCAxMC4xIFxcKDMyNTFcXCkpXCIsXG4gICAgICAgICAgICAgICAgXCJYLVVuaWZvcm0tVHlwZS1JZGVudGlmaWVyOiBjb20uYXBwbGUubWFpbC1kcmFmdFwiLFxuICAgICAgICAgICAgICAgIFwiQ29udGVudC1UcmFuc2Zlci1FbmNvZGluZzogN2JpdFwiXG4gICAgICAgICAgICBdO1xuICAgICAgICAgICAgdGhpcy5pbnRlbGxpZ2VuY2UgPSBFTUxJbnRlbGxpZ2VuY2UubW9kdWxlKFwiZW1haWxcIikubW9uaXRvcigpO1xuICAgICAgICAgICAgdGhpcy5pbnRlbGxpZ2VuY2UuYXNzb2NpYXRlVmFyaWFibGUoXCJFTUxXb3Jrc3BhY2VcIiwgdGhpcyk7XG4gICAgICAgIH1cbiAgICAgICAgRU1MV29ya3NwYWNlLnByb3RvdHlwZS5tYXBMaW5rT2JqZWN0cyA9IGZ1bmN0aW9uIChjYWxsYmFjaykge1xuICAgICAgICAgICAgaWYgKHRoaXMubGlua0RhdGEubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5saW5rRGF0YS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayh0aGlzLmxpbmtEYXRhW2ldKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIEVNTFdvcmtzcGFjZS5wcm90b3R5cGUuY29tcG9zZUVNTCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGxvY2F0aW9uLmhyZWYgPSBcIiMvZXhwb3J0LWNvbXBvc2UtZW1sXCI7XG4gICAgICAgIH07XG4gICAgICAgIEVNTFdvcmtzcGFjZS5wcm90b3R5cGUuZG93bmxvYWRFbWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLmJlZm9yZURpZERvd25sb2FkRW1sKCk7XG4gICAgICAgICAgICB2YXIgb3V0cHV0ID0gdGhpcy5fX2VtbEhlYWRlcnMgKyBcIlxcblxcblwiICsgdGhpcy5fX3JlbW92ZVdoaXRlU3BhY2UodGhpcy5fX3JlcGxhY2VFbG9xdWFNZXJnZUZpZWxkcyh0aGlzLmdlbmVyYXRlT3V0cHV0Q29kZShcIm9mdFwiKSkpO1xuICAgICAgICAgICAgdGhpcy5maWxlTmFtZSA9IHRoaXMuX19mb3JtYXRGaWxlTmFtZSh0aGlzLmZpbGVOYW1lKTtcbiAgICAgICAgICAgIHdpbmRvdy5zYXZlQXMobmV3IEJsb2IoW291dHB1dF0sIHsgdHlwZTogXCJ0ZXh0L2h0bWxcIiB9KSwgdGhpcy5maWxlTmFtZSArIFwiLmVtbFwiKTtcbiAgICAgICAgICAgIHRoaXMuYWZ0ZXJEaWREb3dubG9hZEVtbCgpO1xuICAgICAgICB9O1xuICAgICAgICBFTUxXb3Jrc3BhY2UucHJvdG90eXBlLmJlZm9yZURpZERvd25sb2FkRW1sID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5tYXBMaW5rT2JqZWN0cyhmdW5jdGlvbiAoTGlua09iamVjdCkge1xuICAgICAgICAgICAgICAgIGlmIChMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuaGFzKFwiZWxxVHJhY2tcIikpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLmVudHJpZXMuaW5kZXhPZihcImVscVRyYWNrPXRydWVcIik7XG4gICAgICAgICAgICAgICAgICAgIGlmIChpbmRleCA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuZGVsZXRlQXRJbmRleChpbmRleCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCFMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuaGFzKFwic1wiKSAmJiBMaW5rT2JqZWN0LnJlcXVpcmVzU0NvZGUoKSkge1xuICAgICAgICAgICAgICAgICAgICBMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuYXBwZW5kKFwicz1vZnRcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAoTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLmdldChcInNcIikgPT0gXCJlbWFpbFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuc2V0KFwic1wiLCBcIm9mdFwiKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5tYXBMaW5rT2JqZWN0cyhmdW5jdGlvbiAoTGlua09iamVjdCkge1xuICAgICAgICAgICAgICAgIExpbmtPYmplY3QuQ2hhbmdlTW9uaXRvci51cGRhdGUoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICBFTUxXb3Jrc3BhY2UucHJvdG90eXBlLmFmdGVyRGlkRG93bmxvYWRFbWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB3aW5kb3cuZ2EoJ3NlbmQnLCAnZXZlbnQnLCBcIkVNTFwiLCBcImRvd25sb2FkXCIsIFwiRU1MIEV4cG9ydFwiKTtcbiAgICAgICAgICAgIGxvY2F0aW9uLmhyZWYgPSBcIiMvZXhwb3J0LWVtbFwiO1xuICAgICAgICB9O1xuICAgICAgICBFTUxXb3Jrc3BhY2UucHJvdG90eXBlLmRvd25sb2FkQ3N2ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIG91dHB1dCA9IFwiQ29udGV4dCxPcmlnaW5hbCBVUkwsTW9kaWZpZWQgVVJMXFxuXCI7XG4gICAgICAgICAgICB0aGlzLm1hcExpbmtPYmplY3RzKGZ1bmN0aW9uIChMaW5rT2JqZWN0KSB7XG4gICAgICAgICAgICAgICAgb3V0cHV0ICs9IExpbmtPYmplY3QuY29udGV4dC5yZXBsYWNlKC8sL2csIFwiKGNvbW1hKVwiKSArIFwiLFwiICsgTGlua09iamVjdC5vbGQudXJsICsgXCIsXCIgKyBMaW5rT2JqZWN0Lm5ldy51cmwgKyBcIlxcblwiO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLmZpbGVOYW1lID0gdGhpcy5fX2Zvcm1hdEZpbGVOYW1lKHRoaXMuZmlsZU5hbWUpO1xuICAgICAgICAgICAgd2luZG93LnNhdmVBcyhuZXcgQmxvYihbb3V0cHV0XSwgeyB0eXBlOiBcInRleHQvY3N2XCIgfSksIHRoaXMuZmlsZU5hbWUgKyBcIl9saW5rcy5jc3ZcIik7XG4gICAgICAgICAgICB3aW5kb3cuZ2EoJ3NlbmQnLCAnZXZlbnQnLCBcIkNTVlwiLCBcImRvd25sb2FkXCIsIFwiQ1NWIEV4cG9ydFwiKTtcbiAgICAgICAgfTtcbiAgICAgICAgRU1MV29ya3NwYWNlLnByb3RvdHlwZS5kb3dubG9hZEh0bWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgb3V0cHV0ID0gdGhpcy5iZWZvcmVEaWREb3dubG9hZEh0bWwodGhpcy5nZW5lcmF0ZU91dHB1dENvZGUoXCJlbWFpbFwiKSk7XG4gICAgICAgICAgICB0aGlzLmZpbGVOYW1lID0gdGhpcy5fX2Zvcm1hdEZpbGVOYW1lKHRoaXMuZmlsZU5hbWUpO1xuICAgICAgICAgICAgd2luZG93LnNhdmVBcyhuZXcgQmxvYihbb3V0cHV0XSwgeyB0eXBlOiBcInRleHQvaHRtbFwiIH0pLCB0aGlzLmZpbGVOYW1lICsgXCIuaHRtbFwiKTtcbiAgICAgICAgICAgIHRoaXMuYWZ0ZXJEaWREb3dubG9hZEh0bWwoKTtcbiAgICAgICAgfTtcbiAgICAgICAgRU1MV29ya3NwYWNlLnByb3RvdHlwZS5iZWZvcmVEaWREb3dubG9hZEh0bWwgPSBmdW5jdGlvbiAoY29kZSkge1xuICAgICAgICAgICAgcmV0dXJuIGNvZGU7XG4gICAgICAgIH07XG4gICAgICAgIEVNTFdvcmtzcGFjZS5wcm90b3R5cGUuYWZ0ZXJEaWREb3dubG9hZEh0bWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB3aW5kb3cuZ2EoJ3NlbmQnLCAnZXZlbnQnLCBcIkhUTUxcIiwgXCJkb3dubG9hZFwiLCBcIkhUTUwgRXhwb3J0XCIpO1xuICAgICAgICB9O1xuICAgICAgICBFTUxXb3Jrc3BhY2UucHJvdG90eXBlLmV4cG9ydENvZGVUb0hUTUwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLmJlZm9yZURpZEV4cG9ydENvZGVUb0hUTUwoKTtcbiAgICAgICAgICAgIHRoaXMub3V0cHV0Q29kZSA9IHRoaXMuZ2VuZXJhdGVPdXRwdXRDb2RlKFwiZW1haWxcIik7XG4gICAgICAgICAgICB0aGlzLmFmdGVyRGlkRXhwb3J0Q29kZVRvSFRNTCgpO1xuICAgICAgICB9O1xuICAgICAgICBFTUxXb3Jrc3BhY2UucHJvdG90eXBlLmJlZm9yZURpZEV4cG9ydENvZGVUb0hUTUwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdHJhY2tpbmdPcHRPdXQgPSBmYWxzZTtcbiAgICAgICAgICAgIGlmICh0aGlzLmV4cG9ydEZvckVsb3F1YSAmJiB0aGlzLmV4cG9ydEZvckVsb3F1YSA9PSBcIlllc1wiKSB7XG4gICAgICAgICAgICAgICAgd2luZG93LmdhKCdzZW5kJywgJ2V2ZW50JywgXCJIVE1MXCIsIFwiQWRkIEVsb3F1YSBUcmFja2luZ1wiLCBcIkFkZCBFbG9xdWEgVHJhY2tpbmdcIik7XG4gICAgICAgICAgICAgICAgdGhpcy5tYXBMaW5rT2JqZWN0cyhmdW5jdGlvbiAoTGlua09iamVjdCkge1xuICAgICAgICAgICAgICAgICAgICB0cmFja2luZ09wdE91dCA9IExpbmtPYmplY3Qud2hpdGVMaXN0ZWRVcmwgPT0gTGlua09iamVjdC5uZXcudXJsO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIUxpbmtPYmplY3QuaXNMaW5rVHlwZShcIm1haWx0b1wiKVxuICAgICAgICAgICAgICAgICAgICAgICAgJiYgIUxpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5oYXMoXCJlbHFUcmFja1wiKVxuICAgICAgICAgICAgICAgICAgICAgICAgJiYgIS9hcHBcXC5pbmZvXFwub3B0dW1cXC5jb20vZ2kudGVzdChMaW5rT2JqZWN0Lm5ldy51cmwpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuYXBwZW5kKFwiZWxxVHJhY2s9dHJ1ZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0cmFja2luZ09wdE91dCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIExpbmtPYmplY3Qud2hpdGVMaXN0ZWRVcmwgPSBMaW5rT2JqZWN0Lm5ldy51cmw7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMubWFwTGlua09iamVjdHMoZnVuY3Rpb24gKExpbmtPYmplY3QpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKExpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5oYXMoXCJlbHFUcmFja1wiKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZGV4ID0gTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLmVudHJpZXMuaW5kZXhPZihcImVscVRyYWNrPXRydWVcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5kZXggPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIExpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5kZWxldGVBdEluZGV4KGluZGV4KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIExpbmtPYmplY3QuaXNMaW5rQ29tcGxldGUoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBMaW5rT2JqZWN0LkNoYW5nZU1vbml0b3IudXBkYXRlKCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLm1hcExpbmtPYmplY3RzKGZ1bmN0aW9uIChMaW5rT2JqZWN0KSB7XG4gICAgICAgICAgICAgICAgaWYgKCFMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuaGFzKFwic1wiKSAmJiBMaW5rT2JqZWN0LnJlcXVpcmVzU0NvZGUoKSkge1xuICAgICAgICAgICAgICAgICAgICBMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuYXBwZW5kKFwicz1lbWFpbFwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuaGFzKFwic1wiKSAmJiBMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuZ2V0KFwic1wiKSA9PSBcIm9mdFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuc2V0KFwic1wiLCBcImVtYWlsXCIpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIExpbmtPYmplY3QuQ2hhbmdlTW9uaXRvci51cGRhdGUoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5tYXBMaW5rT2JqZWN0cyhmdW5jdGlvbiAoTGlua09iamVjdCkge1xuICAgICAgICAgICAgICAgIExpbmtPYmplY3QuQ2hhbmdlTW9uaXRvci51cGRhdGUoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICBFTUxXb3Jrc3BhY2UucHJvdG90eXBlLmFmdGVyRGlkRXhwb3J0Q29kZVRvSFRNTCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMubWFwTGlua09iamVjdHMoZnVuY3Rpb24gKExpbmtPYmplY3QpIHtcbiAgICAgICAgICAgICAgICBpZiAoTGlua09iamVjdC53aGl0ZUxpc3RlZFVybCA9PSBMaW5rT2JqZWN0Lm5ldy51cmwpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9yZXBvcnQgdGhlIG5vbiB0cmFja2VkIGxpbms7XG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5nYSgnc2VuZCcsICdldmVudCcsIFwiVHJhY2tpbmctT3B0b3V0XCIsIFwib3ZlcnJpZGVcIiwgTGlua09iamVjdC5uZXcudXJsKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHdpbmRvdy5nYSgnc2VuZCcsICdldmVudCcsIFwiSFRNTFwiLCBcInZpZXcgc291cmNlY29kZVwiLCBcIkV4cG9ydC9WaWV3IEhUTUxcIik7XG4gICAgICAgICAgICBsb2NhdGlvbi5ocmVmID0gXCIjL2V4cG9ydC1odG1sXCI7XG4gICAgICAgIH07XG4gICAgICAgIEVNTFdvcmtzcGFjZS5wcm90b3R5cGUuc2V0VXBTaG9ydGN1dEtleXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgdGhpcy5rZXlCb2FyZFNob3J0Y3V0cyA9IFtdO1xuICAgICAgICAgICAgX3RoaXMua2V5Qm9hcmRTaG9ydGN1dHMucHVzaChuZXcgS2V5Ym9hcmRTaG9ydGN1dChmdW5jdGlvbiAoZSkgeyByZXR1cm4gKGUuY3RybEtleSB8fCBlLm1ldGFLZXkpICYmIGUuc2hpZnRLZXkgJiYgZS53aGljaCA9PSA1MjsgfSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIC8vZG90aGlzO1xuICAgICAgICAgICAgICAgIF90aGlzLnNjb3BlLiRhcHBseShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdkb3dubG9hZGluZyBmaWxlJyk7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLmRvd25sb2FkSHRtbCgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSwgXCJDVFJMICsgU0hJRlQgKyA0XCIsIFwiRG93bmxvYWQgSFRNTFwiKSk7XG4gICAgICAgICAgICBfdGhpcy5rZXlCb2FyZFNob3J0Y3V0cy5wdXNoKG5ldyBLZXlib2FyZFNob3J0Y3V0KGZ1bmN0aW9uIChlKSB7IHJldHVybiAoZS5jdHJsS2V5IHx8IGUubWV0YUtleSkgJiYgZS5zaGlmdEtleSAmJiBlLndoaWNoID09IDUxOyB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgLy9kb3RoaXM7XG4gICAgICAgICAgICAgICAgX3RoaXMuc2NvcGUuJGFwcGx5KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMubWFwTGlua09iamVjdHMoZnVuY3Rpb24gKExpbmtPYmplY3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChMaW5rT2JqZWN0LmVycm9ycy5tZXNzYWdlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTGlua09iamVjdC5lcnJvcnMubWVzc2FnZXMuZm9yRWFjaChmdW5jdGlvbiAoTWVzc2FnZU9iamVjdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoTWVzc2FnZU9iamVjdC50eXBlID09IEVycm9yVHlwZS5TdWdnZXN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBNZXNzYWdlT2JqZWN0LmN0YUhhbmRsZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIExpbmtPYmplY3QuaXNMaW5rQ29tcGxldGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LCBcIkNUUkwgKyBTSElGVCArIDNcIiwgXCJBcHBseSBhbGwgc3VnZ2VzdGlvbnNcIikpO1xuICAgICAgICAgICAgX3RoaXMua2V5Qm9hcmRTaG9ydGN1dHMucHVzaChuZXcgS2V5Ym9hcmRTaG9ydGN1dChmdW5jdGlvbiAoZSkgeyByZXR1cm4gKGUuY3RybEtleSB8fCBlLm1ldGFLZXkpICYmIGUuc2hpZnRLZXkgJiYgZS53aGljaCA9PSA1MDsgfSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIC8vZG90aGlzO1xuICAgICAgICAgICAgICAgIF90aGlzLnNjb3BlLiRhcHBseShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLm1hcExpbmtPYmplY3RzKGZ1bmN0aW9uIChMaW5rT2JqZWN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIUxpbmtPYmplY3QucmVhZE9ubHlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAmJiBMaW5rT2JqZWN0LnJlcXVpcmVzU0NvZGUoKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICYmICFMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuaGFzKCdzJykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuYXBwZW5kKCdzPWVtYWlsJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTGlua09iamVjdC5pc0xpbmtDb21wbGV0ZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0sIFwiQ1RSTCArIFNISUZUICsgMlwiLCBcIkFkZCBzPWVtYWlsIHRvIGFsbCBsaW5rc1wiKSk7XG4gICAgICAgICAgICBfdGhpcy5rZXlCb2FyZFNob3J0Y3V0cy5wdXNoKG5ldyBLZXlib2FyZFNob3J0Y3V0KGZ1bmN0aW9uIChlKSB7IHJldHVybiAoZS5jdHJsS2V5IHx8IGUubWV0YUtleSkgJiYgZS5zaGlmdEtleSAmJiBlLndoaWNoID09IDQ5OyB9LCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgLy9kb3RoaXM7XG4gICAgICAgICAgICAgICAgX3RoaXMuc2NvcGUuJGFwcGx5KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMubWFwTGlua09iamVjdHMoZnVuY3Rpb24gKExpbmtPYmplY3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChMaW5rT2JqZWN0LnJlYWRPbmx5KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLmRlbGV0ZShcIm9cIik7XG4gICAgICAgICAgICAgICAgICAgICAgICBMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuZGVsZXRlKFwib2luXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLmRlbGV0ZShcInZcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICBMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuZGVsZXRlKFwib2lleFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIExpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5kZWxldGUoXCJlbHFfbWlkXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLmRlbGV0ZShcImVscV9saWRcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICBMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuZGVsZXRlKFwiZWxxVHJhY2tcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICBMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuZGVsZXRlKFwiZWxxVHJhY2tJZFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIExpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5kZWxldGUoXCJzXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLmRlbGV0ZShcInMzXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgTGlua09iamVjdC5pc0xpbmtDb21wbGV0ZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuYXJlTGlua3NDb21wbGV0ZSgpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0sIFwiQ1RSTCArIFNISUZUICsgMVwiLCBcIlJlbW92ZSBhbGwgcXVlcnkgc3RyaW5ncyBmcm9tIGVtYWlsXCIpKTtcbiAgICAgICAgICAgIGRvY3VtZW50Lm9ua2V5dXAgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSBfdGhpcy5rZXlCb2FyZFNob3J0Y3V0czsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHNob3J0Y3V0ID0gX2FbX2ldO1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2hvcnRjdXQud2hlbiAmJiBzaG9ydGN1dC53aGVuKGUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzaG9ydGN1dC5kb1RoaXMoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgIH07XG4gICAgICAgIEVNTFdvcmtzcGFjZS5wcm90b3R5cGUucmVwbGFjZVNwZWNpYWxDaGFyYWN0ZXJzID0gZnVuY3Rpb24gKHRleHQpIHtcbiAgICAgICAgICAgIHZhciByZXBsYWNlID0ge1xuICAgICAgICAgICAgICAgIDE3NDogW1wiJnJlZztcIl0sXG4gICAgICAgICAgICAgICAgMTY5OiBbXCImY29weTtcIl0sXG4gICAgICAgICAgICAgICAgODIxMTogW1wiJm5kYXNoO1wiXSxcbiAgICAgICAgICAgICAgICA4MjEyOiBbXCImbWRhc2g7XCJdLFxuICAgICAgICAgICAgICAgIDgyMjA6IFtcIiZsZHF1bztcIl0sXG4gICAgICAgICAgICAgICAgODIyMTogW1wiJnJkcXVvO1wiXSxcbiAgICAgICAgICAgICAgICA4MjE2OiBbXCImbHNxdW87XCJdLFxuICAgICAgICAgICAgICAgIDgyMTc6IFtcIiZyc3F1bztcIl0sXG4gICAgICAgICAgICAgICAgODQ4MjogW1wiJnRyYWRlO1wiXVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgaW4gcmVwbGFjZSkge1xuICAgICAgICAgICAgICAgIGlmIChyZXBsYWNlLmhhc093blByb3BlcnR5KGkpKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZWdleHAgPSBuZXcgUmVnRXhwKFN0cmluZy5mcm9tQ2hhckNvZGUocGFyc2VJbnQoaSkpLCBcImdcIik7XG4gICAgICAgICAgICAgICAgICAgIGlmIChyZWdleHAudGVzdCh0ZXh0KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coXCJmb3VuZCBjaGFyYWN0ZXJcIiArIFN0cmluZy5mcm9tQ2hhckNvZGUocGFyc2VJbnQoaSkpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgPSB0ZXh0LnJlcGxhY2UocmVnZXhwLCByZXBsYWNlW2ldWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0ZXh0O1xuICAgICAgICB9O1xuICAgICAgICBFTUxXb3Jrc3BhY2UucHJvdG90eXBlLnByb2Nlc3NIdG1sID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgLy9jcmVhdGVzIGEgbmV3IHdvcmtzcGFjZSBmcm9tIGh0bWxcbiAgICAgICAgICAgIHRoaXMuc2V0VXBTaG9ydGN1dEtleXMoKTtcbiAgICAgICAgICAgIHRoaXMubGlua0RhdGEgPSBbXTtcbiAgICAgICAgICAgIHRoaXMuaW50ZWxsaWdlbmNlLm92ZXJyaWRkZW4gPSBbXTtcbiAgICAgICAgICAgIHRoaXMuaW50ZWxsaWdlbmNlLmV2YWx1YXRlUnVsZXMoKTtcbiAgICAgICAgICAgIHdpbmRvdy5zY3JvbGxUbygwLCAwKTtcbiAgICAgICAgICAgIC8vIC5yZXBsYWNlKG5ldyBSZWdFeHAoXCI8L2E+XCIsXCJpZ1wiKSwgXCI8L2E+XFxuXCIpXG4gICAgICAgICAgICB0aGlzLndvcmtpbmdDb2RlID0gdGhpcy5yZXBsYWNlU3BlY2lhbENoYXJhY3RlcnModGhpcy5zb3VyY2VDb2RlKTtcbiAgICAgICAgICAgIC8vZGV0ZXJtaW5lIGVtYWlsIGhlYWRlcnNcbiAgICAgICAgICAgIHRoaXMuX19lbWxIZWFkZXJzID0gdGhpcy5fX2J1aWxkSGVhZGVycygpO1xuICAgICAgICAgICAgLy8gICAkc2NvcGUuZGF0YS5oZWFkZXIsXG4gICAgICAgICAgICAvLyAgICRzY29wZS5kYXRhLmFsbG93YWJsZUhlYWRlckZpZWxkcyk7XG4gICAgICAgICAgICAvL3JlcGxhY2UgbWVyZ2UgZmllbGRzXG4gICAgICAgICAgICBpZiAodGhpcy5maWxlTmFtZSA9PSBcInVudGl0bGVkXCIpIHtcbiAgICAgICAgICAgICAgICB2YXIgdGl0bGVSZWcgPSAvPHRpdGxlPihbXjxdLio/KTxcXC90aXRsZT4vZ2k7XG4gICAgICAgICAgICAgICAgaWYgKHRpdGxlUmVnLnRlc3QodGhpcy53b3JraW5nQ29kZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRpdGxlVGFnID0gdGhpcy53b3JraW5nQ29kZS5tYXRjaCh0aXRsZVJlZyk7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aXRsZVRhZy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbGVOYW1lID0gdGhpcy5fX2Zvcm1hdEZpbGVOYW1lKHRpdGxlVGFnWzBdLnJlcGxhY2UodGl0bGVSZWcsIFwiJDFcIikpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIF9zdXBlciA9IHRoaXM7XG4gICAgICAgICAgICB2YXIgcmUxID0gLzxhXFxiW14+XSo/PihbXFxyXFxuXXwuKSo/PFxcL2E+L2dtLCBuID0gMDtcbiAgICAgICAgICAgIHRoaXMud29ya2luZ0NvZGUgPSB0aGlzLndvcmtpbmdDb2RlLnJlcGxhY2UocmUxLCBmdW5jdGlvbiAoZm91bmQpIHtcbiAgICAgICAgICAgICAgICBuKys7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZvdW5kLnJlcGxhY2UoXCI8YVwiLCBcIjxhIGVtbC1pZD1cXFwiXCIgKyBuICsgXCJcXFwiXCIpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBuID0gMDtcbiAgICAgICAgICAgIHRoaXMud29ya2luZ0NvZGUgPSB0aGlzLndvcmtpbmdDb2RlLnJlcGxhY2UocmUxLCBmdW5jdGlvbiAoY29udGV4dCkge1xuICAgICAgICAgICAgICAgIG4rKztcbiAgICAgICAgICAgICAgICAvL2dldCBsaW5lXG4gICAgICAgICAgICAgICAgdmFyIGxpbmUgPSBfc3VwZXIud29ya2luZ0NvZGUuc3Vic3RyKDAsIF9zdXBlci53b3JraW5nQ29kZS5pbmRleE9mKGNvbnRleHQpKS5zcGxpdChcIlxcblwiKS5sZW5ndGggLSAxO1xuICAgICAgICAgICAgICAgIGlmICgvKGhyZWZcXD1cXFwiKFteXFxcIlxcPl0qKVxcXCI/KS9nLnRlc3QoY29udGV4dCkpIHtcbiAgICAgICAgICAgICAgICAgICAgbisrO1xuICAgICAgICAgICAgICAgICAgICB2YXIgYSA9IG5ldyBMaW5rT2JqZWN0KGxpbmUsIGNvbnRleHQsIF9zdXBlcik7XG4gICAgICAgICAgICAgICAgICAgIGEuaWQgPSBuO1xuICAgICAgICAgICAgICAgICAgICBhLnJlYWRPbmx5ID0gKGEubmV3LmNvbnRhaW5zKFwiLmNvbS9lL2VzLmFzcHhcIikgJiYgYS5uZXcuY29udGFpbnMoXCJ+fmVsb3F1YVwiKSk7XG4gICAgICAgICAgICAgICAgICAgIF9zdXBlci5saW5rRGF0YS5wdXNoKGEpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gXCJ7e0VNTE1ha2VyX0xpbms6XCIgKyBuICsgXCJ9fVwiO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGNvbnRleHQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB0aGlzLm1hcExpbmtPYmplY3RzKGZ1bmN0aW9uIChMaW5rT2JqZWN0KSB7XG4gICAgICAgICAgICAgICAgTGlua09iamVjdC5pc0xpbmtDb21wbGV0ZSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLmludGVsbGlnZW5jZSk7XG4gICAgICAgICAgICAvL3JlZGlyZWN0XG4gICAgICAgICAgICBsb2NhdGlvbi5ocmVmID0gXCIjL2xpbmtzXCI7XG4gICAgICAgIH07XG4gICAgICAgIEVNTFdvcmtzcGFjZS5wcm90b3R5cGUuYWRkTmV3SGVhZGVyRmllbGQgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuaGVhZGVyW3ZhbHVlXSA9IFwiXCI7XG4gICAgICAgIH07XG4gICAgICAgIEVNTFdvcmtzcGFjZS5wcm90b3R5cGUucmVtb3ZlSGVhZGVyRmllbGQgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgICAgIGRlbGV0ZSB0aGlzLmhlYWRlclt2YWx1ZV07XG4gICAgICAgIH07XG4gICAgICAgIEVNTFdvcmtzcGFjZS5wcm90b3R5cGUuaXNIZWFkZXJTZWxlY3RlZCA9IGZ1bmN0aW9uIChoZWFkZXIpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5oZWFkZXIuaGFzT3duUHJvcGVydHkoaGVhZGVyKSB8fCB0aGlzLmhlYWRlciA9PSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIEVNTFdvcmtzcGFjZS5wcm90b3R5cGUudmVyaWZ5TGlua1NlY3Rpb25Db21wbGV0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBvdXRwdXQgPSBmYWxzZTtcbiAgICAgICAgICAgIGlmICh0aGlzLmludGVsbGlnZW5jZSAmJiAhdGhpcy5pbnRlbGxpZ2VuY2UuY2FuQ29udGludWUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBhcmUgdGhlcmUgbGluayBpc3N1ZXM/XG4gICAgICAgICAgICBpZiAodGhpcy5saW5rRGF0YSAmJiB0aGlzLmxpbmtEYXRhLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICAgICAgb3V0cHV0ID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5hcmVMaW5rc0NvbXBsZXRlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgb3V0cHV0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIG91dHB1dCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgICAgIH07XG4gICAgICAgIEVNTFdvcmtzcGFjZS5wcm90b3R5cGUuZ2VuZXJhdGVPdXRwdXRDb2RlID0gZnVuY3Rpb24gKHR5cGUsIGNsb25lKSB7XG4gICAgICAgICAgICBpZiAodHlwZSA9PT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgICAgIHR5cGUgPSBcImVtYWlsXCI7XG4gICAgICAgICAgICBpZiAoY2xvbmUgPT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgICAgICBjbG9uZSA9IHRydWU7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgdmFyIG91dHB1dCA9IHRoaXMud29ya2luZ0NvZGU7XG4gICAgICAgICAgICAvL3Bvc3QgcHJvY2Vzc2luZy5cbiAgICAgICAgICAgIC8vZG8gcG9zdCBwcm9jZXNzaW5nLlxuICAgICAgICAgICAgLy9leHBvcnQgY29kZT9cbiAgICAgICAgICAgIHRoaXMubWFwTGlua09iamVjdHMoZnVuY3Rpb24gKExpbmtPYmplY3QpIHtcbiAgICAgICAgICAgICAgICBpZiAoTGlua09iamVjdC5oYXNPd25Qcm9wZXJ0eShcImRlbGV0ZU9uUmVuZGVyXCIpICYmIExpbmtPYmplY3QuZGVsZXRlT25SZW5kZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgb3V0cHV0ID0gb3V0cHV0LnJlcGxhY2UobmV3IFJlZ0V4cChcInt7RU1MTWFrZXJfTGluazpcIiArIExpbmtPYmplY3QuaWQgKyBcIn19XCIsIFwiZ2lcIiksIFwiXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmIChMaW5rT2JqZWN0LnJlYWRPbmx5KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciByZWFkT25seVVybCA9IExpbmtPYmplY3QuY29udGV4dC5yZXBsYWNlKC9lbWxcXC1pZFxcPVxcXCJbMC05XXsxLH1cXFwiXFxzL2csIFwiXCIpO1xuICAgICAgICAgICAgICAgICAgICBvdXRwdXQgPSBvdXRwdXQucmVwbGFjZShuZXcgUmVnRXhwKFwie3tFTUxNYWtlcl9MaW5rOlwiICsgTGlua09iamVjdC5pZCArIFwifX1cIiwgXCJnaVwiKSwgcmVhZE9ubHlVcmwpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHN0YXJ0ID0gTGlua09iamVjdC5jb250ZXh0LmluZGV4T2YoXCJocmVmPVxcXCJcIiArIExpbmtPYmplY3Qub2xkLnVybCk7XG4gICAgICAgICAgICAgICAgICAgIC8vIGNvZGVMaW5lc1tsaW5lXSA9IGNvZGVMaW5lc1tsaW5lXS5zdWJzdHIoMCwgc3RhcnQpICsgXCJocmVmPVxcXCJcIiArIExpbmtPYmplY3QubmV3LnVybCArIGNvZGVMaW5lc1tsaW5lXS5zdWJzdHIoc3RhcnQrNitMaW5rT2JqZWN0Lm9sZC51cmwubGVuZ3RoLCBjb2RlTGluZXNbbGluZV0ubGVuZ3RoKTtcbiAgICAgICAgICAgICAgICAgICAgLy90aGlzIGlzIHdoZXJlIHdlIHVwZGF0ZSB0aGUgY29udGV4dDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5ld0NvbnRleHQgPSBMaW5rT2JqZWN0LmNvbnRleHQ7XG4gICAgICAgICAgICAgICAgICAgIG5ld0NvbnRleHQgPSBuZXdDb250ZXh0LnN1YnN0cigwLCBzdGFydCkgKyBcImhyZWY9XFxcIlwiICsgTGlua09iamVjdC5uZXcudXJsICsgbmV3Q29udGV4dC5zdWJzdHIoc3RhcnQgKyA2ICsgTGlua09iamVjdC5vbGQudXJsLmxlbmd0aCwgbmV3Q29udGV4dC5sZW5ndGgpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoTGlua09iamVjdC5MaW5rZWRJbWFnZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3Q29udGV4dCA9IExpbmtPYmplY3QuTGlua2VkSW1hZ2UuZ2VuZXJhdGVPdXRwdXQobmV3Q29udGV4dCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgbmV3Q29udGV4dCA9IG5ld0NvbnRleHQucmVwbGFjZSgvXFxzP2VtbFxcLWlkXFw9XFxcIlswLTldKlxcXCIvZywgXCJcIik7XG4gICAgICAgICAgICAgICAgICAgIC8vdGhlbiB1cGRhdGUgdGhlIHdvcmtpbmcgY29kZSB3aXRoIHRoZSBuZXcgY29udGV4dDtcbiAgICAgICAgICAgICAgICAgICAgb3V0cHV0ID0gb3V0cHV0LnJlcGxhY2UobmV3IFJlZ0V4cChcInt7RU1MTWFrZXJfTGluazpcIiArIExpbmtPYmplY3QuaWQgKyBcIn19XCIsIFwiZ2lcIiksIG5ld0NvbnRleHQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgLy9maW5kIGFsbCBpbWFnZXMgd2l0aG91dCBhbHQgYXR0cmlidXRlIGFuZCBhZGQgYWx0PVwiXCI7XG4gICAgICAgICAgICBvdXRwdXQgPSBvdXRwdXQucmVwbGFjZSgvXFw8aW1nW15cXD5dLio/XFw+L2dpLCBmdW5jdGlvbiAoZm91bmQpIHtcbiAgICAgICAgICAgICAgICBpZiAoZm91bmQuaW5kZXhPZihcImFsdD1cIikgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZm91bmQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZm91bmQucmVwbGFjZSgvXFw8aW1nL2dpLCBcIjxpbWcgYWx0PVxcXCJcXFwiXCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBvdXRwdXQgPSBvdXRwdXQucmVwbGFjZSgvPFxcL2E+XFxuezAsNX0oXFwufCx8XFw/fCF8Onw7fFxcfCkvZywgXCI8L2E+JDFcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZXJyb3IgbWVyZ2luZyBsaW5lcyB3aXRoIGxpbmtzIHRoYXQgcHJldmlvdXNseSBoYWQgcHVuY3R1YXRpb24uXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICAgICAgfTtcbiAgICAgICAgRU1MV29ya3NwYWNlLnByb3RvdHlwZS51cGRhdGVMaW5rc0FuZEV4cG9ydCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5hcmVMaW5rc0NvbXBsZXRlKCkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBsb2NhdGlvbi5ocmVmID0gXCIjL2V4cG9ydFwiO1xuICAgICAgICAgICAgd2luZG93LnNjcm9sbFRvKDAsIDApO1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH07XG4gICAgICAgIEVNTFdvcmtzcGFjZS5wcm90b3R5cGUuYXJlTGlua3NDb21wbGV0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBvdXRwdXQgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5tYXBMaW5rT2JqZWN0cyhmdW5jdGlvbiAoTGlua09iamVjdCkge1xuICAgICAgICAgICAgICAgIGlmICghTGlua09iamVjdC5fX2lzQ29tcGxldGUpIHtcbiAgICAgICAgICAgICAgICAgICAgb3V0cHV0ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChMaW5rT2JqZWN0Lm5lZWRzVHJhY2tpbmdDb2RlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgb3V0cHV0ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gb3V0cHV0O1xuICAgICAgICB9O1xuICAgICAgICBFTUxXb3Jrc3BhY2UucHJvdG90eXBlLmdldExpbmtzU3VtbWFyeSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBkYXRhID0ge1xuICAgICAgICAgICAgICAgIG5lZWRzVHJhY2tpbmc6IDAsXG4gICAgICAgICAgICAgICAgaW52YWxpZFVybDogMFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMubWFwTGlua09iamVjdHMoZnVuY3Rpb24gKExpbmtPYmplY3QpIHtcbiAgICAgICAgICAgICAgICBpZiAoTGlua09iamVjdC5uZWVkc1RyYWNraW5nQ29kZSgpKVxuICAgICAgICAgICAgICAgICAgICBkYXRhLm5lZWRzVHJhY2tpbmcrKztcbiAgICAgICAgICAgICAgICBpZiAoTGlua09iamVjdC5pc0xpbmtDb21wbGV0ZSgpKVxuICAgICAgICAgICAgICAgICAgICBkYXRhLmludmFsaWRVcmwrKztcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgIH07XG4gICAgICAgIEVNTFdvcmtzcGFjZS5wcm90b3R5cGUuaW1wb3J0SHRtbEZyb21GaWxlRHJvcCA9IGZ1bmN0aW9uIChldnQpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnNvdXJjZUNvZGUubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMuc291cmNlQ29kZSA9IFwiXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZmlsZXMgPSBldnQuZGF0YVRyYW5zZmVyLmZpbGVzO1xuICAgICAgICAgICAgaWYgKGV2dC5kYXRhVHJhbnNmZXIuZmlsZXMubGVuZ3RoID4gMSkge1xuICAgICAgICAgICAgICAgIGFsZXJ0KCd5b3UgY2FuIG9ubHkgaW1wb3J0IG9uZSBmaWxlIGF0IGF0IHRpbWUuJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcbiAgICAgICAgICAgICAgICB2YXIgV1MgPSB0aGlzO1xuICAgICAgICAgICAgICAgIHJlYWRlci5vbmxvYWRlbmQgPSBmdW5jdGlvbiAoZXZ0KSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkcm9wVGV4dCA9IGV2dC50YXJnZXQucmVzdWx0O1xuICAgICAgICAgICAgICAgICAgICB2YXIgbmFtZVBhcnRzID0gZmlsZXNbMF0ubmFtZS5zcGxpdChcIi5cIik7XG4gICAgICAgICAgICAgICAgICAgIHZhciBleHQgPSBuYW1lUGFydHMucG9wKCkudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgV1MuZmlsZU5hbWUgPSBXUy5fX2Zvcm1hdEZpbGVOYW1lKG5hbWVQYXJ0cy5qb2luKFwiLlwiKSk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChleHQgPT0gJ2VtbCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFdTLnNvdXJjZUNvZGUgPSBXUy5fX3N0cmlwSHRtbEFuZFN1YmplY3RGcm9tRU1MKGRyb3BUZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFdTLnNvdXJjZUNvZGUgPSBkcm9wVGV4dDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBXUy5wcm9jZXNzSHRtbCgpO1xuICAgICAgICAgICAgICAgICAgICAvLyBXUy5pbnRlbGxpZ2VuY2UgPSBFTUxNYWtlckFJRW5naW5lLkNoZWNrRW1haWwoV1MpO1xuICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbi5ocmVmID0gXCIjL2xpbmtzXCI7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICByZWFkZXIucmVhZEFzVGV4dChmaWxlc1swXSk7XG4gICAgICAgICAgICAgICAgd2luZG93LmdhKCdzZW5kJywgJ2V2ZW50JywgXCJIVE1MXCIsIFwiaW1wb3J0XCIsIFwiSFRNTCBJbXBvcnQgRmlsZSBEcm9wXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoRU1MV29ya3NwYWNlLnByb3RvdHlwZSwgXCJkZWZhdWx0U0NvZGVcIiwge1xuICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiAobmV3VmFsdWUpIHtcbiAgICAgICAgICAgICAgICB2YXIgb2xkID0gdGhpcy5fZGVmYXVsdFNDb2RlO1xuICAgICAgICAgICAgICAgIGlmIChvbGQgIT09IG5ld1ZhbHVlKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2RlZmF1bHRTQ29kZSA9IG5ld1ZhbHVlO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm1hcExpbmtPYmplY3RzKGZ1bmN0aW9uIChMaW5rT2JqZWN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBMaW5rT2JqZWN0LmlzTGlua0NvbXBsZXRlKCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICAgIH0pO1xuICAgICAgICBFTUxXb3Jrc3BhY2UucHJvdG90eXBlLl9fZm9ybWF0RmlsZU5hbWUgPSBmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICAgICAgdmFyIF9zbHVnaWZ5X3N0cmlwX3JlID0gL1teXFx3XFxzLV0vZztcbiAgICAgICAgICAgIHZhciBfc2x1Z2lmeV9oeXBoZW5hdGVfcmUgPSAvWy1cXHNdKy9nO1xuICAgICAgICAgICAgbmFtZSA9IG5hbWUucmVwbGFjZShfc2x1Z2lmeV9zdHJpcF9yZSwgJycpLnRyaW0oKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAgICAgbmFtZSA9IG5hbWUucmVwbGFjZShfc2x1Z2lmeV9oeXBoZW5hdGVfcmUsICctJyk7XG4gICAgICAgICAgICByZXR1cm4gbmFtZTtcbiAgICAgICAgfTtcbiAgICAgICAgRU1MV29ya3NwYWNlLnByb3RvdHlwZS5fX3JlcGxhY2VFbG9xdWFNZXJnZUZpZWxkcyA9IGZ1bmN0aW9uIChjb250ZW50KSB7XG4gICAgICAgICAgICB2YXIgcmU0ID0gLzxzcGFuKCUyMHxcXHMpY2xhc3M9XCI/ZWxvcXVhZW1haWxcIj9cXHM/PiguKj8pPFxcL3NwYW4+L2lnO1xuICAgICAgICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZShyZTQsIFwiIyQyI1wiKTtcbiAgICAgICAgICAgIHJldHVybiBjb250ZW50O1xuICAgICAgICB9O1xuICAgICAgICBFTUxXb3Jrc3BhY2UucHJvdG90eXBlLl9fc3RyaXBIdG1sQW5kU3ViamVjdEZyb21FTUwgPSBmdW5jdGlvbiAoY29kZSkge1xuICAgICAgICAgICAgdmFyIG91dHB1dCA9IGNvZGUuc3BsaXQoXCJcXG5cIik7XG4gICAgICAgICAgICB2YXIgaHRtbCA9IG91dHB1dC5wb3AoKTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgb3V0cHV0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKG91dHB1dFtpXS5pbmRleE9mKFwiU3ViamVjdDpcIikgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5oZWFkZXIgPT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaGVhZGVyID0ge307XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGh0bWw7XG4gICAgICAgIH07XG4gICAgICAgIEVNTFdvcmtzcGFjZS5wcm90b3R5cGUuX19yZW1vdmVXaGl0ZVNwYWNlID0gZnVuY3Rpb24gKGNvZGUpIHtcbiAgICAgICAgICAgIHZhciBvdXRwdXQgPSBjb2RlO1xuICAgICAgICAgICAgb3V0cHV0ID0gb3V0cHV0LnJlcGxhY2UobmV3IFJlZ0V4cChcIlxcblwiLCBcImdcIiksIFwiIFwiKTtcbiAgICAgICAgICAgIG91dHB1dCA9IG91dHB1dC5yZXBsYWNlKG5ldyBSZWdFeHAoXCJcXHRcIiwgXCJnXCIpLCBcIiBcIik7XG4gICAgICAgICAgICBvdXRwdXQgPSBvdXRwdXQucmVwbGFjZSgvXFxzezIsOTk5OTl9L2csIFwiIFwiKTtcbiAgICAgICAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgICAgIH07XG4gICAgICAgIEVNTFdvcmtzcGFjZS5wcm90b3R5cGUuX19idWlsZEhlYWRlcnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgaGVhZGVycyA9IFtdO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmhlYWRlcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBoZWFkZXJzLnB1c2godGhpcy5oZWFkZXJzW2ldKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBjaGFyc2V0ID0gdGhpcy5fX2dldENoYXJzZXRGcm9tSFRNTCh0aGlzLnNvdXJjZUNvZGUpO1xuICAgICAgICAgICAgaWYgKGNoYXJzZXQgPT0gXCJcIilcbiAgICAgICAgICAgICAgICBjaGFyc2V0ID0gXCJjaGFyc2V0PVVURi04XCI7XG4gICAgICAgICAgICBoZWFkZXJzLnB1c2goXCJDb250ZW50LVR5cGU6IHRleHQvaHRtbDtcXG5cXHRcIiArIGNoYXJzZXQpO1xuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coaGVhZGVycywgYWxsb3dhYmxlSGVhZGVyRmllbGRzKTtcbiAgICAgICAgICAgIGZvciAodmFyIGlfMSBpbiB0aGlzLmhlYWRlcikge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmhlYWRlci5oYXNPd25Qcm9wZXJ0eShpXzEpKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9fYWxsb3dhYmxlSGVhZGVyRmllbGRzLmhhc093blByb3BlcnR5KGlfMSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnMucHVzaCh0aGlzLl9fYWxsb3dhYmxlSGVhZGVyRmllbGRzW2lfMV0uc3ludGF4ICsgXCIgXCIgKyB0aGlzLmhlYWRlcltpXzFdKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuX19lbWxIZWFkZXJzID0gaGVhZGVycy5qb2luKFwiXFxuXCIpO1xuICAgICAgICAgICAgcmV0dXJuIGhlYWRlcnMuam9pbihcIlxcblwiKTtcbiAgICAgICAgfTtcbiAgICAgICAgRU1MV29ya3NwYWNlLnByb3RvdHlwZS5fX2dldENoYXJzZXRGcm9tSFRNTCA9IGZ1bmN0aW9uIChjb250ZW50KSB7XG4gICAgICAgICAgICB2YXIgcmU1ID0gLzxtZXRhLio/Y2hhcnNldD0oW15cXHNcIl0qKS9pZywgY2hhcnNldCA9IFwiXCI7XG4gICAgICAgICAgICB2YXIgbWV0YVRhZ3MgPSBjb250ZW50Lm1hdGNoKHJlNSk7XG4gICAgICAgICAgICBpZiAobWV0YVRhZ3MpIHtcbiAgICAgICAgICAgICAgICBtZXRhVGFncy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjaGFyc2V0VmFscyA9IGl0ZW0ubWF0Y2goL2NoYXJzZXQ9KFteXFxzXCJdKikvaWcpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoY2hhcnNldFZhbHMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYXJzZXQgPSBjaGFyc2V0VmFsc1swXTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNoYXJzZXQgPSBcImNoYXJzZXQ9VVRGLThcIjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIGNoYXJzZXQ7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBFTUxXb3Jrc3BhY2U7XG4gICAgfSgpKTtcbiAgICBFTUxNb2R1bGUuRU1MV29ya3NwYWNlID0gRU1MV29ya3NwYWNlO1xuICAgIHZhciBLZXlib2FyZFNob3J0Y3V0ID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gS2V5Ym9hcmRTaG9ydGN1dCh3aGVuLCBkb1RoaXMsIGtleXMsIGRlc2NyaXB0aW9uKSB7XG4gICAgICAgICAgICB0aGlzLndoZW4gPSB3aGVuO1xuICAgICAgICAgICAgdGhpcy5kb1RoaXMgPSBkb1RoaXM7XG4gICAgICAgICAgICB0aGlzLmtleXMgPSBrZXlzO1xuICAgICAgICAgICAgdGhpcy5kZXNjcmlwdGlvbiA9IGRlc2NyaXB0aW9uO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBLZXlib2FyZFNob3J0Y3V0O1xuICAgIH0oKSk7XG4gICAgRU1MTW9kdWxlLktleWJvYXJkU2hvcnRjdXQgPSBLZXlib2FyZFNob3J0Y3V0O1xufSkoRU1MTW9kdWxlIHx8IChFTUxNb2R1bGUgPSB7fSkpO1xuXG52YXIgSW50ZWxsaWdlbmNlQWxlcnQgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEludGVsbGlnZW5jZUFsZXJ0KCkge1xuICAgICAgICB0aGlzLm92ZXJyaWRlID0gZmFsc2U7XG4gICAgfVxuICAgIEludGVsbGlnZW5jZUFsZXJ0LnByb3RvdHlwZS5nZW5lcmF0ZUd1aWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIHM0KCkge1xuICAgICAgICAgICAgcmV0dXJuIE1hdGguZmxvb3IoKDEgKyBNYXRoLnJhbmRvbSgpKSAqIDB4MTAwMDApXG4gICAgICAgICAgICAgICAgLnRvU3RyaW5nKDE2KVxuICAgICAgICAgICAgICAgIC5zdWJzdHJpbmcoMSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHM0KCkgKyBzNCgpICsgJy0nICsgczQoKSArICctJyArIHM0KCkgKyAnLScgKyBzNCgpICsgJy0nICsgczQoKSArIHM0KCkgKyBzNCgpO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEludGVsbGlnZW5jZUFsZXJ0LnByb3RvdHlwZSwgXCJ0eXBlXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fdHlwZTtcbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiBmdW5jdGlvbiAobmV3VmFsKSB7XG4gICAgICAgICAgICB0aGlzLl90eXBlID0gbmV3VmFsO1xuICAgICAgICAgICAgdGhpcy5jbGVhblR5cGUgPSBFcnJvclR5cGVbbmV3VmFsXTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgSW50ZWxsaWdlbmNlQWxlcnQucHJvdG90eXBlLnNldE92ZXJyaWRlU3RhdHVzID0gZnVuY3Rpb24gKHZhbCkge1xuICAgICAgICB0aGlzLm92ZXJyaWRlID0gdmFsO1xuICAgICAgICAvLyBjb25zb2xlLmxvZyh0aGlzLmlkICsgXCIgLSBvdmVycmlkZGVuXCIpO1xuICAgIH07XG4gICAgcmV0dXJuIEludGVsbGlnZW5jZUFsZXJ0O1xufSgpKTtcbnZhciBFTUxNYWtlckludGVsbGlnZW5jZTtcbihmdW5jdGlvbiAoRU1MTWFrZXJJbnRlbGxpZ2VuY2UpIHtcbiAgICB2YXIgSW50ZWxsaWdlbmNlQ2VudGVyID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gSW50ZWxsaWdlbmNlQ2VudGVyKCRtb25pdG9yLCAkc2NvcGUpIHtcbiAgICAgICAgICAgIHRoaXMuX3Njb3BlID0gJHNjb3BlO1xuICAgICAgICAgICAgdGhpcy5fbW9uaXRvciA9ICRtb25pdG9yO1xuICAgICAgICAgICAgdGhpcy5zZWFyY2hUeXBlID0gdGhpcy5kZWZhdWx0U2VhcmNoVHlwZSgpO1xuICAgICAgICB9XG4gICAgICAgIEludGVsbGlnZW5jZUNlbnRlci5wcm90b3R5cGUuc2V0VHlwZSA9IGZ1bmN0aW9uICh2YWwpIHtcbiAgICAgICAgICAgIHRoaXMuc2VhcmNoVHlwZSA9IHZhbDtcbiAgICAgICAgfTtcbiAgICAgICAgSW50ZWxsaWdlbmNlQ2VudGVyLnByb3RvdHlwZS5kZWZhdWx0U2VhcmNoVHlwZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciB0eXBlcyA9IHRoaXMuX21vbml0b3IudHlwZXM7XG4gICAgICAgICAgICByZXR1cm4gT2JqZWN0LmtleXModGhpcy5fbW9uaXRvci50YWJzKS5sZW5ndGggPiAxXG4gICAgICAgICAgICAgICAgPyBcIlwiXG4gICAgICAgICAgICAgICAgOiAodGhpcy5fbW9uaXRvci50YWJzKVsoT2JqZWN0LmtleXModGhpcy5fbW9uaXRvci50YWJzKVswXSldO1xuICAgICAgICB9O1xuICAgICAgICBJbnRlbGxpZ2VuY2VDZW50ZXIucHJvdG90eXBlLmNhblZpZXdBbGwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gT2JqZWN0LmtleXModGhpcy5fbW9uaXRvci50YWJzKS5sZW5ndGggPiAxO1xuICAgICAgICB9O1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoSW50ZWxsaWdlbmNlQ2VudGVyLnByb3RvdHlwZSwgXCJzZWFyY2hcIiwge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIHR5cGVzID0gdGhpcy5fbW9uaXRvci50eXBlcztcbiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhcInNlYXJjaFR5cGVcIix0aGlzLnNlYXJjaFR5cGUpO1xuICAgICAgICAgICAgICAgIGlmICh0eXBlcyAmJiB0aGlzLnNlYXJjaFR5cGUgaW4gdHlwZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsgdHlwZTogdGhpcy5zZWFyY2hUeXBlIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4geyB0eXBlOiB0aGlzLmRlZmF1bHRTZWFyY2hUeXBlKCkgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIEludGVsbGlnZW5jZUNlbnRlcjtcbiAgICB9KCkpO1xuICAgIEVNTE1ha2VySW50ZWxsaWdlbmNlLkludGVsbGlnZW5jZUNlbnRlciA9IEludGVsbGlnZW5jZUNlbnRlcjtcbiAgICB2YXIgSW50ZWxsaWdlbmNlRW5naW5lID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gSW50ZWxsaWdlbmNlRW5naW5lKCkge1xuICAgICAgICAgICAgdGhpcy5tZXNzYWdlcyA9IFtdO1xuICAgICAgICAgICAgdGhpcy5jYW5Db250aW51ZSA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLmNhY2hlZFJlc3VsdHMgPSBbXTtcbiAgICAgICAgICAgIHRoaXMuc2NvcGVzID0gW107XG4gICAgICAgIH1cbiAgICAgICAgSW50ZWxsaWdlbmNlRW5naW5lLnByb3RvdHlwZS5fX2xvY2F0ZVNjb3BlID0gZnVuY3Rpb24gKHNjb3BlKSB7XG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0gdGhpcy5zY29wZXMuZmlsdGVyKGZ1bmN0aW9uIChvYmopIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gb2JqLnNjb3BlID09IHNjb3BlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAocmVzdWx0Lmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICAgICAgdmFyIGEgPSBuZXcgSW50ZWxsaWdlbmNlTW9kdWxlKHNjb3BlKTtcbiAgICAgICAgICAgICAgICB2YXIgYiA9IHRoaXMuc2NvcGVzLnB1c2goYSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0WzBdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBJbnRlbGxpZ2VuY2VFbmdpbmUucHJvdG90eXBlLnJlYWRPdXRSdWxlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIC8vIHRoaXMuc2NvcGVzO1xuICAgICAgICAgICAgdGhpcy5zY29wZXMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgIC8vbGV0IHRyYXNoTW9uaXRvciA9IG5ldyBJbnRlbGxpZ2VuY2VNb25pdG9yKGl0ZW0uc2NvcGUpO1xuICAgICAgICAgICAgICAgIHZhciBydWxlcyA9IE9iamVjdC5rZXlzKGl0ZW0ucnVsZXMpO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcnVsZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgLy8gdHJhc2hNb25pdG9yID0gbnVsbDtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgLy9ydW4gZWFjaCBvZiB0aGUgZnVuY3Rpb25zIGFuZCByZXR1cm4gdGhlIHN1YnJ0LlxuICAgICAgICB9O1xuICAgICAgICBJbnRlbGxpZ2VuY2VFbmdpbmUucHJvdG90eXBlLm1vZHVsZSA9IGZ1bmN0aW9uIChzY29wZSkge1xuICAgICAgICAgICAgdmFyIG1vZHVsZSA9IHRoaXMuX19sb2NhdGVTY29wZShzY29wZSk7XG4gICAgICAgICAgICByZXR1cm4gbW9kdWxlO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gSW50ZWxsaWdlbmNlRW5naW5lO1xuICAgIH0oKSk7XG4gICAgRU1MTWFrZXJJbnRlbGxpZ2VuY2UuSW50ZWxsaWdlbmNlRW5naW5lID0gSW50ZWxsaWdlbmNlRW5naW5lO1xuICAgIHZhciBJbnRlbGxpZ2VuY2VNb2R1bGUgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBJbnRlbGxpZ2VuY2VNb2R1bGUoc2NvcGUpIHtcbiAgICAgICAgICAgIHRoaXMuc2NvcGUgPSBzY29wZTtcbiAgICAgICAgICAgIHRoaXMucnVsZXMgPSB7fTtcbiAgICAgICAgfVxuICAgICAgICBJbnRlbGxpZ2VuY2VNb2R1bGUucHJvdG90eXBlLm1vbml0b3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IEludGVsbGlnZW5jZU1vbml0b3IodGhpcyk7XG4gICAgICAgIH07XG4gICAgICAgIEludGVsbGlnZW5jZU1vZHVsZS5wcm90b3R5cGUucmVnaXN0ZXIgPSBmdW5jdGlvbiAoaWQsIHJ1bGUpIHtcbiAgICAgICAgICAgIHRoaXMucnVsZXNbaWRdID0gcnVsZTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gSW50ZWxsaWdlbmNlTW9kdWxlO1xuICAgIH0oKSk7XG4gICAgRU1MTWFrZXJJbnRlbGxpZ2VuY2UuSW50ZWxsaWdlbmNlTW9kdWxlID0gSW50ZWxsaWdlbmNlTW9kdWxlO1xuICAgIHZhciBJbnRlbGxpZ2VuY2VNb25pdG9yID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gSW50ZWxsaWdlbmNlTW9uaXRvcihwYXJlbnRTY29wZSkge1xuICAgICAgICAgICAgdGhpcy5ydWxlcyA9IHBhcmVudFNjb3BlLnJ1bGVzO1xuICAgICAgICAgICAgdGhpcy5vdmVycmlkZGVuID0gW107XG4gICAgICAgICAgICB0aGlzLnZhcmlhYmxlcyA9IHtcbiAgICAgICAgICAgICAgICBcIkludGVsbGlnZW5jZU1vbml0b3JcIjogdGhpc1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMucmVzZXQoKTtcbiAgICAgICAgfVxuICAgICAgICBJbnRlbGxpZ2VuY2VNb25pdG9yLnByb3RvdHlwZS5yZXNldCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMubWVzc2FnZXMgPSBbXTtcbiAgICAgICAgICAgIHRoaXMuY2FuQ29udGludWUgPSB0cnVlO1xuICAgICAgICB9O1xuICAgICAgICBJbnRlbGxpZ2VuY2VNb25pdG9yLnByb3RvdHlwZS5hc3NvY2lhdGVWYXJpYWJsZSA9IGZ1bmN0aW9uIChhY2Nlc3NvciwgdmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMudmFyaWFibGVzW2FjY2Vzc29yXSA9IHZhbHVlO1xuICAgICAgICB9O1xuICAgICAgICBJbnRlbGxpZ2VuY2VNb25pdG9yLnByb3RvdHlwZS5ldmFsdWF0ZVJ1bGUgPSBmdW5jdGlvbiAocnVsZSkge1xuICAgICAgICAgICAgLy9sb29rIGZvciBpbmplY3Rpb24gcGFyYW1ldGVyc1xuICAgICAgICAgICAgdmFyIHJlc3VsdDtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgcnVsZSA9PSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgICAgICAgLy9sYXN0IHBhcmFtZXRlciBpcyB0aGUgZnV1bmN0aW9uO1xuICAgICAgICAgICAgICAgIHZhciBmdW5jID0gcnVsZVtydWxlLmxlbmd0aCAtIDFdO1xuICAgICAgICAgICAgICAgIHZhciBwYXJhbWV0ZXJzID0gcnVsZS5zbGljZSgwLCBydWxlLmxlbmd0aCAtIDEpO1xuICAgICAgICAgICAgICAgIHZhciBJTV8xID0gdGhpcztcbiAgICAgICAgICAgICAgICB2YXIgYXJncyA9IHBhcmFtZXRlcnMubWFwKGZ1bmN0aW9uIChrZXkpIHsgcmV0dXJuIElNXzEudmFyaWFibGVzW2tleV07IH0pO1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IGZ1bmMuYXBwbHkobnVsbCwgYXJncyk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gcnVsZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfTtcbiAgICAgICAgSW50ZWxsaWdlbmNlTW9uaXRvci5wcm90b3R5cGUuZXZhbHVhdGVSdWxlcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMucmVzZXQoKTtcbiAgICAgICAgICAgIHZhciBydWxlcyA9IE9iamVjdC5rZXlzKHRoaXMucnVsZXMpO1xuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBydWxlc18xID0gcnVsZXM7IF9pIDwgcnVsZXNfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgcnVsZSA9IHJ1bGVzXzFbX2ldO1xuICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSB0aGlzLmV2YWx1YXRlUnVsZSh0aGlzLnJ1bGVzW3J1bGVdKTtcbiAgICAgICAgICAgICAgICB2YXIgcHJvY2VlZCA9IHJlc3VsdC5oYXNPd25Qcm9wZXJ0eShcIndoZW5cIikgPyByZXN1bHQud2hlbi5hcHBseShudWxsKSA6IGZhbHNlO1xuICAgICAgICAgICAgICAgIGlmIChwcm9jZWVkKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFBVU0ggQUxFUlQgTUVTU0FHRS5cbiAgICAgICAgICAgICAgICAgICAgdmFyIElBID0gbmV3IEludGVsbGlnZW5jZUFsZXJ0KCk7XG4gICAgICAgICAgICAgICAgICAgIElBLmlkID0gcmVzdWx0LmlkID09PSB1bmRlZmluZWQgfHwgcmVzdWx0LmlkID09IFwiXCIgPyBJQS5nZW5lcmF0ZUd1aWQoKSA6IHJlc3VsdC5pZDtcbiAgICAgICAgICAgICAgICAgICAgSUEudHlwZSA9IHJlc3VsdC50eXBlID09PSB1bmRlZmluZWQgPyBFcnJvclR5cGUuV2FybiA6IHJlc3VsdC50eXBlO1xuICAgICAgICAgICAgICAgICAgICBJQS5zZXZlcml0eSA9IHJlc3VsdC5zZXZlcml0eSA9PT0gdW5kZWZpbmVkID8gRXJyb3JTZXZlcml0eS5aZXJvIDogcmVzdWx0LnNldmVyaXR5O1xuICAgICAgICAgICAgICAgICAgICBJQS50aXRsZSA9IHJlc3VsdC50aXRsZSA9PT0gdW5kZWZpbmVkID8gXCJcIiA6IHJlc3VsdC50aXRsZTtcbiAgICAgICAgICAgICAgICAgICAgSUEuZGVzY3JpcHRpb24gPSByZXN1bHQuZGVzY3JpcHRpb24gPT09IHVuZGVmaW5lZCA/IFwiXCIgOiByZXN1bHQuZGVzY3JpcHRpb247XG4gICAgICAgICAgICAgICAgICAgIElBLnJlc291cmNlID0gcmVzdWx0LnJlc291cmNlID09PSB1bmRlZmluZWQgPyBcIlwiIDogcmVzdWx0LnJlc291cmNlO1xuICAgICAgICAgICAgICAgICAgICBJQS5jdGFIYW5kbGVyID0gcmVzdWx0LmN0YSAmJiByZXN1bHQuY3RhLmhhbmRsZXIgPyByZXN1bHQuY3RhLmhhbmRsZXIgOiBmdW5jdGlvbiAoKSB7IH07XG4gICAgICAgICAgICAgICAgICAgIElBLmN0YUxhYmVsID0gcmVzdWx0LmN0YSAmJiByZXN1bHQuY3RhLmxhYmVsID8gcmVzdWx0LmN0YS5sYWJlbCA6IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgIElBLmNhbkNvbnRpbnVlID0gcmVzdWx0Lmhhc093blByb3BlcnR5KFwiY2FuQ29udGludWVcIikgPyByZXN1bHQuY2FuQ29udGludWUgOiB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm1lc3NhZ2VzLnB1c2goSUEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tZXNzYWdlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLm92ZXJyaWRkZW4uaW5kZXhPZih0aGlzLm1lc3NhZ2VzW2ldLmlkKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubWVzc2FnZXNbaV0ub3ZlcnJpZGUgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMubWVzc2FnZXNbaV0uY2FuQ29udGludWUpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0aGlzLm1lc3NhZ2VzW2ldLm92ZXJyaWRlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNhbkNvbnRpbnVlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLm1lc3NhZ2VzLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgICAgICAgICAgICBpZiAoYS5fdHlwZSA+IGIuX3R5cGUpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAxO1xuICAgICAgICAgICAgICAgIGlmIChhLl90eXBlIDwgYi5fdHlwZSlcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbnRlbGxpZ2VuY2VNb25pdG9yLnByb3RvdHlwZSwgXCJ0YWJzXCIsIHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBvdXRwdXQgPSB7fTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubWVzc2FnZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgb3V0cHV0W3RoaXMubWVzc2FnZXNbaV0uY2xlYW5UeXBlXSA9IHRoaXMubWVzc2FnZXNbaV0udHlwZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoSW50ZWxsaWdlbmNlTW9uaXRvci5wcm90b3R5cGUsIFwidHlwZXNcIiwge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIG91dHB1dCA9IHt9O1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tZXNzYWdlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBvdXRwdXRbdGhpcy5tZXNzYWdlc1tpXS50eXBlXSA9IEVycm9yVHlwZVt0aGlzLm1lc3NhZ2VzW2ldLnR5cGVdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gb3V0cHV0O1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgICAgfSk7XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbnRlbGxpZ2VuY2VNb25pdG9yLnByb3RvdHlwZSwgXCJjb3VudFwiLCB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgb3V0cHV0ID0ge307XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1lc3NhZ2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChvdXRwdXRbRXJyb3JUeXBlW3RoaXMubWVzc2FnZXNbaV0udHlwZV1dID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG91dHB1dFtFcnJvclR5cGVbdGhpcy5tZXNzYWdlc1tpXS50eXBlXV0gPSAwO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIG91dHB1dFtFcnJvclR5cGVbdGhpcy5tZXNzYWdlc1tpXS50eXBlXV0rKztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gSW50ZWxsaWdlbmNlTW9uaXRvcjtcbiAgICB9KCkpO1xuICAgIEVNTE1ha2VySW50ZWxsaWdlbmNlLkludGVsbGlnZW5jZU1vbml0b3IgPSBJbnRlbGxpZ2VuY2VNb25pdG9yO1xufSkoRU1MTWFrZXJJbnRlbGxpZ2VuY2UgfHwgKEVNTE1ha2VySW50ZWxsaWdlbmNlID0ge30pKTtcbnZhciBFTUxJbnRlbGxpZ2VuY2UgPSBuZXcgRU1MTWFrZXJJbnRlbGxpZ2VuY2UuSW50ZWxsaWdlbmNlRW5naW5lKCk7XG5cbmZ1bmN0aW9uIGdldE9mZmxpbmVWZXJzaW9uTnVtYmVyKCkge1xuICAgIHZhciBvdXRwdXQgPSBcIlwiO1xuICAgIGlmICh3aW5kb3cubG9jYXRpb24uc2VhcmNoLmluZGV4T2YoXCJvZmZsaW5lX3ZlcnNpb25cIikpIHtcbiAgICAgICAgdmFyIHBhcmFtcyA9IHdpbmRvdy5sb2NhdGlvbi5zZWFyY2guc3Vic3RyKDEsIHdpbmRvdy5sb2NhdGlvbi5zZWFyY2gubGVuZ3RoKS5zcGxpdChcIiZcIik7XG4gICAgICAgIHBhcmFtcy5mb3JFYWNoKGZ1bmN0aW9uIChwYXJhbSkge1xuICAgICAgICAgICAgaWYgKHBhcmFtLmluZGV4T2YoXCJvZmZsaW5lX3ZlcnNpb249XCIpID4gLTEpIHtcbiAgICAgICAgICAgICAgICBvdXRwdXQgPSBwYXJhbS5zdWJzdHIoXCJvZmZsaW5lX3ZlcnNpb249XCIubGVuZ3RoLCBwYXJhbS5sZW5ndGgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIG91dHB1dDtcbn1cbnZhciBBY2Nlc3NPbmxpbmVWZXJzaW9uID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBBY2Nlc3NPbmxpbmVWZXJzaW9uKGFyZ3MpIHtcbiAgICAgICAgdGhpcy5hbmltYXRlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5zdGF0dXMgPSBcImF0dGVtcHRpbmdcIjtcbiAgICAgICAgdGhpcy5oZWFkbGluZSA9IFwiQ2hlY2tpbmcgYXZhaWxhYmlsaXR5IG9mIG9ubGluZSB2ZXJzaW9uXCI7XG4gICAgICAgIHRoaXMubWVzc2FnZSA9IFwiSWYgd2UncmUgYWJsZSB0byBhY2Nlc3MgdGhlIG9ubGluZSB2ZXJzaW9uLCB5b3Ugd2lsbCBiZSByZWRpcmVjdGVkLlwiO1xuICAgICAgICBpZiAoYXJncy5zdWNjZXNzID09PSB1bmRlZmluZWQpXG4gICAgICAgICAgICBhcmdzLnN1Y2Nlc3MgPSBmdW5jdGlvbiAoKSB7IH07XG4gICAgICAgIGlmIChhcmdzLm9uZXJyb3IgPT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgIGFyZ3Mub25lcnJvciA9IGZ1bmN0aW9uICgpIHsgfTtcbiAgICAgICAgd2luZG93LkxPQ0FMSE9TVCA9IHRoaXMuaXNMb2NhbE1hY2hpbmUoKTtcbiAgICAgICAgd2luZG93Lk9GRkxJTkVfVkVSU0lPTiA9IGdldE9mZmxpbmVWZXJzaW9uTnVtYmVyKCk7XG4gICAgICAgIGlmICh3aW5kb3cuTE9DQUxIT1NUKSB7XG4gICAgICAgICAgICB3aW5kb3cuc2Nyb2xsVG8oMCwgMCk7XG4gICAgICAgICAgICB0aGlzLm9idGFpbktleUZyb21TZXJ2ZXIoYXJncyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnN0YXR1cyA9IFwiZmFpbGVkXCI7XG4gICAgICAgICAgICB0aGlzLmFuaW1hdGUgPSBmYWxzZTtcbiAgICAgICAgICAgIGRvY3VtZW50LnRpdGxlID0gd2luZG93LlBBR0VfVElUTEU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgQWNjZXNzT25saW5lVmVyc2lvbi5wcm90b3R5cGUub2J0YWluS2V5RnJvbVNlcnZlciA9IGZ1bmN0aW9uIChhcmdzKSB7XG4gICAgICAgIGlmICh0aGlzLmlzTG9jYWxNYWNoaW5lKCkpIHtcbiAgICAgICAgICAgIHZhciByLCBhLCBtO1xuICAgICAgICAgICAgd2luZG93LnJlZGlyZWN0SnNvbnBDYWxsYmFjayA9IGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0ID09IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgYXJncy5zdWNjZXNzKCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRk9VTkQ/XCIpO1xuICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uLmhyZWYgPSBcImh0dHA6Ly9qb2hucHJvZXN0YWtlcy5naXRodWIuaW8vZW1sLW1ha2VyP29mZmxpbmVfdmVyc2lvbj1cIiArIHdpbmRvdy5DVVJSRU5UX1ZFUlNJT047XG4gICAgICAgICAgICAgICAgICAgIH0sIDUwMCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnbm90IGdpdGh1YicpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2NyaXB0JyksXG4gICAgICAgICAgICAgICAgYSA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdzY3JpcHQnKVswXTtcbiAgICAgICAgICAgIHIudHlwZSA9IFwidGV4dC9qYXZhc2NyaXB0XCI7XG4gICAgICAgICAgICByLm9uZXJyb3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgYXJncy5vbmVycm9yKCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgci5zcmMgPSAhdGhpcy5pc0xvY2FsTWFjaGluZSgpID8gXCJcIiA6IFwiaHR0cDovL2pvaG5wcm9lc3Rha2VzLmdpdGh1Yi5pby9lbWwtbWFrZXIvcHJvZC9hcHAvY2FucmVkaXJlY3QuanNcIjtcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGEucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUociwgbSk7XG4gICAgICAgICAgICB9LCAyMDAwKTtcbiAgICAgICAgICAgIGRvY3VtZW50LnRpdGxlID0gd2luZG93LlBBR0VfVElUTEUgKyBcIiAoT2ZmbGluZSBNb2RlKVwiO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5zdGF0dXMgPSBcImZhaWxlZFwiO1xuICAgICAgICAgICAgdGhpcy5hbmltYXRlID0gZmFsc2U7XG4gICAgICAgICAgICBkb2N1bWVudC50aXRsZSA9IHdpbmRvdy5QQUdFX1RJVExFO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBBY2Nlc3NPbmxpbmVWZXJzaW9uLnByb3RvdHlwZS5nZXRPZmZsaW5lVmVyc2lvbk51bWJlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIG91dHB1dCA9IFwiXCI7XG4gICAgICAgIGlmICh3aW5kb3cubG9jYXRpb24uc2VhcmNoLmluZGV4T2YoXCJvZmZsaW5lX3ZlcnNpb25cIikpIHtcbiAgICAgICAgICAgIHZhciBwYXJhbXMgPSB3aW5kb3cubG9jYXRpb24uc2VhcmNoLnN1YnN0cigxLCB3aW5kb3cubG9jYXRpb24uc2VhcmNoLmxlbmd0aCkuc3BsaXQoXCImXCIpO1xuICAgICAgICAgICAgcGFyYW1zLmZvckVhY2goZnVuY3Rpb24gKHBhcmFtKSB7XG4gICAgICAgICAgICAgICAgaWYgKHBhcmFtLmluZGV4T2YoXCJvZmZsaW5lX3ZlcnNpb249XCIpID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgb3V0cHV0ID0gcGFyYW0uc3Vic3RyKFwib2ZmbGluZV92ZXJzaW9uPVwiLmxlbmd0aCwgcGFyYW0ubGVuZ3RoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gb3V0cHV0O1xuICAgIH07XG4gICAgQWNjZXNzT25saW5lVmVyc2lvbi5wcm90b3R5cGUuaXNMb2NhbE1hY2hpbmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIC8vIHJldHVybiBmYWxzZTtcbiAgICAgICAgcmV0dXJuIGxvY2F0aW9uLmhyZWYuaW5kZXhPZignam9obnByb2VzdGFrZXMuZ2l0aHViLmlvJykgPT0gLTE7XG4gICAgfTtcbiAgICByZXR1cm4gQWNjZXNzT25saW5lVmVyc2lvbjtcbn0oKSk7XG52YXIgVXBkYXRlTW9kdWxlID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBVcGRhdGVNb2R1bGUoKSB7XG4gICAgICAgIHRoaXMudXBkYXRlVmVyc2lvbiA9IGZhbHNlO1xuICAgICAgICB0aGlzLnVwZGF0ZUZvcmNlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLm9mZmxpbmVWZXJzaW9uID0gd2luZG93Lk9GRkxJTkVfVkVSU0lPTiA9PT0gdW5kZWZpbmVkID8gZ2V0T2ZmbGluZVZlcnNpb25OdW1iZXIoKSA6IHdpbmRvdy5PRkZMSU5FX1ZFUlNJT047XG4gICAgICAgIHRoaXMub25saW5lVmVyc2lvbiA9IHdpbmRvdy5DVVJSRU5UX1ZFUlNJT047XG4gICAgICAgIC8vdHJlYXQgbG9jYWxob3N0Ojg4ODggYXMgaW50ZXJuZXRcbiAgICAgICAgaWYgKGxvY2F0aW9uLmhyZWYuaW5kZXhPZihcImxvY2FsaG9zdFwiKSA+IC0xKSB7XG4gICAgICAgICAgICB3aW5kb3cuTE9DQUxIT1NUID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMub2ZmbGluZVZlcnNpb24gPT0gXCJcIikge1xuICAgICAgICAgICAgdGhpcy5hY2Nlc3NpbmdGcm9tT2ZmbGluZSA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgaWYgKHRoaXMub2ZmbGluZVZlcnNpb24gJiYgd2luZG93LkxPQ0FMSE9TVCkge1xuICAgICAgICAgICAgICAgIHRoaXMuYWNjZXNzaW5nRnJvbU9mZmxpbmUgPSB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMub2ZmbGluZVZlcnNpb24gJiYgKHRoaXMub2ZmbGluZVZlcnNpb24gIT09IHRoaXMub25saW5lVmVyc2lvbikpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVZlcnNpb24gPSB0cnVlO1xuICAgICAgICAgICAgICAgIHZhciBvZlYgPSBuZXcgQXBwbGljYXRpb25WZXJzaW9uKHRoaXMub2ZmbGluZVZlcnNpb24pLCBvblYgPSBuZXcgQXBwbGljYXRpb25WZXJzaW9uKHRoaXMub25saW5lVmVyc2lvbik7XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVGb3JjZWQgPSBvZlYuY29tcGFyZUFnYWluc3Qob25WKSA8PSBBcHBWZXJzaW9uRGlmZmVyZW5jZVR5cGUuUEFUQ0g7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJVUERBVEVGT1JDRUQ/XCIsIHRoaXMudXBkYXRlRm9yY2VkLCBvZlYsIG9uVik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgVXBkYXRlTW9kdWxlLnByb3RvdHlwZS5zaG93TWVzc2FnZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudXBkYXRlVmVyc2lvbiAmJiB0aGlzLnVwZGF0ZUZvcmNlZDtcbiAgICB9O1xuICAgIFVwZGF0ZU1vZHVsZS5wcm90b3R5cGUuc2hvd1RlYXNlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMub2ZmbGluZVZlcnNpb24gPT0gXCJcIiAmJiAhd2luZG93LkxPQ0FMSE9TVDtcbiAgICB9O1xuICAgIFVwZGF0ZU1vZHVsZS5wcm90b3R5cGUuZm9yY2VVcGRhdGUgPSBmdW5jdGlvbiAob2ZmbGluZSwgb25saW5lKSB7XG4gICAgICAgIHZhciBvZmZsaW5lVmVyc2lvbiA9IG9mZmxpbmUuc3BsaXQoXCIuXCIpLCBvbmxpbmVWZXJzaW9uID0gb25saW5lLnNwbGl0KFwiLlwiKSwgbWF0Y2ggPSAwLCBvdXRwdXQgPSBmYWxzZTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBvbmxpbmVWZXJzaW9uLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAob25saW5lVmVyc2lvbltpXSA9PSBvZmZsaW5lVmVyc2lvbltpXSlcbiAgICAgICAgICAgICAgICBtYXRjaCsrO1xuICAgICAgICB9XG4gICAgICAgIGlmIChtYXRjaCA8IDMpIHtcbiAgICAgICAgICAgIG91dHB1dCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICB9O1xuICAgIHJldHVybiBVcGRhdGVNb2R1bGU7XG59KCkpO1xudmFyIEFwcFZlcnNpb25EaWZmZXJlbmNlVHlwZTtcbihmdW5jdGlvbiAoQXBwVmVyc2lvbkRpZmZlcmVuY2VUeXBlKSB7XG4gICAgQXBwVmVyc2lvbkRpZmZlcmVuY2VUeXBlW0FwcFZlcnNpb25EaWZmZXJlbmNlVHlwZVtcIk1BSk9SXCJdID0gMF0gPSBcIk1BSk9SXCI7XG4gICAgQXBwVmVyc2lvbkRpZmZlcmVuY2VUeXBlW0FwcFZlcnNpb25EaWZmZXJlbmNlVHlwZVtcIk1JTk9SXCJdID0gMV0gPSBcIk1JTk9SXCI7XG4gICAgQXBwVmVyc2lvbkRpZmZlcmVuY2VUeXBlW0FwcFZlcnNpb25EaWZmZXJlbmNlVHlwZVtcIlBBVENIXCJdID0gMl0gPSBcIlBBVENIXCI7XG4gICAgQXBwVmVyc2lvbkRpZmZlcmVuY2VUeXBlW0FwcFZlcnNpb25EaWZmZXJlbmNlVHlwZVtcIlNVQlBBVENIXCJdID0gM10gPSBcIlNVQlBBVENIXCI7XG4gICAgQXBwVmVyc2lvbkRpZmZlcmVuY2VUeXBlW0FwcFZlcnNpb25EaWZmZXJlbmNlVHlwZVtcIk5PTkVcIl0gPSA0XSA9IFwiTk9ORVwiO1xufSkoQXBwVmVyc2lvbkRpZmZlcmVuY2VUeXBlIHx8IChBcHBWZXJzaW9uRGlmZmVyZW5jZVR5cGUgPSB7fSkpO1xudmFyIEFwcGxpY2F0aW9uVmVyc2lvbiA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQXBwbGljYXRpb25WZXJzaW9uKHZlcnNpb24pIHtcbiAgICAgICAgdGhpcy5fdmVyc2lvbiA9IHZlcnNpb247XG4gICAgICAgIHRoaXMudmVyc2lvbk9iamVjdCA9IHRoaXMuX3ZlcnNpb24uc3BsaXQoXCIuXCIpLm1hcChmdW5jdGlvbiAobikgeyByZXR1cm4gcGFyc2VJbnQobik7IH0pO1xuICAgIH1cbiAgICBBcHBsaWNhdGlvblZlcnNpb24ucHJvdG90eXBlLmNvbXBhcmVBZ2FpbnN0ID0gZnVuY3Rpb24gKE90aGVyVmVyc2lvbikge1xuICAgICAgICB2YXIgbWUgPSB0aGlzLnZlcnNpb25PYmplY3QsIG90aGVyID0gT3RoZXJWZXJzaW9uLnZlcnNpb25PYmplY3QsIG1hdGNoID0gMCwgb3V0cHV0ID0gZmFsc2U7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgNDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAobWVbaV0gPT0gb3RoZXJbaV0pIHtcbiAgICAgICAgICAgICAgICBtYXRjaCsrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIEFwcFZlcnNpb25EaWZmZXJlbmNlVHlwZVtBcHBWZXJzaW9uRGlmZmVyZW5jZVR5cGVbbWF0Y2hdXTtcbiAgICB9O1xuICAgIHJldHVybiBBcHBsaWNhdGlvblZlcnNpb247XG59KCkpO1xuXG52YXIgU2VjdXJlR2F0ZXdheSA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gU2VjdXJlR2F0ZXdheShsb2dpbkNhbGxiYWNrLCAkc2NvcGUpIHtcbiAgICAgICAgdGhpcy5jYW5Mb2dpbiA9IGZhbHNlO1xuICAgICAgICB0aGlzLmxvZ2luQ2FsbGJhY2sgPSBsb2dpbkNhbGxiYWNrO1xuICAgICAgICB0aGlzLmxvZ2luVGltZXIgPSBudWxsO1xuICAgICAgICB0aGlzLnNlc3Npb25Vc2VyRW1haWwgPSBcIlwiO1xuICAgICAgICB0aGlzLnRpbWVyRGVsYXkgPSA1MDA7XG4gICAgICAgIHRoaXMuc2FsdCA9IFwiNDdkYWZlYTlhYWUzYjI4YWI1YzM5ZWI3ZjdkMmM5MjRcIjtcbiAgICAgICAgdGhpcy5lbWFpbFJlZ2V4ID0gL14oKFtePD4oKVxcW1xcXVxcXFwuLDs6XFxzQFwiXSsoXFwuW148PigpXFxbXFxdXFxcXC4sOzpcXHNAXCJdKykqKXwoXCIuK1wiKSlAKChcXFtbMC05XXsxLDN9XFwuWzAtOV17MSwzfVxcLlswLTldezEsM31cXC5bMC05XXsxLDN9XSl8KChbYS16QS1aXFwtMC05XStcXC4pK1thLXpBLVpdezIsfSkpJC87XG4gICAgICAgIHRoaXMuc2Vzc2lvbklkTG9jYWxTdG9yYWdlS2V5ID0gXCJFTUxNYWtlci5lbWxTZXNzaW9uVUlEXCI7XG4gICAgICAgIGlmICghd2luZG93LnBlcnNpc3Rfc3RvcmUpIHtcbiAgICAgICAgICAgIHdpbmRvdy5wZXJzaXN0X3N0b3JlID0gbmV3IHdpbmRvdy5QZXJzaXN0LlN0b3JlKCdFTUxNYWtlcicpO1xuICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3VubG9hZCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB3aW5kb3cucGVyc2lzdF9zdG9yZS5zYXZlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgU0cgPSB0aGlzO1xuICAgICAgICBsb2NhdGlvbi5ocmVmID0gXCIjL2xvZ2luXCI7XG4gICAgfVxuICAgIFNlY3VyZUdhdGV3YXkucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICh0aGlzLmhhc1NhdmVkU2Vzc2lvbklkKCkpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmlzVmFsaWRFbWFpbEFkZHJlc3ModGhpcy5zZXNzaW9uSWQpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXNzaW9uVXNlckVtYWlsID0gdGhpcy5zZXNzaW9uSWQ7XG4gICAgICAgICAgICAgICAgLy8gbG9naW5DYWxsYmFjaygpO1xuICAgICAgICAgICAgICAgIGxvY2F0aW9uLmhyZWYgPSBcIiMvbG9naW5cIjtcbiAgICAgICAgICAgICAgICAvL2F1dG8gbG9ncyBpbjtcbiAgICAgICAgICAgICAgICAvL2lzIG9mZmxpbmUgLT5nZXQgb25saW5lIHZlcnNpb24uXG4gICAgICAgICAgICAgICAgdGhpcy5sb2dpblRpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uLmhyZWYgPSBcIiMvbWFpblwiO1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5zZXRDdXJyZW50VXNlcihfdGhpcy5zZXNzaW9uVXNlckVtYWlsKTtcbiAgICAgICAgICAgICAgICB9LCB0aGlzLnRpbWVyRGVsYXkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgbG9jYXRpb24uaHJlZiA9IFwiIy9sb2dpblwiO1xuICAgICAgICAgICAgICAgIHRoaXMuc2Vzc2lvblVzZXJFbWFpbCA9IFwiXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBsb2NhdGlvbi5ocmVmID0gXCIjL2xvZ2luXCI7XG4gICAgICAgICAgICB0aGlzLnNlc3Npb25Vc2VyRW1haWwgPSBcIlwiO1xuICAgICAgICB9XG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdoYXNoY2hhbmdlJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKF90aGlzLnNlc3Npb25Vc2VyRW1haWwgPT0gXCJcIiB8fCAhX3RoaXMuaGFzU2F2ZWRTZXNzaW9uSWQoKSkge1xuICAgICAgICAgICAgICAgIGxvY2F0aW9uLmhyZWYgPSBcIiMvbG9naW5cIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBTZWN1cmVHYXRld2F5LnByb3RvdHlwZS5sb2dPdXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMubG9naW5Bc090aGVyKCk7XG4gICAgICAgIHRoaXMuc2Vzc2lvbklkID0gXCJcIjtcbiAgICAgICAgdGhpcy5zZXNzaW9uVXNlckVtYWlsID0gXCJcIjtcbiAgICAgICAgd2luZG93LnBlcnNpc3Rfc3RvcmUucmVtb3ZlKHRoaXMuc2Vzc2lvbklkTG9jYWxTdG9yYWdlS2V5KTtcbiAgICAgICAgaWYgKFwicmVsb2FkXCIgaW4gbG9jYXRpb24pIHtcbiAgICAgICAgICAgIGxvY2F0aW9uLnJlbG9hZCgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZG9jdW1lbnQubG9jYXRpb24uaHJlZiA9IGRvY3VtZW50LmxvY2F0aW9uLmhyZWY7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFNlY3VyZUdhdGV3YXkucHJvdG90eXBlLmxvZ2luQXNPdGhlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMubG9naW5UaW1lcik7XG4gICAgICAgIGRlbGV0ZSB0aGlzLmxvZ2luVGltZXI7XG4gICAgfTtcbiAgICBTZWN1cmVHYXRld2F5LnByb3RvdHlwZS5zZXNzaW9uVXBkYXRlVXNlckVtYWlsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmVycm9yTWVzc2FnZSA9IFwiXCI7XG4gICAgICAgIGlmICh0aGlzLmlzVmFsaWRFbWFpbEFkZHJlc3ModGhpcy5zZXNzaW9uVXNlckVtYWlsKSkge1xuICAgICAgICAgICAgdGhpcy5zZXRDdXJyZW50VXNlcih0aGlzLnNlc3Npb25Vc2VyRW1haWwpO1xuICAgICAgICAgICAgdGhpcy5sb2dpbkNhbGxiYWNrKCk7XG4gICAgICAgICAgICBsb2NhdGlvbi5ocmVmID0gXCIjL21haW5cIjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIC8vIEVycm9yIG1lc3NhZ2VcbiAgICAgICAgICAgIHRoaXMuZXJyb3JNZXNzYWdlID0gXCJTb3JyeSEgWW91IGhhdmUgdG8gZW50ZXIgYSB2YWxpZCBlbWFpbCBhZGRyZXNzLlwiO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTZWN1cmVHYXRld2F5LnByb3RvdHlwZS5oYXNTYXZlZFNlc3Npb25JZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHNhdmVkRW1haWxJZCA9IHdpbmRvdy5wZXJzaXN0X3N0b3JlLmdldCh0aGlzLnNlc3Npb25JZExvY2FsU3RvcmFnZUtleSk7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKHNhdmVkRW1haWxJZCk7XG4gICAgICAgIGlmIChzYXZlZEVtYWlsSWQpIHtcbiAgICAgICAgICAgIHRoaXMuc2Vzc2lvbklkID0gdGhpcy5kZWNyeXB0KHNhdmVkRW1haWxJZCk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuc2Vzc2lvbklkID0gXCJcIjtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU2VjdXJlR2F0ZXdheS5wcm90b3R5cGUuZW5jcnlwdCA9IGZ1bmN0aW9uICh0ZXh0KSB7XG4gICAgICAgIHZhciBvdXRwdXQgPSB0ZXh0ICsgXCJcIjtcbiAgICAgICAgb3V0cHV0ID0gb3V0cHV0LnJlcGxhY2UoLy4vZ2ksIGZ1bmN0aW9uIChjaCkge1xuICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhjaC5jaGFyQ29kZUF0KDApKzEpO1xuICAgICAgICAgICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUoY2guY2hhckNvZGVBdCgwKSArIDEpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICB9O1xuICAgIFNlY3VyZUdhdGV3YXkucHJvdG90eXBlLmRlY3J5cHQgPSBmdW5jdGlvbiAodGV4dCkge1xuICAgICAgICB2YXIgb3V0cHV0ID0gdGV4dCArIFwiXCI7XG4gICAgICAgIG91dHB1dCA9IG91dHB1dC5yZXBsYWNlKC8uL2dpLCBmdW5jdGlvbiAoY2gpIHtcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coY2guY2hhckNvZGVBdCgwKSsxKTtcbiAgICAgICAgICAgIHJldHVybiBTdHJpbmcuZnJvbUNoYXJDb2RlKGNoLmNoYXJDb2RlQXQoMCkgLSAxKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgfTtcbiAgICBTZWN1cmVHYXRld2F5LnByb3RvdHlwZS5zZXRDdXJyZW50VXNlciA9IGZ1bmN0aW9uIChlbWFpbCkge1xuICAgICAgICB2YXIgaGFzaCA9IHdpbmRvdy5DcnlwdG9KUy5NRDUoZW1haWwgKyB0aGlzLnNhbHQpLnRvU3RyaW5nKCk7XG4gICAgICAgIHdpbmRvdy5wZXJzaXN0X3N0b3JlLnNldCh0aGlzLnNlc3Npb25JZExvY2FsU3RvcmFnZUtleSwgdGhpcy5lbmNyeXB0KGVtYWlsKSk7XG4gICAgICAgIHdpbmRvdy5nYSgnc2V0JywgJ3VzZXJJZCcsIGhhc2gpO1xuICAgIH07XG4gICAgU2VjdXJlR2F0ZXdheS5wcm90b3R5cGUuaXNWYWxpZEVtYWlsQWRkcmVzcyA9IGZ1bmN0aW9uIChlbWFpbCkge1xuICAgICAgICBpZiAodGhpcy5lbWFpbFJlZ2V4LnRlc3QoZW1haWwpKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlbWFpbCwgXCJpcyB2YWxpZFwiKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY29uc29sZS5sb2coZW1haWwsIFwiaXMgbm90IHZhbGlkXCIpO1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gU2VjdXJlR2F0ZXdheTtcbn0oKSk7XG4iLCJcbmludGVyZmFjZSBJbnRlbGxpZ2VuY2VBbGVydEFyZ3Mge1xuICBoYW5kbGVyOiAoKT0+dm9pZCxcbiAgY3RhTGFiZWw6IHN0cmluZyxcbiAgc2V2ZXJpdHk6IEVycm9yU2V2ZXJpdHksXG4gIGlucHV0TW9kZWw6IHN0cmluZyxcbiAgaW5wdXRMYWJlbDogc3RyaW5nXG59XG5pbnRlcmZhY2UgSW50ZWxsaWdlbmNlU2NvcGV7XG4gIHNjb3BlOiBzdHJpbmc7XG4gIHJ1bGU6IGFueVxufVxuaW50ZXJmYWNlIEludGVsbGlnZW5jZVN1YntcbiAgd2hlbjogKCk9PmJvb2xlYW4sXG4gIGlkOiBzdHJpbmcsXG4gIHR5cGU6IEVycm9yVHlwZSxcbiAgc2V2ZXJpdHk6IEVycm9yU2V2ZXJpdHksXG4gIHRpdGxlOiBzdHJpbmcsXG4gIGRlc2NyaXB0aW9uOiBzdHJpbmcsXG4gIHJlc291cmNlOiBzdHJpbmcsXG4gIGN0YToge1xuICAgIGxhYmVsOiBzdHJpbmcsXG4gICAgaGFuZGxlcjogKCk9PnZvaWRcbiAgfVxuICBjYW5Db250aW51ZTogYm9vbGVhblxuXG59XG5jbGFzcyBJbnRlbGxpZ2VuY2VBbGVydCB7XG4gIGlkOiBzdHJpbmc7XG4gIF90eXBlOiBFcnJvclR5cGU7XG4gIG92ZXJyaWRlOiBib29sZWFuO1xuICB0aXRsZTogc3RyaW5nO1xuICBkZXNjcmlwdGlvbjogc3RyaW5nO1xuICByZXNvdXJjZTogc3RyaW5nO1xuICBjdGFMYWJlbDogc3RyaW5nO1xuICBjdGFIYW5kbGVyOiBhbnk7XG4gIGNhbkNvbnRpbnVlOiBib29sZWFuO1xuICBzZXZlcml0eTogRXJyb3JTZXZlcml0eTtcbiAgY2xlYW5UeXBlOiBzdHJpbmc7XG4gIGFyZ3M6IEludGVsbGlnZW5jZUFsZXJ0QXJncztcblxuICBnZW5lcmF0ZUd1aWQoKSB7XG4gICAgZnVuY3Rpb24gczQoKSB7XG4gICAgICByZXR1cm4gTWF0aC5mbG9vcigoMSArIE1hdGgucmFuZG9tKCkpICogMHgxMDAwMClcbiAgICAgICAgLnRvU3RyaW5nKDE2KVxuICAgICAgICAuc3Vic3RyaW5nKDEpO1xuICAgIH1cbiAgICByZXR1cm4gczQoKSArIHM0KCkgKyAnLScgKyBzNCgpICsgJy0nICsgczQoKSArICctJyArIHM0KCkgKyAnLScgKyBzNCgpICsgczQoKSArIHM0KCk7XG4gIH1cbiAgY29uc3RydWN0b3IoKXtcbiAgICB0aGlzLm92ZXJyaWRlID0gZmFsc2U7XG4gIH1cbiAgZ2V0IHR5cGUoKXtcbiAgICByZXR1cm4gdGhpcy5fdHlwZTtcbiAgfVxuICBzZXQgdHlwZShuZXdWYWwpe1xuICAgIHRoaXMuX3R5cGUgPSBuZXdWYWw7XG4gICAgdGhpcy5jbGVhblR5cGUgPSBFcnJvclR5cGVbbmV3VmFsXTtcbiAgfVxuICBzZXRPdmVycmlkZVN0YXR1cyh2YWwpe1xuICAgIHRoaXMub3ZlcnJpZGUgPSB2YWw7XG4gICAgLy8gY29uc29sZS5sb2codGhpcy5pZCArIFwiIC0gb3ZlcnJpZGRlblwiKTtcbiAgfVxufVxuaW50ZXJmYWNlIEludGVsbGlnZW5jZUNlbnRlckZpbHRlciB7XG4gIHR5cGU6IHN0cmluZztcbn1cbm1vZHVsZSBFTUxNYWtlckludGVsbGlnZW5jZSB7XG5cbiAgZXhwb3J0IGNsYXNzIEludGVsbGlnZW5jZUNlbnRlciB7XG4gICAgX3NlYXJjaDogYW55O1xuICAgIF9tb25pdG9yOiBJbnRlbGxpZ2VuY2VNb25pdG9yO1xuICAgIF9zY29wZTogYW55O1xuICAgIHNlYXJjaFR5cGU6IHN0cmluZztcblxuICAgIGNvbnN0cnVjdG9yKCRtb25pdG9yLCAkc2NvcGUpe1xuICAgICAgdGhpcy5fc2NvcGUgPSAkc2NvcGU7XG4gICAgICB0aGlzLl9tb25pdG9yID0gJG1vbml0b3I7XG4gICAgICB0aGlzLnNlYXJjaFR5cGUgPSB0aGlzLmRlZmF1bHRTZWFyY2hUeXBlKCk7XG4gICAgfVxuICAgIHNldFR5cGUodmFsKXtcbiAgICAgIHRoaXMuc2VhcmNoVHlwZSA9IHZhbDtcbiAgICB9XG4gICAgZGVmYXVsdFNlYXJjaFR5cGUoKXtcbiAgICAgIHZhciB0eXBlcyA9IHRoaXMuX21vbml0b3IudHlwZXM7XG4gICAgICByZXR1cm4gT2JqZWN0LmtleXModGhpcy5fbW9uaXRvci50YWJzKS5sZW5ndGg+MVxuICAgICAgPyBcIlwiXG4gICAgICA6ICh0aGlzLl9tb25pdG9yLnRhYnMpWyhPYmplY3Qua2V5cyh0aGlzLl9tb25pdG9yLnRhYnMpWzBdKV07XG4gICAgfVxuICAgIGNhblZpZXdBbGwoKXtcbiAgICAgIHJldHVybiBPYmplY3Qua2V5cyh0aGlzLl9tb25pdG9yLnRhYnMpLmxlbmd0aD4xO1xuICAgIH1cbiAgICBnZXQgc2VhcmNoKCk6SW50ZWxsaWdlbmNlQ2VudGVyRmlsdGVyIHtcblxuICAgICAgdmFyIHR5cGVzID0gdGhpcy5fbW9uaXRvci50eXBlcztcbiAgICAgIC8vIGNvbnNvbGUubG9nKFwic2VhcmNoVHlwZVwiLHRoaXMuc2VhcmNoVHlwZSk7XG4gICAgICBpZiggdHlwZXMgJiYgdGhpcy5zZWFyY2hUeXBlIGluIHR5cGVzKXtcbiAgICAgICAgcmV0dXJuIHt0eXBlOiB0aGlzLnNlYXJjaFR5cGUgfTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiB7dHlwZTogdGhpcy5kZWZhdWx0U2VhcmNoVHlwZSgpIH07XG4gICAgICB9XG4gICAgfVxuICB9XG5cblxuICBleHBvcnQgY2xhc3MgSW50ZWxsaWdlbmNlRW5naW5lIHtcbiAgICBtZXNzYWdlczogSW50ZWxsaWdlbmNlQWxlcnRbXTtcbiAgICBjYW5Db250aW51ZTogYm9vbGVhbjtcbiAgICBjYWNoZWRSZXN1bHRzOiBJbnRlbGxpZ2VuY2VBbGVydFtdO1xuICAgIG92ZXJyaWRkZW46IHN0cmluZ1tdO1xuICAgIHNjb3BlczogSW50ZWxsaWdlbmNlTW9kdWxlW107XG5cbiAgICBjb25zdHJ1Y3Rvcigpe1xuICAgICAgdGhpcy5tZXNzYWdlcyA9IFtdO1xuICAgICAgdGhpcy5jYW5Db250aW51ZSA9IHRydWU7XG4gICAgICB0aGlzLmNhY2hlZFJlc3VsdHMgPSBbXTtcbiAgICAgIHRoaXMuc2NvcGVzID0gW107XG5cbiAgICB9XG4gICAgX19sb2NhdGVTY29wZShzY29wZSkge1xuICAgICAgdmFyIHJlc3VsdCA9IHRoaXMuc2NvcGVzLmZpbHRlcihmdW5jdGlvbihvYmo6SW50ZWxsaWdlbmNlTW9kdWxlKXtcbiAgICAgICAgcmV0dXJuIG9iai5zY29wZSA9PSBzY29wZTtcbiAgICAgICB9KTtcblxuICAgICAgaWYocmVzdWx0Lmxlbmd0aCA9PSAwKXtcbiAgICAgICAgbGV0IGEgPSBuZXcgSW50ZWxsaWdlbmNlTW9kdWxlKHNjb3BlKTtcbiAgICAgICAgbGV0IGIgPSB0aGlzLnNjb3Blcy5wdXNoKGEpO1xuICAgICAgICByZXR1cm4gYTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiByZXN1bHRbMF07XG4gICAgICB9XG4gICAgfVxuICAgIHJlYWRPdXRSdWxlcygpe1xuICAgICAgLy8gdGhpcy5zY29wZXM7XG5cbiAgICAgIHRoaXMuc2NvcGVzLmZvckVhY2goKGl0ZW06SW50ZWxsaWdlbmNlTW9kdWxlKT0+e1xuICAgICAgICAvL2xldCB0cmFzaE1vbml0b3IgPSBuZXcgSW50ZWxsaWdlbmNlTW9uaXRvcihpdGVtLnNjb3BlKTtcblxuICAgICAgICB2YXIgcnVsZXMgPSBPYmplY3Qua2V5cyhpdGVtLnJ1bGVzKTtcbiAgICAgICAgZm9yKHZhciBpPTA7IGk8cnVsZXMubGVuZ3RoOyBpKyspe1xuXG4gICAgICAgICAgLy8gaWYoaXRlbS5ydWxlcy5oYXNPd25Qcm9wZXJ0eShydWxlKSl7XG4gICAgICAgICAgLy8gICBjb25zb2xlLmxvZyh0cmFzaE1vbml0b3IuZXZhbHVhdGVSdWxlKGl0ZW0ucnVsZXNbcnVsZV0pKTtcbiAgICAgICAgICAvLyB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gdHJhc2hNb25pdG9yID0gbnVsbDtcbiAgICAgIH0pO1xuXG5cblxuICAgICAgLy9ydW4gZWFjaCBvZiB0aGUgZnVuY3Rpb25zIGFuZCByZXR1cm4gdGhlIHN1YnJ0LlxuICAgIH1cbiAgICBtb2R1bGUoc2NvcGUpe1xuICAgICAgbGV0IG1vZHVsZSA9IHRoaXMuX19sb2NhdGVTY29wZShzY29wZSk7XG4gICAgICByZXR1cm4gbW9kdWxlO1xuICAgIH1cbiAgfVxuXG4gIGV4cG9ydCBjbGFzcyBJbnRlbGxpZ2VuY2VNb2R1bGUge1xuICAgIHNjb3BlOiBzdHJpbmc7XG4gICAgcnVsZXM6IHtzdHJpbmc/OiBhbnlbXX07XG4gICAgb3ZlcnJpZGRlbjogc3RyaW5nW107XG4gICAgY2FuQ29udGludWU6IGJvb2xlYW47XG4gICAgbWVzc2FnZXM6IEludGVsbGlnZW5jZUFsZXJ0W107XG5cbiAgICBjb25zdHJ1Y3RvcihzY29wZSl7XG4gICAgICB0aGlzLnNjb3BlID0gc2NvcGU7XG4gICAgICB0aGlzLnJ1bGVzID0ge307XG4gICAgfVxuXG5cbiAgICBtb25pdG9yKCl7XG4gICAgICByZXR1cm4gbmV3IEludGVsbGlnZW5jZU1vbml0b3IodGhpcyk7XG4gICAgfVxuICAgIHJlZ2lzdGVyKGlkLCBydWxlKTpJbnRlbGxpZ2VuY2VNb2R1bGV7XG4gICAgICB0aGlzLnJ1bGVzW2lkXSA9IHJ1bGU7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gIH1cbiAgZXhwb3J0IGNsYXNzIEludGVsbGlnZW5jZU1vbml0b3Ige1xuICAgIHNjb3BlOiBzdHJpbmc7XG4gICAgcnVsZXM6IGFueVtdO1xuICAgIHZhcmlhYmxlczoge307XG4gICAgb3ZlcnJpZGRlbjogc3RyaW5nW107XG4gICAgY2FuQ29udGludWU6IGJvb2xlYW47XG4gICAgbWVzc2FnZXM6IEludGVsbGlnZW5jZUFsZXJ0W107XG5cbiAgICBjb25zdHJ1Y3RvcihwYXJlbnRTY29wZSl7XG4gICAgICB0aGlzLnJ1bGVzID0gcGFyZW50U2NvcGUucnVsZXM7XG4gICAgICB0aGlzLm92ZXJyaWRkZW4gPSBbXTtcbiAgICAgIHRoaXMudmFyaWFibGVzID0ge1xuICAgICAgICBcIkludGVsbGlnZW5jZU1vbml0b3JcIjogdGhpc1xuICAgICAgfTtcbiAgICAgIHRoaXMucmVzZXQoKTtcbiAgICB9XG4gICAgcmVzZXQoKXtcbiAgICAgIHRoaXMubWVzc2FnZXMgPSBbXTtcbiAgICAgIHRoaXMuY2FuQ29udGludWUgPSB0cnVlO1xuICAgIH1cbiAgICBhc3NvY2lhdGVWYXJpYWJsZShhY2Nlc3NvciwgdmFsdWUpe1xuICAgICAgdGhpcy52YXJpYWJsZXNbYWNjZXNzb3JdID0gdmFsdWU7XG4gICAgfVxuICAgIGV2YWx1YXRlUnVsZShydWxlKTpJbnRlbGxpZ2VuY2VTdWJ7XG4gICAgICAvL2xvb2sgZm9yIGluamVjdGlvbiBwYXJhbWV0ZXJzXG4gICAgICB2YXIgcmVzdWx0O1xuXG4gICAgICBpZih0eXBlb2YgcnVsZSA9PSBcIm9iamVjdFwiKXtcbiAgICAgICAgLy9sYXN0IHBhcmFtZXRlciBpcyB0aGUgZnV1bmN0aW9uO1xuICAgICAgICB2YXIgZnVuYyA9IHJ1bGVbcnVsZS5sZW5ndGgtMV07XG4gICAgICAgIHZhciBwYXJhbWV0ZXJzID0gcnVsZS5zbGljZSgwLCBydWxlLmxlbmd0aC0xKTtcbiAgICAgICAgbGV0IElNID0gdGhpcztcblxuICAgICAgICB2YXIgYXJncyA9IHBhcmFtZXRlcnMubWFwKGZ1bmN0aW9uKGtleTpzdHJpbmcpe3JldHVybiBJTS52YXJpYWJsZXNba2V5XTsgfSk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgcmVzdWx0ID0gZnVuYy5hcHBseShudWxsLCBhcmdzKTtcbiAgICAgICAgfSBjYXRjaChlKXtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKGUpO1xuICAgICAgICB9XG5cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc3VsdCA9IHJ1bGUoKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgIGV2YWx1YXRlUnVsZXMoKXtcbiAgICAgIHRoaXMucmVzZXQoKTtcbiAgICAgIHZhciBydWxlcyA9IE9iamVjdC5rZXlzKHRoaXMucnVsZXMpO1xuICAgICAgZm9yKHZhciBydWxlICBvZiBydWxlcyl7XG4gICAgICAgIHZhciByZXN1bHQgPSB0aGlzLmV2YWx1YXRlUnVsZSh0aGlzLnJ1bGVzW3J1bGVdKTtcblxuICAgICAgICB2YXIgcHJvY2VlZCA9IHJlc3VsdC5oYXNPd25Qcm9wZXJ0eShcIndoZW5cIikgPyByZXN1bHQud2hlbi5hcHBseShudWxsKSA6IGZhbHNlO1xuXG4gICAgICAgIGlmKHByb2NlZWQpe1xuICAgICAgICAgIC8vIFBVU0ggQUxFUlQgTUVTU0FHRS5cbiAgICAgICAgICBsZXQgSUEgPSBuZXcgSW50ZWxsaWdlbmNlQWxlcnQoKTtcbiAgICAgICAgICBJQS5pZCA9IHJlc3VsdC5pZD09PXVuZGVmaW5lZCB8fCByZXN1bHQuaWQ9PVwiXCIgPyBJQS5nZW5lcmF0ZUd1aWQoKSA6IHJlc3VsdC5pZDtcbiAgICAgICAgICBJQS50eXBlID0gcmVzdWx0LnR5cGUgPT09IHVuZGVmaW5lZCA/IEVycm9yVHlwZS5XYXJuIDogcmVzdWx0LnR5cGU7XG4gICAgICAgICAgSUEuc2V2ZXJpdHkgPSByZXN1bHQuc2V2ZXJpdHkgPT09IHVuZGVmaW5lZCA/IEVycm9yU2V2ZXJpdHkuWmVybyA6IHJlc3VsdC5zZXZlcml0eTtcbiAgICAgICAgICBJQS50aXRsZSA9IHJlc3VsdC50aXRsZSA9PT0gdW5kZWZpbmVkID8gXCJcIiA6IHJlc3VsdC50aXRsZTtcbiAgICAgICAgICBJQS5kZXNjcmlwdGlvbiA9IHJlc3VsdC5kZXNjcmlwdGlvbiA9PT0gdW5kZWZpbmVkID8gXCJcIiA6IHJlc3VsdC5kZXNjcmlwdGlvbjtcbiAgICAgICAgICBJQS5yZXNvdXJjZSA9IHJlc3VsdC5yZXNvdXJjZSA9PT0gdW5kZWZpbmVkID8gXCJcIiA6IHJlc3VsdC5yZXNvdXJjZTtcbiAgICAgICAgICBJQS5jdGFIYW5kbGVyID0gcmVzdWx0LmN0YSAmJiByZXN1bHQuY3RhLmhhbmRsZXIgPyByZXN1bHQuY3RhLmhhbmRsZXIgOiBmdW5jdGlvbigpe307XG4gICAgICAgICAgSUEuY3RhTGFiZWwgPSByZXN1bHQuY3RhICYmIHJlc3VsdC5jdGEubGFiZWwgPyByZXN1bHQuY3RhLmxhYmVsIDogXCJcIjtcbiAgICAgICAgICBJQS5jYW5Db250aW51ZSA9IHJlc3VsdC5oYXNPd25Qcm9wZXJ0eShcImNhbkNvbnRpbnVlXCIpID8gcmVzdWx0LmNhbkNvbnRpbnVlIDogdHJ1ZTtcbiAgICAgICAgICB0aGlzLm1lc3NhZ2VzLnB1c2goSUEpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGZvcih2YXIgaT0wOyBpIDwgdGhpcy5tZXNzYWdlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZih0aGlzLm92ZXJyaWRkZW4uaW5kZXhPZiggdGhpcy5tZXNzYWdlc1tpXS5pZCApPi0xKXtcbiAgICAgICAgICB0aGlzLm1lc3NhZ2VzW2ldLm92ZXJyaWRlID0gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmKCF0aGlzLm1lc3NhZ2VzW2ldLmNhbkNvbnRpbnVlKSB7XG4gICAgICAgICAgaWYoIXRoaXMubWVzc2FnZXNbaV0ub3ZlcnJpZGUpIHtcbiAgICAgICAgICAgIHRoaXMuY2FuQ29udGludWUgPSBmYWxzZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuXG4gICAgICB0aGlzLm1lc3NhZ2VzLnNvcnQoKGE6SW50ZWxsaWdlbmNlQWxlcnQsIGI6SW50ZWxsaWdlbmNlQWxlcnQpOm51bWJlciA9PiB7XG4gICAgICAgICAgaWYoYS5fdHlwZT5iLl90eXBlKSByZXR1cm4gMTtcbiAgICAgICAgICBpZihhLl90eXBlPGIuX3R5cGUpIHJldHVybiAtMTtcbiAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGdldCB0YWJzKCl7XG4gICAgICBsZXQgb3V0cHV0ID0ge307XG4gICAgICBmb3IobGV0IGkgPSAwOyBpPHRoaXMubWVzc2FnZXMubGVuZ3RoOyBpKyspe1xuICAgICAgICBvdXRwdXRbdGhpcy5tZXNzYWdlc1tpXS5jbGVhblR5cGVdID0gdGhpcy5tZXNzYWdlc1tpXS50eXBlO1xuICAgICAgICAvLyBvdXRwdXRbdGhpcy5tZXNzYWdlc1tpXS50eXBlXSA9IEVycm9yVHlwZVt0aGlzLm1lc3NhZ2VzW2ldLnR5cGVdO1xuICAgICAgfVxuICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICB9XG4gICAgZ2V0IHR5cGVzKCl7XG4gICAgICBsZXQgb3V0cHV0ID0ge307XG4gICAgICBmb3IobGV0IGkgPSAwOyBpPHRoaXMubWVzc2FnZXMubGVuZ3RoOyBpKyspe1xuICAgICAgICBvdXRwdXRbdGhpcy5tZXNzYWdlc1tpXS50eXBlXSA9IEVycm9yVHlwZVt0aGlzLm1lc3NhZ2VzW2ldLnR5cGVdO1xuICAgICAgfVxuICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICB9XG4gICAgZ2V0IGNvdW50KCl7XG4gICAgICBsZXQgb3V0cHV0ID0ge307XG4gICAgICBmb3IodmFyIGkgPTA7IGkgPCB0aGlzLm1lc3NhZ2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmKG91dHB1dFtFcnJvclR5cGVbdGhpcy5tZXNzYWdlc1tpXS50eXBlXV0gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIG91dHB1dFtFcnJvclR5cGVbdGhpcy5tZXNzYWdlc1tpXS50eXBlXV0gPSAwO1xuICAgICAgICB9XG4gICAgICAgIG91dHB1dFtFcnJvclR5cGVbdGhpcy5tZXNzYWdlc1tpXS50eXBlXV0rKztcbiAgICAgIH1cbiAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgfVxuICB9XG5cbn1cblxuXG52YXIgRU1MSW50ZWxsaWdlbmNlID0gbmV3IEVNTE1ha2VySW50ZWxsaWdlbmNlLkludGVsbGlnZW5jZUVuZ2luZSgpO1xuIiwiaW50ZXJmYWNlIFdpbmRvdyB7XG4gICAgZ2Eob3B0aW9uMSwgb3B0aW9uMiwgb3B0aW9uMywgb3B0aW9uND8sIG9wdGlvbjU/KTogdm9pZDtcbiAgICBQZXJzaXN0OiBhbnk7XG4gICAgQ3J5cHRvSlM6IGFueTtcbiAgICBqUXVlcnkob3B0aW9uKTphbnk7XG4gICAgZGVjb2RlVVJJQ29tcG9uZW50KG9wdGlvbik6IHN0cmluZztcbiAgICBlbmNvZGVVUklDb21wb25lbnQob3B0aW9uKTogc3RyaW5nO1xufVxuXG5jbGFzcyBTZWN1cmVHYXRld2F5e1xuICBsb2dpbkNhbGxiYWNrOiAoKT0+e307XG4gIGxvZ2luVGltZXI6IGFueTtcbiAgZXJyb3JNZXNzYWdlOiBzdHJpbmc7XG4gIHNlc3Npb25JZDpzdHJpbmc7XG4gIHNlc3Npb25JZExvY2FsU3RvcmFnZUtleTogc3RyaW5nO1xuICBzZXNzaW9uVXNlckVtYWlsOnN0cmluZztcbiAgdGltZXJEZWxheTogbnVtYmVyO1xuICBzYWx0OiBzdHJpbmc7XG4gIGVtYWlsUmVnZXg6IFJlZ0V4cDtcbiAgY2FuTG9naW46IGJvb2xlYW47XG4gIEFPVjogQWNjZXNzT25saW5lVmVyc2lvbjtcblxuXG4gIGNvbnN0cnVjdG9yKGxvZ2luQ2FsbGJhY2ssICRzY29wZSl7XG4gICAgdGhpcy5jYW5Mb2dpbiA9IGZhbHNlO1xuICAgIHRoaXMubG9naW5DYWxsYmFjayA9IGxvZ2luQ2FsbGJhY2s7XG4gICAgdGhpcy5sb2dpblRpbWVyID0gbnVsbDtcbiAgICB0aGlzLnNlc3Npb25Vc2VyRW1haWwgPSBcIlwiO1xuICAgIHRoaXMudGltZXJEZWxheSA9IDUwMDtcbiAgICB0aGlzLnNhbHQgPSBcIjQ3ZGFmZWE5YWFlM2IyOGFiNWMzOWViN2Y3ZDJjOTI0XCI7XG4gICAgdGhpcy5lbWFpbFJlZ2V4ID0gL14oKFtePD4oKVxcW1xcXVxcXFwuLDs6XFxzQFwiXSsoXFwuW148PigpXFxbXFxdXFxcXC4sOzpcXHNAXCJdKykqKXwoXCIuK1wiKSlAKChcXFtbMC05XXsxLDN9XFwuWzAtOV17MSwzfVxcLlswLTldezEsM31cXC5bMC05XXsxLDN9XSl8KChbYS16QS1aXFwtMC05XStcXC4pK1thLXpBLVpdezIsfSkpJC87XG4gICAgdGhpcy5zZXNzaW9uSWRMb2NhbFN0b3JhZ2VLZXkgPSBcIkVNTE1ha2VyLmVtbFNlc3Npb25VSURcIjtcblxuICAgIGlmKCF3aW5kb3cucGVyc2lzdF9zdG9yZSlcbiAgICB7d2luZG93LnBlcnNpc3Rfc3RvcmUgPSBuZXcgd2luZG93LlBlcnNpc3QuU3RvcmUoJ0VNTE1ha2VyJyk7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3VubG9hZCcsIGZ1bmN0aW9uKCl7XG4gICAgICB3aW5kb3cucGVyc2lzdF9zdG9yZS5zYXZlKCk7XG4gICAgfSk7fVxuICAgIGxldCBTRyA9IHRoaXM7XG4gICAgbG9jYXRpb24uaHJlZj1cIiMvbG9naW5cIjtcbiAgfVxuICBpbml0KCl7XG5cbiAgICBpZih0aGlzLmhhc1NhdmVkU2Vzc2lvbklkKCkpe1xuICAgICAgaWYodGhpcy5pc1ZhbGlkRW1haWxBZGRyZXNzKHRoaXMuc2Vzc2lvbklkKSl7XG4gICAgICAgIHRoaXMuc2Vzc2lvblVzZXJFbWFpbCA9IHRoaXMuc2Vzc2lvbklkO1xuICAgICAgICAvLyBsb2dpbkNhbGxiYWNrKCk7XG4gICAgICAgIGxvY2F0aW9uLmhyZWY9XCIjL2xvZ2luXCI7XG5cbiAgICAgICAgLy9hdXRvIGxvZ3MgaW47XG4gICAgICAgIC8vaXMgb2ZmbGluZSAtPmdldCBvbmxpbmUgdmVyc2lvbi5cbiAgICAgICAgdGhpcy5sb2dpblRpbWVyID0gc2V0VGltZW91dCgoKT0+e1xuICAgICAgICAgIGxvY2F0aW9uLmhyZWY9XCIjL21haW5cIjtcbiAgICAgICAgICB0aGlzLnNldEN1cnJlbnRVc2VyKHRoaXMuc2Vzc2lvblVzZXJFbWFpbCk7XG4gICAgICAgIH0sIHRoaXMudGltZXJEZWxheSk7XG5cblxuXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBsb2NhdGlvbi5ocmVmPVwiIy9sb2dpblwiO1xuICAgICAgICB0aGlzLnNlc3Npb25Vc2VyRW1haWwgPSBcIlwiO1xuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGxvY2F0aW9uLmhyZWY9XCIjL2xvZ2luXCI7XG4gICAgICB0aGlzLnNlc3Npb25Vc2VyRW1haWwgPSBcIlwiO1xuICAgIH1cbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignaGFzaGNoYW5nZScsICgpPT57XG4gICAgICBpZiggdGhpcy5zZXNzaW9uVXNlckVtYWlsID09IFwiXCIgfHwgIXRoaXMuaGFzU2F2ZWRTZXNzaW9uSWQoKSkge1xuICAgICAgICBsb2NhdGlvbi5ocmVmPVwiIy9sb2dpblwiO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG4gIGxvZ091dCgpOnZvaWQge1xuICAgIHRoaXMubG9naW5Bc090aGVyKCk7XG4gICAgdGhpcy5zZXNzaW9uSWQgPSBcIlwiO1xuICAgIHRoaXMuc2Vzc2lvblVzZXJFbWFpbCA9IFwiXCI7XG4gICAgd2luZG93LnBlcnNpc3Rfc3RvcmUucmVtb3ZlKHRoaXMuc2Vzc2lvbklkTG9jYWxTdG9yYWdlS2V5KTtcbiAgICBpZihcInJlbG9hZFwiIGluIGxvY2F0aW9uKXtcbiAgICAgIGxvY2F0aW9uLnJlbG9hZCgpO1xuICAgIH0gZWxzZSB7XG4gICAgICBkb2N1bWVudC5sb2NhdGlvbi5ocmVmID0gZG9jdW1lbnQubG9jYXRpb24uaHJlZjtcbiAgICB9XG4gIH1cbiAgbG9naW5Bc090aGVyKCk6dm9pZCB7XG4gICAgY2xlYXJUaW1lb3V0KHRoaXMubG9naW5UaW1lcik7XG4gICAgZGVsZXRlIHRoaXMubG9naW5UaW1lcjtcbiAgfVxuICBzZXNzaW9uVXBkYXRlVXNlckVtYWlsKCk6dm9pZCB7XG4gICAgdGhpcy5lcnJvck1lc3NhZ2UgPSBcIlwiO1xuXG4gICAgaWYodGhpcy5pc1ZhbGlkRW1haWxBZGRyZXNzKHRoaXMuc2Vzc2lvblVzZXJFbWFpbCkpIHtcbiAgICAgIHRoaXMuc2V0Q3VycmVudFVzZXIodGhpcy5zZXNzaW9uVXNlckVtYWlsKTtcbiAgICAgIHRoaXMubG9naW5DYWxsYmFjaygpO1xuICAgICAgbG9jYXRpb24uaHJlZiA9IFwiIy9tYWluXCI7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIEVycm9yIG1lc3NhZ2VcbiAgICAgIHRoaXMuZXJyb3JNZXNzYWdlID0gXCJTb3JyeSEgWW91IGhhdmUgdG8gZW50ZXIgYSB2YWxpZCBlbWFpbCBhZGRyZXNzLlwiO1xuICAgIH1cbiAgfVxuICBoYXNTYXZlZFNlc3Npb25JZCgpOmJvb2xlYW4ge1xuICAgIHZhciBzYXZlZEVtYWlsSWQgPSB3aW5kb3cucGVyc2lzdF9zdG9yZS5nZXQodGhpcy5zZXNzaW9uSWRMb2NhbFN0b3JhZ2VLZXkpO1xuICAgIC8vIGNvbnNvbGUubG9nKHNhdmVkRW1haWxJZCk7XG4gICAgaWYoc2F2ZWRFbWFpbElkKXtcbiAgICAgIHRoaXMuc2Vzc2lvbklkID0gdGhpcy5kZWNyeXB0KHNhdmVkRW1haWxJZCk7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5zZXNzaW9uSWQgPSBcIlwiO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuICBlbmNyeXB0KHRleHQpe1xuICAgIHZhciBvdXRwdXQ9dGV4dCtcIlwiO1xuICAgIG91dHB1dCA9IG91dHB1dC5yZXBsYWNlKC8uL2dpLGZ1bmN0aW9uKGNoKXtcbiAgICAvL2NvbnNvbGUubG9nKGNoLmNoYXJDb2RlQXQoMCkrMSk7XG4gICAgICByZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZShjaC5jaGFyQ29kZUF0KDApKzEpO1xuICAgIH0pO1xuICAgIHJldHVybiBvdXRwdXQ7XG5cbiAgfVxuICBkZWNyeXB0KHRleHQpe1xuICAgIHZhciBvdXRwdXQ9dGV4dCtcIlwiO1xuICAgIG91dHB1dCA9IG91dHB1dC5yZXBsYWNlKC8uL2dpLGZ1bmN0aW9uKGNoKXtcbiAgICAvL2NvbnNvbGUubG9nKGNoLmNoYXJDb2RlQXQoMCkrMSk7XG4gICAgICByZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZShjaC5jaGFyQ29kZUF0KDApLTEpO1xuICAgIH0pO1xuICAgIHJldHVybiBvdXRwdXQ7XG5cbiAgfVxuICBzZXRDdXJyZW50VXNlcihlbWFpbCl7XG4gICAgdmFyIGhhc2ggPSB3aW5kb3cuQ3J5cHRvSlMuTUQ1KGVtYWlsICsgdGhpcy5zYWx0KS50b1N0cmluZygpO1xuICAgIHdpbmRvdy5wZXJzaXN0X3N0b3JlLnNldCh0aGlzLnNlc3Npb25JZExvY2FsU3RvcmFnZUtleSwgdGhpcy5lbmNyeXB0KGVtYWlsKSk7XG4gICAgd2luZG93LmdhKCdzZXQnLCAndXNlcklkJywgaGFzaCk7XG4gIH1cbiAgaXNWYWxpZEVtYWlsQWRkcmVzcyhlbWFpbCk6Ym9vbGVhbntcbiAgICBpZih0aGlzLmVtYWlsUmVnZXgudGVzdChlbWFpbCkpe1xuICAgICAgY29uc29sZS5sb2coZW1haWwsIFwiaXMgdmFsaWRcIik7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc29sZS5sb2coZW1haWwsIFwiaXMgbm90IHZhbGlkXCIpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuXG5cbn1cbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
