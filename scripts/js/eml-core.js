function getOfflineVersionNumber(){var e="";if(window.location.search.indexOf("offline_version")){var t=window.location.search.substr(1,window.location.search.length).split("&");t.forEach(function(t){t.indexOf("offline_version=")>-1&&(e=t.substr("offline_version=".length,t.length))})}return e}var ErrorSeverity;!function(e){e[e.High=1]="High",e[e.Medium=2]="Medium",e[e.Low=3]="Low",e[e.Zero=4]="Zero"}(ErrorSeverity||(ErrorSeverity={}));var ErrorType;!function(e){e[e.Fix=1]="Fix",e[e.Warn=2]="Warn",e[e.Suggestion=3]="Suggestion",e[e.QA=4]="QA",e[e.BestPractice=5]="BestPractice"}(ErrorType||(ErrorType={}));var GlobalVars;!function(e){e.landingPagePreferred=/(\.mp4|\.avi|\.mpeg|\.mp3|\.swf|\.mov|\.pdf)/i,e.extDoesNotrequireTrackingCode=/(\.pdf|\.oft|\.ics|\.png|\.jpeg|\.jpg)/i,e.linkEncapsulatedPunctuation=/([\.\?\,\:\*]+)((\n|\r|\s)+)?<\/a>$/,e.RequiresSCodeRegex=/http(.*)optum(.*)\/(campaign|resource)/i,e.RequiresTrackingCodeRegex=RegExp("^http(s)?://(.*?)?optum(.*?)?.co[m.]?"),e.TelephoneRegex=/(\+?\d{1,2}(\s|-|\.))?\(?\d{3}\)?[\s.-]\d{3,}[\s.-]\d{4,}/,e.TelephoneRegexGlobal=/(\+?\d{1,2}(\s|-|\.))?\(?\d{3}\)?[\s.-]\d{3,}[\s.-]\d{4,}/g,e.EmailRegex=/(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))/,e.EmailRegexGlobal=/(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))/g,e.UrlRegex=/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:[\/?#]\S*)?$/i,e.LinkHasTitleTagRegexGlobal=/<a\s([^<]*)title=\"(.*?)\">/gi,e.PreheaderRegexGlobal=/\<p\s[^\<]*class=\"preheader\"[^\>]*\>/gi,e.RequiredTrackingCodeWhitelist=[".pdf",".ics",".oft","optumsurveys.co","healthid.optum.com","learning.optum.com","app.info.optum.com","optum.webex.com","twitter.com","facebook.com","linkedin.com","info.optum"]}(GlobalVars||(GlobalVars={}));var EMLModule;!function(e){var t=function(){function e(e){this.parent=e,this.email="",this.subject="",this.body="",this.parent.isLinkType("mailto")&&this.initEmailEditor()}return e.prototype.has=function(e){return this.updateMailtoObj(),this[e]&&""!==this[e].trim()},e.prototype.isValidEmailAddress=function(){return GlobalVars.EmailRegex.test(this.email)},e.prototype.deinitEmailEditor=function(){this.email="",this.subject="",this.body=""},e.prototype.composeEmail=function(){this.parent["new"].url="mailto:"+this.email;for(var e=["subject","body"],t=0;t<e.length;t++)this[e[t]]&&""!==this[e[t]]?this.parent["new"].searchParams.set(e[t],this[e[t]]):""==this[e[t]]&&this.parent["new"].searchParams["delete"](e[t])},e.prototype.updateMailtoObj=function(){var e=this,t=this.parent["new"].url.substr(7,this.parent["new"].url.length-7),i=t.split("?");this.email=i[0],this.parent["new"].searchParams.updateEntries(),i.length>1?["subject","body"].forEach(function(t){e.parent["new"].searchParams.has(t)&&(e[t]=window.decodeURIComponent(e.parent["new"].searchParams.get(t)))}):(this.subject="",this.body="")},e.prototype.inputOnBlur=function(){this.parent["new"].searchParams.updateEntries(),this.parent["new"].searchParams.updateSearchProp()},e.prototype.openEditor=function(){this.initEmailEditor();var e=this.parent;console.log(e.id-1),e.showMailtoEditor=!0},e.prototype.initEmailEditor=function(){this.updateMailtoObj()},e}();e.MailtoLinkObject=t;var i=function(){function e(e){this.href="",this.search="",this.origin="",this.hash="",this.protocol="",this.url=e,this.searchParams=new r(this)}return e.prototype.prepareExport=function(){},e.prototype.isValid=function(){return GlobalVars.UrlRegex.test(this.url)},e.prototype.contains=function(e){return this.url.indexOf(e)>-1},Object.defineProperty(e.prototype,"url",{get:function(){this.prepareExport();var e=this.origin+this.search+this.hash;return e=e.replace("?undefined","")},set:function(e){this.search="",this.hash="";var t=/^(https?|mailto|ftp)\:/gi;if(t.test(e)){var i=e.match(t);this.protocol=i[0]}if(this.href=e,"#"==e.trim())this.hash="#";else if(e.trim().length>1&&e.indexOf("#")>-1){var r=e.split("#");this.hash="#"+r.pop();var n=r.join("#").split("?");this.origin=n[0],this.search=n.length>0?"?"+n[1]:""}else if(e.indexOf("?")>-1){var n=e.split("?");this.origin=n[0],this.search=n.length>0?"?"+n[1]:""}else this.origin=e},enumerable:!0,configurable:!0}),e}();e.URLObj=i;var r=function(){function e(e){this.parent=e,this.parent.search.length>0?this._entries=this.parent.search.substr(1,this.parent.search.length).split(/\&amp\;|\&/g):this._entries=[]}return Object.defineProperty(e.prototype,"entries",{get:function(){for(var e=[],t=0;t<this._entries.length;t++){var i=this._entries[t].split("=");i.length>1&&(i[1]=decodeURIComponent(i[1])),e.push(i.join("="))}return e},enumerable:!0,configurable:!0}),e.prototype.updateEntries=function(){if(this._entries=[],"?"!==this.parent.search&&this.parent.search.length>1)for(var e=this.parent.search.substr(1,this.parent.search.length).split(/\&amp\;|\&/g),t=0;t<e.length;t++)this._entries.push(e[t])},e.prototype.updateSearchProp=function(){var e=[];if(this._entries.length>0)for(var t=0;t<this._entries.length;t++){var i=this._entries[t].split("=");/[a-z]{1,4}=(.*?:){3,9}/gi.test(this._entries[t])?e.push(this._entries[t]):e.push(i[0]+(i.length>1?"="+encodeURIComponent(decodeURIComponent(i[1])):""))}this.parent.search=e.length>0?"?"+e.join("&"):""},e.prototype.has=function(e){for(var t=new RegExp("^"+e+"=","g"),i=!1,r=0;r<this._entries.length;r++)t.test(this._entries[r])&&(i=!0);return i},e.prototype.get=function(e){for(var t=new RegExp("^"+e+"=","g"),i=!1,r=0;r<this._entries.length;r++)t.test(this._entries[r])&&(i=this._entries[r].split("=").pop());return i},e.prototype.set=function(e,t){for(var i=new RegExp("^"+e+"=","g"),r=!1,n=0;n<this._entries.length;n++)i.test(this._entries[n])&&(this._entries[n]=e+"="+t,r=!0);r||this.append(e+"="+t),this.updateSearchProp()},e.prototype.append=function(e){this._entries.push(e),this.updateSearchProp()},e.prototype.deleteAll=function(){this._entries=[],this.updateSearchProp()},e.prototype.deleteAtIndex=function(e){this._entries.splice(e,1),this.updateSearchProp()},e.prototype["delete"]=function(e){for(var t=0;t<this._entries.length;t++)this._entries[t].substr(0,e.length+1)==e+"="&&this.deleteAtIndex(t)},e}();e.URLObjSearchParams=r;var n=function(){function e(e,t){this.context=t,this._super=e;for(var i=["src","alt","height","width"],r=0,n=i;r<n.length;r++){var s=n[r],o=new RegExp(s+'="([^"].*?)?"',"i");o.test(t)&&(this[s]=t.match(o)[1])}var a=this.width&&parseInt(this.width.toString()),h=this.height&&parseInt(this.height.toString());a&&h||"string"==typeof this.src&&this.preloadImage(this.src)}return e.prototype.preloadImage=function(e){var t=this,i=new Image;i.onload=function(){t.height=i.height,t.width=i.width,console.log(i.height,i.width),i.parentNode.removeChild(i)},i.src=t.src,console.log(i),document.body.appendChild(i)},e.prototype.generateOutput=function(e){var t=this;return e=this.context.indexOf("alt")>-1?e.replace(this.context,function(e){return e.replace(/alt\=\"([^\"].*?)?\"/g,'alt="'+(void 0===t.alt?"":t.alt)+'"')}):e.replace(this.context,function(e){return e.replace("<img",'<img alt="'+(void 0===t.alt?"":t.alt)+'"')})},e}();e.LinkedImage=n;var s=function(){function e(e,i,r){this.__isComplete=!1,this._super=r,this.showQueryStringEditor=!1,this.showMailtoEditor=!1,this.id=0,this.line=e+1,this.context=i,this.queryStrings=[],this.ChangeMonitor=new o(this),this.errors=EMLIntelligence.module("hyperlink").monitor(),this.errors.associateVariable("LinkObject",this),this.whiteListedUrl="~~whitelist~~",this.__locateHref(i),this.__locateLinkedImage(i),this.mailto=new t(this),this.isLinkComplete()}return e.prototype.__locateHref=function(e){var t=/href\=\"([^\"\>]*)\"/g,r=e.match(t);r.length>0&&('href=""'==r[0]?(this["new"]=new i("#"),this.old=new i("#"),this.context=this.context.replace(new RegExp('href=""',"g"),'href="#"')):(this["new"]=new i(r[0].substr(6,r[0].length-7).trim()),this.old=new i(r[0].substr(6,r[0].length-7).trim())))},e.prototype.__locateLinkedImage=function(e){if(/\<img([^>].*?)\>/.test(e)){var t=e.match(/\<img([^>].*?)\>/);t.length>0&&(this.LinkedImage=new n(this,t[0]),this.LinkedImageOld=new n(this,t[0]))}},e.prototype.hasDuplicateQueryStrings=function(){var e=[],t=[];if(this["new"].searchParams.entries.length>0)for(var i=0,r=this["new"].searchParams.entries;i<r.length;i++){var n=r[i],s=n.split("=").shift();t.indexOf(s)>-1&&e.push(s),t.push(s)}return e.length>0&&e},e.prototype.overrideTrackingRequirements=function(){this.whiteListedUrl=this["new"].url},e.prototype.displayFormattedURL=function(){var e=this.context;e=e.replace(/\seml\-id\=\"([0-9]*)\"/,"");var t='href="',i=e.indexOf(t);return e=e.replace(new RegExp('href=""',"g"),'href="#"'),this.LinkedImage&&(e=this.LinkedImage.generateOutput(e)),e=e.substr(0,i)+t+"|||a.href|||"+e.substr(i+(t.length+this.old.url.length),e.length),e=e.replace(new RegExp('"',"g"),"&quot;"),e=e.replace(new RegExp("/","g"),"&#47;"),e=e.replace(new RegExp(">","g"),"&gt;"),e=e.replace(new RegExp("<","g"),"&lt;"),e=e.replace(/([^\s]*?)\=/g,'<span class="attr">$1</span><span class="keyword">=</span>'),e=e.replace(/\&quot\;\&gt\;/g,'&quot;<span class="tag">&gt;</span>'),e=e.replace(/\&\#47\;\&gt\;/g,'<span class="tag">&#47;&gt;</span>'),e=e.replace(/\&quot\;(.*?)\&quot\;/g,'<span class="value">"$1"</span>'),e=e.replace(/\&lt\;([a-z]+\s?)/g,'<span class="tag">&lt;$1</span>'),e=e.replace(/\&lt\;\&\#47\;([a-z]+\s?)\&gt\;/g,'<span class="tag">&lt;&#47;$1&gt;</span>'),e=e.replace(/\n/g,"<br>"),e=e.replace(/\&gt\;/g,'<span class="tag">&gt;</span>'),e=e.replace(/\s{3}/g,"&nbsp;&nbsp;&nbsp"),e=e.replace(/\|\|\|a\.href\|\|\|/g,"<strong>"+(this.hasOwnProperty("deleteOnRender")&&this.deleteOnRender?this.old.url:this["new"].url)+"</strong>")},e.prototype.isLinkComplete=function(){return this._super.intelligence.evaluateRules(),this.errors.evaluateRules(),this.ChangeMonitor.update(),this.__isComplete=this.errors.canContinue,this.hasOwnProperty("deleteOnRender")&&this.deleteOnRender&&(this.__isComplete=!0),this.__isComplete},e.prototype.isLinkType=function(e){var t=!1;switch(e){case"http":"http:"!=this["new"].protocol&&"https:"!=this["new"].protocol||(t=!0);break;case"mailto":"mailto:"==this["new"].protocol&&(t=!0)}return t},e.prototype.hasTrackingCode=function(e){void 0===e&&(e=this["new"].url);var t=/[a-z]{1,4}=(.*?:){3,9}/gi;return t.test(e)},e.prototype.requiresTrackingCode=function(e){var t=!1;if(GlobalVars.RequiresTrackingCodeRegex.test(this["new"].url)){t=!0;for(var i=0;i<GlobalVars.RequiredTrackingCodeWhitelist.length;i++)GlobalVars.RequiredTrackingCodeWhitelist[i]instanceof RegExp?GlobalVars.RequiredTrackingCodeWhitelist[i].test(this["new"].url)&&(t=!1):this["new"].url.indexOf(GlobalVars.RequiredTrackingCodeWhitelist[i])>-1&&(t=!1)}return t},e.prototype.requiresSCode=function(){return!!GlobalVars.RequiresSCodeRegex.test(this["new"].url)},e.prototype.needsTrackingCode=function(){var e=this.requiresTrackingCode();return this.whiteListedUrl!=this["new"].url&&(this.hasTrackingCode()&&(e=!1),e)},e.prototype.updateInput=function(){this.isLinkType("mailto")?this.mailto.updateMailtoObj():this["new"].searchParams.updateEntries(),this.isLinkComplete()},e}();e.LinkObject=s;var o=function(){function e(e){this.visible=!1,this._super=e,this.messages=[]}return e.prototype.compareOldAndNew=function(){var e=["protocol","origin","search","hash"],t=[],i=this._super;return e.forEach(function(e){i.old.hasOwnProperty(e)&&i.old[e]!==i["new"][e]&&t.push(e)}),i.LinkedImage&&i.LinkedImage.alt!==i.LinkedImageOld.alt&&t.push("alt"),t},e.prototype.beforeDidReturnChanges=function(){},e.prototype.afterDidReturnChanges=function(){},e.prototype.update=function(){if(0==this._super.readOnly){var e=[],t=this.compareOldAndNew(),i=this;t.forEach(function(t){e.push(i.articulateChanges(t,{}))}),this.messages=e}},e.prototype.compareSearchStrings=function(e,t){var i={added:[],updated:[],removed:[]};for(var r in e)t.indexOf(e[r])===-1&&i.removed.push(e[r]);for(r in t)e.indexOf(t[r])===-1&&i.added.push(t[r]);var n=function(e,t){for(var i=-1,r=0;r<t.length;r++)e.test(t[r])&&(i=r);return i};for(r in e){var s=new RegExp(e[r].split("=")[0]+"="),o=n(s,i.added);if(o>-1){i.updated.push(i.added[o]);var a=n(s,i.removed);i.removed.splice(a,1),i.added.splice(o,1)}}return i},e.prototype.articulateChanges=function(e,t){if("protocol"==e)return"mailto:"==this._super["new"].protocol?{message:"Changed to mailto link.",data:[]}:{message:(""==this._super.old.protocol?"Updated":"Changed")+" protocol to "+this._super["new"].protocol,data:[]};if("origin"==e)return"mailto:"==this._super["new"].protocol?{message:"Changed mailto link to "+this._super["new"].origin,data:[]}:{message:"Changed link URL to "+this._super["new"].origin,data:[]};if("alt"==e)return""==this._super.LinkedImage.alt?{message:"Removed linked image ALT text",data:[]}:{message:"Updated linked image ALT text to <b>"+this._super.LinkedImage.alt+"</b>",data:[]};if("search"==e){var i=this._super.old.searchParams._entries,r=this._super["new"].searchParams._entries,n=this.compareSearchStrings(i,r),s="",o=this._super;return["updated","added","removed"].forEach(function(e){n[e].length>0&&(s=s+e[0].toUpperCase()+e.substr(1,e.length)+" "+("mailto:"==o["new"].protocol?"parameter":"query string")+(n[e].length>1?"s":"")+": <b>"+n[e].join(", ")+"</b><br>")}),{message:s,data:[]}}return"hash"==e?""==this._super.old.hash?{message:"You added the hash "+this._super["new"].hash,data:[]}:""==this._super["new"].hash?{message:"You removed the hash "+this._super.old.hash,data:[]}:{message:"You changed the hash from "+this._super.old.hash+" to "+this._super["new"].hash,data:[]}:void 0},e}();e.ChangeMonitor=o;var a=function(){function e(e,t){this.overriddenIds=[],void 0===e&&(e=""),void 0===t&&(t="");this.buffer=null,this.scope=t,this.linksView="experimental",this.sourceCode=e,this.workingCode="",this.fileName="eml-maker-untitled",this.linkData=[],this._defaultSCode="s=email",this.header={subject:""},this.messages=[],this.exportForEloqua="Yes",this.__emlHeaders="",this.keyBoardShortcuts=[],this.__allowableHeaderFields={to:{syntax:"To: ",label:"To",instructions:"A list of email addresses separated by commas."},subject:{syntax:"Subject: ",label:"Subject",instructions:""},cc:{syntax:"Cc: ",label:"CC",instructions:"A list of email addresses separated by commas."},replyto:{syntax:"Reply-to: ",label:"Reply to",instructions:"A list of email addresses separated by commas."}},this.headers=["X-Unsent: 1","Mime-Version: 1.0 (Mac OS X Mail 10.1 (3251))","X-Uniform-Type-Identifier: com.apple.mail-draft","Content-Transfer-Encoding: 7bit"],this.intelligence=EMLIntelligence.module("email").monitor(),this.intelligence.associateVariable("EMLWorkspace",this)}return e.prototype.mapLinkObjects=function(e){if(this.linkData.length>0)for(var t=0;t<this.linkData.length;t++)e(this.linkData[t])},e.prototype.composeEML=function(){location.href="#/export-compose-eml"},e.prototype.downloadEml=function(){this.beforeDidDownloadEml();var e=this.__emlHeaders+"\n\n"+this.__removeWhiteSpace(this.__replaceEloquaMergeFields(this.generateOutputCode("oft")));this.fileName=this.__formatFileName(this.fileName),window.saveAs(new Blob([e],{type:"text/html"}),this.fileName+".eml"),this.afterDidDownloadEml()},e.prototype.beforeDidDownloadEml=function(){this.mapLinkObjects(function(e){if(e["new"].searchParams.has("elqTrack")){var t=e["new"].searchParams.entries.indexOf("elqTrack=true");t>-1&&e["new"].searchParams.deleteAtIndex(t)}!e["new"].searchParams.has("s")&&e.requiresSCode()?e["new"].searchParams.append("s=oft"):"email"==e["new"].searchParams.get("s")&&e["new"].searchParams.set("s","oft")}),this.mapLinkObjects(function(e){e.ChangeMonitor.update()})},e.prototype.afterDidDownloadEml=function(){window.ga("send","event","EML","download","EML Export"),location.href="#/export-eml"},e.prototype.downloadCsv=function(){var e="Context,Original URL,Modified URL\n";this.mapLinkObjects(function(t){e+=t.context.replace(/,/g,"(comma)")+","+t.old.url+","+t["new"].url+"\n"}),this.fileName=this.__formatFileName(this.fileName),window.saveAs(new Blob([e],{type:"text/csv"}),this.fileName+"_links.csv"),window.ga("send","event","CSV","download","CSV Export")},e.prototype.downloadHtml=function(){var e=this.beforeDidDownloadHtml(this.generateOutputCode("email"));this.fileName=this.__formatFileName(this.fileName),window.saveAs(new Blob([e],{type:"text/html"}),this.fileName+".html"),this.afterDidDownloadHtml()},e.prototype.beforeDidDownloadHtml=function(e){return e},e.prototype.afterDidDownloadHtml=function(){window.ga("send","event","HTML","download","HTML Export")},e.prototype.exportCodeToHTML=function(){this.beforeDidExportCodeToHTML(),this.outputCode=this.generateOutputCode("email"),this.afterDidExportCodeToHTML()},e.prototype.beforeDidExportCodeToHTML=function(){var e=!1;this.exportForEloqua&&"Yes"==this.exportForEloqua?(window.ga("send","event","HTML","Add Eloqua Tracking","Add Eloqua Tracking"),this.mapLinkObjects(function(t){e=t.whiteListedUrl==t["new"].url,t.isLinkType("mailto")||t["new"].searchParams.has("elqTrack")||/app\.info\.optum\.com/gi.test(t["new"].url)||(t["new"].searchParams.append("elqTrack=true"),e&&(t.whiteListedUrl=t["new"].url))})):this.mapLinkObjects(function(e){if(e["new"].searchParams.has("elqTrack")){var t=e["new"].searchParams.entries.indexOf("elqTrack=true");t>-1&&e["new"].searchParams.deleteAtIndex(t),e.isLinkComplete()}e.ChangeMonitor.update()}),this.mapLinkObjects(function(e){!e["new"].searchParams.has("s")&&e.requiresSCode()?e["new"].searchParams.append("s=email"):e["new"].searchParams.has("s")&&"oft"==e["new"].searchParams.get("s")&&e["new"].searchParams.set("s","email"),e.ChangeMonitor.update()}),this.mapLinkObjects(function(e){e.ChangeMonitor.update()})},e.prototype.afterDidExportCodeToHTML=function(){this.mapLinkObjects(function(e){e.whiteListedUrl==e["new"].url&&window.ga("send","event","Tracking-Optout","override",e["new"].url)}),window.ga("send","event","HTML","view sourcecode","Export/View HTML"),location.href="#/export-html"},e.prototype.setUpShortcutKeys=function(){var e=this;this.keyBoardShortcuts=[],e.keyBoardShortcuts.push(new h(function(e){return(e.ctrlKey||e.metaKey)&&e.shiftKey&&52==e.which},function(){e.scope.$apply(function(){console.log("downloading file"),e.downloadHtml()})},"CTRL + SHIFT + 4","Download HTML")),e.keyBoardShortcuts.push(new h(function(e){return(e.ctrlKey||e.metaKey)&&e.shiftKey&&51==e.which},function(){e.scope.$apply(function(){e.mapLinkObjects(function(e){e.errors.messages.length>0&&(e.errors.messages.forEach(function(e){e.type==ErrorType.Suggestion&&e.ctaHandler()}),e.isLinkComplete())})})},"CTRL + SHIFT + 3","Apply all suggestions")),e.keyBoardShortcuts.push(new h(function(e){return(e.ctrlKey||e.metaKey)&&e.shiftKey&&50==e.which},function(){e.scope.$apply(function(){e.mapLinkObjects(function(e){e.readOnly||!e.requiresSCode()||e["new"].searchParams.has("s")||(e["new"].searchParams.append("s=email"),e.isLinkComplete())})})},"CTRL + SHIFT + 2","Add s=email to all links")),e.keyBoardShortcuts.push(new h(function(e){return(e.ctrlKey||e.metaKey)&&e.shiftKey&&49==e.which},function(){e.scope.$apply(function(){e.mapLinkObjects(function(t){return!!t.readOnly||(t["new"].searchParams["delete"]("o"),t["new"].searchParams["delete"]("oin"),t["new"].searchParams["delete"]("v"),t["new"].searchParams["delete"]("oiex"),t["new"].searchParams["delete"]("elq_mid"),t["new"].searchParams["delete"]("elq_lid"),t["new"].searchParams["delete"]("elqTrack"),t["new"].searchParams["delete"]("elqTrackId"),t["new"].searchParams["delete"]("s"),t["new"].searchParams["delete"]("s3"),t.isLinkComplete(),void e.areLinksComplete())})})},"CTRL + SHIFT + 1","Remove all query strings from email")),document.onkeyup=function(t){for(var i=0,r=e.keyBoardShortcuts;i<r.length;i++){var n=r[i];n.when&&n.when(t)&&n.doThis()}}},e.prototype.replaceSpecialCharacters=function(e){var t={174:["&reg;"],169:["&copy;"],8211:["&ndash;"],8212:["&mdash;"],8220:["&ldquo;"],8221:["&rdquo;"],8216:["&lsquo;"],8217:["&rsquo;"],8482:["&trade;"]};for(var i in t)if(t.hasOwnProperty(i)){var r=new RegExp(String.fromCharCode(parseInt(i)),"g");r.test(e)&&(e=e.replace(r,t[i][0]))}return e},e.prototype.processHtml=function(){if(this.setUpShortcutKeys(),this.linkData=[],this.intelligence.overridden=[],this.intelligence.evaluateRules(),window.scrollTo(0,0),this.workingCode=this.replaceSpecialCharacters(this.sourceCode),this.__emlHeaders=this.__buildHeaders(),"untitled"==this.fileName){var e=/<title>([^<].*?)<\/title>/gi;if(e.test(this.workingCode)){var t=this.workingCode.match(e);t.length>0&&(this.fileName=this.__formatFileName(t[0].replace(e,"$1")))}}var i=this,r=/<a\b[^>]*?>([\r\n]|.)*?<\/a>/gm,n=0;this.workingCode=this.workingCode.replace(r,function(e){return n++,e.replace("<a",'<a eml-id="'+n+'"')}),n=0,this.workingCode=this.workingCode.replace(r,function(e){n++;var t=i.workingCode.substr(0,i.workingCode.indexOf(e)).split("\n").length-1;if(/(href\=\"([^\"\>]*)\"?)/g.test(e)){n++;var r=new s(t,e,i);return r.id=n,r.readOnly=r["new"].contains(".com/e/es.aspx")&&r["new"].contains("~~eloqua"),i.linkData.push(r),"{{EMLMaker_Link:"+n+"}}"}return e}),this.mapLinkObjects(function(e){e.isLinkComplete()}),location.href="#/links"},e.prototype.addNewHeaderField=function(e){this.header[e]=""},e.prototype.removeHeaderField=function(e){delete this.header[e]},e.prototype.isHeaderSelected=function(e){return!this.header.hasOwnProperty(e)||""==this.header},e.prototype.verifyLinkSectionComplete=function(){var e=!1;return!(this.intelligence&&!this.intelligence.canContinue)&&(e=(!this.linkData||0!=this.linkData.length)&&!!this.areLinksComplete())},e.prototype.generateOutputCode=function(e,t){void 0===e&&(e="email"),void 0===t&&(t=!0);var i=this.workingCode;this.mapLinkObjects(function(e){if(e.hasOwnProperty("deleteOnRender")&&e.deleteOnRender)i=i.replace(new RegExp("{{EMLMaker_Link:"+e.id+"}}","gi"),"");else if(e.readOnly){var t=e.context.replace(/eml\-id\=\"[0-9]{1,}\"\s/g,"");i=i.replace(new RegExp("{{EMLMaker_Link:"+e.id+"}}","gi"),t)}else{var r=e.context.indexOf('href="'+e.old.url),n=e.context;n=n.substr(0,r)+'href="'+e["new"].url+n.substr(r+6+e.old.url.length,n.length),e.LinkedImage&&(n=e.LinkedImage.generateOutput(n)),n=n.replace(/\s?eml\-id\=\"[0-9]*\"/g,""),i=i.replace(new RegExp("{{EMLMaker_Link:"+e.id+"}}","gi"),n)}}),i=i.replace(/\<img[^\>].*?\>/gi,function(e){return e.indexOf("alt=")>-1?e:e.replace(/\<img/gi,'<img alt=""')});try{i=i.replace(/<\/a>\n{0,5}(\.|,|\?|!|:|;|\|)/g,"</a>$1")}catch(r){console.log("error merging lines with links that previously had punctuation.")}return i},e.prototype.updateLinksAndExport=function(){return!!this.areLinksComplete()&&(location.href="#/export",window.scrollTo(0,0),!0)},e.prototype.areLinksComplete=function(){var e=!0;return this.mapLinkObjects(function(t){t.__isComplete||(e=!1),t.needsTrackingCode()&&(e=!1)}),e},e.prototype.getLinksSummary=function(){var e={needsTracking:0,invalidUrl:0};return this.mapLinkObjects(function(t){t.needsTrackingCode()&&e.needsTracking++,t.isLinkComplete()&&e.invalidUrl++}),e},e.prototype.importHtmlFromFileDrop=function(e){this.sourceCode.length>0&&(this.sourceCode="");var t=e.dataTransfer.files;if(e.dataTransfer.files.length>1)alert("you can only import one file at at time.");else{var i=new FileReader,r=this;i.onloadend=function(e){var i=e.target.result,n=t[0].name.split("."),s=n.pop().toLowerCase();r.fileName=r.__formatFileName(n.join(".")),"eml"==s?r.sourceCode=r.__stripHtmlAndSubjectFromEML(i):r.sourceCode=i,r.processHtml(),location.href="#/links"},i.readAsText(t[0]),window.ga("send","event","HTML","import","HTML Import File Drop")}},Object.defineProperty(e.prototype,"defaultSCode",{set:function(e){var t=this._defaultSCode;t!==e&&(this._defaultSCode=e,this.mapLinkObjects(function(e){e.isLinkComplete()}))},enumerable:!0,configurable:!0}),e.prototype.__formatFileName=function(e){var t=/[^\w\s-]/g,i=/[-\s]+/g;return e=e.replace(t,"").trim().toLowerCase(),e=e.replace(i,"-")},e.prototype.__replaceEloquaMergeFields=function(e){var t=/<span(%20|\s)class="?eloquaemail"?\s?>(.*?)<\/span>/gi;return e=e.replace(t,"#$2#")},e.prototype.__stripHtmlAndSubjectFromEML=function(e){for(var t=e.split("\n"),i=t.pop(),r=0;r<t.length;r++)t[r].indexOf("Subject:")>-1&&void 0===this.header&&(this.header={});return i},e.prototype.__removeWhiteSpace=function(e){var t=e;return t=t.replace(new RegExp("\n","g")," "),t=t.replace(new RegExp("\t","g")," "),t=t.replace(/\s{2,99999}/g," ")},e.prototype.__buildHeaders=function(){for(var e=[],t=0;t<this.headers.length;t++)e.push(this.headers[t]);var i=this.__getCharsetFromHTML(this.sourceCode);""==i&&(i="charset=UTF-8"),e.push("Content-Type: text/html;\n\t"+i);for(var r in this.header)this.header.hasOwnProperty(r)&&this.__allowableHeaderFields.hasOwnProperty(r)&&e.push(this.__allowableHeaderFields[r].syntax+" "+this.header[r]);return this.__emlHeaders=e.join("\n"),e.join("\n")},e.prototype.__getCharsetFromHTML=function(e){var t=/<meta.*?charset=([^\s"]*)/gi,i="",r=e.match(t);return r&&r.forEach(function(e){var t=e.match(/charset=([^\s"]*)/gi);i=t?t[0]:"charset=UTF-8"}),i},e}();e.EMLWorkspace=a;var h=function(){function e(e,t,i,r){this.when=e,this.doThis=t,this.keys=i,this.description=r}return e}();e.KeyboardShortcut=h}(EMLModule||(EMLModule={}));var IntelligenceAlert=function(){function e(){this.override=!1}return e.prototype.generateGuid=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(e){this._type=e,this.cleanType=ErrorType[e]},enumerable:!0,configurable:!0}),e.prototype.setOverrideStatus=function(e){this.override=e},e}(),EMLMakerIntelligence;!function(e){var t=function(){function e(e,t){this._scope=t,this._monitor=e,this.searchType=this.defaultSearchType()}return e.prototype.setType=function(e){this.searchType=e},e.prototype.defaultSearchType=function(){this._monitor.types;return Object.keys(this._monitor.tabs).length>1?"":this._monitor.tabs[Object.keys(this._monitor.tabs)[0]]},e.prototype.canViewAll=function(){return Object.keys(this._monitor.tabs).length>1},Object.defineProperty(e.prototype,"search",{get:function(){var e=this._monitor.types;return e&&this.searchType in e?{type:this.searchType}:{type:this.defaultSearchType()}},enumerable:!0,configurable:!0}),e}();e.IntelligenceCenter=t;var i=function(){function e(){this.messages=[],this.canContinue=!0,this.cachedResults=[],this.scopes=[]}return e.prototype.__locateScope=function(e){var t=this.scopes.filter(function(t){return t.scope==e});if(0==t.length){var i=new r(e);this.scopes.push(i);return i}return t[0]},e.prototype.readOutRules=function(){this.scopes.forEach(function(e){for(var t=Object.keys(e.rules),i=0;i<t.length;i++);})},e.prototype.module=function(e){var t=this.__locateScope(e);return t},e}();e.IntelligenceEngine=i;var r=function(){function e(e){this.scope=e,this.rules={}}return e.prototype.monitor=function(){return new n(this)},e.prototype.register=function(e,t){return this.rules[e]=t,this},e}();e.IntelligenceModule=r;var n=function(){function e(e){this.rules=e.rules,this.overridden=[],this.variables={IntelligenceMonitor:this},this.reset()}return e.prototype.reset=function(){this.messages=[],this.canContinue=!0},e.prototype.associateVariable=function(e,t){this.variables[e]=t},e.prototype.evaluateRule=function(e){var t;if("object"==typeof e){var i=e[e.length-1],r=e.slice(0,e.length-1),n=this,s=r.map(function(e){return n.variables[e]});try{t=i.apply(null,s)}catch(o){console.error(o)}}else t=e();return t},e.prototype.evaluateRules=function(){this.reset();for(var e=Object.keys(this.rules),t=0,i=e;t<i.length;t++){var r=i[t],n=this.evaluateRule(this.rules[r]),s=!!n.hasOwnProperty("when")&&n.when.apply(null);if(s){var o=new IntelligenceAlert;o.id=void 0===n.id||""==n.id?o.generateGuid():n.id,o.type=void 0===n.type?ErrorType.Warn:n.type,o.severity=void 0===n.severity?ErrorSeverity.Zero:n.severity,o.title=void 0===n.title?"":n.title,o.description=void 0===n.description?"":n.description,o.resource=void 0===n.resource?"":n.resource,o.ctaHandler=n.cta&&n.cta.handler?n.cta.handler:function(){},o.ctaLabel=n.cta&&n.cta.label?n.cta.label:"",o.canContinue=!n.hasOwnProperty("canContinue")||n.canContinue,this.messages.push(o)}}for(var a=0;a<this.messages.length;a++)this.overridden.indexOf(this.messages[a].id)>-1&&(this.messages[a].override=!0),this.messages[a].canContinue||this.messages[a].override||(this.canContinue=!1);this.messages.sort(function(e,t){return e._type>t._type?1:e._type<t._type?-1:0})},Object.defineProperty(e.prototype,"tabs",{get:function(){for(var e={},t=0;t<this.messages.length;t++)e[this.messages[t].cleanType]=this.messages[t].type;return e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"types",{get:function(){for(var e={},t=0;t<this.messages.length;t++)e[this.messages[t].type]=ErrorType[this.messages[t].type];return e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"count",{get:function(){for(var e={},t=0;t<this.messages.length;t++)void 0===e[ErrorType[this.messages[t].type]]&&(e[ErrorType[this.messages[t].type]]=0),e[ErrorType[this.messages[t].type]]++;return e},enumerable:!0,configurable:!0}),e}();e.IntelligenceMonitor=n}(EMLMakerIntelligence||(EMLMakerIntelligence={}));var EMLIntelligence=new EMLMakerIntelligence.IntelligenceEngine,AccessOnlineVersion=function(){function e(e){this.animate=!0,this.status="attempting",this.headline="Checking availability of online version",this.message="If we're able to access the online version, you will be redirected.",void 0===e.success&&(e.success=function(){}),void 0===e.onerror&&(e.onerror=function(){}),window.LOCALHOST=this.isLocalMachine(),window.OFFLINE_VERSION=getOfflineVersionNumber(),window.LOCALHOST?(window.scrollTo(0,0),this.obtainKeyFromServer(e)):(this.status="failed",this.animate=!1,document.title=window.PAGE_TITLE)}return e.prototype.obtainKeyFromServer=function(e){if(this.isLocalMachine()){var t,i,r;window.redirectJsonpCallback=function(t){1==t?(e.success(),console.log("FOUND?"),setTimeout(function(){location.href="http://johnproestakes.github.io/eml-maker?offline_version="+window.CURRENT_VERSION},500)):console.log("not github")},t=document.createElement("script"),i=document.getElementsByTagName("script")[0],t.type="text/javascript",t.onerror=function(){e.onerror()},t.src=this.isLocalMachine()?"http://johnproestakes.github.io/eml-maker/prod/app/canredirect.js":"",setTimeout(function(){i.parentNode.insertBefore(t,r)},2e3),document.title=window.PAGE_TITLE+" (Offline Mode)"}else this.status="failed",this.animate=!1,document.title=window.PAGE_TITLE},e.prototype.getOfflineVersionNumber=function(){var e="";if(window.location.search.indexOf("offline_version")){var t=window.location.search.substr(1,window.location.search.length).split("&");t.forEach(function(t){t.indexOf("offline_version=")>-1&&(e=t.substr("offline_version=".length,t.length))})}return e},e.prototype.isLocalMachine=function(){return location.href.indexOf("johnproestakes.github.io")==-1},e}(),UpdateModule=function(){function e(){if(this.updateVersion=!1,this.updateForced=!1,this.offlineVersion=void 0===window.OFFLINE_VERSION?"":window.OFFLINE_VERSION,this.onlineVersion=window.CURRENT_VERSION,location.href.indexOf("localhost")>-1&&(window.LOCALHOST=!1),""==window.OFFLINE_VERSION)this.accessingFromOffline=!1;else if(window.OFFLINE_VERSION&&window.LOCALHOST&&(this.accessingFromOffline=!0),
window.OFFLINE_VERSION&&window.OFFLINE_VERSION!==window.CURRENT_VERSION){this.updateVersion=!0;var e=new ApplicationVersion(window.OFFLINE_VERSION),t=new ApplicationVersion(window.CURRENT_VERSION);this.updateForced=e.compareAgainst(t)<=AppVersionDifferenceType.PATCH}}return e.prototype.showMessage=function(){return this.updateVersion&&this.updateForced},e.prototype.showTeaser=function(){return""==this.offlineVersion&&!window.LOCALHOST},e.prototype.forceUpdate=function(e,t){for(var i=e.split("."),r=t.split("."),n=0,s=!1,o=0;o<r.length;o++)r[o]==i[o]&&n++;return n<3&&(s=!0),s},e}(),AppVersionDifferenceType;!function(e){e[e.MAJOR=0]="MAJOR",e[e.MINOR=1]="MINOR",e[e.PATCH=2]="PATCH",e[e.SUBPATCH=3]="SUBPATCH",e[e.NONE=4]="NONE"}(AppVersionDifferenceType||(AppVersionDifferenceType={}));var ApplicationVersion=function(){function e(e){this._version=e,this.versionObject=this._version.split(".").map(function(e){return parseInt(e)})}return e.prototype.compareAgainst=function(e){for(var t=this.versionObject,i=e.versionObject,r=0,n=0;n<4&&t[n]==i[n];n++)r++;return AppVersionDifferenceType[AppVersionDifferenceType[r]]},e}(),SecureGateway=function(){function e(e,t){this.canLogin=!1,this.loginCallback=e,this.loginTimer=null,this.sessionUserEmail="",this.timerDelay=500,this.salt="47dafea9aae3b28ab5c39eb7f7d2c924",this.emailRegex=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,this.sessionIdLocalStorageKey="EMLMaker.emlSessionUID",window.persist_store||(window.persist_store=new window.Persist.Store("EMLMaker"),window.addEventListener("unload",function(){window.persist_store.save()}));location.href="#/login"}return e.prototype.init=function(){var e=this;this.hasSavedSessionId()&&this.isValidEmailAddress(this.sessionId)?(this.sessionUserEmail=this.sessionId,location.href="#/login",this.loginTimer=setTimeout(function(){location.href="#/main",e.setCurrentUser(e.sessionUserEmail)},this.timerDelay)):(location.href="#/login",this.sessionUserEmail=""),window.addEventListener("hashchange",function(){""!=e.sessionUserEmail&&e.hasSavedSessionId()||(location.href="#/login")})},e.prototype.logOut=function(){this.loginAsOther(),this.sessionId="",this.sessionUserEmail="",window.persist_store.remove(this.sessionIdLocalStorageKey),"reload"in location?location.reload():document.location.href=document.location.href},e.prototype.loginAsOther=function(){clearTimeout(this.loginTimer),delete this.loginTimer},e.prototype.sessionUpdateUserEmail=function(){this.errorMessage="",this.isValidEmailAddress(this.sessionUserEmail)?(this.setCurrentUser(this.sessionUserEmail),this.loginCallback(),location.href="#/main"):this.errorMessage="Sorry! You have to enter a valid email address."},e.prototype.hasSavedSessionId=function(){var e=window.persist_store.get(this.sessionIdLocalStorageKey);return e?(this.sessionId=this.decrypt(e),!0):(this.sessionId="",!1)},e.prototype.encrypt=function(e){var t=e+"";return t=t.replace(/./gi,function(e){return String.fromCharCode(e.charCodeAt(0)+1)})},e.prototype.decrypt=function(e){var t=e+"";return t=t.replace(/./gi,function(e){return String.fromCharCode(e.charCodeAt(0)-1)})},e.prototype.setCurrentUser=function(e){var t=window.CryptoJS.MD5(e+this.salt).toString();window.persist_store.set(this.sessionIdLocalStorageKey,this.encrypt(e)),window.ga("set","userId",t)},e.prototype.isValidEmailAddress=function(e){return this.emailRegex.test(e)?(console.log(e,"is valid"),!0):(console.log(e,"is not valid"),!1)},e}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlVwZGF0ZU1vZHVsZS50cyIsIkVNTE1vZHVsZS50cyIsImVtbC1jb3JlLmpzIiwiSW50ZWxsaWdlbmNlRW5naW5lLnRzIiwiVXNlck1hbmFnZW1lbnQudHMiXSwibmFtZXMiOlsiZ2V0T2ZmbGluZVZlcnNpb25OdW1iZXIiLCJvdXRwdXQiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsInNlYXJjaCIsImluZGV4T2YiLCJwYXJhbXMiLCJzdWJzdHIiLCJsZW5ndGgiLCJzcGxpdCIsImZvckVhY2giLCJwYXJhbSIsIkVycm9yU2V2ZXJpdHkiLCJFcnJvclR5cGUiLCJHbG9iYWxWYXJzIiwibGFuZGluZ1BhZ2VQcmVmZXJyZWQiLCJleHREb2VzTm90cmVxdWlyZVRyYWNraW5nQ29kZSIsImxpbmtFbmNhcHN1bGF0ZWRQdW5jdHVhdGlvbiIsIlJlcXVpcmVzU0NvZGVSZWdleCIsIlJlcXVpcmVzVHJhY2tpbmdDb2RlUmVnZXgiLCJSZWdFeHAiLCJUZWxlcGhvbmVSZWdleCIsIlRlbGVwaG9uZVJlZ2V4R2xvYmFsIiwiRW1haWxSZWdleCIsIkVtYWlsUmVnZXhHbG9iYWwiLCJVcmxSZWdleCIsIkxpbmtIYXNUaXRsZVRhZ1JlZ2V4R2xvYmFsIiwiUHJlaGVhZGVyUmVnZXhHbG9iYWwiLCJSZXF1aXJlZFRyYWNraW5nQ29kZVdoaXRlbGlzdCIsIkVNTE1vZHVsZSIsIk1haWx0b0xpbmtPYmplY3QiLCJMaW5rT2JqZWN0IiwidGhpcyIsInBhcmVudCIsImVtYWlsIiwic3ViamVjdCIsImJvZHkiLCJpc0xpbmtUeXBlIiwiaW5pdEVtYWlsRWRpdG9yIiwicHJvdG90eXBlIiwiaGFzIiwib3B0aW9uIiwidXBkYXRlTWFpbHRvT2JqIiwidHJpbSIsImlzVmFsaWRFbWFpbEFkZHJlc3MiLCJ0ZXN0IiwiZGVpbml0RW1haWxFZGl0b3IiLCJjb21wb3NlRW1haWwiLCJ1cmwiLCJvcHRpb25zIiwiaSIsInNlYXJjaFBhcmFtcyIsInNldCIsIl90aGlzIiwiYSIsImIiLCJ1cGRhdGVFbnRyaWVzIiwiZGVjb2RlVVJJQ29tcG9uZW50IiwiZ2V0IiwiaW5wdXRPbkJsdXIiLCJ1cGRhdGVTZWFyY2hQcm9wIiwib3BlbkVkaXRvciIsIkxPIiwiY29uc29sZSIsImxvZyIsImlkIiwic2hvd01haWx0b0VkaXRvciIsIlVSTE9iaiIsImhyZWYiLCJvcmlnaW4iLCJoYXNoIiwicHJvdG9jb2wiLCJVUkxPYmpTZWFyY2hQYXJhbXMiLCJwcmVwYXJlRXhwb3J0IiwiaXNWYWxpZCIsImNvbnRhaW5zIiwic3RyIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJ1IiwicmVwbGFjZSIsInByb3RvY29sVHlwZSIsIm1hdGNoIiwidXJsUGFydHMiLCJwb3AiLCJwYXJ0cyIsImpvaW4iLCJlbnVtZXJhYmxlIiwiY29uZmlndXJhYmxlIiwiX2VudHJpZXMiLCJwdXNoIiwicHJvcHMiLCJwcm9wIiwiZW5jb2RlVVJJQ29tcG9uZW50IiwicmVnZXgiLCJ2YWx1ZSIsImFwcGVuZCIsInZhbHVlUGFpciIsImRlbGV0ZUFsbCIsImRlbGV0ZUF0SW5kZXgiLCJpbmRleCIsInNwbGljZSIsIkxpbmtlZEltYWdlIiwiX3N1cGVyIiwiY29kZSIsImNvbnRleHQiLCJ0YWdzIiwiX2kiLCJ0YWdzXzEiLCJ0YWciLCJoYXNXaWR0aCIsIndpZHRoIiwicGFyc2VJbnQiLCJ0b1N0cmluZyIsImhhc0hlaWdodCIsImhlaWdodCIsInNyYyIsInByZWxvYWRJbWFnZSIsIkxJIiwiaW1nIiwiSW1hZ2UiLCJvbmxvYWQiLCJwYXJlbnROb2RlIiwicmVtb3ZlQ2hpbGQiLCJkb2N1bWVudCIsImFwcGVuZENoaWxkIiwiZ2VuZXJhdGVPdXRwdXQiLCJjb250ZW50IiwiZiIsInVuZGVmaW5lZCIsImFsdCIsImxpbmUiLCJfX2lzQ29tcGxldGUiLCJzaG93UXVlcnlTdHJpbmdFZGl0b3IiLCJxdWVyeVN0cmluZ3MiLCJDaGFuZ2VNb25pdG9yIiwiZXJyb3JzIiwiRU1MSW50ZWxsaWdlbmNlIiwibW9kdWxlIiwibW9uaXRvciIsImFzc29jaWF0ZVZhcmlhYmxlIiwid2hpdGVMaXN0ZWRVcmwiLCJfX2xvY2F0ZUhyZWYiLCJfX2xvY2F0ZUxpbmtlZEltYWdlIiwibWFpbHRvIiwiaXNMaW5rQ29tcGxldGUiLCJyZTIiLCJvbGQiLCJmb3VuZCIsIkxpbmtlZEltYWdlT2xkIiwiaGFzRHVwbGljYXRlUXVlcnlTdHJpbmdzIiwicmVzdWx0IiwidXNlZFN0cmluZ3MiLCJlbnRyaWVzIiwiX2EiLCJzaGlmdCIsIm92ZXJyaWRlVHJhY2tpbmdSZXF1aXJlbWVudHMiLCJkaXNwbGF5Rm9ybWF0dGVkVVJMIiwiZmluZFN0YXJ0Iiwic3RhcnQiLCJoYXNPd25Qcm9wZXJ0eSIsImRlbGV0ZU9uUmVuZGVyIiwiaW50ZWxsaWdlbmNlIiwiZXZhbHVhdGVSdWxlcyIsInVwZGF0ZSIsImNhbkNvbnRpbnVlIiwidHlwZSIsImhhc1RyYWNraW5nQ29kZSIsIm9iaiIsInJlcXVpcmVzVHJhY2tpbmdDb2RlIiwicmVxdWlyZXNTQ29kZSIsIm5lZWRzVHJhY2tpbmdDb2RlIiwidXBkYXRlSW5wdXQiLCJ2aXNpYmxlIiwibWVzc2FnZXMiLCJjb21wYXJlT2xkQW5kTmV3IiwidXJsUGFyYW1zIiwiY2hhbmdlZCIsImJlZm9yZURpZFJldHVybkNoYW5nZXMiLCJhZnRlckRpZFJldHVybkNoYW5nZXMiLCJyZWFkT25seSIsImNoYW5nZXMiLCJDTSIsInNjb3BlIiwiYXJ0aWN1bGF0ZUNoYW5nZXMiLCJjb21wYXJlU2VhcmNoU3RyaW5ncyIsIm9sZFAiLCJuZXdQIiwicGF5bG9hZCIsImFkZGVkIiwidXBkYXRlZCIsInJlbW92ZWQiLCJmaW5kX3BhdHRlcm5faW5BcnJheSIsInBhdHRlcm4iLCJhcnIiLCJ5IiwicmUiLCJvdGhlciIsImFyZ3MiLCJtZXNzYWdlIiwiZGF0YSIsIm9sZFBhcmFtcyIsIm5ld1BhcmFtcyIsInNlYXJjaENoYW5nZXNfMSIsImtleSIsInRvVXBwZXJDYXNlIiwiRU1MV29ya3NwYWNlIiwiaHRtbCIsIiRzY29wZSIsIm92ZXJyaWRkZW5JZHMiLCJidWZmZXIiLCJsaW5rc1ZpZXciLCJzb3VyY2VDb2RlIiwid29ya2luZ0NvZGUiLCJmaWxlTmFtZSIsImxpbmtEYXRhIiwiX2RlZmF1bHRTQ29kZSIsImhlYWRlciIsImV4cG9ydEZvckVsb3F1YSIsIl9fZW1sSGVhZGVycyIsImtleUJvYXJkU2hvcnRjdXRzIiwiX19hbGxvd2FibGVIZWFkZXJGaWVsZHMiLCJ0byIsInN5bnRheCIsImxhYmVsIiwiaW5zdHJ1Y3Rpb25zIiwiY2MiLCJyZXBseXRvIiwiaGVhZGVycyIsIm1hcExpbmtPYmplY3RzIiwiY2FsbGJhY2siLCJjb21wb3NlRU1MIiwiZG93bmxvYWRFbWwiLCJiZWZvcmVEaWREb3dubG9hZEVtbCIsIl9fcmVtb3ZlV2hpdGVTcGFjZSIsIl9fcmVwbGFjZUVsb3F1YU1lcmdlRmllbGRzIiwiZ2VuZXJhdGVPdXRwdXRDb2RlIiwiX19mb3JtYXRGaWxlTmFtZSIsInNhdmVBcyIsIkJsb2IiLCJhZnRlckRpZERvd25sb2FkRW1sIiwiZ2EiLCJkb3dubG9hZENzdiIsImRvd25sb2FkSHRtbCIsImJlZm9yZURpZERvd25sb2FkSHRtbCIsImFmdGVyRGlkRG93bmxvYWRIdG1sIiwiZXhwb3J0Q29kZVRvSFRNTCIsImJlZm9yZURpZEV4cG9ydENvZGVUb0hUTUwiLCJvdXRwdXRDb2RlIiwiYWZ0ZXJEaWRFeHBvcnRDb2RlVG9IVE1MIiwidHJhY2tpbmdPcHRPdXQiLCJzZXRVcFNob3J0Y3V0S2V5cyIsIktleWJvYXJkU2hvcnRjdXQiLCJlIiwiY3RybEtleSIsIm1ldGFLZXkiLCJzaGlmdEtleSIsIndoaWNoIiwiJGFwcGx5IiwiTWVzc2FnZU9iamVjdCIsIlN1Z2dlc3Rpb24iLCJjdGFIYW5kbGVyIiwiYXJlTGlua3NDb21wbGV0ZSIsIm9ua2V5dXAiLCJzaG9ydGN1dCIsIndoZW4iLCJkb1RoaXMiLCJyZXBsYWNlU3BlY2lhbENoYXJhY3RlcnMiLCJ0ZXh0IiwiMTc0IiwiMTY5IiwiODIxMSIsIjgyMTIiLCI4MjIwIiwiODIyMSIsIjgyMTYiLCI4MjE3IiwiODQ4MiIsInJlZ2V4cCIsIlN0cmluZyIsImZyb21DaGFyQ29kZSIsInByb2Nlc3NIdG1sIiwib3ZlcnJpZGRlbiIsInNjcm9sbFRvIiwiX19idWlsZEhlYWRlcnMiLCJ0aXRsZVJlZyIsInRpdGxlVGFnIiwicmUxIiwibiIsImFkZE5ld0hlYWRlckZpZWxkIiwicmVtb3ZlSGVhZGVyRmllbGQiLCJpc0hlYWRlclNlbGVjdGVkIiwidmVyaWZ5TGlua1NlY3Rpb25Db21wbGV0ZSIsImNsb25lIiwicmVhZE9ubHlVcmwiLCJuZXdDb250ZXh0IiwidXBkYXRlTGlua3NBbmRFeHBvcnQiLCJnZXRMaW5rc1N1bW1hcnkiLCJuZWVkc1RyYWNraW5nIiwiaW52YWxpZFVybCIsImltcG9ydEh0bWxGcm9tRmlsZURyb3AiLCJldnQiLCJmaWxlcyIsImRhdGFUcmFuc2ZlciIsImFsZXJ0IiwicmVhZGVyIiwiRmlsZVJlYWRlciIsIldTIiwib25sb2FkZW5kIiwiZHJvcFRleHQiLCJ0YXJnZXQiLCJuYW1lUGFydHMiLCJuYW1lIiwiZXh0IiwidG9Mb3dlckNhc2UiLCJfX3N0cmlwSHRtbEFuZFN1YmplY3RGcm9tRU1MIiwicmVhZEFzVGV4dCIsIm5ld1ZhbHVlIiwiX3NsdWdpZnlfc3RyaXBfcmUiLCJfc2x1Z2lmeV9oeXBoZW5hdGVfcmUiLCJyZTQiLCJjaGFyc2V0IiwiX19nZXRDaGFyc2V0RnJvbUhUTUwiLCJpXzEiLCJyZTUiLCJtZXRhVGFncyIsIml0ZW0iLCJjaGFyc2V0VmFscyIsImtleXMiLCJkZXNjcmlwdGlvbiIsIkludGVsbGlnZW5jZUFsZXJ0Iiwib3ZlcnJpZGUiLCJnZW5lcmF0ZUd1aWQiLCJzNCIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsInN1YnN0cmluZyIsIl90eXBlIiwibmV3VmFsIiwiY2xlYW5UeXBlIiwic2V0T3ZlcnJpZGVTdGF0dXMiLCJ2YWwiLCJFTUxNYWtlckludGVsbGlnZW5jZSIsIkludGVsbGlnZW5jZUNlbnRlciIsIiRtb25pdG9yIiwiX3Njb3BlIiwiX21vbml0b3IiLCJzZWFyY2hUeXBlIiwiZGVmYXVsdFNlYXJjaFR5cGUiLCJzZXRUeXBlIiwidHlwZXMiLCJ0YWJzIiwiY2FuVmlld0FsbCIsIkludGVsbGlnZW5jZUVuZ2luZSIsImNhY2hlZFJlc3VsdHMiLCJzY29wZXMiLCJfX2xvY2F0ZVNjb3BlIiwiZmlsdGVyIiwiSW50ZWxsaWdlbmNlTW9kdWxlIiwicmVhZE91dFJ1bGVzIiwicnVsZXMiLCJJbnRlbGxpZ2VuY2VNb25pdG9yIiwicmVnaXN0ZXIiLCJydWxlIiwicGFyZW50U2NvcGUiLCJ2YXJpYWJsZXMiLCJyZXNldCIsImFjY2Vzc29yIiwiZXZhbHVhdGVSdWxlIiwiZnVuYyIsInBhcmFtZXRlcnMiLCJzbGljZSIsIklNXzEiLCJtYXAiLCJhcHBseSIsImVycm9yIiwicnVsZXNfMSIsInByb2NlZWQiLCJJQSIsIldhcm4iLCJzZXZlcml0eSIsIlplcm8iLCJ0aXRsZSIsInJlc291cmNlIiwiY3RhIiwiaGFuZGxlciIsImN0YUxhYmVsIiwic29ydCIsIkFjY2Vzc09ubGluZVZlcnNpb24iLCJhbmltYXRlIiwic3RhdHVzIiwiaGVhZGxpbmUiLCJzdWNjZXNzIiwib25lcnJvciIsIkxPQ0FMSE9TVCIsImlzTG9jYWxNYWNoaW5lIiwiT0ZGTElORV9WRVJTSU9OIiwib2J0YWluS2V5RnJvbVNlcnZlciIsIlBBR0VfVElUTEUiLCJyIiwibSIsInJlZGlyZWN0SnNvbnBDYWxsYmFjayIsInNldFRpbWVvdXQiLCJDVVJSRU5UX1ZFUlNJT04iLCJjcmVhdGVFbGVtZW50IiwiZ2V0RWxlbWVudHNCeVRhZ05hbWUiLCJpbnNlcnRCZWZvcmUiLCJVcGRhdGVNb2R1bGUiLCJ1cGRhdGVWZXJzaW9uIiwidXBkYXRlRm9yY2VkIiwib2ZmbGluZVZlcnNpb24iLCJvbmxpbmVWZXJzaW9uIiwiYWNjZXNzaW5nRnJvbU9mZmxpbmUiLCJvZlYiLCJBcHBsaWNhdGlvblZlcnNpb24iLCJvblYiLCJjb21wYXJlQWdhaW5zdCIsIkFwcFZlcnNpb25EaWZmZXJlbmNlVHlwZSIsIlBBVENIIiwic2hvd01lc3NhZ2UiLCJzaG93VGVhc2VyIiwiZm9yY2VVcGRhdGUiLCJvZmZsaW5lIiwib25saW5lIiwidmVyc2lvbiIsIl92ZXJzaW9uIiwidmVyc2lvbk9iamVjdCIsIk90aGVyVmVyc2lvbiIsIm1lIiwiU2VjdXJlR2F0ZXdheSIsImxvZ2luQ2FsbGJhY2siLCJjYW5Mb2dpbiIsImxvZ2luVGltZXIiLCJzZXNzaW9uVXNlckVtYWlsIiwidGltZXJEZWxheSIsInNhbHQiLCJlbWFpbFJlZ2V4Iiwic2Vzc2lvbklkTG9jYWxTdG9yYWdlS2V5IiwicGVyc2lzdF9zdG9yZSIsIlBlcnNpc3QiLCJTdG9yZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJzYXZlIiwiaW5pdCIsImhhc1NhdmVkU2Vzc2lvbklkIiwic2Vzc2lvbklkIiwic2V0Q3VycmVudFVzZXIiLCJsb2dPdXQiLCJsb2dpbkFzT3RoZXIiLCJyZW1vdmUiLCJyZWxvYWQiLCJjbGVhclRpbWVvdXQiLCJzZXNzaW9uVXBkYXRlVXNlckVtYWlsIiwiZXJyb3JNZXNzYWdlIiwic2F2ZWRFbWFpbElkIiwiZGVjcnlwdCIsImVuY3J5cHQiLCJjaCIsImNoYXJDb2RlQXQiLCJDcnlwdG9KUyIsIk1ENSJdLCJtYXBwaW5ncyI6IkFBU0EsUUFBQUEsMkJBQ0UsR0FBSUMsR0FBUyxFQUNiLElBQUdDLE9BQU9DLFNBQVNDLE9BQU9DLFFBQVEsbUJBQW9CLENBQ3BELEdBQUlDLEdBQVNKLE9BQU9DLFNBQVNDLE9BQU9HLE9BQU8sRUFBRUwsT0FBT0MsU0FBU0MsT0FBT0ksUUFBUUMsTUFBTSxJQUNsRkgsR0FBT0ksUUFBUSxTQUFTQyxHQUNuQkEsRUFBTU4sUUFBUSx5QkFDZkosRUFBU1UsRUFBTUosT0FBTyxtQkFBbUJDLE9BQVFHLEVBQU1ILFdBSTdELE1BQU9QLEdDUVQsR0FBS1csZ0JBQUwsU0FBS0EsR0FDSEEsRUFBQUEsRUFBQSxLQUFBLEdBQUEsT0FDQUEsRUFBQUEsRUFBQSxPQUFBLEdBQUEsU0FDQUEsRUFBQUEsRUFBQSxJQUFBLEdBQUEs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LEdBQU8yUSxFQUFLLEVBS2hCLE9BSkEzUSxHQUFTQSxFQUFPK0UsUUFBUSxNQUFNLFNBQVMwWCxHQUVyQyxNQUFPbkwsUUFBT0MsYUFBYWtMLEVBQUdDLFdBQVcsR0FBRyxNQUtoRDdCLEVBQUF2WSxVQUFBd1osZUFBQSxTQUFlN1osR0FDYixHQUFJb0MsR0FBT3BFLE9BQU8wYyxTQUFTQyxJQUFJM2EsRUFBUUYsS0FBS29aLE1BQU1uVSxVQUNsRC9HLFFBQU9xYixjQUFjblksSUFBSXBCLEtBQUtzWix5QkFBMEJ0WixLQUFLeWEsUUFBUXZhLElBQ3JFaEMsT0FBTytPLEdBQUcsTUFBTyxTQUFVM0ssSUFFN0J3VyxFQUFBdlksVUFBQUssb0JBQUEsU0FBb0JWLEdBQ2xCLE1BQUdGLE1BQUtxWixXQUFXeFksS0FBS1gsSUFDdEI2QixRQUFRQyxJQUFJOUIsRUFBTyxhQUNaLElBRVA2QixRQUFRQyxJQUFJOUIsRUFBTyxpQkFDWixJQUtiNFkiLCJmaWxlIjoiZW1sLWNvcmUuanMiLCJzb3VyY2VzQ29udGVudCI6WyJcbmludGVyZmFjZSBXaW5kb3cge1xuICBPRkZMSU5FX1ZFUlNJT046IHN0cmluZztcbiAgQ1VSUkVOVF9WRVJTSU9OOiBzdHJpbmc7XG4gIHBlcnNpc3Rfc3RvcmU6IGFueTtcbiAgTE9DQUxIT1NUOiBib29sZWFuO1xuICBQQUdFX1RJVExFOiBzdHJpbmc7XG4gIHJlZGlyZWN0SnNvbnBDYWxsYmFjazogKHN0cmluZyk9PnZvaWQ7XG59XG5mdW5jdGlvbiBnZXRPZmZsaW5lVmVyc2lvbk51bWJlcigpe1xuICB2YXIgb3V0cHV0ID0gXCJcIjtcbiAgaWYod2luZG93LmxvY2F0aW9uLnNlYXJjaC5pbmRleE9mKFwib2ZmbGluZV92ZXJzaW9uXCIpKSB7XG4gICAgdmFyIHBhcmFtcyA9IHdpbmRvdy5sb2NhdGlvbi5zZWFyY2guc3Vic3RyKDEsd2luZG93LmxvY2F0aW9uLnNlYXJjaC5sZW5ndGgpLnNwbGl0KFwiJlwiKTtcbiAgICBwYXJhbXMuZm9yRWFjaChmdW5jdGlvbihwYXJhbSl7XG4gICAgICBpZihwYXJhbS5pbmRleE9mKFwib2ZmbGluZV92ZXJzaW9uPVwiKT4tMSl7XG4gICAgICAgIG91dHB1dCA9IHBhcmFtLnN1YnN0cihcIm9mZmxpbmVfdmVyc2lvbj1cIi5sZW5ndGgsIHBhcmFtLmxlbmd0aCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbiAgcmV0dXJuIG91dHB1dDtcbn1cbmNsYXNzIEFjY2Vzc09ubGluZVZlcnNpb24ge1xuICBoZWFkbGluZTogc3RyaW5nO1xuICBtZXNzYWdlOiBzdHJpbmc7XG4gIHN0YXR1czogc3RyaW5nO1xuICBhbmltYXRlOiBib29sZWFuO1xuICBzdWNjZXNzOigpPT52b2lkO1xuICBvbmVycm9yOigpPT52b2lkO1xuICBjb25zdHJ1Y3RvcihhcmdzKXtcblxuICAgIHRoaXMuYW5pbWF0ZT0gdHJ1ZTtcbiAgICB0aGlzLnN0YXR1cz0gXCJhdHRlbXB0aW5nXCI7XG4gICAgdGhpcy5oZWFkbGluZT0gXCJDaGVja2luZyBhdmFpbGFiaWxpdHkgb2Ygb25saW5lIHZlcnNpb25cIjtcbiAgICB0aGlzLm1lc3NhZ2U9IFwiSWYgd2UncmUgYWJsZSB0byBhY2Nlc3MgdGhlIG9ubGluZSB2ZXJzaW9uLCB5b3Ugd2lsbCBiZSByZWRpcmVjdGVkLlwiO1xuXG4gICAgaWYoYXJncy5zdWNjZXNzID09PSB1bmRlZmluZWQpIGFyZ3Muc3VjY2Vzcz1mdW5jdGlvbigpe307XG4gICAgaWYoYXJncy5vbmVycm9yID09PSB1bmRlZmluZWQpIGFyZ3Mub25lcnJvcj1mdW5jdGlvbigpe307XG5cbiAgICB3aW5kb3cuTE9DQUxIT1NUID0gdGhpcy5pc0xvY2FsTWFjaGluZSgpO1xuICAgIHdpbmRvdy5PRkZMSU5FX1ZFUlNJT04gPSBnZXRPZmZsaW5lVmVyc2lvbk51bWJlcigpO1xuXG4gICAgaWYod2luZG93LkxPQ0FMSE9TVCl7XG4gICAgICB3aW5kb3cuc2Nyb2xsVG8oMCwgMCk7XG4gICAgICB0aGlzLm9idGFpbktleUZyb21TZXJ2ZXIoYXJncyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuc3RhdHVzID0gXCJmYWlsZWRcIjtcbiAgICAgIHRoaXMuYW5pbWF0ZSA9IGZhbHNlO1xuICAgICAgZG9jdW1lbnQudGl0bGUgPSB3aW5kb3cuUEFHRV9USVRMRTtcbiAgICB9XG5cblxuICB9XG4gIG9idGFpbktleUZyb21TZXJ2ZXIoYXJncyl7XG5cbiAgICBpZih0aGlzLmlzTG9jYWxNYWNoaW5lKCkpe1xuICAgICAgdmFyIHIsIGEsIG07XG4gICAgICAgIHdpbmRvdy5yZWRpcmVjdEpzb25wQ2FsbGJhY2sgPSBmdW5jdGlvbihyZXN1bHQpe1xuICAgICAgICAgIGlmKHJlc3VsdCA9PSB0cnVlKSB7XG4gICAgICAgICAgICBhcmdzLnN1Y2Nlc3MoKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRk9VTkQ/XCIpO1xuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xuICAgICAgICAgICAgICBsb2NhdGlvbi5ocmVmPVwiaHR0cDovL2pvaG5wcm9lc3Rha2VzLmdpdGh1Yi5pby9lbWwtbWFrZXI/b2ZmbGluZV92ZXJzaW9uPVwiK3dpbmRvdy5DVVJSRU5UX1ZFUlNJT047XG4gICAgICAgICAgICB9LCA1MDApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNvbnNvbGUubG9nKCdub3QgZ2l0aHViJyk7XG5cbiAgICAgIH19O1xuICAgICAgciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpLFxuICAgICAgYSA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCdzY3JpcHQnKVswXTtcbiAgICAgIHIudHlwZT1cInRleHQvamF2YXNjcmlwdFwiO1xuICAgICAgci5vbmVycm9yID0gZnVuY3Rpb24oKXtcbiAgICAgICAgYXJncy5vbmVycm9yKCk7XG4gICAgICAgfTtcblxuICAgICAgci5zcmM9ICF0aGlzLmlzTG9jYWxNYWNoaW5lKCkgPyBcIlwiIDogXCJodHRwOi8vam9obnByb2VzdGFrZXMuZ2l0aHViLmlvL2VtbC1tYWtlci9wcm9kL2FwcC9jYW5yZWRpcmVjdC5qc1wiO1xuICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xuICAgICAgICBhLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKHIsbSk7XG4gICAgICB9LDIwMDApO1xuICAgICAgZG9jdW1lbnQudGl0bGUgPSB3aW5kb3cuUEFHRV9USVRMRSArIFwiIChPZmZsaW5lIE1vZGUpXCI7XG4gICB9IGVsc2Uge1xuICAgICAgdGhpcy5zdGF0dXMgPSBcImZhaWxlZFwiO1xuICAgICAgdGhpcy5hbmltYXRlID0gZmFsc2U7XG4gICAgICBkb2N1bWVudC50aXRsZSA9IHdpbmRvdy5QQUdFX1RJVExFO1xuXG4gICB9XG4gIH1cbiAgZ2V0T2ZmbGluZVZlcnNpb25OdW1iZXIoKTpzdHJpbmd7XG4gICAgdmFyIG91dHB1dCA9IFwiXCI7XG4gICAgaWYod2luZG93LmxvY2F0aW9uLnNlYXJjaC5pbmRleE9mKFwib2ZmbGluZV92ZXJzaW9uXCIpKSB7XG4gICAgICB2YXIgcGFyYW1zID0gd2luZG93LmxvY2F0aW9uLnNlYXJjaC5zdWJzdHIoMSx3aW5kb3cubG9jYXRpb24uc2VhcmNoLmxlbmd0aCkuc3BsaXQoXCImXCIpO1xuICAgICAgcGFyYW1zLmZvckVhY2goZnVuY3Rpb24ocGFyYW0pe1xuICAgICAgICBpZihwYXJhbS5pbmRleE9mKFwib2ZmbGluZV92ZXJzaW9uPVwiKT4tMSl7XG4gICAgICAgICAgb3V0cHV0ID0gcGFyYW0uc3Vic3RyKFwib2ZmbGluZV92ZXJzaW9uPVwiLmxlbmd0aCwgcGFyYW0ubGVuZ3RoKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiBvdXRwdXQ7XG4gIH1cbiAgaXNMb2NhbE1hY2hpbmUoKXtcbiAgICAvLyByZXR1cm4gZmFsc2U7XG4gICAgcmV0dXJuIGxvY2F0aW9uLmhyZWYuaW5kZXhPZignam9obnByb2VzdGFrZXMuZ2l0aHViLmlvJyk9PS0xO1xuICB9XG59XG5cblxuY2xhc3MgVXBkYXRlTW9kdWxlIHtcblxuICB1cGRhdGVWZXJzaW9uOiBib29sZWFuO1xuICB1cGRhdGVGb3JjZWQ6IGJvb2xlYW47XG4gIG9mZmxpbmVWZXJzaW9uOiBzdHJpbmc7XG4gIG9ubGluZVZlcnNpb246IHN0cmluZztcbiAgYWNjZXNzaW5nRnJvbU9mZmxpbmU6IGJvb2xlYW47XG5cbiAgY29uc3RydWN0b3IoKXtcblxuICAgIHRoaXMudXBkYXRlVmVyc2lvbiA9IGZhbHNlO1xuICAgIHRoaXMudXBkYXRlRm9yY2VkID0gZmFsc2U7XG4gICAgdGhpcy5vZmZsaW5lVmVyc2lvbiA9IHdpbmRvdy5PRkZMSU5FX1ZFUlNJT04gPT09IHVuZGVmaW5lZCA/IFwiXCIgOiB3aW5kb3cuT0ZGTElORV9WRVJTSU9OIDtcbiAgICB0aGlzLm9ubGluZVZlcnNpb24gPSB3aW5kb3cuQ1VSUkVOVF9WRVJTSU9OO1xuXG4gICAgLy90cmVhdCBsb2NhbGhvc3Q6ODg4OCBhcyBpbnRlcm5ldFxuICAgIGlmKGxvY2F0aW9uLmhyZWYuaW5kZXhPZihcImxvY2FsaG9zdFwiKT4tMSl7IHdpbmRvdy5MT0NBTEhPU1QgPSBmYWxzZTt9XG5cbiAgICBpZih3aW5kb3cuT0ZGTElORV9WRVJTSU9OID09IFwiXCIpe1xuICAgICAgdGhpcy5hY2Nlc3NpbmdGcm9tT2ZmbGluZSA9IGZhbHNlO1xuICAgIH0gZWxzZSB7XG4gICAgICBpZih3aW5kb3cuT0ZGTElORV9WRVJTSU9OICYmIHdpbmRvdy5MT0NBTEhPU1Qpe1xuICAgICAgICB0aGlzLmFjY2Vzc2luZ0Zyb21PZmZsaW5lID0gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIGlmKHdpbmRvdy5PRkZMSU5FX1ZFUlNJT04gJiYgKHdpbmRvdy5PRkZMSU5FX1ZFUlNJT04gIT09IHdpbmRvdy5DVVJSRU5UX1ZFUlNJT04pKXtcbiAgICAgICAgdGhpcy51cGRhdGVWZXJzaW9uID0gdHJ1ZTtcbiAgICAgICAgbGV0IG9mViA9IG5ldyBBcHBsaWNhdGlvblZlcnNpb24od2luZG93Lk9GRkxJTkVfVkVSU0lPTiksIG9uViA9IG5ldyBBcHBsaWNhdGlvblZlcnNpb24od2luZG93LkNVUlJFTlRfVkVSU0lPTik7XG4gICAgICAgIHRoaXMudXBkYXRlRm9yY2VkID0gb2ZWLmNvbXBhcmVBZ2FpbnN0KG9uVik8PUFwcFZlcnNpb25EaWZmZXJlbmNlVHlwZS5QQVRDSDtcbiAgICAgIH1cbiAgICB9XG5cbiAgfVxuICBzaG93TWVzc2FnZSgpe1xuICAgIHJldHVybiB0aGlzLnVwZGF0ZVZlcnNpb24gJiYgdGhpcy51cGRhdGVGb3JjZWQ7XG4gIH1cbiAgc2hvd1RlYXNlcigpe1xuICAgIHJldHVybiB0aGlzLm9mZmxpbmVWZXJzaW9uPT1cIlwiICYmICF3aW5kb3cuTE9DQUxIT1NUO1xuICB9XG4gIGZvcmNlVXBkYXRlKG9mZmxpbmUsIG9ubGluZSl7XG4gICAgdmFyIG9mZmxpbmVWZXJzaW9uID0gb2ZmbGluZS5zcGxpdChcIi5cIiksXG4gICAgb25saW5lVmVyc2lvbiA9IG9ubGluZS5zcGxpdChcIi5cIiksXG4gICAgbWF0Y2ggPSAwLCBvdXRwdXQgPSBmYWxzZTtcbiAgICBmb3IodmFyIGk9MDsgaTxvbmxpbmVWZXJzaW9uLmxlbmd0aDtpKyspe1xuICAgICAgaWYob25saW5lVmVyc2lvbltpXT09IG9mZmxpbmVWZXJzaW9uW2ldKSBtYXRjaCsrO1xuICAgIH1cbiAgICBpZihtYXRjaDwzKXtcbiAgICAgIG91dHB1dCA9IHRydWU7XG4gICAgfVxuICAgIHJldHVybiBvdXRwdXQ7XG4gIH1cbn1cblxuZW51bSBBcHBWZXJzaW9uRGlmZmVyZW5jZVR5cGV7XG4gIE1BSk9SPTAsXG4gIE1JTk9SLFxuICBQQVRDSCxcbiAgU1VCUEFUQ0gsXG4gIE5PTkVcbn1cbmNsYXNzIEFwcGxpY2F0aW9uVmVyc2lvbiB7XG4gIF92ZXJzaW9uOiBzdHJpbmc7XG4gIHZlcnNpb25PYmplY3Q6IG51bWJlcltdO1xuICBjb25zdHJ1Y3Rvcih2ZXJzaW9uOnN0cmluZyl7XG4gICAgdGhpcy5fdmVyc2lvbiA9IHZlcnNpb247XG4gICAgdGhpcy52ZXJzaW9uT2JqZWN0ID0gdGhpcy5fdmVyc2lvbi5zcGxpdChcIi5cIikubWFwKChuOnN0cmluZyk9PnBhcnNlSW50KG4pKTtcbiAgfVxuICBjb21wYXJlQWdhaW5zdChPdGhlclZlcnNpb246QXBwbGljYXRpb25WZXJzaW9uKTpBcHBWZXJzaW9uRGlmZmVyZW5jZVR5cGV7XG4gICAgdmFyIG1lID0gdGhpcy52ZXJzaW9uT2JqZWN0LFxuICAgICAgb3RoZXIgPSBPdGhlclZlcnNpb24udmVyc2lvbk9iamVjdCxcbiAgICAgIG1hdGNoID0gMCxcbiAgICAgIG91dHB1dCA9IGZhbHNlO1xuXG4gICAgZm9yKHZhciBpPTA7IGk8NDtpKyspe1xuICAgICAgaWYobWVbaV09PSBvdGhlcltpXSl7XG4gICAgICAgICBtYXRjaCsrO1xuICAgICAgIH0gZWxzZSB7XG4gICAgICAgICBicmVhaztcbiAgICAgICB9XG4gICAgIH1cblxuICAgIHJldHVybiBBcHBWZXJzaW9uRGlmZmVyZW5jZVR5cGVbQXBwVmVyc2lvbkRpZmZlcmVuY2VUeXBlW21hdGNoXV07XG4gIH1cbn1cbiIsIlxuaW50ZXJmYWNlIFdpbmRvdyB7XG4gICAgZ2Eob3B0aW9uMSwgb3B0aW9uMiwgb3B0aW9uMywgb3B0aW9uNCwgb3B0aW9uNSk6IHZvaWQ7XG4gICAgc2F2ZUFzKG9wdGlvbjE/LCBvcHRpb24yPyk6IHZvaWQ7XG4gICAgalF1ZXJ5KG9wdGlvbik6YW55O1xuICAgIGRlY29kZVVSSUNvbXBvbmVudChvcHRpb24pOiBzdHJpbmc7XG4gICAgZW5jb2RlVVJJQ29tcG9uZW50KG9wdGlvbik6IHN0cmluZztcbn1cbmludGVyZmFjZSBFdmVudFRhcmdldCB7XG4gIHJlc3VsdD86YW55O1xufVxuLy8gZGVjbGFyZSB2YXIgd2luZG93OiBNeVdpbmRvdztcblxuaW50ZXJmYWNlICRTY2Uge1xuICB0cnVzdEFzSHRtbChzdHI6IHN0cmluZyk6IGFueTtcbn1cblxuaW50ZXJmYWNlIFNlYXJjaFN0cmluZ1BheWxvYWQge1xuICBhZGRlZDogc3RyaW5nW10sXG4gIHVwZGF0ZWQ6IHN0cmluZ1tdLFxuICByZW1vdmVkOiBzdHJpbmdbXSxcbn1cbmludGVyZmFjZSBDaGFuZ2VNb25pdG9yTXNnIHtcbiAgbWVzc2FnZTogc3RyaW5nLFxuICBkYXRhOiBhbnlbXVxufVxuXG5lbnVtIEVycm9yU2V2ZXJpdHkge1xuICBIaWdoPTEsXG4gIE1lZGl1bSxcbiAgTG93LFxuICBaZXJvXG59XG5lbnVtIEVycm9yVHlwZSB7XG4gIEZpeD0xLFxuICBXYXJuLFxuICBTdWdnZXN0aW9uLFxuICBRQSxcbiAgQmVzdFByYWN0aWNlXG59XG5cblxubmFtZXNwYWNlIEdsb2JhbFZhcnMge1xuICBleHBvcnQgbGV0IGxhbmRpbmdQYWdlUHJlZmVycmVkID0gLyhcXC5tcDR8XFwuYXZpfFxcLm1wZWd8XFwubXAzfFxcLnN3ZnxcXC5tb3Z8XFwucGRmKS9pO1xuICBleHBvcnQgbGV0IGV4dERvZXNOb3RyZXF1aXJlVHJhY2tpbmdDb2RlID0gLyhcXC5wZGZ8XFwub2Z0fFxcLmljc3xcXC5wbmd8XFwuanBlZ3xcXC5qcGcpL2k7XG4gIGV4cG9ydCBsZXQgbGlua0VuY2Fwc3VsYXRlZFB1bmN0dWF0aW9uID0gLyhbXFwuXFw/XFwsXFw6XFwqXSspKChcXG58XFxyfFxccykrKT88XFwvYT4kLztcblxuICBleHBvcnQgbGV0IFJlcXVpcmVzU0NvZGVSZWdleCA9IC9odHRwKC4qKW9wdHVtKC4qKVxcLyhjYW1wYWlnbnxyZXNvdXJjZSkvaTtcbiAgZXhwb3J0IGxldCBSZXF1aXJlc1RyYWNraW5nQ29kZVJlZ2V4ID0gUmVnRXhwKFwiXmh0dHAocyk/OlxcL1xcLyguKj8pP29wdHVtKC4qPyk/XFwuY29bbVxcLl0/XCIpO1xuICBleHBvcnQgbGV0IFRlbGVwaG9uZVJlZ2V4ID0gLyhcXCs/XFxkezEsMn0oXFxzfC18XFwuKSk/XFwoP1xcZHszfVxcKT9bXFxzLi1dXFxkezMsfVtcXHMuLV1cXGR7NCx9LztcbiAgZXhwb3J0IGxldCBUZWxlcGhvbmVSZWdleEdsb2JhbCA9IC8oXFwrP1xcZHsxLDJ9KFxcc3wtfFxcLikpP1xcKD9cXGR7M31cXCk/W1xccy4tXVxcZHszLH1bXFxzLi1dXFxkezQsfS9nO1xuICBleHBvcnQgbGV0IEVtYWlsUmVnZXggPSAvKChbXjw+KClcXFtcXF1cXFxcLiw7Olxcc0BcIl0rKFxcLltePD4oKVxcW1xcXVxcXFwuLDs6XFxzQFwiXSspKil8KFwiLitcIikpQCgoXFxbWzAtOV17MSwzfVxcLlswLTldezEsM31cXC5bMC05XXsxLDN9XFwuWzAtOV17MSwzfVxcXSl8KChbYS16QS1aXFwtMC05XStcXC4pK1thLXpBLVpdezIsfSkpLztcbiAgZXhwb3J0IGxldCBFbWFpbFJlZ2V4R2xvYmFsID0gLygoW148PigpXFxbXFxdXFxcXC4sOzpcXHNAXCJdKyhcXC5bXjw+KClcXFtcXF1cXFxcLiw7Olxcc0BcIl0rKSopfChcIi4rXCIpKUAoKFxcW1swLTldezEsM31cXC5bMC05XXsxLDN9XFwuWzAtOV17MSwzfVxcLlswLTldezEsM31cXF0pfCgoW2EtekEtWlxcLTAtOV0rXFwuKStbYS16QS1aXXsyLH0pKS9nO1xuICBleHBvcnQgbGV0IFVybFJlZ2V4ID0gL14oPzooPzooPzpodHRwcz98ZnRwKTopP1xcL1xcLykoPzpcXFMrKD86OlxcUyopP0ApPyg/Oig/ISg/OjEwfDEyNykoPzpcXC5cXGR7MSwzfSl7M30pKD8hKD86MTY5XFwuMjU0fDE5MlxcLjE2OCkoPzpcXC5cXGR7MSwzfSl7Mn0pKD8hMTcyXFwuKD86MVs2LTldfDJcXGR8M1swLTFdKSg/OlxcLlxcZHsxLDN9KXsyfSkoPzpbMS05XVxcZD98MVxcZFxcZHwyWzAxXVxcZHwyMlswLTNdKSg/OlxcLig/OjE/XFxkezEsMn18MlswLTRdXFxkfDI1WzAtNV0pKXsyfSg/OlxcLig/OlsxLTldXFxkP3wxXFxkXFxkfDJbMC00XVxcZHwyNVswLTRdKSl8KD86KD86W2EtelxcdTAwYTEtXFx1ZmZmZjAtOV0tKikqW2EtelxcdTAwYTEtXFx1ZmZmZjAtOV0rKSg/OlxcLig/OlthLXpcXHUwMGExLVxcdWZmZmYwLTldLSopKlthLXpcXHUwMGExLVxcdWZmZmYwLTldKykqKD86XFwuKD86W2EtelxcdTAwYTEtXFx1ZmZmZl17Mix9KSkpKD86OlxcZHsyLDV9KT8oPzpbLz8jXVxcUyopPyQvaTtcbiAgZXhwb3J0IGxldCBMaW5rSGFzVGl0bGVUYWdSZWdleEdsb2JhbCA9IC88YVxccyhbXjxdKil0aXRsZT1cXFwiKC4qPylcXFwiPi9naTtcbiAgZXhwb3J0IGxldCBQcmVoZWFkZXJSZWdleEdsb2JhbCA9IC9cXDxwXFxzW15cXDxdKmNsYXNzPVxcXCJwcmVoZWFkZXJcXFwiW15cXD5dKlxcPi9naTtcbiAgZXhwb3J0IGxldCBSZXF1aXJlZFRyYWNraW5nQ29kZVdoaXRlbGlzdDogYW55W10gPSBbXG4gICAgJy5wZGYnLCcuaWNzJywnLm9mdCcsJ29wdHVtc3VydmV5cy5jbycsJ2hlYWx0aGlkLm9wdHVtLmNvbScsJ2xlYXJuaW5nLm9wdHVtLmNvbScsJ2FwcC5pbmZvLm9wdHVtLmNvbScsXG4gICAgJ29wdHVtLndlYmV4LmNvbScsJ3R3aXR0ZXIuY29tJywnZmFjZWJvb2suY29tJywnbGlua2VkaW4uY29tJywnaW5mby5vcHR1bSdcbiAgXTtcbn1cblxuXG5uYW1lc3BhY2UgRU1MTW9kdWxlIHtcblxuXG5cbiAgZXhwb3J0IGNsYXNzIE1haWx0b0xpbmtPYmplY3Qge1xuICAgICBwYXJlbnQ6IExpbmtPYmplY3Q7XG4gICAgIGVtYWlsOiBzdHJpbmc7XG4gICAgIHN1YmplY3Q6IHN0cmluZztcbiAgICAgYm9keTogc3RyaW5nO1xuXG4gICAgIGNvbnN0cnVjdG9yKExpbmtPYmplY3Qpe1xuICAgICAgIHRoaXMucGFyZW50ID0gTGlua09iamVjdDtcbiAgICAgICB0aGlzLmVtYWlsID0gXCJcIjtcbiAgICAgICB0aGlzLnN1YmplY3QgPSBcIlwiO1xuICAgICAgIHRoaXMuYm9keSA9IFwiXCI7XG5cbiAgICAgICBpZih0aGlzLnBhcmVudC5pc0xpbmtUeXBlKCdtYWlsdG8nKSl7XG4gICAgICAgICB0aGlzLmluaXRFbWFpbEVkaXRvcigpO1xuICAgICAgIH1cbiAgICAgfVxuICAgICBoYXMob3B0aW9uKTpib29sZWFue1xuICAgICAgIHRoaXMudXBkYXRlTWFpbHRvT2JqKCk7XG4gICAgICAgcmV0dXJuIHRoaXNbb3B0aW9uXSAmJiB0aGlzW29wdGlvbl0udHJpbSgpIT09XCJcIjtcbiAgICAgfVxuICAgICBpc1ZhbGlkRW1haWxBZGRyZXNzKCl7XG4gICAgICAgcmV0dXJuIEdsb2JhbFZhcnMuRW1haWxSZWdleC50ZXN0KHRoaXMuZW1haWwpO1xuICAgICB9XG4gICAgIGRlaW5pdEVtYWlsRWRpdG9yKCl7XG4gICAgICAgdGhpcy5lbWFpbCA9IFwiXCI7XG4gICAgICAgdGhpcy5zdWJqZWN0ID0gXCJcIjtcbiAgICAgICB0aGlzLmJvZHkgPSBcIlwiO1xuICAgICB9XG4gICAgIGNvbXBvc2VFbWFpbCgpe1xuICAgICAgIHRoaXMucGFyZW50Lm5ldy51cmwgPSBcIm1haWx0bzpcIiArIHRoaXMuZW1haWw7XG4gICAgICAgdmFyIG9wdGlvbnMgPSBbXCJzdWJqZWN0XCIsXCJib2R5XCJdO1xuICAgICAgIGZvcih2YXIgaSA9MDsgaTxvcHRpb25zLmxlbmd0aDsgaSsrKXtcbiAgICAgICAgIGlmKHRoaXNbb3B0aW9uc1tpXV0gJiYgdGhpc1tvcHRpb25zW2ldXSAhPT0gXCJcIikge1xuICAgICAgICAgICB0aGlzLnBhcmVudC5uZXcuc2VhcmNoUGFyYW1zLnNldChvcHRpb25zW2ldLCB0aGlzW29wdGlvbnNbaV1dKTtcbiAgICAgICAgIH0gZWxzZSBpZih0aGlzW29wdGlvbnNbaV1dPT1cIlwiKXtcbiAgICAgICAgICAgdGhpcy5wYXJlbnQubmV3LnNlYXJjaFBhcmFtcy5kZWxldGUob3B0aW9uc1tpXSk7XG4gICAgICAgICAgIC8vIFtcInN1YmplY3RcIixcImJvZHlcIl0uZm9yRWFjaCgob3B0aW9uKT0+e1xuICAgICAgICAgICAvLyAgIGlmKHRoaXNbb3B0aW9uXSA9PSBcIlwiKSB7XG4gICAgICAgICAgIC8vXG4gICAgICAgICAgIC8vICAgIH1cbiAgICAgICAgICAgLy8gIH0pO1xuICAgICAgICAgICAvLyAvL2RlbGV0ZSBpdDtcbiAgICAgICAgICAgLy8gdGhpcy5wYXJlbnQubmV3LnNlYXJjaFBhcmFtcy5kZWxldGUob3B0aW9uc1tpXSk7XG4gICAgICAgICB9XG4gICAgICAgfVxuICAgICB9XG4gICAgIHVwZGF0ZU1haWx0b09iaigpe1xuXG4gICAgICAgdmFyIGEgPSB0aGlzLnBhcmVudC5uZXcudXJsLnN1YnN0cig3LCB0aGlzLnBhcmVudC5uZXcudXJsLmxlbmd0aC03KTtcbiAgICAgICB2YXIgYiA9IGEuc3BsaXQoXCI/XCIpO1xuICAgICAgIHRoaXMuZW1haWwgPSBiWzBdO1xuXG4gICAgICAgdGhpcy5wYXJlbnQubmV3LnNlYXJjaFBhcmFtcy51cGRhdGVFbnRyaWVzKCk7XG4gICAgICAgaWYoYi5sZW5ndGg+MSl7XG4gICAgICAgICBbXCJzdWJqZWN0XCIsXCJib2R5XCJdLmZvckVhY2goKG9wdGlvbik9PntcbiAgICAgICAgICAgaWYodGhpcy5wYXJlbnQubmV3LnNlYXJjaFBhcmFtcy5oYXMob3B0aW9uKSl7XG4gICAgICAgICAgICAgdGhpc1tvcHRpb25dID0gd2luZG93LmRlY29kZVVSSUNvbXBvbmVudCh0aGlzLnBhcmVudC5uZXcuc2VhcmNoUGFyYW1zLmdldChvcHRpb24pKTtcbiAgICAgICAgICAgfVxuICAgICAgICAgfSk7XG4gICAgICAgfSBlbHNlIHtcbiAgICAgICAgIHRoaXMuc3ViamVjdD0gXCJcIjtcbiAgICAgICAgIHRoaXMuYm9keSA9IFwiXCI7XG4gICAgICAgfVxuICAgICB9XG4gICAgIGlucHV0T25CbHVyKCl7XG4gICAgICAgLy9kZWNvZGVkIHVybCBhbGwgdGhlIGVudHJpZXM7XG4gICAgICAgLy9yZWVuY29kZSB0aGVtLlxuXG4gICAgICAgdGhpcy5wYXJlbnQubmV3LnNlYXJjaFBhcmFtcy51cGRhdGVFbnRyaWVzKCk7XG4gICAgICAgdGhpcy5wYXJlbnQubmV3LnNlYXJjaFBhcmFtcy51cGRhdGVTZWFyY2hQcm9wKCk7XG5cblxuICAgICB9XG4gICAgIG9wZW5FZGl0b3IoKXtcbiAgICAgICB0aGlzLmluaXRFbWFpbEVkaXRvcigpO1xuICAgICAgIC8vIHdpbmRvdy5qUXVlcnkoXCJodG1sLGJvZHlcIilcbiAgICAgICAvLyAuYW5pbWF0ZSh7c2Nyb2xsVG9wOiB3aW5kb3cualF1ZXJ5KCcjbGluay0nKyh0aGlzLnBhcmVudC5pZC0xKSkub2Zmc2V0KCkudG9wIC0gNzV9LCAzMDApO1xuICAgICAgIHZhciBMTyA9IHRoaXMucGFyZW50O1xuICAgICAgICAgY29uc29sZS5sb2coTE8uaWQtMSk7XG4gICAgICAgICBMTy5zaG93TWFpbHRvRWRpdG9yID0gdHJ1ZTtcbiAgICAgfVxuICAgICBpbml0RW1haWxFZGl0b3IoKXtcbiAgICAgICB0aGlzLnVwZGF0ZU1haWx0b09iaigpO1xuICAgICB9XG4gICB9XG5cbiAgZXhwb3J0IGNsYXNzIFVSTE9iaiB7XG4gICAgc2VhcmNoOiBzdHJpbmc7XG4gICAgaHJlZjogc3RyaW5nO1xuICAgIG9yaWdpbjogc3RyaW5nO1xuICAgIGhhc2g6IHN0cmluZztcbiAgICBwcm90b2NvbDogc3RyaW5nO1xuICAgIHNlYXJjaFBhcmFtczogVVJMT2JqU2VhcmNoUGFyYW1zO1xuXG4gICAgY29uc3RydWN0b3IodXJsKXtcbiAgICAgIHRoaXMuaHJlZiA9IFwiXCI7XG4gICAgICB0aGlzLnNlYXJjaCA9IFwiXCI7XG4gICAgICB0aGlzLm9yaWdpbiA9IFwiXCI7XG4gICAgICB0aGlzLmhhc2ggPSBcIlwiO1xuICAgICAgdGhpcy5wcm90b2NvbCA9IFwiXCI7XG4gICAgICB0aGlzLnVybCA9IHVybDtcbiAgICAgIHRoaXMuc2VhcmNoUGFyYW1zID0gbmV3IFVSTE9ialNlYXJjaFBhcmFtcyh0aGlzKTtcbiAgICB9XG4gICAgcHJlcGFyZUV4cG9ydCgpe1xuICAgIC8vZG8gc29tZXRoaW5nIGhlcmU/XG4gICAgICAvL3RoaXMuc2VhcmNoUGFyYW1zLnVwZGF0ZVNlYXJjaFByb3AoKTtcbiAgICB9XG4gICAgaXNWYWxpZCgpOmJvb2xlYW4ge1xuICAgICAgcmV0dXJuIEdsb2JhbFZhcnMuVXJsUmVnZXgudGVzdCh0aGlzLnVybCk7XG4gICAgfVxuICAgIGNvbnRhaW5zKHN0cjpzdHJpbmcpOiBib29sZWFue1xuICAgICAgaWYodGhpcy51cmwuaW5kZXhPZihzdHIpPi0xKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH1cbiAgICBnZXQgdXJsKCl7XG4gICAgICB0aGlzLnByZXBhcmVFeHBvcnQoKTtcbiAgICAgIHZhciB1ID0gdGhpcy5vcmlnaW4gKyB0aGlzLnNlYXJjaCArIHRoaXMuaGFzaDtcbiAgICAgIHUgPSB1LnJlcGxhY2UoXCI/dW5kZWZpbmVkXCIsXCJcIik7XG4gICAgICByZXR1cm4gdTtcbiAgICB9XG4gICAgc2V0IHVybCh1cmwpe1xuICAgICAgdGhpcy5zZWFyY2ggPSBcIlwiO1xuICAgICAgdGhpcy5oYXNoID0gXCJcIjtcbiAgICAgIHZhciBwcm90b2NvbFR5cGUgPSAvXihodHRwcz98bWFpbHRvfGZ0cClcXDovZ2k7XG4gICAgICBpZihwcm90b2NvbFR5cGUudGVzdCh1cmwpKXtcbiAgICAgICAgdmFyIGEgPSB1cmwubWF0Y2gocHJvdG9jb2xUeXBlKTtcbiAgICAgICAgdGhpcy5wcm90b2NvbCA9IGFbMF07XG4gICAgICB9XG4gICAgICB0aGlzLmhyZWYgPSB1cmw7XG4gICAgICBpZih1cmwudHJpbSgpPT1cIiNcIil7XG4gICAgICAgIHRoaXMuaGFzaCA9IFwiI1wiO1xuICAgICAgfVxuICAgICAgZWxzZSBpZih1cmwudHJpbSgpLmxlbmd0aD4xICYmIHVybC5pbmRleE9mKFwiI1wiKT4tMSl7XG4gICAgICAgIHZhciB1cmxQYXJ0cyA9IHVybC5zcGxpdChcIiNcIik7XG4gICAgICAgIHRoaXMuaGFzaCA9IFwiI1wiICsgdXJsUGFydHMucG9wKCk7IC8vanVtcCBsaW5rLi4gbmVlZCB0byByZW1vdmUgaXQgZnJvbSB0aGUgb3RoZXIgc3R1ZmYuXG4gICAgICAgIHZhciBwYXJ0cyA9ICh1cmxQYXJ0cy5qb2luKFwiI1wiKSkuc3BsaXQoXCI/XCIpO1xuICAgICAgICB0aGlzLm9yaWdpbiA9IHBhcnRzWzBdO1xuICAgICAgICB0aGlzLnNlYXJjaCA9IHBhcnRzLmxlbmd0aD4wID8gXCI/XCIrcGFydHNbMV06XCJcIjtcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuXG4gICAgICAgIGlmKHVybC5pbmRleE9mKFwiP1wiKT4tMSl7XG4gICAgICAgICAgdmFyIHBhcnRzID0gdXJsLnNwbGl0KFwiP1wiKTtcbiAgICAgICAgICB0aGlzLm9yaWdpbiA9IHBhcnRzWzBdO1xuICAgICAgICAgIHRoaXMuc2VhcmNoID0gKHBhcnRzLmxlbmd0aCA+IDApID8gXCI/XCIrcGFydHNbMV06XCJcIjtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLm9yaWdpbiA9IHVybDtcbiAgICAgICAgfVxuXG4gICAgICB9XG4gICAgICAvL3RoaXMuc2VhcmNoUGFyYW1zLnVwZGF0ZVNlYXJjaFByb3AoKTtcbiAgICB9XG5cbiAgfVxuXG4gIGV4cG9ydCBjbGFzcyBVUkxPYmpTZWFyY2hQYXJhbXMge1xuICAgIF9lbnRyaWVzIDogYW55W107XG4gICAgcGFyZW50OiBVUkxPYmo7XG5cbiAgICBjb25zdHJ1Y3RvcihwYXJlbnQ6VVJMT2JqKXtcblxuICAgICAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG4gICAgICBpZih0aGlzLnBhcmVudC5zZWFyY2gubGVuZ3RoPjApe1xuICAgICAgICB0aGlzLl9lbnRyaWVzID0gKHRoaXMucGFyZW50LnNlYXJjaC5zdWJzdHIoMSx0aGlzLnBhcmVudC5zZWFyY2gubGVuZ3RoKSkuc3BsaXQoL1xcJmFtcFxcO3xcXCYvZyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLl9lbnRyaWVzPVtdO1xuICAgICAgfVxuXG5cbiAgICB9XG4gICAgZ2V0IGVudHJpZXMoKXtcbiAgICAgIGxldCBvdXRwdXQgPSBbXTtcbiAgICAgIGZvcihsZXQgaSA9IDA7IGk8dGhpcy5fZW50cmllcy5sZW5ndGg7aSsrKXtcbiAgICAgICAgdmFyIGEgPSB0aGlzLl9lbnRyaWVzW2ldLnNwbGl0KFwiPVwiKTtcbiAgICAgICAgaWYoYS5sZW5ndGg+MSl7XG4gICAgICAgICAgYVsxXSA9IGRlY29kZVVSSUNvbXBvbmVudChhWzFdKTtcbiAgICAgICAgfVxuICAgICAgICBvdXRwdXQucHVzaChhLmpvaW4oXCI9XCIpKTtcbiAgICAgIH1cblxuXG4gICAgICByZXR1cm4gb3V0cHV0O1xuICAgIH1cbiAgICB1cGRhdGVFbnRyaWVzKCk6dm9pZCB7XG4gICAgICB0aGlzLl9lbnRyaWVzID0gW107XG4gICAgICBpZih0aGlzLnBhcmVudC5zZWFyY2ghPT0gXCI/XCIgJiYgdGhpcy5wYXJlbnQuc2VhcmNoLmxlbmd0aD4xKXtcbiAgICAgICAgdmFyIHByb3BzID0gKHRoaXMucGFyZW50LnNlYXJjaC5zdWJzdHIoMSx0aGlzLnBhcmVudC5zZWFyY2gubGVuZ3RoKSkuc3BsaXQoL1xcJmFtcFxcO3xcXCYvZyk7XG4gICAgICAgIGZvcihsZXQgaSA9IDA7IGk8cHJvcHMubGVuZ3RoO2krKyl7XG4gICAgICAgICAgdGhpcy5fZW50cmllcy5wdXNoKHByb3BzW2ldKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICB1cGRhdGVTZWFyY2hQcm9wKCk6dm9pZHtcbiAgICAgIHZhciBvdXRwdXQgPSBbXTtcbiAgICAgIGlmKHRoaXMuX2VudHJpZXMubGVuZ3RoPjApe1xuICAgICAgICBmb3IodmFyIGkgPTA7aTx0aGlzLl9lbnRyaWVzLmxlbmd0aDtpKyspe1xuICAgICAgICAgIHZhciBwcm9wID10aGlzLl9lbnRyaWVzW2ldLnNwbGl0KFwiPVwiKTtcbiAgICAgICAgICBpZigvW2Etel17MSw0fT0oLio/Oil7Myw5fS9naS50ZXN0KHRoaXMuX2VudHJpZXNbaV0pKSB7XG4gICAgICAgICAgICBvdXRwdXQucHVzaCh0aGlzLl9lbnRyaWVzW2ldKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgb3V0cHV0LnB1c2gocHJvcFswXSsocHJvcC5sZW5ndGg+MSA/IFwiPVwiKyBlbmNvZGVVUklDb21wb25lbnQoZGVjb2RlVVJJQ29tcG9uZW50KHByb3BbMV0pKSA6IFwiXCIpKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgdGhpcy5wYXJlbnQuc2VhcmNoID0gb3V0cHV0Lmxlbmd0aD4wID8gXCI/XCIrb3V0cHV0LmpvaW4oXCImXCIpIDogXCJcIjtcbiAgICB9XG4gICAgaGFzKHBhcmFtKTpib29sZWFue1xuICAgICAgdmFyIHJlZ2V4ID0gbmV3IFJlZ0V4cChcIl5cIiArIHBhcmFtICsgXCJcXD1cIixcImdcIik7XG4gICAgICB2YXIgb3V0cHV0ID0gZmFsc2U7XG4gICAgICBmb3IodmFyIGk9MDtpPHRoaXMuX2VudHJpZXMubGVuZ3RoO2krKyl7XG4gICAgICAgIGlmKHJlZ2V4LnRlc3QodGhpcy5fZW50cmllc1tpXSkpIG91dHB1dCA9IHRydWU7XG4gICAgICB9XG4gICAgICByZXR1cm4gb3V0cHV0O1xuICAgIH1cbiAgICBnZXQocGFyYW0pe1xuICAgICAgdmFyIHJlZ2V4ID0gbmV3IFJlZ0V4cChcIl5cIiArIHBhcmFtICsgXCJcXD1cIixcImdcIiksXG4gICAgICAgICAgb3V0cHV0ID0gZmFsc2U7XG4gICAgICBmb3IodmFyIGk9MDtpPHRoaXMuX2VudHJpZXMubGVuZ3RoO2krKyl7XG4gICAgICAgIGlmKHJlZ2V4LnRlc3QodGhpcy5fZW50cmllc1tpXSkpIHtcbiAgICAgICAgICBvdXRwdXQgPSAodGhpcy5fZW50cmllc1tpXS5zcGxpdChcIj1cIikpLnBvcCgpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gb3V0cHV0O1xuICAgIH1cbiAgICBzZXQocGFyYW0sIHZhbHVlKTp2b2lke1xuICAgICAgdmFyIHJlZ2V4ID0gbmV3IFJlZ0V4cChcIl5cIiArIHBhcmFtICsgXCJcXD1cIixcImdcIiksXG4gICAgICAgICAgb3V0cHV0ID0gZmFsc2U7XG4gICAgICBmb3IodmFyIGk9MDtpPHRoaXMuX2VudHJpZXMubGVuZ3RoO2krKyl7XG4gICAgICAgIGlmKHJlZ2V4LnRlc3QodGhpcy5fZW50cmllc1tpXSkpIHtcbiAgICAgICAgICB0aGlzLl9lbnRyaWVzW2ldID0gcGFyYW0gKyBcIj1cIiArIHZhbHVlO1xuICAgICAgICAgIG91dHB1dCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmKCFvdXRwdXQpe1xuICAgICAgICB0aGlzLmFwcGVuZChwYXJhbSArIFwiPVwiICsgdmFsdWUpO1xuICAgICAgfVxuICAgICAgdGhpcy51cGRhdGVTZWFyY2hQcm9wKCk7XG4gICAgfVxuICAgIGFwcGVuZCh2YWx1ZVBhaXIpe1xuICAgICAgdGhpcy5fZW50cmllcy5wdXNoKHZhbHVlUGFpcik7XG4gICAgICB0aGlzLnVwZGF0ZVNlYXJjaFByb3AoKTtcbiAgICB9XG4gICAgZGVsZXRlQWxsKCl7XG4gICAgICB0aGlzLl9lbnRyaWVzID0gW107XG4gICAgICB0aGlzLnVwZGF0ZVNlYXJjaFByb3AoKTtcbiAgICB9XG4gICAgZGVsZXRlQXRJbmRleChpbmRleCl7XG4gICAgICB0aGlzLl9lbnRyaWVzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICB0aGlzLnVwZGF0ZVNlYXJjaFByb3AoKTtcbiAgICB9XG4gICAgZGVsZXRlKHBhcmFtKXtcbiAgICAgIC8vZG9lc250IGRvIGFueXRoaW5nIHlldC5cbiAgICAgIGZvcihsZXQgaT0wO2kgPCB0aGlzLl9lbnRyaWVzLmxlbmd0aDtpKyspe1xuICAgICAgICBpZih0aGlzLl9lbnRyaWVzW2ldLnN1YnN0cigwLHBhcmFtLmxlbmd0aCsxKT09cGFyYW0rXCI9XCIpe1xuICAgICAgICAgIHRoaXMuZGVsZXRlQXRJbmRleChpKTtcbiAgICAgICAgICAvLyBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGV4cG9ydCBjbGFzcyBMaW5rZWRJbWFnZSB7XG4gICAgc3JjOiBzdHJpbmd8Ym9vbGVhbjtcbiAgICBhbHQ6IHN0cmluZ3xib29sZWFuO1xuICAgIGhlaWdodDogbnVtYmVyfGJvb2xlYW47XG4gICAgd2lkdGg6IG51bWJlcnxib29sZWFuO1xuICAgIGNvbnRleHQ6IHN0cmluZztcbiAgICBfc3VwZXI6IExpbmtPYmplY3Q7XG5cblxuICAgIGNvbnN0cnVjdG9yIChfc3VwZXIsIGNvZGUpIHtcbiAgICAgIHRoaXMuY29udGV4dCA9IGNvZGU7XG4gICAgICB0aGlzLl9zdXBlciA9IF9zdXBlcjtcbiAgICAgIHZhciB0YWdzID0gW1wic3JjXCIsIFwiYWx0XCIsIFwiaGVpZ2h0XCIsIFwid2lkdGhcIl07XG4gICAgICBmb3IobGV0IHRhZyBvZiB0YWdzKXtcbiAgICAgICAgdmFyIHJlZ2V4ID0gbmV3IFJlZ0V4cCh0YWcrXCI9XFxcIihbXlxcXCJdLio/KT9cXFwiXCIsXCJpXCIpO1xuICAgICAgICBpZihyZWdleC50ZXN0KGNvZGUpKXtcbiAgICAgICAgICB0aGlzW3RhZ10gPSBjb2RlLm1hdGNoKHJlZ2V4KVsxXTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgbGV0IGhhc1dpZHRoID0gdGhpcy53aWR0aCAmJiBwYXJzZUludCh0aGlzLndpZHRoLnRvU3RyaW5nKCkpO1xuICAgICAgbGV0IGhhc0hlaWdodCA9IHRoaXMuaGVpZ2h0ICYmIHBhcnNlSW50KHRoaXMuaGVpZ2h0LnRvU3RyaW5nKCkpO1xuXG4gICAgICBpZighaGFzV2lkdGggfHwgIWhhc0hlaWdodCl7XG4gICAgICAgIGlmKHR5cGVvZiB0aGlzLnNyYyA9PT0gXCJzdHJpbmdcIil7XG4gICAgICAgICAgdGhpcy5wcmVsb2FkSW1hZ2UodGhpcy5zcmMpO1xuICAgICAgICB9XG4gICAgICB9IC8vZWl0aGVyIGlzIG5vdCBzZXRcblxuICAgIH1cbiAgICBwcmVsb2FkSW1hZ2Uoc3JjKXtcbiAgICAgIHZhciBMSSA9IHRoaXM7XG4gICAgICAgIHZhciBpbWcgPSBuZXcgSW1hZ2UoKTtcbiAgICAgICAgLy8gaW1nLnN0eWxlLnZpc2liaWxpdHkgPSBcImhpZGRlblwiO1xuICAgICAgICBpbWcub25sb2FkPWZ1bmN0aW9uKCl7XG4gICAgICAgICAgTEkuaGVpZ2h0ID0gaW1nLmhlaWdodDtcbiAgICAgICAgICBMSS53aWR0aCA9IGltZy53aWR0aDtcbiAgICAgICAgICBjb25zb2xlLmxvZyhpbWcuaGVpZ2h0LGltZy53aWR0aCk7XG4gICAgICAgICAgaW1nLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoaW1nKTtcbiAgICAgICAgfTtcblxuXG4gICAgICAgIGltZy5zcmMgPSA8c3RyaW5nPkxJLnNyYztcbiAgICAgICAgY29uc29sZS5sb2coaW1nKTtcbiAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChpbWcpO1xuICAgIH1cbiAgICBnZW5lcmF0ZU91dHB1dChjb250ZW50KTpzdHJpbmcge1xuICAgICAgdmFyIF90aGlzPSB0aGlzO1xuICAgICAgaWYodGhpcy5jb250ZXh0LmluZGV4T2YoXCJhbHRcIik+LTEpe1xuICAgICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKHRoaXMuY29udGV4dCwgZnVuY3Rpb24oZil7XG4gICAgICAgICAgcmV0dXJuIGYucmVwbGFjZSgvYWx0XFw9XFxcIihbXlxcXCJdLio/KT9cXFwiL2csIFwiYWx0PVxcXCJcIiArIChfdGhpcy5hbHQ9PT11bmRlZmluZWQ/XCJcIjpfdGhpcy5hbHQpICsgXCJcXFwiXCIpO1xuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UodGhpcy5jb250ZXh0LCBmdW5jdGlvbihmKXtcbiAgICAgICAgICByZXR1cm4gZi5yZXBsYWNlKFwiPGltZ1wiLCBcIjxpbWcgYWx0PVxcXCJcIisoX3RoaXMuYWx0PT09dW5kZWZpbmVkP1wiXCI6X3RoaXMuYWx0KStcIlxcXCJcIik7fSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gY29udGVudDtcbiAgICB9XG4gIH1cblxuICBleHBvcnQgY2xhc3MgTGlua09iamVjdCB7XG4gICAgX3N1cGVyOiBFTUxXb3Jrc3BhY2U7XG4gICAgX19pc0NvbXBsZXRlOiBib29sZWFuO1xuXG5cbiAgICByZWFkT25seTogYm9vbGVhbjtcbiAgICBjb250ZXh0OiBzdHJpbmc7XG4gICAgZGVsZXRlT25SZW5kZXI6IGJvb2xlYW47XG4gICAgZW1haWxSZWdleDogUmVnRXhwO1xuICAgIGVycm9yczogYW55O1xuICAgIGlkOiBudW1iZXI7XG4gICAgbGluZTogbnVtYmVyO1xuICAgIExpbmtlZEltYWdlOiBMaW5rZWRJbWFnZTtcbiAgICBMaW5rZWRJbWFnZU9sZDogTGlua2VkSW1hZ2U7XG4gICAgbWFpbHRvOiBNYWlsdG9MaW5rT2JqZWN0O1xuICAgIG5ldzogVVJMT2JqO1xuICAgIG9sZDogVVJMT2JqO1xuICAgIENoYW5nZU1vbml0b3I6IENoYW5nZU1vbml0b3I7XG4gICAgc2hvd01haWx0b0VkaXRvcjogYm9vbGVhbjtcbiAgICBzaG93UXVlcnlTdHJpbmdFZGl0b3I6IGJvb2xlYW47XG4gICAgcXVlcnlTdHJpbmdzOiBzdHJpbmdbXTtcbiAgICAvLyB1cmxSZWdleDogUmVnRXhwO1xuICAgIHdoaXRlTGlzdGVkVXJsOiBzdHJpbmc7XG5cblxuICAgIGNvbnN0cnVjdG9yKGxpbmU6IG51bWJlciwgY29udGV4dDogc3RyaW5nLCBwYXJlbnQ6IEVNTFdvcmtzcGFjZSl7XG4gICAgICB0aGlzLl9faXNDb21wbGV0ZSA9IGZhbHNlO1xuICAgICAgdGhpcy5fc3VwZXIgPSBwYXJlbnQ7XG5cbiAgICAgIHRoaXMuc2hvd1F1ZXJ5U3RyaW5nRWRpdG9yID0gZmFsc2U7XG4gICAgICB0aGlzLnNob3dNYWlsdG9FZGl0b3IgPSBmYWxzZTtcblxuICAgICAgdGhpcy5pZCA9IDA7XG4gICAgICB0aGlzLmxpbmUgPSBsaW5lICsgMTtcbiAgICAgIHRoaXMuY29udGV4dCA9IGNvbnRleHQ7XG4gICAgICB0aGlzLnF1ZXJ5U3RyaW5ncyA9IFtdO1xuXG4gICAgICB0aGlzLkNoYW5nZU1vbml0b3IgPSBuZXcgQ2hhbmdlTW9uaXRvcih0aGlzKTtcbiAgICAgIHRoaXMuZXJyb3JzID0gRU1MSW50ZWxsaWdlbmNlLm1vZHVsZShcImh5cGVybGlua1wiKS5tb25pdG9yKCk7XG4gICAgICB0aGlzLmVycm9ycy5hc3NvY2lhdGVWYXJpYWJsZShcIkxpbmtPYmplY3RcIiwgdGhpcyk7XG5cbiAgICAgIHRoaXMud2hpdGVMaXN0ZWRVcmwgPSBcIn5+d2hpdGVsaXN0fn5cIjtcblxuICAgICAgLy9maW5kIGhyZWZcbiAgICAgIHRoaXMuX19sb2NhdGVIcmVmKGNvbnRleHQpO1xuICAgICAgLy9maW5kIGltYWdlXG4gICAgICB0aGlzLl9fbG9jYXRlTGlua2VkSW1hZ2UoY29udGV4dCk7XG5cbiAgICAgIC8vbmVlZCB0byBzZXQgdGhlIHVybCBiZWZvcmUgeW91IGRvIHRoaXM7XG4gICAgICB0aGlzLm1haWx0byA9IG5ldyBNYWlsdG9MaW5rT2JqZWN0KHRoaXMpO1xuICAgICAgdGhpcy5pc0xpbmtDb21wbGV0ZSgpO1xuICAgIH1cbiAgICBfX2xvY2F0ZUhyZWYoY29udGV4dCl7XG4gICAgICB2YXIgcmUyID0gL2hyZWZcXD1cXFwiKFteXFxcIlxcPl0qKVxcXCIvZztcbiAgICAgIHZhciBocmVmID0gY29udGV4dC5tYXRjaChyZTIpO1xuICAgICAgaWYoaHJlZi5sZW5ndGg+MCl7XG4gICAgICAgIGlmKGhyZWZbMF09PVwiaHJlZj1cXFwiXFxcIlwiKSB7XG4gICAgICAgICAgdGhpcy5uZXcgPSAgbmV3IFVSTE9iaihcIiNcIik7XG4gICAgICAgICAgdGhpcy5vbGQgPSBuZXcgVVJMT2JqKFwiI1wiKTtcbiAgICAgICAgICB0aGlzLmNvbnRleHQgPSB0aGlzLmNvbnRleHQucmVwbGFjZShuZXcgUmVnRXhwKFwiaHJlZj1cXFwiXFxcIlwiLFwiZ1wiKSxcImhyZWY9XFxcIiNcXFwiXCIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHRoaXMubmV3ID0gbmV3IFVSTE9iaigoaHJlZlswXS5zdWJzdHIoNiwgaHJlZlswXS5sZW5ndGgtNykpLnRyaW0oKSk7XG4gICAgICAgICAgdGhpcy5vbGQgPSBuZXcgVVJMT2JqKChocmVmWzBdLnN1YnN0cig2LCBocmVmWzBdLmxlbmd0aC03KSkudHJpbSgpKTtcbiAgICAgICAgfVxuXG4gICAgICB9XG4gICAgfVxuICAgIF9fbG9jYXRlTGlua2VkSW1hZ2UoY29udGV4dCl7XG4gICAgICBpZigvXFw8aW1nKFtePl0uKj8pXFw+Ly50ZXN0KGNvbnRleHQpKXtcbiAgICAgICAgdmFyIGZvdW5kID0gY29udGV4dC5tYXRjaCgvXFw8aW1nKFtePl0uKj8pXFw+Lyk7XG4gICAgICAgIGlmKGZvdW5kLmxlbmd0aD4wKXtcbiAgICAgICAgICB0aGlzLkxpbmtlZEltYWdlID0gbmV3IExpbmtlZEltYWdlKHRoaXMsIGZvdW5kWzBdKTtcbiAgICAgICAgICB0aGlzLkxpbmtlZEltYWdlT2xkID0gbmV3IExpbmtlZEltYWdlKHRoaXMsIGZvdW5kWzBdKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIGhhc0R1cGxpY2F0ZVF1ZXJ5U3RyaW5ncygpOiBzdHJpbmdbXXxib29sZWFuIHtcbiAgICAgIHZhciByZXN1bHQgPSBbXSxcbiAgICAgICAgICB1c2VkU3RyaW5ncyA9IFtdO1xuXG4gICAgICBpZih0aGlzLm5ldy5zZWFyY2hQYXJhbXMuZW50cmllcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIGZvcihsZXQgYSBvZiB0aGlzLm5ldy5zZWFyY2hQYXJhbXMuZW50cmllcyl7XG4gICAgICAgICAgdmFyIHBhcmFtID0gYS5zcGxpdChcIj1cIikuc2hpZnQoKTtcbiAgICAgICAgICBpZih1c2VkU3RyaW5ncy5pbmRleE9mKHBhcmFtKT4tMSl7XG4gICAgICAgICAgICByZXN1bHQucHVzaChwYXJhbSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHVzZWRTdHJpbmdzLnB1c2gocGFyYW0pO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmKHJlc3VsdC5sZW5ndGg+MCl7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG5cbiAgICB9XG5cbiAgICBvdmVycmlkZVRyYWNraW5nUmVxdWlyZW1lbnRzKCl7XG4gICAgICB0aGlzLndoaXRlTGlzdGVkVXJsID0gdGhpcy5uZXcudXJsO1xuICAgIH1cbiAgICBkaXNwbGF5Rm9ybWF0dGVkVVJMKCl7XG4gICAgICAvL2Rpc3BsYXlzIHVybDtcbiAgICAgIHZhciBjb250ZW50ID0gdGhpcy5jb250ZXh0O1xuICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvXFxzZW1sXFwtaWRcXD1cXFwiKFswLTldKilcXFwiLywgXCJcIik7XG5cbiAgICAgIHZhciBmaW5kU3RhcnQgPSBcImhyZWY9XFxcIlwiO1xuICAgICAgdmFyIHN0YXJ0ID0gY29udGVudC5pbmRleE9mKGZpbmRTdGFydCk7XG4gICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKG5ldyBSZWdFeHAoXCJocmVmPVxcXCJcXFwiXCIsXCJnXCIpLCBcImhyZWY9XFxcIiNcXFwiXCIpO1xuICAgICAgLy8gdmFyIGltZ1JlZyA9IC9cXDxpbWcoW14+XS4qPylcXD4vZztcbiAgICAgIGlmKHRoaXMuTGlua2VkSW1hZ2Upe1xuICAgICAgICBjb250ZW50ID0gdGhpcy5MaW5rZWRJbWFnZS5nZW5lcmF0ZU91dHB1dChjb250ZW50KTtcbiAgICAgIH1cbiAgICAgIGNvbnRlbnQgPSBjb250ZW50LnN1YnN0cigwLCBzdGFydCkgKyBmaW5kU3RhcnQrIFwifHx8YS5ocmVmfHx8XCIgKyBjb250ZW50LnN1YnN0cihzdGFydCArIChmaW5kU3RhcnQubGVuZ3RoKyh0aGlzLm9sZC51cmwubGVuZ3RoKSksIGNvbnRlbnQubGVuZ3RoICkgO1xuICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZShuZXcgUmVnRXhwKFwiXFxcIlwiLFwiZ1wiKSwgXCImcXVvdDtcIik7XG4gICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKG5ldyBSZWdFeHAoXCIvXCIsXCJnXCIpLCBcIiYjNDc7XCIpO1xuICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZShuZXcgUmVnRXhwKFwiPlwiLFwiZ1wiKSwgXCImZ3Q7XCIpO1xuICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZShuZXcgUmVnRXhwKFwiPFwiLFwiZ1wiKSwgXCImbHQ7XCIpO1xuXG5cbiAgICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoLyhbXlxcc10qPylcXD0vZyxcIjxzcGFuIGNsYXNzPVxcXCJhdHRyXFxcIj4kMTwvc3Bhbj48c3BhbiBjbGFzcz1cXFwia2V5d29yZFxcXCI+PTwvc3Bhbj5cIik7XG4gICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC9cXCZxdW90XFw7XFwmZ3RcXDsvZyxcIiZxdW90OzxzcGFuIGNsYXNzPVxcXCJ0YWdcXFwiPiZndDs8L3NwYW4+XCIpO1xuICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvXFwmXFwjNDdcXDtcXCZndFxcOy9nLFwiPHNwYW4gY2xhc3M9XFxcInRhZ1xcXCI+JiM0NzsmZ3Q7PC9zcGFuPlwiKTtcbiAgICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoL1xcJnF1b3RcXDsoLio/KVxcJnF1b3RcXDsvZyxcIjxzcGFuIGNsYXNzPVxcXCJ2YWx1ZVxcXCI+XFxcIiQxXFxcIjwvc3Bhbj5cIik7XG4gICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC9cXCZsdFxcOyhbYS16XStcXHM/KS9nLFwiPHNwYW4gY2xhc3M9XFxcInRhZ1xcXCI+Jmx0OyQxPC9zcGFuPlwiKTtcbiAgICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoL1xcJmx0XFw7XFwmXFwjNDdcXDsoW2Etel0rXFxzPylcXCZndFxcOy9nLFwiPHNwYW4gY2xhc3M9XFxcInRhZ1xcXCI+Jmx0OyYjNDc7JDEmZ3Q7PC9zcGFuPlwiKTtcbiAgICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoL1xcbi9nLFwiPGJyPlwiKTtcblxuICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvXFwmZ3RcXDsvZyxcIjxzcGFuIGNsYXNzPVxcXCJ0YWdcXFwiPiZndDs8L3NwYW4+XCIpO1xuICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvXFxzezN9L2csXCImbmJzcDsmbmJzcDsmbmJzcFwiKTtcblxuICAgICAgLy8gaWYodGhpcy5MaW5rZWRJbWFnZSkge1xuICAgICAgLy8gICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC9cXHxcXHxcXHxpbWdcXC5hbHRcXHxcXHxcXHwvZywgdGhpcy5MaW5rZWRJbWFnZS5hbHQgPT09IHVuZGVmaW5lZCA/IFwiXCIgOiB0aGlzLkxpbmtlZEltYWdlLmFsdCk7XG4gICAgICAvLyB9XG5cbiAgICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoL1xcfFxcfFxcfGFcXC5ocmVmXFx8XFx8XFx8L2csIFwiPHN0cm9uZz5cIisodGhpcy5oYXNPd25Qcm9wZXJ0eShcImRlbGV0ZU9uUmVuZGVyXCIpICYmIHRoaXMuZGVsZXRlT25SZW5kZXIgPyB0aGlzLm9sZC51cmwgOiB0aGlzLm5ldy51cmwpK1wiPC9zdHJvbmc+XCIpO1xuXG5cblxuXG5cbiAgICAgIHJldHVybiBjb250ZW50O1xuICAgIH1cblxuICAgIGlzTGlua0NvbXBsZXRlKCl7XG4gICAgICAvL2ludGVsbGlnZW5jZSBzY2FuczpcbiAgICAgIHRoaXMuX3N1cGVyLmludGVsbGlnZW5jZS5ldmFsdWF0ZVJ1bGVzKCk7XG4gICAgICB0aGlzLmVycm9ycy5ldmFsdWF0ZVJ1bGVzKCk7XG4gICAgICAvL3RyYWNrIGNoYW5nZXM6XG4gICAgICB0aGlzLkNoYW5nZU1vbml0b3IudXBkYXRlKCk7XG5cbiAgICAgIHRoaXMuX19pc0NvbXBsZXRlPSB0aGlzLmVycm9ycy5jYW5Db250aW51ZTtcbiAgICAgIGlmKHRoaXMuaGFzT3duUHJvcGVydHkoXCJkZWxldGVPblJlbmRlclwiKSYmIHRoaXMuZGVsZXRlT25SZW5kZXIpIHRoaXMuX19pc0NvbXBsZXRlID0gdHJ1ZTtcbiAgICAgIHJldHVybiB0aGlzLl9faXNDb21wbGV0ZTtcbiAgICB9XG5cbiAgICBpc0xpbmtUeXBlKHR5cGUpOiBib29sZWFuIHtcbiAgICAgIHZhciBvdXRwdXQgPSBmYWxzZTtcbiAgICAgIHN3aXRjaCAodHlwZSkge1xuICAgICAgICBjYXNlIFwiaHR0cFwiOlxuICAgICAgICAgIGlmKHRoaXMubmV3LnByb3RvY29sPT1cImh0dHA6XCIgfHwgdGhpcy5uZXcucHJvdG9jb2w9PVwiaHR0cHM6XCIpe1xuICAgICAgICAgICAgb3V0cHV0ID0gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgXCJtYWlsdG9cIjpcbiAgICAgICAgICBpZih0aGlzLm5ldy5wcm90b2NvbD09XCJtYWlsdG86XCIpe1xuICAgICAgICAgICAgb3V0cHV0ID0gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6XG5cbiAgICAgIH1cbiAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgfVxuXG4gICAgaGFzVHJhY2tpbmdDb2RlKG9iaj8pOiBib29sZWFuIHsvL3N1c3BlY3RcbiAgICAgIGlmKG9iaj09PXVuZGVmaW5lZCkgb2JqID0gdGhpcy5uZXcudXJsO1xuICAgICAgLy8gaWYodGhpcy53aGl0ZUxpc3RlZFVybD09dGhpcy5uZXcpIHJldHVybiB0cnVlO1xuICAgICAgdmFyIGEgPSAvW2Etel17MSw0fT0oLio/Oil7Myw5fS9pZztcbiAgICAgIHJldHVybiBhLnRlc3Qob2JqKTtcbiAgICB9XG4gICAgcmVxdWlyZXNUcmFja2luZ0NvZGUob2JqPyk6IGJvb2xlYW4ge1xuICAgICAgdmFyIG91dHB1dDogYm9vbGVhbiA9IGZhbHNlO1xuICAgICAgaWYoR2xvYmFsVmFycy5SZXF1aXJlc1RyYWNraW5nQ29kZVJlZ2V4LnRlc3QodGhpcy5uZXcudXJsKSkge1xuICAgICAgICBvdXRwdXQgPSB0cnVlO1xuICAgICAgICAvLyBpdGVyYXRlIG9mZXIgd2hpdGVsaXN0XG4gICAgICAgIGZvcih2YXIgaSA9MDsgaSA8IEdsb2JhbFZhcnMuUmVxdWlyZWRUcmFja2luZ0NvZGVXaGl0ZWxpc3QubGVuZ3RoOyBpKyspe1xuICAgICAgICAgIGlmKCBHbG9iYWxWYXJzLlJlcXVpcmVkVHJhY2tpbmdDb2RlV2hpdGVsaXN0W2ldIGluc3RhbmNlb2YgUmVnRXhwKSB7XG4gICAgICAgICAgICBpZihHbG9iYWxWYXJzLlJlcXVpcmVkVHJhY2tpbmdDb2RlV2hpdGVsaXN0W2ldW1widGVzdFwiXSh0aGlzLm5ldy51cmwpKSB7IG91dHB1dCA9IGZhbHNlOyB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmKHRoaXMubmV3LnVybC5pbmRleE9mKEdsb2JhbFZhcnMuUmVxdWlyZWRUcmFja2luZ0NvZGVXaGl0ZWxpc3RbaV0pPi0xKSB7IG91dHB1dCA9IGZhbHNlOyB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gb3V0cHV0O1xuICAgIH1cbiAgICByZXF1aXJlc1NDb2RlKCk6IGJvb2xlYW4ge1xuICAgICAgaWYoR2xvYmFsVmFycy5SZXF1aXJlc1NDb2RlUmVnZXgudGVzdCh0aGlzLm5ldy51cmwpKXtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuICAgIG5lZWRzVHJhY2tpbmdDb2RlKCk6IGJvb2xlYW4ge1xuICAgICAgdmFyIG91dHB1dDogYm9vbGVhbiA9IHRoaXMucmVxdWlyZXNUcmFja2luZ0NvZGUoKTtcbiAgICAgIGlmKHRoaXMud2hpdGVMaXN0ZWRVcmw9PXRoaXMubmV3LnVybCkgcmV0dXJuIGZhbHNlO1xuICAgICAgLy8gZGV0ZXJtaW5lIGxpbmtzIHRoYXQgbmVlZCBzcGVjaWFsIHRyYWNraW5nXG4gICAgICBpZih0aGlzLmhhc1RyYWNraW5nQ29kZSgpICl7XG4gICAgICAgIG91dHB1dCA9IGZhbHNlO1xuICAgICAgfVxuICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICB9XG4gICAgdXBkYXRlSW5wdXQoKXtcbiAgICAgIGlmKHRoaXMuaXNMaW5rVHlwZSgnbWFpbHRvJykpe1xuICAgICAgICB0aGlzLm1haWx0by51cGRhdGVNYWlsdG9PYmooKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMubmV3LnNlYXJjaFBhcmFtcy51cGRhdGVFbnRyaWVzKClcbiAgICAgIH1cbiAgICAgIHRoaXMuaXNMaW5rQ29tcGxldGUoKTtcbiAgICB9XG5cbiAgfVxuXG5cblxuXG4gIGV4cG9ydCBjbGFzcyBDaGFuZ2VNb25pdG9ye1xuICAgIF9zdXBlcjogTGlua09iamVjdDtcbiAgICBtZXNzYWdlczogQ2hhbmdlTW9uaXRvck1zZ1tdO1xuICAgIHZpc2libGU6IGJvb2xlYW47XG5cbiAgICBjb25zdHJ1Y3Rvcihfc3VwZXIpe1xuICAgICAgdGhpcy52aXNpYmxlID0gZmFsc2U7XG4gICAgICB0aGlzLl9zdXBlciA9IF9zdXBlcjtcbiAgICAgIHRoaXMubWVzc2FnZXMgPSBbXTtcbiAgICB9XG4gICAgY29tcGFyZU9sZEFuZE5ldygpOiBzdHJpbmdbXXtcbiAgICAgIGxldCB1cmxQYXJhbXMgPSBbXCJwcm90b2NvbFwiLFwib3JpZ2luXCIsXCJzZWFyY2hcIixcImhhc2hcIl07XG4gICAgICB2YXIgY2hhbmdlZCA9IFtdO1xuICAgICAgdmFyIF9zdXBlciA9IHRoaXMuX3N1cGVyO1xuICAgICAgdXJsUGFyYW1zLmZvckVhY2goZnVuY3Rpb24ocGFyYW0pe1xuICAgICAgICBpZihfc3VwZXIub2xkLmhhc093blByb3BlcnR5KHBhcmFtKSAmJiBfc3VwZXIub2xkW3BhcmFtXSE9PSBfc3VwZXIubmV3W3BhcmFtXSl7XG4gICAgICAgICAgY2hhbmdlZC5wdXNoKHBhcmFtKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBpZihfc3VwZXIuTGlua2VkSW1hZ2UgJiYgX3N1cGVyLkxpbmtlZEltYWdlLmFsdCE9PV9zdXBlci5MaW5rZWRJbWFnZU9sZC5hbHQpe1xuICAgICAgICBjaGFuZ2VkLnB1c2goXCJhbHRcIik7XG4gICAgICB9XG4gICAgICByZXR1cm4gY2hhbmdlZDtcbiAgICB9XG4gICAgYmVmb3JlRGlkUmV0dXJuQ2hhbmdlcygpeyB9XG4gICAgYWZ0ZXJEaWRSZXR1cm5DaGFuZ2VzKCl7IH1cbiAgICB1cGRhdGUoKXtcbiAgICAgIGlmKHRoaXMuX3N1cGVyLnJlYWRPbmx5ID09IGZhbHNlKXtcbiAgICAgICAgdmFyIG91dHB1dCA9IFtdO1xuICAgICAgICBsZXQgY2hhbmdlcyA9IHRoaXMuY29tcGFyZU9sZEFuZE5ldygpO1xuICAgICAgICB2YXIgQ00gPSB0aGlzO1xuICAgICAgICBjaGFuZ2VzLmZvckVhY2goZnVuY3Rpb24oc2NvcGUpe1xuICAgICAgICAgIG91dHB1dC5wdXNoKENNLmFydGljdWxhdGVDaGFuZ2VzKHNjb3BlLCB7fSkpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5tZXNzYWdlcyA9IG91dHB1dDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb21wYXJlU2VhcmNoU3RyaW5ncyhvbGRQLCBuZXdQKTogU2VhcmNoU3RyaW5nUGF5bG9hZCB7XG4gICAgICB2YXIgcGF5bG9hZDogU2VhcmNoU3RyaW5nUGF5bG9hZCA9IHtcbiAgICAgICAgYWRkZWQ6IFtdLFxuICAgICAgICB1cGRhdGVkOiBbXSxcbiAgICAgICAgcmVtb3ZlZDpbXVxuICAgICAgfTtcbiAgICAgIGZvcih2YXIgaSBpbiBvbGRQKXtcbiAgICAgICAgaWYobmV3UC5pbmRleE9mKG9sZFBbaV0pPT09LTEpeyBwYXlsb2FkLnJlbW92ZWQucHVzaChvbGRQW2ldKSB9XG4gICAgICB9XG4gICAgICBmb3IoaSBpbiBuZXdQKXtcbiAgICAgICAgaWYob2xkUC5pbmRleE9mKG5ld1BbaV0pPT09LTEpeyBwYXlsb2FkLmFkZGVkLnB1c2gobmV3UFtpXSkgfVxuICAgICAgfVxuICAgICAgbGV0IGZpbmRfcGF0dGVybl9pbkFycmF5ID0gZnVuY3Rpb24ocGF0dGVybjpSZWdFeHAsIGFycjogc3RyaW5nW10pe1xuICAgICAgICB2YXIgb3V0cHV0OiBudW1iZXIgPSAtMTtcbiAgICAgICAgIGZvcih2YXIgeT0wO3k8YXJyLmxlbmd0aDt5Kyspe1xuICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhcInV1cGRhdHJlZD9cIix5KTtcbiAgICAgICAgICAgaWYocGF0dGVybi50ZXN0KGFyclt5XSkpe1xuICAgICAgICAgICAgIG91dHB1dCA9IHk7XG4gICAgICAgICAgIH1cbiAgICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICAgIH07XG4gICAgICBmb3IoaSBpbiBvbGRQKXtcbiAgICAgICAgdmFyIHJlID0gbmV3IFJlZ0V4cChvbGRQW2ldLnNwbGl0KFwiPVwiKVswXStcIj1cIik7XG4gICAgICAgIHZhciBmb3VuZCA9IGZpbmRfcGF0dGVybl9pbkFycmF5KHJlLCBwYXlsb2FkLmFkZGVkKTtcbiAgICAgICAgaWYoZm91bmQ+LTEpe1xuICAgICAgICAgIHBheWxvYWQudXBkYXRlZC5wdXNoKHBheWxvYWQuYWRkZWRbZm91bmRdKTtcbiAgICAgICAgICB2YXIgb3RoZXIgPSBmaW5kX3BhdHRlcm5faW5BcnJheShyZSwgcGF5bG9hZC5yZW1vdmVkKTtcbiAgICAgICAgICBwYXlsb2FkLnJlbW92ZWQuc3BsaWNlKG90aGVyLDEpO1xuICAgICAgICAgIHBheWxvYWQuYWRkZWQuc3BsaWNlKGZvdW5kLDEpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gcGF5bG9hZDtcbiAgICB9XG4gICAgYXJ0aWN1bGF0ZUNoYW5nZXMoc2NvcGUsIGFyZ3MpOiB7bWVzc2FnZTogc3RyaW5nLCBkYXRhOiBhbnl9IHtcbiAgICAgIGlmKHNjb3BlPT1cInByb3RvY29sXCIpe1xuICAgICAgICBpZih0aGlzLl9zdXBlci5uZXcucHJvdG9jb2wgPT0gXCJtYWlsdG86XCIpe1xuICAgICAgICAgIHJldHVybiB7bWVzc2FnZTogXCJDaGFuZ2VkIHRvIG1haWx0byBsaW5rLlwiLCBkYXRhOiBbXX07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIG1lc3NhZ2U6ICh0aGlzLl9zdXBlci5vbGQucHJvdG9jb2w9PVwiXCIgPyBcIlVwZGF0ZWRcIiA6IFwiQ2hhbmdlZFwiKStcIiBwcm90b2NvbCB0byBcIiArIHRoaXMuX3N1cGVyLm5ldy5wcm90b2NvbCxcbiAgICAgICAgICAgIGRhdGE6IFtdXG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmKHNjb3BlPT1cIm9yaWdpblwiKXtcbiAgICAgICAgaWYodGhpcy5fc3VwZXIubmV3LnByb3RvY29sID09IFwibWFpbHRvOlwiKXtcbiAgICAgICAgICByZXR1cm4ge21lc3NhZ2U6IFwiQ2hhbmdlZCBtYWlsdG8gbGluayB0byBcIiArIHRoaXMuX3N1cGVyLm5ldy5vcmlnaW4sIGRhdGE6IFtdfTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4ge21lc3NhZ2U6IFwiQ2hhbmdlZCBsaW5rIFVSTCB0byBcIiArIHRoaXMuX3N1cGVyLm5ldy5vcmlnaW4sIGRhdGE6IFtdfTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIGlmKHNjb3BlPT1cImFsdFwiKSB7XG4gICAgICAgIGlmKHRoaXMuX3N1cGVyLkxpbmtlZEltYWdlLmFsdCA9PSBcIlwiKXtcbiAgICAgICAgICByZXR1cm4ge21lc3NhZ2U6IFwiUmVtb3ZlZCBsaW5rZWQgaW1hZ2UgQUxUIHRleHRcIiwgZGF0YTogW119O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiB7bWVzc2FnZTogXCJVcGRhdGVkIGxpbmtlZCBpbWFnZSBBTFQgdGV4dCB0byA8Yj5cIiArIHRoaXMuX3N1cGVyLkxpbmtlZEltYWdlLmFsdCArIFwiPC9iPlwiLCBkYXRhOiBbXX07XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZihzY29wZT09XCJzZWFyY2hcIikge1xuXG4gICAgICAgIGxldCBvbGRQYXJhbXMgPSB0aGlzLl9zdXBlci5vbGQuc2VhcmNoUGFyYW1zLl9lbnRyaWVzO1xuICAgICAgICBsZXQgbmV3UGFyYW1zID0gdGhpcy5fc3VwZXIubmV3LnNlYXJjaFBhcmFtcy5fZW50cmllcztcblxuICAgICAgICBsZXQgc2VhcmNoQ2hhbmdlcyA9IHRoaXMuY29tcGFyZVNlYXJjaFN0cmluZ3Mob2xkUGFyYW1zLCBuZXdQYXJhbXMpO1xuXG4gICAgICAgIHZhciBtZXNzYWdlID0gXCJcIjtcbiAgICAgICAgdmFyIF9zdXBlciA9IHRoaXMuX3N1cGVyO1xuICAgICAgICBbXCJ1cGRhdGVkXCIsXCJhZGRlZFwiLFwicmVtb3ZlZFwiXS5mb3JFYWNoKGZ1bmN0aW9uKGtleSl7XG4gICAgICAgICAgaWYoc2VhcmNoQ2hhbmdlc1trZXldLmxlbmd0aD4wKXtcbiAgICAgICAgICAgIG1lc3NhZ2UgPSBtZXNzYWdlICsga2V5WzBdLnRvVXBwZXJDYXNlKCkra2V5LnN1YnN0cigxLGtleS5sZW5ndGgpICsgXCIgXCIrKF9zdXBlci5uZXcucHJvdG9jb2w9PVwibWFpbHRvOlwiID8gXCJwYXJhbWV0ZXJcIiA6IFwicXVlcnkgc3RyaW5nXCIpKyhzZWFyY2hDaGFuZ2VzW2tleV0ubGVuZ3RoPjEgPyBcInNcIjogXCJcIikgKyBcIjogPGI+XCIgKyBzZWFyY2hDaGFuZ2VzW2tleV0uam9pbihcIiwgXCIpICsgXCI8L2I+PGJyPlwiO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIHsgbWVzc2FnZTogbWVzc2FnZSwgZGF0YTogW10gfTtcblxuXG4gICAgICB9IGVsc2UgaWYoc2NvcGU9PVwiaGFzaFwiKSB7XG4gICAgICAgIGlmKHRoaXMuX3N1cGVyLm9sZC5oYXNoID09XCJcIikge1xuICAgICAgICAgIHJldHVybiB7bWVzc2FnZTogXCJZb3UgYWRkZWQgdGhlIGhhc2ggXCIgKyB0aGlzLl9zdXBlci5uZXcuaGFzaCwgZGF0YTpbXX07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgaWYodGhpcy5fc3VwZXIubmV3Lmhhc2ggPT1cIlwiKXtcbiAgICAgICAgICAgIHJldHVybiB7bWVzc2FnZTogXCJZb3UgcmVtb3ZlZCB0aGUgaGFzaCBcIiArIHRoaXMuX3N1cGVyLm9sZC5oYXNoLCBkYXRhOltdfTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHttZXNzYWdlOiBcIllvdSBjaGFuZ2VkIHRoZSBoYXNoIGZyb20gXCIgKyB0aGlzLl9zdXBlci5vbGQuaGFzaCArIFwiIHRvIFwiICsgdGhpcy5fc3VwZXIubmV3Lmhhc2gsIGRhdGE6W119O1xuICAgICAgICAgIH1cblxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICB9XG4gIH1cbiAgZXhwb3J0IGNsYXNzIEVNTFdvcmtzcGFjZSB7XG5cbiAgICBzY29wZTogYW55O1xuICAgIGJ1ZmZlcjogYW55O1xuICAgIGxpbmtzVmlldzogc3RyaW5nO1xuICAgIHNvdXJjZUNvZGU6IHN0cmluZztcbiAgICB3b3JraW5nQ29kZTogc3RyaW5nO1xuICAgIG91dHB1dENvZGU6IHN0cmluZztcbiAgICBpbnRlbGxpZ2VuY2U6IGFueTtcbiAgICBvdmVycmlkZGVuSWRzOnN0cmluZ1tdO1xuICAgIGtleUJvYXJkU2hvcnRjdXRzOiBhbnlbXTtcbiAgICBtZXNzYWdlczogYW55W107XG4gICAgZmlsZU5hbWU6IHN0cmluZztcbiAgICBsaW5rRGF0YTogTGlua09iamVjdFtdO1xuICAgIF9kZWZhdWx0U0NvZGU6IHN0cmluZztcbiAgICBoZWFkZXI6IGFueTtcbiAgICBlcnJvcnM6IGFueTtcbiAgICBleHBvcnRGb3JFbG9xdWE6IHN0cmluZztcbiAgICBfX2VtbEhlYWRlcnM6IHN0cmluZztcbiAgICBfX2FsbG93YWJsZUhlYWRlckZpZWxkczogYW55O1xuICAgIGhlYWRlcnM6IHN0cmluZ1tdO1xuXG4gICAgY29uc3RydWN0b3IoaHRtbDogc3RyaW5nLCAkc2NvcGU6IGFueSl7XG4gICAgICB0aGlzLm92ZXJyaWRkZW5JZHMgPSBbXTtcbiAgICAgIGlmKCBodG1sID09PSB1bmRlZmluZWQpIGh0bWwgPSBcIlwiO1xuICAgICAgaWYoICRzY29wZSA9PT0gdW5kZWZpbmVkKSAkc2NvcGUgPSBcIlwiO1xuICAgICAgdmFyIFdvcmtzcGFjZSA9IHRoaXM7XG4gICAgICB0aGlzLmJ1ZmZlciA9IG51bGw7XG4gICAgICB0aGlzLnNjb3BlID0gJHNjb3BlO1xuICAgICAgdGhpcy5saW5rc1ZpZXcgPSAnZXhwZXJpbWVudGFsJzsgLy9hZHZhbmNlZCBzaG93cyBhbGxcbiAgICAgIHRoaXMuc291cmNlQ29kZSA9IGh0bWw7IC8vaW5pdGFsXG4gICAgICB0aGlzLndvcmtpbmdDb2RlID0gXCJcIjtcbiAgICAgIHRoaXMuZmlsZU5hbWUgPSBcImVtbC1tYWtlci11bnRpdGxlZFwiO1xuICAgICAgdGhpcy5saW5rRGF0YSA9IFtdO1xuICAgICAgdGhpcy5fZGVmYXVsdFNDb2RlID0gXCJzPWVtYWlsXCI7XG4gICAgICB0aGlzLmhlYWRlciA9IHtcInN1YmplY3RcIjpcIlwifTtcbiAgICAgIHRoaXMubWVzc2FnZXMgPSBbXTtcbiAgICAgIHRoaXMuZXhwb3J0Rm9yRWxvcXVhICA9IFwiWWVzXCI7XG5cbiAgICAgIHRoaXMuX19lbWxIZWFkZXJzID0gXCJcIjtcbiAgICAgIHRoaXMua2V5Qm9hcmRTaG9ydGN1dHMgPSBbXTtcbiAgICAgIHRoaXMuX19hbGxvd2FibGVIZWFkZXJGaWVsZHMgPSB7XG4gICAgICAgIFwidG9cIjoge3N5bnRheDpcIlRvOiBcIiwgbGFiZWw6XCJUb1wiLCBpbnN0cnVjdGlvbnM6IFwiQSBsaXN0IG9mIGVtYWlsIGFkZHJlc3NlcyBzZXBhcmF0ZWQgYnkgY29tbWFzLlwifSxcbiAgICAgICAgXCJzdWJqZWN0XCI6IHtzeW50YXg6IFwiU3ViamVjdDogXCIsIGxhYmVsOlwiU3ViamVjdFwiLCBpbnN0cnVjdGlvbnM6IFwiXCJ9LFxuICAgICAgICBcImNjXCIgOiB7c3ludGF4OlwiQ2M6IFwiLCBsYWJlbDpcIkNDXCIsIGluc3RydWN0aW9uczogXCJBIGxpc3Qgb2YgZW1haWwgYWRkcmVzc2VzIHNlcGFyYXRlZCBieSBjb21tYXMuXCJ9LFxuICAgICAgICBcInJlcGx5dG9cIjogeyBzeW50YXg6XCJSZXBseS10bzogXCIsIGxhYmVsOlwiUmVwbHkgdG9cIiwgaW5zdHJ1Y3Rpb25zOiBcIkEgbGlzdCBvZiBlbWFpbCBhZGRyZXNzZXMgc2VwYXJhdGVkIGJ5IGNvbW1hcy5cIn1cbiAgICAgIH07XG4gICAgICB0aGlzLmhlYWRlcnMgPSBbXG4gICAgICAgIFwiWC1VbnNlbnQ6IDFcIixcbiAgICAgICAgXCJNaW1lLVZlcnNpb246IDEuMCAoTWFjIE9TIFggTWFpbCAxMC4xIFxcKDMyNTFcXCkpXCIsXG4gICAgICAgIFwiWC1Vbmlmb3JtLVR5cGUtSWRlbnRpZmllcjogY29tLmFwcGxlLm1haWwtZHJhZnRcIixcbiAgICAgICAgXCJDb250ZW50LVRyYW5zZmVyLUVuY29kaW5nOiA3Yml0XCJcbiAgICAgIF07XG4gICAgICB0aGlzLmludGVsbGlnZW5jZSA9IEVNTEludGVsbGlnZW5jZS5tb2R1bGUoXCJlbWFpbFwiKS5tb25pdG9yKCk7XG4gICAgICB0aGlzLmludGVsbGlnZW5jZS5hc3NvY2lhdGVWYXJpYWJsZShcIkVNTFdvcmtzcGFjZVwiLCB0aGlzKTtcbiAgICB9XG4gICAgbWFwTGlua09iamVjdHMoY2FsbGJhY2spe1xuICAgICAgaWYodGhpcy5saW5rRGF0YS5sZW5ndGg+MCl7XG4gICAgICAgIGZvcih2YXIgaT0wOyBpPHRoaXMubGlua0RhdGEubGVuZ3RoOyBpKyspe1xuICAgICAgICAgIGNhbGxiYWNrKHRoaXMubGlua0RhdGFbaV0pO1xuICAgICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgY29tcG9zZUVNTCgpOnZvaWR7XG4gICAgICBsb2NhdGlvbi5ocmVmPSBcIiMvZXhwb3J0LWNvbXBvc2UtZW1sXCI7XG4gICAgfVxuXG4gICAgZG93bmxvYWRFbWwoKTp2b2lke1xuICAgICAgdGhpcy5iZWZvcmVEaWREb3dubG9hZEVtbCgpO1xuICAgICAgdmFyIG91dHB1dCA9IHRoaXMuX19lbWxIZWFkZXJzICsgXCJcXG5cXG5cIiArIHRoaXMuX19yZW1vdmVXaGl0ZVNwYWNlKHRoaXMuX19yZXBsYWNlRWxvcXVhTWVyZ2VGaWVsZHModGhpcy5nZW5lcmF0ZU91dHB1dENvZGUoXCJvZnRcIikpKTtcbiAgICAgIHRoaXMuZmlsZU5hbWUgPSB0aGlzLl9fZm9ybWF0RmlsZU5hbWUodGhpcy5maWxlTmFtZSk7XG4gICAgICB3aW5kb3cuc2F2ZUFzKG5ldyBCbG9iKFtvdXRwdXRdLCB7dHlwZTpcInRleHQvaHRtbFwifSksIHRoaXMuZmlsZU5hbWUrXCIuZW1sXCIpO1xuICAgICAgdGhpcy5hZnRlckRpZERvd25sb2FkRW1sKCk7XG4gICAgfVxuICAgIGJlZm9yZURpZERvd25sb2FkRW1sKCl7XG4gICAgICB0aGlzLm1hcExpbmtPYmplY3RzKGZ1bmN0aW9uKExpbmtPYmplY3Qpe1xuICAgICAgICBpZihMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuaGFzKFwiZWxxVHJhY2tcIikpe1xuICAgICAgICAgIGxldCBpbmRleCA9IExpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5lbnRyaWVzLmluZGV4T2YoXCJlbHFUcmFjaz10cnVlXCIpO1xuICAgICAgICAgIGlmKGluZGV4Pi0xKXtcbiAgICAgICAgICAgIExpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5kZWxldGVBdEluZGV4KGluZGV4KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYoIUxpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5oYXMoXCJzXCIpJiYgTGlua09iamVjdC5yZXF1aXJlc1NDb2RlKCkpe1xuICAgICAgICAgIExpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5hcHBlbmQoXCJzPW9mdFwiKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpZihMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuZ2V0KFwic1wiKT09XCJlbWFpbFwiKXtcbiAgICAgICAgICAgIExpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5zZXQoXCJzXCIsXCJvZnRcIik7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHRoaXMubWFwTGlua09iamVjdHMoZnVuY3Rpb24oTGlua09iamVjdCl7XG4gICAgICAgIExpbmtPYmplY3QuQ2hhbmdlTW9uaXRvci51cGRhdGUoKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICBhZnRlckRpZERvd25sb2FkRW1sKCl7XG4gICAgICB3aW5kb3cuZ2EoJ3NlbmQnLCAnZXZlbnQnLCBcIkVNTFwiLCBcImRvd25sb2FkXCIsIFwiRU1MIEV4cG9ydFwiKTtcbiAgICAgIGxvY2F0aW9uLmhyZWY9IFwiIy9leHBvcnQtZW1sXCI7XG4gICAgfVxuXG4gICAgZG93bmxvYWRDc3YoKTp2b2lke1xuICAgICAgdmFyIG91dHB1dCA9IFwiQ29udGV4dCxPcmlnaW5hbCBVUkwsTW9kaWZpZWQgVVJMXFxuXCI7XG4gICAgICB0aGlzLm1hcExpbmtPYmplY3RzKGZ1bmN0aW9uKExpbmtPYmplY3QpIHtcbiAgICAgICAgb3V0cHV0ICs9IExpbmtPYmplY3QuY29udGV4dC5yZXBsYWNlKC8sL2csIFwiKGNvbW1hKVwiKSArIFwiLFwiICsgTGlua09iamVjdC5vbGQudXJsICsgXCIsXCIgK0xpbmtPYmplY3QubmV3LnVybCArIFwiXFxuXCI7XG4gICAgICB9KTtcbiAgICAgIHRoaXMuZmlsZU5hbWUgPSB0aGlzLl9fZm9ybWF0RmlsZU5hbWUodGhpcy5maWxlTmFtZSk7XG4gICAgICB3aW5kb3cuc2F2ZUFzKG5ldyBCbG9iKFtvdXRwdXRdLCB7dHlwZTpcInRleHQvY3N2XCJ9KSwgdGhpcy5maWxlTmFtZStcIl9saW5rcy5jc3ZcIik7XG4gICAgICB3aW5kb3cuZ2EoJ3NlbmQnLCAnZXZlbnQnLCBcIkNTVlwiLCBcImRvd25sb2FkXCIsIFwiQ1NWIEV4cG9ydFwiKTtcbiAgICB9XG5cbiAgICBkb3dubG9hZEh0bWwoKTp2b2lke1xuICAgICAgdmFyIG91dHB1dCA9IHRoaXMuYmVmb3JlRGlkRG93bmxvYWRIdG1sKHRoaXMuZ2VuZXJhdGVPdXRwdXRDb2RlKFwiZW1haWxcIikpO1xuICAgICAgdGhpcy5maWxlTmFtZSA9IHRoaXMuX19mb3JtYXRGaWxlTmFtZSh0aGlzLmZpbGVOYW1lKTtcbiAgICAgIHdpbmRvdy5zYXZlQXMobmV3IEJsb2IoW291dHB1dF0sIHt0eXBlOlwidGV4dC9odG1sXCJ9KSwgdGhpcy5maWxlTmFtZStcIi5odG1sXCIpO1xuICAgICAgdGhpcy5hZnRlckRpZERvd25sb2FkSHRtbCgpO1xuICAgIH1cbiAgICBiZWZvcmVEaWREb3dubG9hZEh0bWwoY29kZSl7XG4gICAgICByZXR1cm4gY29kZTtcbiAgICB9XG4gICAgYWZ0ZXJEaWREb3dubG9hZEh0bWwoKXtcbiAgICAgIHdpbmRvdy5nYSgnc2VuZCcsICdldmVudCcsIFwiSFRNTFwiLCBcImRvd25sb2FkXCIsIFwiSFRNTCBFeHBvcnRcIik7XG4gICAgfVxuXG5cbiAgICBleHBvcnRDb2RlVG9IVE1MKCk6dm9pZHtcbiAgICAgIHRoaXMuYmVmb3JlRGlkRXhwb3J0Q29kZVRvSFRNTCgpO1xuICAgICAgdGhpcy5vdXRwdXRDb2RlID0gdGhpcy5nZW5lcmF0ZU91dHB1dENvZGUoXCJlbWFpbFwiKTtcbiAgICAgIHRoaXMuYWZ0ZXJEaWRFeHBvcnRDb2RlVG9IVE1MKCk7XG4gICAgfVxuICAgIGJlZm9yZURpZEV4cG9ydENvZGVUb0hUTUwoKXtcbiAgICAgIGxldCB0cmFja2luZ09wdE91dCA9IGZhbHNlO1xuICAgICAgaWYodGhpcy5leHBvcnRGb3JFbG9xdWEgJiYgdGhpcy5leHBvcnRGb3JFbG9xdWEgPT0gXCJZZXNcIikge1xuICAgICAgICB3aW5kb3cuZ2EoJ3NlbmQnLCAnZXZlbnQnLCBcIkhUTUxcIiwgXCJBZGQgRWxvcXVhIFRyYWNraW5nXCIsIFwiQWRkIEVsb3F1YSBUcmFja2luZ1wiKTtcbiAgICAgICAgdGhpcy5tYXBMaW5rT2JqZWN0cyhmdW5jdGlvbihMaW5rT2JqZWN0KXtcbiAgICAgICAgICB0cmFja2luZ09wdE91dCA9IExpbmtPYmplY3Qud2hpdGVMaXN0ZWRVcmwgPT0gTGlua09iamVjdC5uZXcudXJsO1xuICAgICAgICAgIGlmKCFMaW5rT2JqZWN0LmlzTGlua1R5cGUoXCJtYWlsdG9cIilcbiAgICAgICAgICAmJiAhTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLmhhcyhcImVscVRyYWNrXCIpXG4gICAgICAgICAgJiYgIS9hcHBcXC5pbmZvXFwub3B0dW1cXC5jb20vZ2kudGVzdChMaW5rT2JqZWN0Lm5ldy51cmwpKXtcbiAgICAgICAgICAgIExpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5hcHBlbmQoXCJlbHFUcmFjaz10cnVlXCIpO1xuXG4gICAgICAgICAgICBpZih0cmFja2luZ09wdE91dCkge1xuICAgICAgICAgICAgICBMaW5rT2JqZWN0LndoaXRlTGlzdGVkVXJsID0gTGlua09iamVjdC5uZXcudXJsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuXG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5tYXBMaW5rT2JqZWN0cyhmdW5jdGlvbihMaW5rT2JqZWN0KXtcbiAgICAgICAgICBpZihMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuaGFzKFwiZWxxVHJhY2tcIikpe1xuICAgICAgICAgICAgbGV0IGluZGV4ID0gTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLmVudHJpZXMuaW5kZXhPZihcImVscVRyYWNrPXRydWVcIik7XG4gICAgICAgICAgICBpZihpbmRleD4tMSl7XG4gICAgICAgICAgICAgIExpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5kZWxldGVBdEluZGV4KGluZGV4KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIExpbmtPYmplY3QuaXNMaW5rQ29tcGxldGUoKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgTGlua09iamVjdC5DaGFuZ2VNb25pdG9yLnVwZGF0ZSgpO1xuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgdGhpcy5tYXBMaW5rT2JqZWN0cyhmdW5jdGlvbihMaW5rT2JqZWN0KXtcbiAgICAgICAgaWYoIUxpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5oYXMoXCJzXCIpICYmIExpbmtPYmplY3QucmVxdWlyZXNTQ29kZSgpKXtcbiAgICAgICAgICBMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuYXBwZW5kKFwicz1lbWFpbFwiKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBpZihMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuaGFzKFwic1wiKSAmJiBMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuZ2V0KFwic1wiKT09XCJvZnRcIil7XG4gICAgICAgICAgICBMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuc2V0KFwic1wiLFwiZW1haWxcIik7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIExpbmtPYmplY3QuQ2hhbmdlTW9uaXRvci51cGRhdGUoKTtcbiAgICAgIH0pO1xuXG4gICAgICB0aGlzLm1hcExpbmtPYmplY3RzKGZ1bmN0aW9uKExpbmtPYmplY3Qpe1xuICAgICAgICBMaW5rT2JqZWN0LkNoYW5nZU1vbml0b3IudXBkYXRlKCk7XG4gICAgICB9KTtcblxuICAgIH1cbiAgICBhZnRlckRpZEV4cG9ydENvZGVUb0hUTUwoKXtcbiAgICAgIHRoaXMubWFwTGlua09iamVjdHMoZnVuY3Rpb24oTGlua09iamVjdCl7XG4gICAgICAgIGlmKExpbmtPYmplY3Qud2hpdGVMaXN0ZWRVcmw9PUxpbmtPYmplY3QubmV3LnVybCl7XG4gICAgICAgICAgLy9yZXBvcnQgdGhlIG5vbiB0cmFja2VkIGxpbms7XG4gICAgICAgICAgd2luZG93LmdhKCdzZW5kJywgJ2V2ZW50JywgXCJUcmFja2luZy1PcHRvdXRcIiwgXCJvdmVycmlkZVwiLCBMaW5rT2JqZWN0Lm5ldy51cmwpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHdpbmRvdy5nYSgnc2VuZCcsICdldmVudCcsIFwiSFRNTFwiLCBcInZpZXcgc291cmNlY29kZVwiLCBcIkV4cG9ydC9WaWV3IEhUTUxcIik7XG4gICAgICBsb2NhdGlvbi5ocmVmPSBcIiMvZXhwb3J0LWh0bWxcIjtcbiAgICB9XG5cblxuICAgIHNldFVwU2hvcnRjdXRLZXlzKCk6dm9pZHtcbiAgICAgIHZhciBfdGhpcz0gdGhpcztcbiAgICAgIHRoaXMua2V5Qm9hcmRTaG9ydGN1dHMgPSBbXTtcblxuICAgICAgX3RoaXMua2V5Qm9hcmRTaG9ydGN1dHMucHVzaChcbiAgICAgICAgbmV3IEtleWJvYXJkU2hvcnRjdXQoXG4gICAgICAgICAgZnVuY3Rpb24oZSl7IHJldHVybiAoZS5jdHJsS2V5fHxlLm1ldGFLZXkpICYmIGUuc2hpZnRLZXkgJiYgZS53aGljaCA9PSA1MjsgfSxcbiAgICAgICAgICBmdW5jdGlvbigpe1xuICAgICAgICAgICAgLy9kb3RoaXM7XG4gICAgICAgICAgICBfdGhpcy5zY29wZS4kYXBwbHkoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2Rvd25sb2FkaW5nIGZpbGUnKTtcbiAgICAgICAgICAgICAgX3RoaXMuZG93bmxvYWRIdG1sKCk7XG5cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJDVFJMICsgU0hJRlQgKyA0XCIsXG4gICAgICAgICAgXCJEb3dubG9hZCBIVE1MXCJcbiAgICAgICAgKVxuICAgICAgKTtcblxuICAgICAgX3RoaXMua2V5Qm9hcmRTaG9ydGN1dHMucHVzaChcbiAgICAgICAgbmV3IEtleWJvYXJkU2hvcnRjdXQoXG4gICAgICAgICAgZnVuY3Rpb24oZSl7IHJldHVybiAoZS5jdHJsS2V5fHxlLm1ldGFLZXkpICYmIGUuc2hpZnRLZXkgJiYgZS53aGljaCA9PSA1MTsgfSxcbiAgICAgICAgICBmdW5jdGlvbigpe1xuICAgICAgICAgICAgLy9kb3RoaXM7XG4gICAgICAgICAgICBfdGhpcy5zY29wZS4kYXBwbHkoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgX3RoaXMubWFwTGlua09iamVjdHMoZnVuY3Rpb24oTGlua09iamVjdCl7XG4gICAgICAgICAgICAgICAgaWYoTGlua09iamVjdC5lcnJvcnMubWVzc2FnZXMubGVuZ3RoPjApe1xuICAgICAgICAgICAgICAgICAgTGlua09iamVjdC5lcnJvcnMubWVzc2FnZXMuZm9yRWFjaChmdW5jdGlvbihNZXNzYWdlT2JqZWN0KXtcbiAgICAgICAgICAgICAgICAgICAgaWYoTWVzc2FnZU9iamVjdC50eXBlID09IEVycm9yVHlwZS5TdWdnZXN0aW9uKXtcbiAgICAgICAgICAgICAgICAgICAgICBNZXNzYWdlT2JqZWN0LmN0YUhhbmRsZXIoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICBMaW5rT2JqZWN0LmlzTGlua0NvbXBsZXRlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgXCJDVFJMICsgU0hJRlQgKyAzXCIsXG4gICAgICAgICAgXCJBcHBseSBhbGwgc3VnZ2VzdGlvbnNcIlxuICAgICAgICApXG4gICAgICApO1xuXG4gICAgICBfdGhpcy5rZXlCb2FyZFNob3J0Y3V0cy5wdXNoKFxuICAgICAgICBuZXcgS2V5Ym9hcmRTaG9ydGN1dChcbiAgICAgICAgICBmdW5jdGlvbihlKXsgcmV0dXJuIChlLmN0cmxLZXl8fGUubWV0YUtleSkgJiYgZS5zaGlmdEtleSAmJiBlLndoaWNoID09IDUwOyB9LFxuICAgICAgICAgIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAvL2RvdGhpcztcbiAgICAgICAgICAgIF90aGlzLnNjb3BlLiRhcHBseShmdW5jdGlvbigpe1xuICAgICAgICAgICAgICBfdGhpcy5tYXBMaW5rT2JqZWN0cyhmdW5jdGlvbihMaW5rT2JqZWN0KXtcbiAgICAgICAgICAgICAgICBpZighTGlua09iamVjdC5yZWFkT25seVxuICAgICAgICAgICAgICAgICAgJiYgTGlua09iamVjdC5yZXF1aXJlc1NDb2RlKClcbiAgICAgICAgICAgICAgICAmJiAhTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLmhhcygncycpKXtcbiAgICAgICAgICAgICAgICAgIExpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5hcHBlbmQoJ3M9ZW1haWwnKTtcbiAgICAgICAgICAgICAgICAgIExpbmtPYmplY3QuaXNMaW5rQ29tcGxldGUoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSxcbiAgICAgICAgICBcIkNUUkwgKyBTSElGVCArIDJcIixcbiAgICAgICAgICBcIkFkZCBzPWVtYWlsIHRvIGFsbCBsaW5rc1wiXG4gICAgICAgIClcbiAgICAgICk7XG5cbiAgICAgIF90aGlzLmtleUJvYXJkU2hvcnRjdXRzLnB1c2goXG4gICAgICAgIG5ldyBLZXlib2FyZFNob3J0Y3V0KFxuICAgICAgICAgIGZ1bmN0aW9uKGUpeyByZXR1cm4gKGUuY3RybEtleXx8ZS5tZXRhS2V5KSAmJiBlLnNoaWZ0S2V5ICYmIGUud2hpY2ggPT0gNDk7IH0sXG4gICAgICAgICAgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIC8vZG90aGlzO1xuICAgICAgICAgICAgX3RoaXMuc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgIF90aGlzLm1hcExpbmtPYmplY3RzKGZ1bmN0aW9uKExpbmtPYmplY3Qpe1xuICAgICAgICAgICAgICAgIGlmKExpbmtPYmplY3QucmVhZE9ubHkpIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgIExpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5kZWxldGUoXCJvXCIpO1xuICAgICAgICAgICAgICAgIExpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5kZWxldGUoXCJvaW5cIik7XG4gICAgICAgICAgICAgICAgTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLmRlbGV0ZShcInZcIik7XG4gICAgICAgICAgICAgICAgTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLmRlbGV0ZShcIm9pZXhcIik7XG4gICAgICAgICAgICAgICAgTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLmRlbGV0ZShcImVscV9taWRcIik7XG4gICAgICAgICAgICAgICAgTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLmRlbGV0ZShcImVscV9saWRcIik7XG4gICAgICAgICAgICAgICAgTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLmRlbGV0ZShcImVscVRyYWNrXCIpO1xuICAgICAgICAgICAgICAgIExpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5kZWxldGUoXCJlbHFUcmFja0lkXCIpO1xuICAgICAgICAgICAgICAgIExpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5kZWxldGUoXCJzXCIpO1xuICAgICAgICAgICAgICAgIExpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5kZWxldGUoXCJzM1wiKTtcblxuICAgICAgICAgICAgICAgIExpbmtPYmplY3QuaXNMaW5rQ29tcGxldGUoKTtcbiAgICAgICAgICAgICAgICBfdGhpcy5hcmVMaW5rc0NvbXBsZXRlKCk7XG4gICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIFwiQ1RSTCArIFNISUZUICsgMVwiLFxuICAgICAgICAgIFwiUmVtb3ZlIGFsbCBxdWVyeSBzdHJpbmdzIGZyb20gZW1haWxcIlxuICAgICAgICApXG4gICAgICApO1xuXG5cblxuICAgICAgZG9jdW1lbnQub25rZXl1cCA9IGZ1bmN0aW9uKGUpe1xuICAgICAgICBmb3IobGV0IHNob3J0Y3V0IG9mIF90aGlzLmtleUJvYXJkU2hvcnRjdXRzKXtcbiAgICAgICAgICBpZihzaG9ydGN1dC53aGVuICYmIHNob3J0Y3V0LndoZW4oZSkpe1xuICAgICAgICAgICAgc2hvcnRjdXQuZG9UaGlzKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9O1xuICAgIH1cbiAgICByZXBsYWNlU3BlY2lhbENoYXJhY3RlcnModGV4dCk6c3RyaW5ne1xuICAgICAgdmFyIHJlcGxhY2UgPSB7XG4gICAgICAgIDE3NDogW1wiJnJlZztcIl0sXG4gICAgICAgIDE2OTogW1wiJmNvcHk7XCJdLFxuICAgICAgICA4MjExIDogW1wiJm5kYXNoO1wiXSxcbiAgICAgICAgODIxMiA6IFtcIiZtZGFzaDtcIl0sXG4gICAgICAgIDgyMjAgOiBbXCImbGRxdW87XCJdLFxuICAgICAgICA4MjIxIDogW1wiJnJkcXVvO1wiXSxcbiAgICAgICAgODIxNiA6IFtcIiZsc3F1bztcIl0sXG4gICAgICAgIDgyMTcgOiBbXCImcnNxdW87XCJdLFxuICAgICAgICA4NDgyIDogW1wiJnRyYWRlO1wiXVxuICAgICAgfTtcbiAgICAgIGZvcihsZXQgaSBpbiByZXBsYWNlKXtcbiAgICAgICAgaWYocmVwbGFjZS5oYXNPd25Qcm9wZXJ0eShpKSl7XG4gICAgICAgICAgdmFyIHJlZ2V4cCA9IG5ldyBSZWdFeHAoU3RyaW5nLmZyb21DaGFyQ29kZShwYXJzZUludChpKSksXCJnXCIpO1xuICAgICAgICAgIGlmKHJlZ2V4cC50ZXN0KHRleHQpKXtcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwiZm91bmQgY2hhcmFjdGVyXCIgKyBTdHJpbmcuZnJvbUNoYXJDb2RlKHBhcnNlSW50KGkpKSk7XG4gICAgICAgICAgICB0ZXh0ID0gdGV4dC5yZXBsYWNlKHJlZ2V4cCwgcmVwbGFjZVtpXVswXSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gdGV4dDtcbiAgICB9XG4gICAgcHJvY2Vzc0h0bWwoKTp2b2lke1xuICAgICAgLy9jcmVhdGVzIGEgbmV3IHdvcmtzcGFjZSBmcm9tIGh0bWxcbiAgICAgIHRoaXMuc2V0VXBTaG9ydGN1dEtleXMoKTtcbiAgICAgIHRoaXMubGlua0RhdGEgPSBbXTtcbiAgICAgIHRoaXMuaW50ZWxsaWdlbmNlLm92ZXJyaWRkZW4gPSBbXTtcbiAgICAgIHRoaXMuaW50ZWxsaWdlbmNlLmV2YWx1YXRlUnVsZXMoKTtcbiAgICAgIHdpbmRvdy5zY3JvbGxUbygwLDApO1xuICAgICAgLy8gLnJlcGxhY2UobmV3IFJlZ0V4cChcIjwvYT5cIixcImlnXCIpLCBcIjwvYT5cXG5cIilcbiAgICAgIHRoaXMud29ya2luZ0NvZGUgPSB0aGlzLnJlcGxhY2VTcGVjaWFsQ2hhcmFjdGVycyh0aGlzLnNvdXJjZUNvZGUpO1xuICAgICAgLy9kZXRlcm1pbmUgZW1haWwgaGVhZGVyc1xuICAgICAgdGhpcy5fX2VtbEhlYWRlcnMgPSB0aGlzLl9fYnVpbGRIZWFkZXJzKCk7XG4gICAgICAvLyAgICRzY29wZS5kYXRhLmhlYWRlcixcbiAgICAgIC8vICAgJHNjb3BlLmRhdGEuYWxsb3dhYmxlSGVhZGVyRmllbGRzKTtcblxuICAgICAgLy9yZXBsYWNlIG1lcmdlIGZpZWxkc1xuICAgICAgaWYodGhpcy5maWxlTmFtZT09XCJ1bnRpdGxlZFwiKXtcbiAgICAgICAgdmFyIHRpdGxlUmVnID0gLzx0aXRsZT4oW148XS4qPyk8XFwvdGl0bGU+L2dpO1xuICAgICAgICBpZih0aXRsZVJlZy50ZXN0KHRoaXMud29ya2luZ0NvZGUpKXtcbiAgICAgICAgICB2YXIgdGl0bGVUYWcgPSB0aGlzLndvcmtpbmdDb2RlLm1hdGNoKHRpdGxlUmVnKTtcbiAgICAgICAgICBpZih0aXRsZVRhZy5sZW5ndGg+MCl7XG4gICAgICAgICAgICB0aGlzLmZpbGVOYW1lID0gdGhpcy5fX2Zvcm1hdEZpbGVOYW1lKHRpdGxlVGFnWzBdLnJlcGxhY2UodGl0bGVSZWcsIFwiJDFcIikpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgdmFyIF9zdXBlciA9IHRoaXM7XG4gICAgICB2YXIgcmUxID0gLzxhXFxiW14+XSo/PihbXFxyXFxuXXwuKSo/PFxcL2E+L2dtLCBuID0gMDtcbiAgICAgIHRoaXMud29ya2luZ0NvZGUgPSB0aGlzLndvcmtpbmdDb2RlLnJlcGxhY2UocmUxLCBmdW5jdGlvbihmb3VuZCl7XG4gICAgICAgIG4rKzsgcmV0dXJuIGZvdW5kLnJlcGxhY2UoXCI8YVwiLCBcIjxhIGVtbC1pZD1cXFwiXCIrbitcIlxcXCJcIik7XG4gICAgICB9KTtcblxuICAgICAgbiA9IDA7XG4gICAgICB0aGlzLndvcmtpbmdDb2RlID0gdGhpcy53b3JraW5nQ29kZS5yZXBsYWNlKHJlMSwgZnVuY3Rpb24oY29udGV4dCl7XG4gICAgICAgIG4rKztcbiAgICAgICAgLy9nZXQgbGluZVxuICAgICAgICB2YXIgbGluZSA9IF9zdXBlci53b3JraW5nQ29kZS5zdWJzdHIoMCwgX3N1cGVyLndvcmtpbmdDb2RlLmluZGV4T2YoY29udGV4dCkpLnNwbGl0KFwiXFxuXCIpLmxlbmd0aC0xO1xuXG4gICAgICAgIGlmKC8oaHJlZlxcPVxcXCIoW15cXFwiXFw+XSopXFxcIj8pL2cudGVzdChjb250ZXh0KSl7XG4gICAgICAgICAgbisrO1xuICAgICAgICAgIHZhciBhID0gbmV3IExpbmtPYmplY3QobGluZSwgY29udGV4dCwgX3N1cGVyKTtcbiAgICAgICAgICBhLmlkID0gbjtcbiAgICAgICAgICBhLnJlYWRPbmx5ID0gKGEubmV3LmNvbnRhaW5zKFwiLmNvbS9lL2VzLmFzcHhcIikgJiYgYS5uZXcuY29udGFpbnMoXCJ+fmVsb3F1YVwiKSk7XG4gICAgICAgICAgX3N1cGVyLmxpbmtEYXRhLnB1c2goYSk7XG4gICAgICAgICAgcmV0dXJuIFwie3tFTUxNYWtlcl9MaW5rOlwiK24rXCJ9fVwiO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiBjb250ZXh0O1xuICAgICAgICB9XG5cbiAgICAgIH0pO1xuXG5cbiAgICAgIHRoaXMubWFwTGlua09iamVjdHMoZnVuY3Rpb24oTGlua09iamVjdCl7XG4gICAgICAgIExpbmtPYmplY3QuaXNMaW5rQ29tcGxldGUoKTtcbiAgICAgIH0pO1xuXG5cbiAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMuaW50ZWxsaWdlbmNlKTtcbiAgICAgIC8vcmVkaXJlY3RcblxuICAgICAgbG9jYXRpb24uaHJlZj1cIiMvbGlua3NcIjtcbiAgICB9XG4gICAgYWRkTmV3SGVhZGVyRmllbGQodmFsdWUpe1xuICAgICAgdGhpcy5oZWFkZXJbdmFsdWVdID0gXCJcIjtcbiAgICB9XG4gICAgcmVtb3ZlSGVhZGVyRmllbGQodmFsdWUpe1xuICAgICAgZGVsZXRlIHRoaXMuaGVhZGVyW3ZhbHVlXTtcbiAgICB9XG4gICAgaXNIZWFkZXJTZWxlY3RlZChoZWFkZXIpOmJvb2xlYW57XG4gICAgICBpZighdGhpcy5oZWFkZXIuaGFzT3duUHJvcGVydHkoaGVhZGVyKSB8fCB0aGlzLmhlYWRlcj09XCJcIiAgKSB7IHJldHVybiB0cnVlOyB9XG4gICAgICBlbHNlIHsgcmV0dXJuIGZhbHNlOyB9XG4gICAgfVxuICAgIHZlcmlmeUxpbmtTZWN0aW9uQ29tcGxldGUoKTpib29sZWFue1xuICAgICAgdmFyIG91dHB1dCA9IGZhbHNlO1xuXG4gICAgICBpZih0aGlzLmludGVsbGlnZW5jZSAmJiAhdGhpcy5pbnRlbGxpZ2VuY2UuY2FuQ29udGludWUpe1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgLy8gYXJlIHRoZXJlIGxpbmsgaXNzdWVzP1xuICAgICAgaWYgKHRoaXMubGlua0RhdGEgJiYgdGhpcy5saW5rRGF0YS5sZW5ndGggPT0gMCkge1xuICAgICAgICBvdXRwdXQgPSBmYWxzZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmICh0aGlzLmFyZUxpbmtzQ29tcGxldGUoKSkge1xuICAgICAgICAgIG91dHB1dCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgb3V0cHV0ID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgfVxuXG5cbiAgICBnZW5lcmF0ZU91dHB1dENvZGUodHlwZT8sIGNsb25lPyk6c3RyaW5ne1xuICAgICAgaWYodHlwZSA9PT0gdW5kZWZpbmVkKSB0eXBlID0gXCJlbWFpbFwiO1xuICAgICAgaWYoY2xvbmUgPT09IHVuZGVmaW5lZCkgY2xvbmUgPSB0cnVlO1xuICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgIHZhciBvdXRwdXQ6c3RyaW5nID0gdGhpcy53b3JraW5nQ29kZTtcblxuICAgICAgLy9wb3N0IHByb2Nlc3NpbmcuXG4gICAgICAvL2RvIHBvc3QgcHJvY2Vzc2luZy5cbiAgICAgIC8vZXhwb3J0IGNvZGU/XG4gICAgICB0aGlzLm1hcExpbmtPYmplY3RzKGZ1bmN0aW9uKExpbmtPYmplY3Qpe1xuXG4gICAgICAgIGlmKExpbmtPYmplY3QuaGFzT3duUHJvcGVydHkoXCJkZWxldGVPblJlbmRlclwiKSYmTGlua09iamVjdC5kZWxldGVPblJlbmRlcil7XG4gICAgICAgICAgb3V0cHV0ID0gb3V0cHV0LnJlcGxhY2UobmV3IFJlZ0V4cChcInt7RU1MTWFrZXJfTGluazpcIitMaW5rT2JqZWN0LmlkK1wifX1cIiwgXCJnaVwiKSwgXCJcIik7XG4gICAgICAgIH0gZWxzZSBpZihMaW5rT2JqZWN0LnJlYWRPbmx5KSB7XG4gICAgICAgICAgbGV0IHJlYWRPbmx5VXJsID0gTGlua09iamVjdC5jb250ZXh0LnJlcGxhY2UoL2VtbFxcLWlkXFw9XFxcIlswLTldezEsfVxcXCJcXHMvZyxcIlwiKTtcbiAgICAgICAgICBvdXRwdXQgPSBvdXRwdXQucmVwbGFjZShuZXcgUmVnRXhwKFwie3tFTUxNYWtlcl9MaW5rOlwiK0xpbmtPYmplY3QuaWQrXCJ9fVwiLCBcImdpXCIpLCByZWFkT25seVVybCk7XG4gICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICB2YXIgc3RhcnQgPSBMaW5rT2JqZWN0LmNvbnRleHQuaW5kZXhPZihcImhyZWY9XFxcIlwiICsgTGlua09iamVjdC5vbGQudXJsKTtcbiAgICAgICAgICAvLyBjb2RlTGluZXNbbGluZV0gPSBjb2RlTGluZXNbbGluZV0uc3Vic3RyKDAsIHN0YXJ0KSArIFwiaHJlZj1cXFwiXCIgKyBMaW5rT2JqZWN0Lm5ldy51cmwgKyBjb2RlTGluZXNbbGluZV0uc3Vic3RyKHN0YXJ0KzYrTGlua09iamVjdC5vbGQudXJsLmxlbmd0aCwgY29kZUxpbmVzW2xpbmVdLmxlbmd0aCk7XG4gICAgICAgICAgLy90aGlzIGlzIHdoZXJlIHdlIHVwZGF0ZSB0aGUgY29udGV4dDtcbiAgICAgICAgICB2YXIgbmV3Q29udGV4dCA9IExpbmtPYmplY3QuY29udGV4dDtcbiAgICAgICAgICBuZXdDb250ZXh0ID0gbmV3Q29udGV4dC5zdWJzdHIoMCxzdGFydCkgKyBcImhyZWY9XFxcIlwiICsgTGlua09iamVjdC5uZXcudXJsICsgbmV3Q29udGV4dC5zdWJzdHIoc3RhcnQrNitMaW5rT2JqZWN0Lm9sZC51cmwubGVuZ3RoLCBuZXdDb250ZXh0Lmxlbmd0aCk7XG4gICAgICAgICAgaWYoTGlua09iamVjdC5MaW5rZWRJbWFnZSl7XG4gICAgICAgICAgICBuZXdDb250ZXh0ID0gTGlua09iamVjdC5MaW5rZWRJbWFnZS5nZW5lcmF0ZU91dHB1dChuZXdDb250ZXh0KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgbmV3Q29udGV4dCA9IG5ld0NvbnRleHQucmVwbGFjZSgvXFxzP2VtbFxcLWlkXFw9XFxcIlswLTldKlxcXCIvZyxcIlwiKTtcbiAgICAgICAgICAvL3RoZW4gdXBkYXRlIHRoZSB3b3JraW5nIGNvZGUgd2l0aCB0aGUgbmV3IGNvbnRleHQ7XG4gICAgICAgICAgb3V0cHV0ID0gb3V0cHV0LnJlcGxhY2UobmV3IFJlZ0V4cChcInt7RU1MTWFrZXJfTGluazpcIitMaW5rT2JqZWN0LmlkK1wifX1cIiwgXCJnaVwiKSwgbmV3Q29udGV4dCk7XG4gICAgICAgIH1cblxuICAgICAgfSk7XG5cbiAgICAgIC8vZmluZCBhbGwgaW1hZ2VzIHdpdGhvdXQgYWx0IGF0dHJpYnV0ZSBhbmQgYWRkIGFsdD1cIlwiO1xuICAgICAgb3V0cHV0ID0gb3V0cHV0LnJlcGxhY2UoL1xcPGltZ1teXFw+XS4qP1xcPi9naSwgZnVuY3Rpb24oZm91bmQpe1xuICAgICAgICBpZihmb3VuZC5pbmRleE9mKFwiYWx0PVwiKT4tMSl7XG4gICAgICAgICAgcmV0dXJuIGZvdW5kO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiBmb3VuZC5yZXBsYWNlKC9cXDxpbWcvZ2ksIFwiPGltZyBhbHQ9XFxcIlxcXCJcIik7XG4gICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgIHRyeSB7XG4gICAgICAgIG91dHB1dCA9IG91dHB1dC5yZXBsYWNlKC88XFwvYT5cXG57MCw1fShcXC58LHxcXD98IXw6fDt8XFx8KS9nLCBcIjwvYT4kMVwiKTtcbiAgICAgIH0gY2F0Y2goZSl7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiZXJyb3IgbWVyZ2luZyBsaW5lcyB3aXRoIGxpbmtzIHRoYXQgcHJldmlvdXNseSBoYWQgcHVuY3R1YXRpb24uXCIpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICB9XG4gICAgdXBkYXRlTGlua3NBbmRFeHBvcnQoKTpib29sZWFue1xuICAgICAgaWYoIXRoaXMuYXJlTGlua3NDb21wbGV0ZSgpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cblxuXG4gICAgICBsb2NhdGlvbi5ocmVmPVwiIy9leHBvcnRcIjtcbiAgICAgIHdpbmRvdy5zY3JvbGxUbygwLDApO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIGFyZUxpbmtzQ29tcGxldGUoKTpib29sZWFue1xuICAgICAgdmFyIG91dHB1dCA9IHRydWU7XG5cbiAgICAgIHRoaXMubWFwTGlua09iamVjdHMoZnVuY3Rpb24oTGlua09iamVjdCl7XG5cbiAgICAgICAgaWYoIUxpbmtPYmplY3QuX19pc0NvbXBsZXRlKXtcbiAgICAgICAgICBvdXRwdXQgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZihMaW5rT2JqZWN0Lm5lZWRzVHJhY2tpbmdDb2RlKCkpe1xuICAgICAgICAgIG91dHB1dCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICB9XG4gICAgZ2V0TGlua3NTdW1tYXJ5KCk6YW55e1xuICAgICAgdmFyIGRhdGEgPSB7XG4gICAgICAgIG5lZWRzVHJhY2tpbmc6IDAsXG4gICAgICAgIGludmFsaWRVcmw6IDBcbiAgICAgIH07XG4gICAgICB0aGlzLm1hcExpbmtPYmplY3RzKGZ1bmN0aW9uKExpbmtPYmplY3Qpe1xuICAgICAgICBpZihMaW5rT2JqZWN0Lm5lZWRzVHJhY2tpbmdDb2RlKCkpIGRhdGEubmVlZHNUcmFja2luZysrO1xuICAgICAgICBpZihMaW5rT2JqZWN0LmlzTGlua0NvbXBsZXRlKCkpIGRhdGEuaW52YWxpZFVybCsrO1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gZGF0YTtcbiAgICB9XG4gICAgaW1wb3J0SHRtbEZyb21GaWxlRHJvcChldnQpOnZvaWR7XG4gICAgICBpZih0aGlzLnNvdXJjZUNvZGUubGVuZ3RoPjApIHsgdGhpcy5zb3VyY2VDb2RlID0gXCJcIjsgfVxuICAgICAgdmFyIGZpbGVzID0gZXZ0LmRhdGFUcmFuc2Zlci5maWxlcztcbiAgICAgIGlmKGV2dC5kYXRhVHJhbnNmZXIuZmlsZXMubGVuZ3RoPjEpe1xuICAgICAgICBhbGVydCgneW91IGNhbiBvbmx5IGltcG9ydCBvbmUgZmlsZSBhdCBhdCB0aW1lLicpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XG4gICAgICAgIHZhciBXUyA9IHRoaXM7XG4gICAgICAgIHJlYWRlci5vbmxvYWRlbmQgPSBmdW5jdGlvbihldnQpe1xuICAgICAgICAgIHZhciBkcm9wVGV4dCA9IGV2dC50YXJnZXQucmVzdWx0O1xuXG4gICAgICAgICAgdmFyIG5hbWVQYXJ0cyA9IGZpbGVzWzBdLm5hbWUuc3BsaXQoXCIuXCIpO1xuICAgICAgICAgIHZhciBleHQgPSBuYW1lUGFydHMucG9wKCkudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICBXUy5maWxlTmFtZSA9IFdTLl9fZm9ybWF0RmlsZU5hbWUobmFtZVBhcnRzLmpvaW4oXCIuXCIpKTtcblxuICAgICAgICAgIGlmKGV4dD09J2VtbCcpe1xuICAgICAgICAgICAgV1Muc291cmNlQ29kZSA9IFdTLl9fc3RyaXBIdG1sQW5kU3ViamVjdEZyb21FTUwoZHJvcFRleHQpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBXUy5zb3VyY2VDb2RlID0gZHJvcFRleHQ7XG4gICAgICAgICAgfVxuICAgICAgICAgIFdTLnByb2Nlc3NIdG1sKCk7XG4gICAgICAgICAgLy8gV1MuaW50ZWxsaWdlbmNlID0gRU1MTWFrZXJBSUVuZ2luZS5DaGVja0VtYWlsKFdTKTtcbiAgICAgICAgICBsb2NhdGlvbi5ocmVmID0gXCIjL2xpbmtzXCI7XG4gICAgICAgIH07XG4gICAgICAgIHJlYWRlci5yZWFkQXNUZXh0KGZpbGVzWzBdKTtcbiAgICAgICAgd2luZG93LmdhKCdzZW5kJywgJ2V2ZW50JywgXCJIVE1MXCIsIFwiaW1wb3J0XCIsIFwiSFRNTCBJbXBvcnQgRmlsZSBEcm9wXCIpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHNldCBkZWZhdWx0U0NvZGUobmV3VmFsdWUpe1xuICAgICAgbGV0IG9sZCA9dGhpcy5fZGVmYXVsdFNDb2RlO1xuXG4gICAgICBpZihvbGQhPT1uZXdWYWx1ZSl7XG4gICAgICAgIHRoaXMuX2RlZmF1bHRTQ29kZSA9IG5ld1ZhbHVlO1xuICAgICAgICB0aGlzLm1hcExpbmtPYmplY3RzKGZ1bmN0aW9uKExpbmtPYmplY3Qpe1xuICAgICAgICAgIExpbmtPYmplY3QuaXNMaW5rQ29tcGxldGUoKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG5cbiAgICB9XG5cblxuICAgIF9fZm9ybWF0RmlsZU5hbWUobmFtZSk6c3RyaW5nIHtcbiAgICAgIGxldCBfc2x1Z2lmeV9zdHJpcF9yZSA9IC9bXlxcd1xccy1dL2c7XG4gICAgICBsZXQgX3NsdWdpZnlfaHlwaGVuYXRlX3JlID0gL1stXFxzXSsvZztcbiAgICAgIG5hbWUgPSBuYW1lLnJlcGxhY2UoX3NsdWdpZnlfc3RyaXBfcmUsICcnKS50cmltKCkudG9Mb3dlckNhc2UoKTtcbiAgICAgIG5hbWUgPSBuYW1lLnJlcGxhY2UoX3NsdWdpZnlfaHlwaGVuYXRlX3JlLCAnLScpO1xuICAgICAgcmV0dXJuIG5hbWU7XG4gICAgfVxuICAgIF9fcmVwbGFjZUVsb3F1YU1lcmdlRmllbGRzKGNvbnRlbnQpOnN0cmluZ3tcbiAgICAgIHZhciByZTQgPSAvPHNwYW4oJTIwfFxccyljbGFzcz1cIj9lbG9xdWFlbWFpbFwiP1xccz8+KC4qPyk8XFwvc3Bhbj4vaWc7XG4gICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKHJlNCwgXCIjJDIjXCIpO1xuICAgICAgcmV0dXJuIGNvbnRlbnQ7XG4gICAgfVxuICAgIF9fc3RyaXBIdG1sQW5kU3ViamVjdEZyb21FTUwoY29kZSk6c3RyaW5ne1xuICAgICAgdmFyIG91dHB1dCA9IGNvZGUuc3BsaXQoXCJcXG5cIik7XG4gICAgICB2YXIgaHRtbCA9IG91dHB1dC5wb3AoKTtcblxuICAgICAgZm9yKHZhciBpID0wOyBpPCBvdXRwdXQubGVuZ3RoOyBpKyspe1xuXG4gICAgICAgIGlmKG91dHB1dFtpXS5pbmRleE9mKFwiU3ViamVjdDpcIik+LTEpe1xuICAgICAgICAgIGlmKHRoaXMuaGVhZGVyID09PSB1bmRlZmluZWQpIHRoaXMuaGVhZGVyID0ge307XG5cbiAgICAgICAgICAvLyAkc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgLy8gICAgIHRoaXMuaGVhZGVyW1wic3ViamVjdFwiXSA9ICBvdXRwdXRbaV0uc3Vic3RyKDgsb3V0cHV0W2ldLmxlbmd0aCkudHJpbSgpO1xuICAgICAgICAgIC8vIH0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gaHRtbDtcbiAgICB9XG4gICAgX19yZW1vdmVXaGl0ZVNwYWNlKGNvZGUpOnN0cmluZyB7XG4gICAgICB2YXIgb3V0cHV0ID0gY29kZTtcbiAgICAgIG91dHB1dCA9IG91dHB1dC5yZXBsYWNlKG5ldyBSZWdFeHAoXCJcXG5cIiwgXCJnXCIpLCBcIiBcIik7XG4gICAgICBvdXRwdXQgPSBvdXRwdXQucmVwbGFjZShuZXcgUmVnRXhwKFwiXFx0XCIsIFwiZ1wiKSwgXCIgXCIpO1xuICAgICAgb3V0cHV0ID0gb3V0cHV0LnJlcGxhY2UoL1xcc3syLDk5OTk5fS9nLCBcIiBcIik7XG4gICAgICByZXR1cm4gb3V0cHV0O1xuICAgIH1cbiAgICBfX2J1aWxkSGVhZGVycygpOnN0cmluZ3tcbiAgICAgIHZhciBoZWFkZXJzOnN0cmluZ1tdID0gW107XG4gICAgICBmb3IodmFyIGk9MDsgaTx0aGlzLmhlYWRlcnMubGVuZ3RoOyBpKyspeyBoZWFkZXJzLnB1c2godGhpcy5oZWFkZXJzW2ldKTsgfVxuICAgICAgdmFyIGNoYXJzZXQgPSB0aGlzLl9fZ2V0Q2hhcnNldEZyb21IVE1MKHRoaXMuc291cmNlQ29kZSk7XG4gICAgICBpZihjaGFyc2V0ID09IFwiXCIpIGNoYXJzZXQgPSBcImNoYXJzZXQ9VVRGLThcIjtcbiAgICAgIGhlYWRlcnMucHVzaChcIkNvbnRlbnQtVHlwZTogdGV4dC9odG1sO1xcblxcdFwiICsgY2hhcnNldCk7XG5cbiAgICAgIC8vIGNvbnNvbGUubG9nKGhlYWRlcnMsIGFsbG93YWJsZUhlYWRlckZpZWxkcyk7XG4gICAgICBmb3IobGV0IGkgaW4gdGhpcy5oZWFkZXIpe1xuICAgICAgICBpZih0aGlzLmhlYWRlci5oYXNPd25Qcm9wZXJ0eShpKSl7XG4gICAgICAgICAgaWYodGhpcy5fX2FsbG93YWJsZUhlYWRlckZpZWxkcy5oYXNPd25Qcm9wZXJ0eShpKSl7XG4gICAgICAgICAgICBoZWFkZXJzLnB1c2goXG4gICAgICAgICAgICAgIHRoaXMuX19hbGxvd2FibGVIZWFkZXJGaWVsZHNbaV0uc3ludGF4ICsgXCIgXCIgKyB0aGlzLmhlYWRlcltpXVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHRoaXMuX19lbWxIZWFkZXJzID0gaGVhZGVycy5qb2luKFwiXFxuXCIpO1xuICAgICAgcmV0dXJuIGhlYWRlcnMuam9pbihcIlxcblwiKTtcbiAgICB9XG4gICAgX19nZXRDaGFyc2V0RnJvbUhUTUwoY29udGVudCk6c3RyaW5ne1xuICAgICAgdmFyIHJlNSA9IC88bWV0YS4qP2NoYXJzZXQ9KFteXFxzXCJdKikvaWcsIGNoYXJzZXQgPVwiXCI7XG5cbiAgICAgIHZhciBtZXRhVGFncyA9IGNvbnRlbnQubWF0Y2gocmU1KTtcbiAgICAgIGlmKG1ldGFUYWdzKXtcbiAgICAgICAgbWV0YVRhZ3MuZm9yRWFjaChmdW5jdGlvbihpdGVtKXtcbiAgICAgICAgICB2YXIgY2hhcnNldFZhbHMgPSBpdGVtLm1hdGNoKC9jaGFyc2V0PShbXlxcc1wiXSopL2lnKTtcbiAgICAgICAgICBpZihjaGFyc2V0VmFscyl7XG4gICAgICAgICAgICBjaGFyc2V0ID0gY2hhcnNldFZhbHNbMF07XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNoYXJzZXQgPSBcImNoYXJzZXQ9VVRGLThcIjtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gY2hhcnNldDtcbiAgICB9XG5cbiAgfVxuXG5cbiAgZXhwb3J0IGNsYXNzIEtleWJvYXJkU2hvcnRjdXQge1xuXG4gICAgd2hlbiA6ICgpPT5ib29sZWFuO1xuICAgIGRvVGhpcyA6ICgpPT52b2lkO1xuICAgIGRlc2NyaXB0aW9uOiBzdHJpbmc7XG4gICAga2V5czogc3RyaW5nO1xuXG4gICAgY29uc3RydWN0b3Iod2hlbiwgZG9UaGlzLCBrZXlzLCBkZXNjcmlwdGlvbil7XG5cbiAgICAgIHRoaXMud2hlbiA9IHdoZW47XG4gICAgICB0aGlzLmRvVGhpcyA9IGRvVGhpcztcbiAgICAgIHRoaXMua2V5cyA9IGtleXM7XG4gICAgICB0aGlzLmRlc2NyaXB0aW9uID0gZGVzY3JpcHRpb247XG4gICAgfVxuICB9XG5cblxufVxuIiwidmFyIEVycm9yU2V2ZXJpdHk7XG4oZnVuY3Rpb24gKEVycm9yU2V2ZXJpdHkpIHtcbiAgICBFcnJvclNldmVyaXR5W0Vycm9yU2V2ZXJpdHlbXCJIaWdoXCJdID0gMV0gPSBcIkhpZ2hcIjtcbiAgICBFcnJvclNldmVyaXR5W0Vycm9yU2V2ZXJpdHlbXCJNZWRpdW1cIl0gPSAyXSA9IFwiTWVkaXVtXCI7XG4gICAgRXJyb3JTZXZlcml0eVtFcnJvclNldmVyaXR5W1wiTG93XCJdID0gM10gPSBcIkxvd1wiO1xuICAgIEVycm9yU2V2ZXJpdHlbRXJyb3JTZXZlcml0eVtcIlplcm9cIl0gPSA0XSA9IFwiWmVyb1wiO1xufSkoRXJyb3JTZXZlcml0eSB8fCAoRXJyb3JTZXZlcml0eSA9IHt9KSk7XG52YXIgRXJyb3JUeXBlO1xuKGZ1bmN0aW9uIChFcnJvclR5cGUpIHtcbiAgICBFcnJvclR5cGVbRXJyb3JUeXBlW1wiRml4XCJdID0gMV0gPSBcIkZpeFwiO1xuICAgIEVycm9yVHlwZVtFcnJvclR5cGVbXCJXYXJuXCJdID0gMl0gPSBcIldhcm5cIjtcbiAgICBFcnJvclR5cGVbRXJyb3JUeXBlW1wiU3VnZ2VzdGlvblwiXSA9IDNdID0gXCJTdWdnZXN0aW9uXCI7XG4gICAgRXJyb3JUeXBlW0Vycm9yVHlwZVtcIlFBXCJdID0gNF0gPSBcIlFBXCI7XG4gICAgRXJyb3JUeXBlW0Vycm9yVHlwZVtcIkJlc3RQcmFjdGljZVwiXSA9IDVdID0gXCJCZXN0UHJhY3RpY2VcIjtcbn0pKEVycm9yVHlwZSB8fCAoRXJyb3JUeXBlID0ge30pKTtcbnZhciBHbG9iYWxWYXJzO1xuKGZ1bmN0aW9uIChHbG9iYWxWYXJzKSB7XG4gICAgR2xvYmFsVmFycy5sYW5kaW5nUGFnZVByZWZlcnJlZCA9IC8oXFwubXA0fFxcLmF2aXxcXC5tcGVnfFxcLm1wM3xcXC5zd2Z8XFwubW92fFxcLnBkZikvaTtcbiAgICBHbG9iYWxWYXJzLmV4dERvZXNOb3RyZXF1aXJlVHJhY2tpbmdDb2RlID0gLyhcXC5wZGZ8XFwub2Z0fFxcLmljc3xcXC5wbmd8XFwuanBlZ3xcXC5qcGcpL2k7XG4gICAgR2xvYmFsVmFycy5saW5rRW5jYXBzdWxhdGVkUHVuY3R1YXRpb24gPSAvKFtcXC5cXD9cXCxcXDpcXCpdKykoKFxcbnxcXHJ8XFxzKSspPzxcXC9hPiQvO1xuICAgIEdsb2JhbFZhcnMuUmVxdWlyZXNTQ29kZVJlZ2V4ID0gL2h0dHAoLiopb3B0dW0oLiopXFwvKGNhbXBhaWdufHJlc291cmNlKS9pO1xuICAgIEdsb2JhbFZhcnMuUmVxdWlyZXNUcmFja2luZ0NvZGVSZWdleCA9IFJlZ0V4cChcIl5odHRwKHMpPzpcXC9cXC8oLio/KT9vcHR1bSguKj8pP1xcLmNvW21cXC5dP1wiKTtcbiAgICBHbG9iYWxWYXJzLlRlbGVwaG9uZVJlZ2V4ID0gLyhcXCs/XFxkezEsMn0oXFxzfC18XFwuKSk/XFwoP1xcZHszfVxcKT9bXFxzLi1dXFxkezMsfVtcXHMuLV1cXGR7NCx9LztcbiAgICBHbG9iYWxWYXJzLlRlbGVwaG9uZVJlZ2V4R2xvYmFsID0gLyhcXCs/XFxkezEsMn0oXFxzfC18XFwuKSk/XFwoP1xcZHszfVxcKT9bXFxzLi1dXFxkezMsfVtcXHMuLV1cXGR7NCx9L2c7XG4gICAgR2xvYmFsVmFycy5FbWFpbFJlZ2V4ID0gLygoW148PigpXFxbXFxdXFxcXC4sOzpcXHNAXCJdKyhcXC5bXjw+KClcXFtcXF1cXFxcLiw7Olxcc0BcIl0rKSopfChcIi4rXCIpKUAoKFxcW1swLTldezEsM31cXC5bMC05XXsxLDN9XFwuWzAtOV17MSwzfVxcLlswLTldezEsM31cXF0pfCgoW2EtekEtWlxcLTAtOV0rXFwuKStbYS16QS1aXXsyLH0pKS87XG4gICAgR2xvYmFsVmFycy5FbWFpbFJlZ2V4R2xvYmFsID0gLygoW148PigpXFxbXFxdXFxcXC4sOzpcXHNAXCJdKyhcXC5bXjw+KClcXFtcXF1cXFxcLiw7Olxcc0BcIl0rKSopfChcIi4rXCIpKUAoKFxcW1swLTldezEsM31cXC5bMC05XXsxLDN9XFwuWzAtOV17MSwzfVxcLlswLTldezEsM31cXF0pfCgoW2EtekEtWlxcLTAtOV0rXFwuKStbYS16QS1aXXsyLH0pKS9nO1xuICAgIEdsb2JhbFZhcnMuVXJsUmVnZXggPSAvXig/Oig/Oig/Omh0dHBzP3xmdHApOik/XFwvXFwvKSg/OlxcUysoPzo6XFxTKik/QCk/KD86KD8hKD86MTB8MTI3KSg/OlxcLlxcZHsxLDN9KXszfSkoPyEoPzoxNjlcXC4yNTR8MTkyXFwuMTY4KSg/OlxcLlxcZHsxLDN9KXsyfSkoPyExNzJcXC4oPzoxWzYtOV18MlxcZHwzWzAtMV0pKD86XFwuXFxkezEsM30pezJ9KSg/OlsxLTldXFxkP3wxXFxkXFxkfDJbMDFdXFxkfDIyWzAtM10pKD86XFwuKD86MT9cXGR7MSwyfXwyWzAtNF1cXGR8MjVbMC01XSkpezJ9KD86XFwuKD86WzEtOV1cXGQ/fDFcXGRcXGR8MlswLTRdXFxkfDI1WzAtNF0pKXwoPzooPzpbYS16XFx1MDBhMS1cXHVmZmZmMC05XS0qKSpbYS16XFx1MDBhMS1cXHVmZmZmMC05XSspKD86XFwuKD86W2EtelxcdTAwYTEtXFx1ZmZmZjAtOV0tKikqW2EtelxcdTAwYTEtXFx1ZmZmZjAtOV0rKSooPzpcXC4oPzpbYS16XFx1MDBhMS1cXHVmZmZmXXsyLH0pKSkoPzo6XFxkezIsNX0pPyg/OlsvPyNdXFxTKik/JC9pO1xuICAgIEdsb2JhbFZhcnMuTGlua0hhc1RpdGxlVGFnUmVnZXhHbG9iYWwgPSAvPGFcXHMoW148XSopdGl0bGU9XFxcIiguKj8pXFxcIj4vZ2k7XG4gICAgR2xvYmFsVmFycy5QcmVoZWFkZXJSZWdleEdsb2JhbCA9IC9cXDxwXFxzW15cXDxdKmNsYXNzPVxcXCJwcmVoZWFkZXJcXFwiW15cXD5dKlxcPi9naTtcbiAgICBHbG9iYWxWYXJzLlJlcXVpcmVkVHJhY2tpbmdDb2RlV2hpdGVsaXN0ID0gW1xuICAgICAgICAnLnBkZicsICcuaWNzJywgJy5vZnQnLCAnb3B0dW1zdXJ2ZXlzLmNvJywgJ2hlYWx0aGlkLm9wdHVtLmNvbScsICdsZWFybmluZy5vcHR1bS5jb20nLCAnYXBwLmluZm8ub3B0dW0uY29tJyxcbiAgICAgICAgJ29wdHVtLndlYmV4LmNvbScsICd0d2l0dGVyLmNvbScsICdmYWNlYm9vay5jb20nLCAnbGlua2VkaW4uY29tJywgJ2luZm8ub3B0dW0nXG4gICAgXTtcbn0pKEdsb2JhbFZhcnMgfHwgKEdsb2JhbFZhcnMgPSB7fSkpO1xudmFyIEVNTE1vZHVsZTtcbihmdW5jdGlvbiAoRU1MTW9kdWxlKSB7XG4gICAgdmFyIE1haWx0b0xpbmtPYmplY3QgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBNYWlsdG9MaW5rT2JqZWN0KExpbmtPYmplY3QpIHtcbiAgICAgICAgICAgIHRoaXMucGFyZW50ID0gTGlua09iamVjdDtcbiAgICAgICAgICAgIHRoaXMuZW1haWwgPSBcIlwiO1xuICAgICAgICAgICAgdGhpcy5zdWJqZWN0ID0gXCJcIjtcbiAgICAgICAgICAgIHRoaXMuYm9keSA9IFwiXCI7XG4gICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQuaXNMaW5rVHlwZSgnbWFpbHRvJykpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmluaXRFbWFpbEVkaXRvcigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIE1haWx0b0xpbmtPYmplY3QucHJvdG90eXBlLmhhcyA9IGZ1bmN0aW9uIChvcHRpb24pIHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlTWFpbHRvT2JqKCk7XG4gICAgICAgICAgICByZXR1cm4gdGhpc1tvcHRpb25dICYmIHRoaXNbb3B0aW9uXS50cmltKCkgIT09IFwiXCI7XG4gICAgICAgIH07XG4gICAgICAgIE1haWx0b0xpbmtPYmplY3QucHJvdG90eXBlLmlzVmFsaWRFbWFpbEFkZHJlc3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gR2xvYmFsVmFycy5FbWFpbFJlZ2V4LnRlc3QodGhpcy5lbWFpbCk7XG4gICAgICAgIH07XG4gICAgICAgIE1haWx0b0xpbmtPYmplY3QucHJvdG90eXBlLmRlaW5pdEVtYWlsRWRpdG9yID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5lbWFpbCA9IFwiXCI7XG4gICAgICAgICAgICB0aGlzLnN1YmplY3QgPSBcIlwiO1xuICAgICAgICAgICAgdGhpcy5ib2R5ID0gXCJcIjtcbiAgICAgICAgfTtcbiAgICAgICAgTWFpbHRvTGlua09iamVjdC5wcm90b3R5cGUuY29tcG9zZUVtYWlsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5wYXJlbnQubmV3LnVybCA9IFwibWFpbHRvOlwiICsgdGhpcy5lbWFpbDtcbiAgICAgICAgICAgIHZhciBvcHRpb25zID0gW1wic3ViamVjdFwiLCBcImJvZHlcIl07XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG9wdGlvbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpc1tvcHRpb25zW2ldXSAmJiB0aGlzW29wdGlvbnNbaV1dICE9PSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGFyZW50Lm5ldy5zZWFyY2hQYXJhbXMuc2V0KG9wdGlvbnNbaV0sIHRoaXNbb3B0aW9uc1tpXV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmICh0aGlzW29wdGlvbnNbaV1dID09IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wYXJlbnQubmV3LnNlYXJjaFBhcmFtcy5kZWxldGUob3B0aW9uc1tpXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBNYWlsdG9MaW5rT2JqZWN0LnByb3RvdHlwZS51cGRhdGVNYWlsdG9PYmogPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgdmFyIGEgPSB0aGlzLnBhcmVudC5uZXcudXJsLnN1YnN0cig3LCB0aGlzLnBhcmVudC5uZXcudXJsLmxlbmd0aCAtIDcpO1xuICAgICAgICAgICAgdmFyIGIgPSBhLnNwbGl0KFwiP1wiKTtcbiAgICAgICAgICAgIHRoaXMuZW1haWwgPSBiWzBdO1xuICAgICAgICAgICAgdGhpcy5wYXJlbnQubmV3LnNlYXJjaFBhcmFtcy51cGRhdGVFbnRyaWVzKCk7XG4gICAgICAgICAgICBpZiAoYi5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICAgICAgW1wic3ViamVjdFwiLCBcImJvZHlcIl0uZm9yRWFjaChmdW5jdGlvbiAob3B0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChfdGhpcy5wYXJlbnQubmV3LnNlYXJjaFBhcmFtcy5oYXMob3B0aW9uKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXNbb3B0aW9uXSA9IHdpbmRvdy5kZWNvZGVVUklDb21wb25lbnQoX3RoaXMucGFyZW50Lm5ldy5zZWFyY2hQYXJhbXMuZ2V0KG9wdGlvbikpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnN1YmplY3QgPSBcIlwiO1xuICAgICAgICAgICAgICAgIHRoaXMuYm9keSA9IFwiXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIE1haWx0b0xpbmtPYmplY3QucHJvdG90eXBlLmlucHV0T25CbHVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgLy9kZWNvZGVkIHVybCBhbGwgdGhlIGVudHJpZXM7XG4gICAgICAgICAgICAvL3JlZW5jb2RlIHRoZW0uXG4gICAgICAgICAgICB0aGlzLnBhcmVudC5uZXcuc2VhcmNoUGFyYW1zLnVwZGF0ZUVudHJpZXMoKTtcbiAgICAgICAgICAgIHRoaXMucGFyZW50Lm5ldy5zZWFyY2hQYXJhbXMudXBkYXRlU2VhcmNoUHJvcCgpO1xuICAgICAgICB9O1xuICAgICAgICBNYWlsdG9MaW5rT2JqZWN0LnByb3RvdHlwZS5vcGVuRWRpdG9yID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5pbml0RW1haWxFZGl0b3IoKTtcbiAgICAgICAgICAgIC8vIHdpbmRvdy5qUXVlcnkoXCJodG1sLGJvZHlcIilcbiAgICAgICAgICAgIC8vIC5hbmltYXRlKHtzY3JvbGxUb3A6IHdpbmRvdy5qUXVlcnkoJyNsaW5rLScrKHRoaXMucGFyZW50LmlkLTEpKS5vZmZzZXQoKS50b3AgLSA3NX0sIDMwMCk7XG4gICAgICAgICAgICB2YXIgTE8gPSB0aGlzLnBhcmVudDtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKExPLmlkIC0gMSk7XG4gICAgICAgICAgICBMTy5zaG93TWFpbHRvRWRpdG9yID0gdHJ1ZTtcbiAgICAgICAgfTtcbiAgICAgICAgTWFpbHRvTGlua09iamVjdC5wcm90b3R5cGUuaW5pdEVtYWlsRWRpdG9yID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy51cGRhdGVNYWlsdG9PYmooKTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIE1haWx0b0xpbmtPYmplY3Q7XG4gICAgfSgpKTtcbiAgICBFTUxNb2R1bGUuTWFpbHRvTGlua09iamVjdCA9IE1haWx0b0xpbmtPYmplY3Q7XG4gICAgdmFyIFVSTE9iaiA9IChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIFVSTE9iaih1cmwpIHtcbiAgICAgICAgICAgIHRoaXMuaHJlZiA9IFwiXCI7XG4gICAgICAgICAgICB0aGlzLnNlYXJjaCA9IFwiXCI7XG4gICAgICAgICAgICB0aGlzLm9yaWdpbiA9IFwiXCI7XG4gICAgICAgICAgICB0aGlzLmhhc2ggPSBcIlwiO1xuICAgICAgICAgICAgdGhpcy5wcm90b2NvbCA9IFwiXCI7XG4gICAgICAgICAgICB0aGlzLnVybCA9IHVybDtcbiAgICAgICAgICAgIHRoaXMuc2VhcmNoUGFyYW1zID0gbmV3IFVSTE9ialNlYXJjaFBhcmFtcyh0aGlzKTtcbiAgICAgICAgfVxuICAgICAgICBVUkxPYmoucHJvdG90eXBlLnByZXBhcmVFeHBvcnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAvL2RvIHNvbWV0aGluZyBoZXJlP1xuICAgICAgICAgICAgLy90aGlzLnNlYXJjaFBhcmFtcy51cGRhdGVTZWFyY2hQcm9wKCk7XG4gICAgICAgIH07XG4gICAgICAgIFVSTE9iai5wcm90b3R5cGUuaXNWYWxpZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBHbG9iYWxWYXJzLlVybFJlZ2V4LnRlc3QodGhpcy51cmwpO1xuICAgICAgICB9O1xuICAgICAgICBVUkxPYmoucHJvdG90eXBlLmNvbnRhaW5zID0gZnVuY3Rpb24gKHN0cikge1xuICAgICAgICAgICAgaWYgKHRoaXMudXJsLmluZGV4T2Yoc3RyKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShVUkxPYmoucHJvdG90eXBlLCBcInVybFwiLCB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByZXBhcmVFeHBvcnQoKTtcbiAgICAgICAgICAgICAgICB2YXIgdSA9IHRoaXMub3JpZ2luICsgdGhpcy5zZWFyY2ggKyB0aGlzLmhhc2g7XG4gICAgICAgICAgICAgICAgdSA9IHUucmVwbGFjZShcIj91bmRlZmluZWRcIiwgXCJcIik7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHU7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiAodXJsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWFyY2ggPSBcIlwiO1xuICAgICAgICAgICAgICAgIHRoaXMuaGFzaCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgdmFyIHByb3RvY29sVHlwZSA9IC9eKGh0dHBzP3xtYWlsdG98ZnRwKVxcOi9naTtcbiAgICAgICAgICAgICAgICBpZiAocHJvdG9jb2xUeXBlLnRlc3QodXJsKSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgYSA9IHVybC5tYXRjaChwcm90b2NvbFR5cGUpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnByb3RvY29sID0gYVswXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5ocmVmID0gdXJsO1xuICAgICAgICAgICAgICAgIGlmICh1cmwudHJpbSgpID09IFwiI1wiKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaGFzaCA9IFwiI1wiO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIGlmICh1cmwudHJpbSgpLmxlbmd0aCA+IDEgJiYgdXJsLmluZGV4T2YoXCIjXCIpID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHVybFBhcnRzID0gdXJsLnNwbGl0KFwiI1wiKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5oYXNoID0gXCIjXCIgKyB1cmxQYXJ0cy5wb3AoKTsgLy9qdW1wIGxpbmsuLiBuZWVkIHRvIHJlbW92ZSBpdCBmcm9tIHRoZSBvdGhlciBzdHVmZi5cbiAgICAgICAgICAgICAgICAgICAgdmFyIHBhcnRzID0gKHVybFBhcnRzLmpvaW4oXCIjXCIpKS5zcGxpdChcIj9cIik7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMub3JpZ2luID0gcGFydHNbMF07XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VhcmNoID0gcGFydHMubGVuZ3RoID4gMCA/IFwiP1wiICsgcGFydHNbMV0gOiBcIlwiO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHVybC5pbmRleE9mKFwiP1wiKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGFydHMgPSB1cmwuc3BsaXQoXCI/XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vcmlnaW4gPSBwYXJ0c1swXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2VhcmNoID0gKHBhcnRzLmxlbmd0aCA+IDApID8gXCI/XCIgKyBwYXJ0c1sxXSA6IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm9yaWdpbiA9IHVybDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAvL3RoaXMuc2VhcmNoUGFyYW1zLnVwZGF0ZVNlYXJjaFByb3AoKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gVVJMT2JqO1xuICAgIH0oKSk7XG4gICAgRU1MTW9kdWxlLlVSTE9iaiA9IFVSTE9iajtcbiAgICB2YXIgVVJMT2JqU2VhcmNoUGFyYW1zID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gVVJMT2JqU2VhcmNoUGFyYW1zKHBhcmVudCkge1xuICAgICAgICAgICAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG4gICAgICAgICAgICBpZiAodGhpcy5wYXJlbnQuc2VhcmNoLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9lbnRyaWVzID0gKHRoaXMucGFyZW50LnNlYXJjaC5zdWJzdHIoMSwgdGhpcy5wYXJlbnQuc2VhcmNoLmxlbmd0aCkpLnNwbGl0KC9cXCZhbXBcXDt8XFwmL2cpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fZW50cmllcyA9IFtdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShVUkxPYmpTZWFyY2hQYXJhbXMucHJvdG90eXBlLCBcImVudHJpZXNcIiwge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIG91dHB1dCA9IFtdO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5fZW50cmllcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgYSA9IHRoaXMuX2VudHJpZXNbaV0uc3BsaXQoXCI9XCIpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoYS5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhWzFdID0gZGVjb2RlVVJJQ29tcG9uZW50KGFbMV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIG91dHB1dC5wdXNoKGEuam9pbihcIj1cIikpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICByZXR1cm4gb3V0cHV0O1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgICAgfSk7XG4gICAgICAgIFVSTE9ialNlYXJjaFBhcmFtcy5wcm90b3R5cGUudXBkYXRlRW50cmllcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMuX2VudHJpZXMgPSBbXTtcbiAgICAgICAgICAgIGlmICh0aGlzLnBhcmVudC5zZWFyY2ggIT09IFwiP1wiICYmIHRoaXMucGFyZW50LnNlYXJjaC5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICAgICAgdmFyIHByb3BzID0gKHRoaXMucGFyZW50LnNlYXJjaC5zdWJzdHIoMSwgdGhpcy5wYXJlbnQuc2VhcmNoLmxlbmd0aCkpLnNwbGl0KC9cXCZhbXBcXDt8XFwmL2cpO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZW50cmllcy5wdXNoKHByb3BzW2ldKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIFVSTE9ialNlYXJjaFBhcmFtcy5wcm90b3R5cGUudXBkYXRlU2VhcmNoUHJvcCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBvdXRwdXQgPSBbXTtcbiAgICAgICAgICAgIGlmICh0aGlzLl9lbnRyaWVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuX2VudHJpZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHByb3AgPSB0aGlzLl9lbnRyaWVzW2ldLnNwbGl0KFwiPVwiKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKC9bYS16XXsxLDR9PSguKj86KXszLDl9L2dpLnRlc3QodGhpcy5fZW50cmllc1tpXSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG91dHB1dC5wdXNoKHRoaXMuX2VudHJpZXNbaV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0LnB1c2gocHJvcFswXSArIChwcm9wLmxlbmd0aCA+IDEgPyBcIj1cIiArIGVuY29kZVVSSUNvbXBvbmVudChkZWNvZGVVUklDb21wb25lbnQocHJvcFsxXSkpIDogXCJcIikpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5wYXJlbnQuc2VhcmNoID0gb3V0cHV0Lmxlbmd0aCA+IDAgPyBcIj9cIiArIG91dHB1dC5qb2luKFwiJlwiKSA6IFwiXCI7XG4gICAgICAgIH07XG4gICAgICAgIFVSTE9ialNlYXJjaFBhcmFtcy5wcm90b3R5cGUuaGFzID0gZnVuY3Rpb24gKHBhcmFtKSB7XG4gICAgICAgICAgICB2YXIgcmVnZXggPSBuZXcgUmVnRXhwKFwiXlwiICsgcGFyYW0gKyBcIlxcPVwiLCBcImdcIik7XG4gICAgICAgICAgICB2YXIgb3V0cHV0ID0gZmFsc2U7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuX2VudHJpZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAocmVnZXgudGVzdCh0aGlzLl9lbnRyaWVzW2ldKSlcbiAgICAgICAgICAgICAgICAgICAgb3V0cHV0ID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgICAgIH07XG4gICAgICAgIFVSTE9ialNlYXJjaFBhcmFtcy5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24gKHBhcmFtKSB7XG4gICAgICAgICAgICB2YXIgcmVnZXggPSBuZXcgUmVnRXhwKFwiXlwiICsgcGFyYW0gKyBcIlxcPVwiLCBcImdcIiksIG91dHB1dCA9IGZhbHNlO1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLl9lbnRyaWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKHJlZ2V4LnRlc3QodGhpcy5fZW50cmllc1tpXSkpIHtcbiAgICAgICAgICAgICAgICAgICAgb3V0cHV0ID0gKHRoaXMuX2VudHJpZXNbaV0uc3BsaXQoXCI9XCIpKS5wb3AoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gb3V0cHV0O1xuICAgICAgICB9O1xuICAgICAgICBVUkxPYmpTZWFyY2hQYXJhbXMucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uIChwYXJhbSwgdmFsdWUpIHtcbiAgICAgICAgICAgIHZhciByZWdleCA9IG5ldyBSZWdFeHAoXCJeXCIgKyBwYXJhbSArIFwiXFw9XCIsIFwiZ1wiKSwgb3V0cHV0ID0gZmFsc2U7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuX2VudHJpZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAocmVnZXgudGVzdCh0aGlzLl9lbnRyaWVzW2ldKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9lbnRyaWVzW2ldID0gcGFyYW0gKyBcIj1cIiArIHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBvdXRwdXQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghb3V0cHV0KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5hcHBlbmQocGFyYW0gKyBcIj1cIiArIHZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMudXBkYXRlU2VhcmNoUHJvcCgpO1xuICAgICAgICB9O1xuICAgICAgICBVUkxPYmpTZWFyY2hQYXJhbXMucHJvdG90eXBlLmFwcGVuZCA9IGZ1bmN0aW9uICh2YWx1ZVBhaXIpIHtcbiAgICAgICAgICAgIHRoaXMuX2VudHJpZXMucHVzaCh2YWx1ZVBhaXIpO1xuICAgICAgICAgICAgdGhpcy51cGRhdGVTZWFyY2hQcm9wKCk7XG4gICAgICAgIH07XG4gICAgICAgIFVSTE9ialNlYXJjaFBhcmFtcy5wcm90b3R5cGUuZGVsZXRlQWxsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5fZW50cmllcyA9IFtdO1xuICAgICAgICAgICAgdGhpcy51cGRhdGVTZWFyY2hQcm9wKCk7XG4gICAgICAgIH07XG4gICAgICAgIFVSTE9ialNlYXJjaFBhcmFtcy5wcm90b3R5cGUuZGVsZXRlQXRJbmRleCA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgICAgICAgdGhpcy5fZW50cmllcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgdGhpcy51cGRhdGVTZWFyY2hQcm9wKCk7XG4gICAgICAgIH07XG4gICAgICAgIFVSTE9ialNlYXJjaFBhcmFtcy5wcm90b3R5cGUuZGVsZXRlID0gZnVuY3Rpb24gKHBhcmFtKSB7XG4gICAgICAgICAgICAvL2RvZXNudCBkbyBhbnl0aGluZyB5ZXQuXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuX2VudHJpZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fZW50cmllc1tpXS5zdWJzdHIoMCwgcGFyYW0ubGVuZ3RoICsgMSkgPT0gcGFyYW0gKyBcIj1cIikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmRlbGV0ZUF0SW5kZXgoaSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gVVJMT2JqU2VhcmNoUGFyYW1zO1xuICAgIH0oKSk7XG4gICAgRU1MTW9kdWxlLlVSTE9ialNlYXJjaFBhcmFtcyA9IFVSTE9ialNlYXJjaFBhcmFtcztcbiAgICB2YXIgTGlua2VkSW1hZ2UgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBMaW5rZWRJbWFnZShfc3VwZXIsIGNvZGUpIHtcbiAgICAgICAgICAgIHRoaXMuY29udGV4dCA9IGNvZGU7XG4gICAgICAgICAgICB0aGlzLl9zdXBlciA9IF9zdXBlcjtcbiAgICAgICAgICAgIHZhciB0YWdzID0gW1wic3JjXCIsIFwiYWx0XCIsIFwiaGVpZ2h0XCIsIFwid2lkdGhcIl07XG4gICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIHRhZ3NfMSA9IHRhZ3M7IF9pIDwgdGFnc18xLmxlbmd0aDsgX2krKykge1xuICAgICAgICAgICAgICAgIHZhciB0YWcgPSB0YWdzXzFbX2ldO1xuICAgICAgICAgICAgICAgIHZhciByZWdleCA9IG5ldyBSZWdFeHAodGFnICsgXCI9XFxcIihbXlxcXCJdLio/KT9cXFwiXCIsIFwiaVwiKTtcbiAgICAgICAgICAgICAgICBpZiAocmVnZXgudGVzdChjb2RlKSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzW3RhZ10gPSBjb2RlLm1hdGNoKHJlZ2V4KVsxXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgaGFzV2lkdGggPSB0aGlzLndpZHRoICYmIHBhcnNlSW50KHRoaXMud2lkdGgudG9TdHJpbmcoKSk7XG4gICAgICAgICAgICB2YXIgaGFzSGVpZ2h0ID0gdGhpcy5oZWlnaHQgJiYgcGFyc2VJbnQodGhpcy5oZWlnaHQudG9TdHJpbmcoKSk7XG4gICAgICAgICAgICBpZiAoIWhhc1dpZHRoIHx8ICFoYXNIZWlnaHQpIHtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHRoaXMuc3JjID09PSBcInN0cmluZ1wiKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJlbG9hZEltYWdlKHRoaXMuc3JjKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IC8vZWl0aGVyIGlzIG5vdCBzZXRcbiAgICAgICAgfVxuICAgICAgICBMaW5rZWRJbWFnZS5wcm90b3R5cGUucHJlbG9hZEltYWdlID0gZnVuY3Rpb24gKHNyYykge1xuICAgICAgICAgICAgdmFyIExJID0gdGhpcztcbiAgICAgICAgICAgIHZhciBpbWcgPSBuZXcgSW1hZ2UoKTtcbiAgICAgICAgICAgIC8vIGltZy5zdHlsZS52aXNpYmlsaXR5ID0gXCJoaWRkZW5cIjtcbiAgICAgICAgICAgIGltZy5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgTEkuaGVpZ2h0ID0gaW1nLmhlaWdodDtcbiAgICAgICAgICAgICAgICBMSS53aWR0aCA9IGltZy53aWR0aDtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhpbWcuaGVpZ2h0LCBpbWcud2lkdGgpO1xuICAgICAgICAgICAgICAgIGltZy5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGltZyk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgaW1nLnNyYyA9IExJLnNyYztcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGltZyk7XG4gICAgICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGltZyk7XG4gICAgICAgIH07XG4gICAgICAgIExpbmtlZEltYWdlLnByb3RvdHlwZS5nZW5lcmF0ZU91dHB1dCA9IGZ1bmN0aW9uIChjb250ZW50KSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICAgICAgaWYgKHRoaXMuY29udGV4dC5pbmRleE9mKFwiYWx0XCIpID4gLTEpIHtcbiAgICAgICAgICAgICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKHRoaXMuY29udGV4dCwgZnVuY3Rpb24gKGYpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGYucmVwbGFjZSgvYWx0XFw9XFxcIihbXlxcXCJdLio/KT9cXFwiL2csIFwiYWx0PVxcXCJcIiArIChfdGhpcy5hbHQgPT09IHVuZGVmaW5lZCA/IFwiXCIgOiBfdGhpcy5hbHQpICsgXCJcXFwiXCIpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSh0aGlzLmNvbnRleHQsIGZ1bmN0aW9uIChmKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmLnJlcGxhY2UoXCI8aW1nXCIsIFwiPGltZyBhbHQ9XFxcIlwiICsgKF90aGlzLmFsdCA9PT0gdW5kZWZpbmVkID8gXCJcIiA6IF90aGlzLmFsdCkgKyBcIlxcXCJcIik7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gY29udGVudDtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIExpbmtlZEltYWdlO1xuICAgIH0oKSk7XG4gICAgRU1MTW9kdWxlLkxpbmtlZEltYWdlID0gTGlua2VkSW1hZ2U7XG4gICAgdmFyIExpbmtPYmplY3QgPSAoZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBMaW5rT2JqZWN0KGxpbmUsIGNvbnRleHQsIHBhcmVudCkge1xuICAgICAgICAgICAgdGhpcy5fX2lzQ29tcGxldGUgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuX3N1cGVyID0gcGFyZW50O1xuICAgICAgICAgICAgdGhpcy5zaG93UXVlcnlTdHJpbmdFZGl0b3IgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuc2hvd01haWx0b0VkaXRvciA9IGZhbHNlO1xuICAgICAgICAgICAgdGhpcy5pZCA9IDA7XG4gICAgICAgICAgICB0aGlzLmxpbmUgPSBsaW5lICsgMTtcbiAgICAgICAgICAgIHRoaXMuY29udGV4dCA9IGNvbnRleHQ7XG4gICAgICAgICAgICB0aGlzLnF1ZXJ5U3RyaW5ncyA9IFtdO1xuICAgICAgICAgICAgdGhpcy5DaGFuZ2VNb25pdG9yID0gbmV3IENoYW5nZU1vbml0b3IodGhpcyk7XG4gICAgICAgICAgICB0aGlzLmVycm9ycyA9IEVNTEludGVsbGlnZW5jZS5tb2R1bGUoXCJoeXBlcmxpbmtcIikubW9uaXRvcigpO1xuICAgICAgICAgICAgdGhpcy5lcnJvcnMuYXNzb2NpYXRlVmFyaWFibGUoXCJMaW5rT2JqZWN0XCIsIHRoaXMpO1xuICAgICAgICAgICAgdGhpcy53aGl0ZUxpc3RlZFVybCA9IFwifn53aGl0ZWxpc3R+flwiO1xuICAgICAgICAgICAgLy9maW5kIGhyZWZcbiAgICAgICAgICAgIHRoaXMuX19sb2NhdGVIcmVmKGNvbnRleHQpO1xuICAgICAgICAgICAgLy9maW5kIGltYWdlXG4gICAgICAgICAgICB0aGlzLl9fbG9jYXRlTGlua2VkSW1hZ2UoY29udGV4dCk7XG4gICAgICAgICAgICAvL25lZWQgdG8gc2V0IHRoZSB1cmwgYmVmb3JlIHlvdSBkbyB0aGlzO1xuICAgICAgICAgICAgdGhpcy5tYWlsdG8gPSBuZXcgTWFpbHRvTGlua09iamVjdCh0aGlzKTtcbiAgICAgICAgICAgIHRoaXMuaXNMaW5rQ29tcGxldGUoKTtcbiAgICAgICAgfVxuICAgICAgICBMaW5rT2JqZWN0LnByb3RvdHlwZS5fX2xvY2F0ZUhyZWYgPSBmdW5jdGlvbiAoY29udGV4dCkge1xuICAgICAgICAgICAgdmFyIHJlMiA9IC9ocmVmXFw9XFxcIihbXlxcXCJcXD5dKilcXFwiL2c7XG4gICAgICAgICAgICB2YXIgaHJlZiA9IGNvbnRleHQubWF0Y2gocmUyKTtcbiAgICAgICAgICAgIGlmIChocmVmLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBpZiAoaHJlZlswXSA9PSBcImhyZWY9XFxcIlxcXCJcIikge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm5ldyA9IG5ldyBVUkxPYmooXCIjXCIpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm9sZCA9IG5ldyBVUkxPYmooXCIjXCIpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNvbnRleHQgPSB0aGlzLmNvbnRleHQucmVwbGFjZShuZXcgUmVnRXhwKFwiaHJlZj1cXFwiXFxcIlwiLCBcImdcIiksIFwiaHJlZj1cXFwiI1xcXCJcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm5ldyA9IG5ldyBVUkxPYmooKGhyZWZbMF0uc3Vic3RyKDYsIGhyZWZbMF0ubGVuZ3RoIC0gNykpLnRyaW0oKSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMub2xkID0gbmV3IFVSTE9iaigoaHJlZlswXS5zdWJzdHIoNiwgaHJlZlswXS5sZW5ndGggLSA3KSkudHJpbSgpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIExpbmtPYmplY3QucHJvdG90eXBlLl9fbG9jYXRlTGlua2VkSW1hZ2UgPSBmdW5jdGlvbiAoY29udGV4dCkge1xuICAgICAgICAgICAgaWYgKC9cXDxpbWcoW14+XS4qPylcXD4vLnRlc3QoY29udGV4dCkpIHtcbiAgICAgICAgICAgICAgICB2YXIgZm91bmQgPSBjb250ZXh0Lm1hdGNoKC9cXDxpbWcoW14+XS4qPylcXD4vKTtcbiAgICAgICAgICAgICAgICBpZiAoZm91bmQubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLkxpbmtlZEltYWdlID0gbmV3IExpbmtlZEltYWdlKHRoaXMsIGZvdW5kWzBdKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5MaW5rZWRJbWFnZU9sZCA9IG5ldyBMaW5rZWRJbWFnZSh0aGlzLCBmb3VuZFswXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBMaW5rT2JqZWN0LnByb3RvdHlwZS5oYXNEdXBsaWNhdGVRdWVyeVN0cmluZ3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0gW10sIHVzZWRTdHJpbmdzID0gW107XG4gICAgICAgICAgICBpZiAodGhpcy5uZXcuc2VhcmNoUGFyYW1zLmVudHJpZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgX2EgPSB0aGlzLm5ldy5zZWFyY2hQYXJhbXMuZW50cmllczsgX2kgPCBfYS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGEgPSBfYVtfaV07XG4gICAgICAgICAgICAgICAgICAgIHZhciBwYXJhbSA9IGEuc3BsaXQoXCI9XCIpLnNoaWZ0KCk7XG4gICAgICAgICAgICAgICAgICAgIGlmICh1c2VkU3RyaW5ncy5pbmRleE9mKHBhcmFtKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQucHVzaChwYXJhbSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdXNlZFN0cmluZ3MucHVzaChwYXJhbSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHJlc3VsdC5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgTGlua09iamVjdC5wcm90b3R5cGUub3ZlcnJpZGVUcmFja2luZ1JlcXVpcmVtZW50cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMud2hpdGVMaXN0ZWRVcmwgPSB0aGlzLm5ldy51cmw7XG4gICAgICAgIH07XG4gICAgICAgIExpbmtPYmplY3QucHJvdG90eXBlLmRpc3BsYXlGb3JtYXR0ZWRVUkwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAvL2Rpc3BsYXlzIHVybDtcbiAgICAgICAgICAgIHZhciBjb250ZW50ID0gdGhpcy5jb250ZXh0O1xuICAgICAgICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvXFxzZW1sXFwtaWRcXD1cXFwiKFswLTldKilcXFwiLywgXCJcIik7XG4gICAgICAgICAgICB2YXIgZmluZFN0YXJ0ID0gXCJocmVmPVxcXCJcIjtcbiAgICAgICAgICAgIHZhciBzdGFydCA9IGNvbnRlbnQuaW5kZXhPZihmaW5kU3RhcnQpO1xuICAgICAgICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZShuZXcgUmVnRXhwKFwiaHJlZj1cXFwiXFxcIlwiLCBcImdcIiksIFwiaHJlZj1cXFwiI1xcXCJcIik7XG4gICAgICAgICAgICAvLyB2YXIgaW1nUmVnID0gL1xcPGltZyhbXj5dLio/KVxcPi9nO1xuICAgICAgICAgICAgaWYgKHRoaXMuTGlua2VkSW1hZ2UpIHtcbiAgICAgICAgICAgICAgICBjb250ZW50ID0gdGhpcy5MaW5rZWRJbWFnZS5nZW5lcmF0ZU91dHB1dChjb250ZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnRlbnQgPSBjb250ZW50LnN1YnN0cigwLCBzdGFydCkgKyBmaW5kU3RhcnQgKyBcInx8fGEuaHJlZnx8fFwiICsgY29udGVudC5zdWJzdHIoc3RhcnQgKyAoZmluZFN0YXJ0Lmxlbmd0aCArICh0aGlzLm9sZC51cmwubGVuZ3RoKSksIGNvbnRlbnQubGVuZ3RoKTtcbiAgICAgICAgICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UobmV3IFJlZ0V4cChcIlxcXCJcIiwgXCJnXCIpLCBcIiZxdW90O1wiKTtcbiAgICAgICAgICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UobmV3IFJlZ0V4cChcIi9cIiwgXCJnXCIpLCBcIiYjNDc7XCIpO1xuICAgICAgICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZShuZXcgUmVnRXhwKFwiPlwiLCBcImdcIiksIFwiJmd0O1wiKTtcbiAgICAgICAgICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UobmV3IFJlZ0V4cChcIjxcIiwgXCJnXCIpLCBcIiZsdDtcIik7XG4gICAgICAgICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC8oW15cXHNdKj8pXFw9L2csIFwiPHNwYW4gY2xhc3M9XFxcImF0dHJcXFwiPiQxPC9zcGFuPjxzcGFuIGNsYXNzPVxcXCJrZXl3b3JkXFxcIj49PC9zcGFuPlwiKTtcbiAgICAgICAgICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoL1xcJnF1b3RcXDtcXCZndFxcOy9nLCBcIiZxdW90OzxzcGFuIGNsYXNzPVxcXCJ0YWdcXFwiPiZndDs8L3NwYW4+XCIpO1xuICAgICAgICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvXFwmXFwjNDdcXDtcXCZndFxcOy9nLCBcIjxzcGFuIGNsYXNzPVxcXCJ0YWdcXFwiPiYjNDc7Jmd0Ozwvc3Bhbj5cIik7XG4gICAgICAgICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC9cXCZxdW90XFw7KC4qPylcXCZxdW90XFw7L2csIFwiPHNwYW4gY2xhc3M9XFxcInZhbHVlXFxcIj5cXFwiJDFcXFwiPC9zcGFuPlwiKTtcbiAgICAgICAgICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoL1xcJmx0XFw7KFthLXpdK1xccz8pL2csIFwiPHNwYW4gY2xhc3M9XFxcInRhZ1xcXCI+Jmx0OyQxPC9zcGFuPlwiKTtcbiAgICAgICAgICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoL1xcJmx0XFw7XFwmXFwjNDdcXDsoW2Etel0rXFxzPylcXCZndFxcOy9nLCBcIjxzcGFuIGNsYXNzPVxcXCJ0YWdcXFwiPiZsdDsmIzQ3OyQxJmd0Ozwvc3Bhbj5cIik7XG4gICAgICAgICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC9cXG4vZywgXCI8YnI+XCIpO1xuICAgICAgICAgICAgY29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvXFwmZ3RcXDsvZywgXCI8c3BhbiBjbGFzcz1cXFwidGFnXFxcIj4mZ3Q7PC9zcGFuPlwiKTtcbiAgICAgICAgICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoL1xcc3szfS9nLCBcIiZuYnNwOyZuYnNwOyZuYnNwXCIpO1xuICAgICAgICAgICAgLy8gaWYodGhpcy5MaW5rZWRJbWFnZSkge1xuICAgICAgICAgICAgLy8gICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC9cXHxcXHxcXHxpbWdcXC5hbHRcXHxcXHxcXHwvZywgdGhpcy5MaW5rZWRJbWFnZS5hbHQgPT09IHVuZGVmaW5lZCA/IFwiXCIgOiB0aGlzLkxpbmtlZEltYWdlLmFsdCk7XG4gICAgICAgICAgICAvLyB9XG4gICAgICAgICAgICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC9cXHxcXHxcXHxhXFwuaHJlZlxcfFxcfFxcfC9nLCBcIjxzdHJvbmc+XCIgKyAodGhpcy5oYXNPd25Qcm9wZXJ0eShcImRlbGV0ZU9uUmVuZGVyXCIpICYmIHRoaXMuZGVsZXRlT25SZW5kZXIgPyB0aGlzLm9sZC51cmwgOiB0aGlzLm5ldy51cmwpICsgXCI8L3N0cm9uZz5cIik7XG4gICAgICAgICAgICByZXR1cm4gY29udGVudDtcbiAgICAgICAgfTtcbiAgICAgICAgTGlua09iamVjdC5wcm90b3R5cGUuaXNMaW5rQ29tcGxldGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAvL2ludGVsbGlnZW5jZSBzY2FuczpcbiAgICAgICAgICAgIHRoaXMuX3N1cGVyLmludGVsbGlnZW5jZS5ldmFsdWF0ZVJ1bGVzKCk7XG4gICAgICAgICAgICB0aGlzLmVycm9ycy5ldmFsdWF0ZVJ1bGVzKCk7XG4gICAgICAgICAgICAvL3RyYWNrIGNoYW5nZXM6XG4gICAgICAgICAgICB0aGlzLkNoYW5nZU1vbml0b3IudXBkYXRlKCk7XG4gICAgICAgICAgICB0aGlzLl9faXNDb21wbGV0ZSA9IHRoaXMuZXJyb3JzLmNhbkNvbnRpbnVlO1xuICAgICAgICAgICAgaWYgKHRoaXMuaGFzT3duUHJvcGVydHkoXCJkZWxldGVPblJlbmRlclwiKSAmJiB0aGlzLmRlbGV0ZU9uUmVuZGVyKVxuICAgICAgICAgICAgICAgIHRoaXMuX19pc0NvbXBsZXRlID0gdHJ1ZTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9faXNDb21wbGV0ZTtcbiAgICAgICAgfTtcbiAgICAgICAgTGlua09iamVjdC5wcm90b3R5cGUuaXNMaW5rVHlwZSA9IGZ1bmN0aW9uICh0eXBlKSB7XG4gICAgICAgICAgICB2YXIgb3V0cHV0ID0gZmFsc2U7XG4gICAgICAgICAgICBzd2l0Y2ggKHR5cGUpIHtcbiAgICAgICAgICAgICAgICBjYXNlIFwiaHR0cFwiOlxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5uZXcucHJvdG9jb2wgPT0gXCJodHRwOlwiIHx8IHRoaXMubmV3LnByb3RvY29sID09IFwiaHR0cHM6XCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG91dHB1dCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSBcIm1haWx0b1wiOlxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5uZXcucHJvdG9jb2wgPT0gXCJtYWlsdG86XCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG91dHB1dCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgICAgIH07XG4gICAgICAgIExpbmtPYmplY3QucHJvdG90eXBlLmhhc1RyYWNraW5nQ29kZSA9IGZ1bmN0aW9uIChvYmopIHtcbiAgICAgICAgICAgIGlmIChvYmogPT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgICAgICBvYmogPSB0aGlzLm5ldy51cmw7XG4gICAgICAgICAgICAvLyBpZih0aGlzLndoaXRlTGlzdGVkVXJsPT10aGlzLm5ldykgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB2YXIgYSA9IC9bYS16XXsxLDR9PSguKj86KXszLDl9L2lnO1xuICAgICAgICAgICAgcmV0dXJuIGEudGVzdChvYmopO1xuICAgICAgICB9O1xuICAgICAgICBMaW5rT2JqZWN0LnByb3RvdHlwZS5yZXF1aXJlc1RyYWNraW5nQ29kZSA9IGZ1bmN0aW9uIChvYmopIHtcbiAgICAgICAgICAgIHZhciBvdXRwdXQgPSBmYWxzZTtcbiAgICAgICAgICAgIGlmIChHbG9iYWxWYXJzLlJlcXVpcmVzVHJhY2tpbmdDb2RlUmVnZXgudGVzdCh0aGlzLm5ldy51cmwpKSB7XG4gICAgICAgICAgICAgICAgb3V0cHV0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAvLyBpdGVyYXRlIG9mZXIgd2hpdGVsaXN0XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBHbG9iYWxWYXJzLlJlcXVpcmVkVHJhY2tpbmdDb2RlV2hpdGVsaXN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChHbG9iYWxWYXJzLlJlcXVpcmVkVHJhY2tpbmdDb2RlV2hpdGVsaXN0W2ldIGluc3RhbmNlb2YgUmVnRXhwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoR2xvYmFsVmFycy5SZXF1aXJlZFRyYWNraW5nQ29kZVdoaXRlbGlzdFtpXVtcInRlc3RcIl0odGhpcy5uZXcudXJsKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG91dHB1dCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMubmV3LnVybC5pbmRleE9mKEdsb2JhbFZhcnMuUmVxdWlyZWRUcmFja2luZ0NvZGVXaGl0ZWxpc3RbaV0pID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgICAgIH07XG4gICAgICAgIExpbmtPYmplY3QucHJvdG90eXBlLnJlcXVpcmVzU0NvZGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoR2xvYmFsVmFycy5SZXF1aXJlc1NDb2RlUmVnZXgudGVzdCh0aGlzLm5ldy51cmwpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIExpbmtPYmplY3QucHJvdG90eXBlLm5lZWRzVHJhY2tpbmdDb2RlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIG91dHB1dCA9IHRoaXMucmVxdWlyZXNUcmFja2luZ0NvZGUoKTtcbiAgICAgICAgICAgIGlmICh0aGlzLndoaXRlTGlzdGVkVXJsID09IHRoaXMubmV3LnVybClcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAvLyBkZXRlcm1pbmUgbGlua3MgdGhhdCBuZWVkIHNwZWNpYWwgdHJhY2tpbmdcbiAgICAgICAgICAgIGlmICh0aGlzLmhhc1RyYWNraW5nQ29kZSgpKSB7XG4gICAgICAgICAgICAgICAgb3V0cHV0ID0gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gb3V0cHV0O1xuICAgICAgICB9O1xuICAgICAgICBMaW5rT2JqZWN0LnByb3RvdHlwZS51cGRhdGVJbnB1dCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmlzTGlua1R5cGUoJ21haWx0bycpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5tYWlsdG8udXBkYXRlTWFpbHRvT2JqKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLm5ldy5zZWFyY2hQYXJhbXMudXBkYXRlRW50cmllcygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5pc0xpbmtDb21wbGV0ZSgpO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gTGlua09iamVjdDtcbiAgICB9KCkpO1xuICAgIEVNTE1vZHVsZS5MaW5rT2JqZWN0ID0gTGlua09iamVjdDtcbiAgICB2YXIgQ2hhbmdlTW9uaXRvciA9IChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIENoYW5nZU1vbml0b3IoX3N1cGVyKSB7XG4gICAgICAgICAgICB0aGlzLnZpc2libGUgPSBmYWxzZTtcbiAgICAgICAgICAgIHRoaXMuX3N1cGVyID0gX3N1cGVyO1xuICAgICAgICAgICAgdGhpcy5tZXNzYWdlcyA9IFtdO1xuICAgICAgICB9XG4gICAgICAgIENoYW5nZU1vbml0b3IucHJvdG90eXBlLmNvbXBhcmVPbGRBbmROZXcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdXJsUGFyYW1zID0gW1wicHJvdG9jb2xcIiwgXCJvcmlnaW5cIiwgXCJzZWFyY2hcIiwgXCJoYXNoXCJdO1xuICAgICAgICAgICAgdmFyIGNoYW5nZWQgPSBbXTtcbiAgICAgICAgICAgIHZhciBfc3VwZXIgPSB0aGlzLl9zdXBlcjtcbiAgICAgICAgICAgIHVybFBhcmFtcy5mb3JFYWNoKGZ1bmN0aW9uIChwYXJhbSkge1xuICAgICAgICAgICAgICAgIGlmIChfc3VwZXIub2xkLmhhc093blByb3BlcnR5KHBhcmFtKSAmJiBfc3VwZXIub2xkW3BhcmFtXSAhPT0gX3N1cGVyLm5ld1twYXJhbV0pIHtcbiAgICAgICAgICAgICAgICAgICAgY2hhbmdlZC5wdXNoKHBhcmFtKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmIChfc3VwZXIuTGlua2VkSW1hZ2UgJiYgX3N1cGVyLkxpbmtlZEltYWdlLmFsdCAhPT0gX3N1cGVyLkxpbmtlZEltYWdlT2xkLmFsdCkge1xuICAgICAgICAgICAgICAgIGNoYW5nZWQucHVzaChcImFsdFwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBjaGFuZ2VkO1xuICAgICAgICB9O1xuICAgICAgICBDaGFuZ2VNb25pdG9yLnByb3RvdHlwZS5iZWZvcmVEaWRSZXR1cm5DaGFuZ2VzID0gZnVuY3Rpb24gKCkgeyB9O1xuICAgICAgICBDaGFuZ2VNb25pdG9yLnByb3RvdHlwZS5hZnRlckRpZFJldHVybkNoYW5nZXMgPSBmdW5jdGlvbiAoKSB7IH07XG4gICAgICAgIENoYW5nZU1vbml0b3IucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9zdXBlci5yZWFkT25seSA9PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgIHZhciBvdXRwdXQgPSBbXTtcbiAgICAgICAgICAgICAgICB2YXIgY2hhbmdlcyA9IHRoaXMuY29tcGFyZU9sZEFuZE5ldygpO1xuICAgICAgICAgICAgICAgIHZhciBDTSA9IHRoaXM7XG4gICAgICAgICAgICAgICAgY2hhbmdlcy5mb3JFYWNoKGZ1bmN0aW9uIChzY29wZSkge1xuICAgICAgICAgICAgICAgICAgICBvdXRwdXQucHVzaChDTS5hcnRpY3VsYXRlQ2hhbmdlcyhzY29wZSwge30pKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0aGlzLm1lc3NhZ2VzID0gb3V0cHV0O1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBDaGFuZ2VNb25pdG9yLnByb3RvdHlwZS5jb21wYXJlU2VhcmNoU3RyaW5ncyA9IGZ1bmN0aW9uIChvbGRQLCBuZXdQKSB7XG4gICAgICAgICAgICB2YXIgcGF5bG9hZCA9IHtcbiAgICAgICAgICAgICAgICBhZGRlZDogW10sXG4gICAgICAgICAgICAgICAgdXBkYXRlZDogW10sXG4gICAgICAgICAgICAgICAgcmVtb3ZlZDogW11cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBmb3IgKHZhciBpIGluIG9sZFApIHtcbiAgICAgICAgICAgICAgICBpZiAobmV3UC5pbmRleE9mKG9sZFBbaV0pID09PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICBwYXlsb2FkLnJlbW92ZWQucHVzaChvbGRQW2ldKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKGkgaW4gbmV3UCkge1xuICAgICAgICAgICAgICAgIGlmIChvbGRQLmluZGV4T2YobmV3UFtpXSkgPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHBheWxvYWQuYWRkZWQucHVzaChuZXdQW2ldKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgZmluZF9wYXR0ZXJuX2luQXJyYXkgPSBmdW5jdGlvbiAocGF0dGVybiwgYXJyKSB7XG4gICAgICAgICAgICAgICAgdmFyIG91dHB1dCA9IC0xO1xuICAgICAgICAgICAgICAgIGZvciAodmFyIHkgPSAwOyB5IDwgYXJyLmxlbmd0aDsgeSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwidXVwZGF0cmVkP1wiLHkpO1xuICAgICAgICAgICAgICAgICAgICBpZiAocGF0dGVybi50ZXN0KGFyclt5XSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG91dHB1dCA9IHk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBmb3IgKGkgaW4gb2xkUCkge1xuICAgICAgICAgICAgICAgIHZhciByZSA9IG5ldyBSZWdFeHAob2xkUFtpXS5zcGxpdChcIj1cIilbMF0gKyBcIj1cIik7XG4gICAgICAgICAgICAgICAgdmFyIGZvdW5kID0gZmluZF9wYXR0ZXJuX2luQXJyYXkocmUsIHBheWxvYWQuYWRkZWQpO1xuICAgICAgICAgICAgICAgIGlmIChmb3VuZCA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIHBheWxvYWQudXBkYXRlZC5wdXNoKHBheWxvYWQuYWRkZWRbZm91bmRdKTtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG90aGVyID0gZmluZF9wYXR0ZXJuX2luQXJyYXkocmUsIHBheWxvYWQucmVtb3ZlZCk7XG4gICAgICAgICAgICAgICAgICAgIHBheWxvYWQucmVtb3ZlZC5zcGxpY2Uob3RoZXIsIDEpO1xuICAgICAgICAgICAgICAgICAgICBwYXlsb2FkLmFkZGVkLnNwbGljZShmb3VuZCwgMSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHBheWxvYWQ7XG4gICAgICAgIH07XG4gICAgICAgIENoYW5nZU1vbml0b3IucHJvdG90eXBlLmFydGljdWxhdGVDaGFuZ2VzID0gZnVuY3Rpb24gKHNjb3BlLCBhcmdzKSB7XG4gICAgICAgICAgICBpZiAoc2NvcGUgPT0gXCJwcm90b2NvbFwiKSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX3N1cGVyLm5ldy5wcm90b2NvbCA9PSBcIm1haWx0bzpcIikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4geyBtZXNzYWdlOiBcIkNoYW5nZWQgdG8gbWFpbHRvIGxpbmsuXCIsIGRhdGE6IFtdIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogKHRoaXMuX3N1cGVyLm9sZC5wcm90b2NvbCA9PSBcIlwiID8gXCJVcGRhdGVkXCIgOiBcIkNoYW5nZWRcIikgKyBcIiBwcm90b2NvbCB0byBcIiArIHRoaXMuX3N1cGVyLm5ldy5wcm90b2NvbCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IFtdXG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoc2NvcGUgPT0gXCJvcmlnaW5cIikge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9zdXBlci5uZXcucHJvdG9jb2wgPT0gXCJtYWlsdG86XCIpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsgbWVzc2FnZTogXCJDaGFuZ2VkIG1haWx0byBsaW5rIHRvIFwiICsgdGhpcy5fc3VwZXIubmV3Lm9yaWdpbiwgZGF0YTogW10gfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7IG1lc3NhZ2U6IFwiQ2hhbmdlZCBsaW5rIFVSTCB0byBcIiArIHRoaXMuX3N1cGVyLm5ldy5vcmlnaW4sIGRhdGE6IFtdIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoc2NvcGUgPT0gXCJhbHRcIikge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9zdXBlci5MaW5rZWRJbWFnZS5hbHQgPT0gXCJcIikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4geyBtZXNzYWdlOiBcIlJlbW92ZWQgbGlua2VkIGltYWdlIEFMVCB0ZXh0XCIsIGRhdGE6IFtdIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4geyBtZXNzYWdlOiBcIlVwZGF0ZWQgbGlua2VkIGltYWdlIEFMVCB0ZXh0IHRvIDxiPlwiICsgdGhpcy5fc3VwZXIuTGlua2VkSW1hZ2UuYWx0ICsgXCI8L2I+XCIsIGRhdGE6IFtdIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoc2NvcGUgPT0gXCJzZWFyY2hcIikge1xuICAgICAgICAgICAgICAgIHZhciBvbGRQYXJhbXMgPSB0aGlzLl9zdXBlci5vbGQuc2VhcmNoUGFyYW1zLl9lbnRyaWVzO1xuICAgICAgICAgICAgICAgIHZhciBuZXdQYXJhbXMgPSB0aGlzLl9zdXBlci5uZXcuc2VhcmNoUGFyYW1zLl9lbnRyaWVzO1xuICAgICAgICAgICAgICAgIHZhciBzZWFyY2hDaGFuZ2VzXzEgPSB0aGlzLmNvbXBhcmVTZWFyY2hTdHJpbmdzKG9sZFBhcmFtcywgbmV3UGFyYW1zKTtcbiAgICAgICAgICAgICAgICB2YXIgbWVzc2FnZSA9IFwiXCI7XG4gICAgICAgICAgICAgICAgdmFyIF9zdXBlciA9IHRoaXMuX3N1cGVyO1xuICAgICAgICAgICAgICAgIFtcInVwZGF0ZWRcIiwgXCJhZGRlZFwiLCBcInJlbW92ZWRcIl0uZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZWFyY2hDaGFuZ2VzXzFba2V5XS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlID0gbWVzc2FnZSArIGtleVswXS50b1VwcGVyQ2FzZSgpICsga2V5LnN1YnN0cigxLCBrZXkubGVuZ3RoKSArIFwiIFwiICsgKF9zdXBlci5uZXcucHJvdG9jb2wgPT0gXCJtYWlsdG86XCIgPyBcInBhcmFtZXRlclwiIDogXCJxdWVyeSBzdHJpbmdcIikgKyAoc2VhcmNoQ2hhbmdlc18xW2tleV0ubGVuZ3RoID4gMSA/IFwic1wiIDogXCJcIikgKyBcIjogPGI+XCIgKyBzZWFyY2hDaGFuZ2VzXzFba2V5XS5qb2luKFwiLCBcIikgKyBcIjwvYj48YnI+XCI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICByZXR1cm4geyBtZXNzYWdlOiBtZXNzYWdlLCBkYXRhOiBbXSB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZiAoc2NvcGUgPT0gXCJoYXNoXCIpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fc3VwZXIub2xkLmhhc2ggPT0gXCJcIikge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4geyBtZXNzYWdlOiBcIllvdSBhZGRlZCB0aGUgaGFzaCBcIiArIHRoaXMuX3N1cGVyLm5ldy5oYXNoLCBkYXRhOiBbXSB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX3N1cGVyLm5ldy5oYXNoID09IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7IG1lc3NhZ2U6IFwiWW91IHJlbW92ZWQgdGhlIGhhc2ggXCIgKyB0aGlzLl9zdXBlci5vbGQuaGFzaCwgZGF0YTogW10gfTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB7IG1lc3NhZ2U6IFwiWW91IGNoYW5nZWQgdGhlIGhhc2ggZnJvbSBcIiArIHRoaXMuX3N1cGVyLm9sZC5oYXNoICsgXCIgdG8gXCIgKyB0aGlzLl9zdXBlci5uZXcuaGFzaCwgZGF0YTogW10gfTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIENoYW5nZU1vbml0b3I7XG4gICAgfSgpKTtcbiAgICBFTUxNb2R1bGUuQ2hhbmdlTW9uaXRvciA9IENoYW5nZU1vbml0b3I7XG4gICAgdmFyIEVNTFdvcmtzcGFjZSA9IChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIEVNTFdvcmtzcGFjZShodG1sLCAkc2NvcGUpIHtcbiAgICAgICAgICAgIHRoaXMub3ZlcnJpZGRlbklkcyA9IFtdO1xuICAgICAgICAgICAgaWYgKGh0bWwgPT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgICAgICBodG1sID0gXCJcIjtcbiAgICAgICAgICAgIGlmICgkc2NvcGUgPT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgICAgICAkc2NvcGUgPSBcIlwiO1xuICAgICAgICAgICAgdmFyIFdvcmtzcGFjZSA9IHRoaXM7XG4gICAgICAgICAgICB0aGlzLmJ1ZmZlciA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLnNjb3BlID0gJHNjb3BlO1xuICAgICAgICAgICAgdGhpcy5saW5rc1ZpZXcgPSAnZXhwZXJpbWVudGFsJzsgLy9hZHZhbmNlZCBzaG93cyBhbGxcbiAgICAgICAgICAgIHRoaXMuc291cmNlQ29kZSA9IGh0bWw7IC8vaW5pdGFsXG4gICAgICAgICAgICB0aGlzLndvcmtpbmdDb2RlID0gXCJcIjtcbiAgICAgICAgICAgIHRoaXMuZmlsZU5hbWUgPSBcImVtbC1tYWtlci11bnRpdGxlZFwiO1xuICAgICAgICAgICAgdGhpcy5saW5rRGF0YSA9IFtdO1xuICAgICAgICAgICAgdGhpcy5fZGVmYXVsdFNDb2RlID0gXCJzPWVtYWlsXCI7XG4gICAgICAgICAgICB0aGlzLmhlYWRlciA9IHsgXCJzdWJqZWN0XCI6IFwiXCIgfTtcbiAgICAgICAgICAgIHRoaXMubWVzc2FnZXMgPSBbXTtcbiAgICAgICAgICAgIHRoaXMuZXhwb3J0Rm9yRWxvcXVhID0gXCJZZXNcIjtcbiAgICAgICAgICAgIHRoaXMuX19lbWxIZWFkZXJzID0gXCJcIjtcbiAgICAgICAgICAgIHRoaXMua2V5Qm9hcmRTaG9ydGN1dHMgPSBbXTtcbiAgICAgICAgICAgIHRoaXMuX19hbGxvd2FibGVIZWFkZXJGaWVsZHMgPSB7XG4gICAgICAgICAgICAgICAgXCJ0b1wiOiB7IHN5bnRheDogXCJUbzogXCIsIGxhYmVsOiBcIlRvXCIsIGluc3RydWN0aW9uczogXCJBIGxpc3Qgb2YgZW1haWwgYWRkcmVzc2VzIHNlcGFyYXRlZCBieSBjb21tYXMuXCIgfSxcbiAgICAgICAgICAgICAgICBcInN1YmplY3RcIjogeyBzeW50YXg6IFwiU3ViamVjdDogXCIsIGxhYmVsOiBcIlN1YmplY3RcIiwgaW5zdHJ1Y3Rpb25zOiBcIlwiIH0sXG4gICAgICAgICAgICAgICAgXCJjY1wiOiB7IHN5bnRheDogXCJDYzogXCIsIGxhYmVsOiBcIkNDXCIsIGluc3RydWN0aW9uczogXCJBIGxpc3Qgb2YgZW1haWwgYWRkcmVzc2VzIHNlcGFyYXRlZCBieSBjb21tYXMuXCIgfSxcbiAgICAgICAgICAgICAgICBcInJlcGx5dG9cIjogeyBzeW50YXg6IFwiUmVwbHktdG86IFwiLCBsYWJlbDogXCJSZXBseSB0b1wiLCBpbnN0cnVjdGlvbnM6IFwiQSBsaXN0IG9mIGVtYWlsIGFkZHJlc3NlcyBzZXBhcmF0ZWQgYnkgY29tbWFzLlwiIH1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLmhlYWRlcnMgPSBbXG4gICAgICAgICAgICAgICAgXCJYLVVuc2VudDogMVwiLFxuICAgICAgICAgICAgICAgIFwiTWltZS1WZXJzaW9uOiAxLjAgKE1hYyBPUyBYIE1haWwgMTAuMSBcXCgzMjUxXFwpKVwiLFxuICAgICAgICAgICAgICAgIFwiWC1Vbmlmb3JtLVR5cGUtSWRlbnRpZmllcjogY29tLmFwcGxlLm1haWwtZHJhZnRcIixcbiAgICAgICAgICAgICAgICBcIkNvbnRlbnQtVHJhbnNmZXItRW5jb2Rpbmc6IDdiaXRcIlxuICAgICAgICAgICAgXTtcbiAgICAgICAgICAgIHRoaXMuaW50ZWxsaWdlbmNlID0gRU1MSW50ZWxsaWdlbmNlLm1vZHVsZShcImVtYWlsXCIpLm1vbml0b3IoKTtcbiAgICAgICAgICAgIHRoaXMuaW50ZWxsaWdlbmNlLmFzc29jaWF0ZVZhcmlhYmxlKFwiRU1MV29ya3NwYWNlXCIsIHRoaXMpO1xuICAgICAgICB9XG4gICAgICAgIEVNTFdvcmtzcGFjZS5wcm90b3R5cGUubWFwTGlua09iamVjdHMgPSBmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmxpbmtEYXRhLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubGlua0RhdGEubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2sodGhpcy5saW5rRGF0YVtpXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBFTUxXb3Jrc3BhY2UucHJvdG90eXBlLmNvbXBvc2VFTUwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBsb2NhdGlvbi5ocmVmID0gXCIjL2V4cG9ydC1jb21wb3NlLWVtbFwiO1xuICAgICAgICB9O1xuICAgICAgICBFTUxXb3Jrc3BhY2UucHJvdG90eXBlLmRvd25sb2FkRW1sID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5iZWZvcmVEaWREb3dubG9hZEVtbCgpO1xuICAgICAgICAgICAgdmFyIG91dHB1dCA9IHRoaXMuX19lbWxIZWFkZXJzICsgXCJcXG5cXG5cIiArIHRoaXMuX19yZW1vdmVXaGl0ZVNwYWNlKHRoaXMuX19yZXBsYWNlRWxvcXVhTWVyZ2VGaWVsZHModGhpcy5nZW5lcmF0ZU91dHB1dENvZGUoXCJvZnRcIikpKTtcbiAgICAgICAgICAgIHRoaXMuZmlsZU5hbWUgPSB0aGlzLl9fZm9ybWF0RmlsZU5hbWUodGhpcy5maWxlTmFtZSk7XG4gICAgICAgICAgICB3aW5kb3cuc2F2ZUFzKG5ldyBCbG9iKFtvdXRwdXRdLCB7IHR5cGU6IFwidGV4dC9odG1sXCIgfSksIHRoaXMuZmlsZU5hbWUgKyBcIi5lbWxcIik7XG4gICAgICAgICAgICB0aGlzLmFmdGVyRGlkRG93bmxvYWRFbWwoKTtcbiAgICAgICAgfTtcbiAgICAgICAgRU1MV29ya3NwYWNlLnByb3RvdHlwZS5iZWZvcmVEaWREb3dubG9hZEVtbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMubWFwTGlua09iamVjdHMoZnVuY3Rpb24gKExpbmtPYmplY3QpIHtcbiAgICAgICAgICAgICAgICBpZiAoTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLmhhcyhcImVscVRyYWNrXCIpKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBpbmRleCA9IExpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5lbnRyaWVzLmluZGV4T2YoXCJlbHFUcmFjaz10cnVlXCIpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaW5kZXggPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLmRlbGV0ZUF0SW5kZXgoaW5kZXgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICghTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLmhhcyhcInNcIikgJiYgTGlua09iamVjdC5yZXF1aXJlc1NDb2RlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLmFwcGVuZChcInM9b2Z0XCIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKExpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5nZXQoXCJzXCIpID09IFwiZW1haWxcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLnNldChcInNcIiwgXCJvZnRcIik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMubWFwTGlua09iamVjdHMoZnVuY3Rpb24gKExpbmtPYmplY3QpIHtcbiAgICAgICAgICAgICAgICBMaW5rT2JqZWN0LkNoYW5nZU1vbml0b3IudXBkYXRlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgRU1MV29ya3NwYWNlLnByb3RvdHlwZS5hZnRlckRpZERvd25sb2FkRW1sID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgd2luZG93LmdhKCdzZW5kJywgJ2V2ZW50JywgXCJFTUxcIiwgXCJkb3dubG9hZFwiLCBcIkVNTCBFeHBvcnRcIik7XG4gICAgICAgICAgICBsb2NhdGlvbi5ocmVmID0gXCIjL2V4cG9ydC1lbWxcIjtcbiAgICAgICAgfTtcbiAgICAgICAgRU1MV29ya3NwYWNlLnByb3RvdHlwZS5kb3dubG9hZENzdiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBvdXRwdXQgPSBcIkNvbnRleHQsT3JpZ2luYWwgVVJMLE1vZGlmaWVkIFVSTFxcblwiO1xuICAgICAgICAgICAgdGhpcy5tYXBMaW5rT2JqZWN0cyhmdW5jdGlvbiAoTGlua09iamVjdCkge1xuICAgICAgICAgICAgICAgIG91dHB1dCArPSBMaW5rT2JqZWN0LmNvbnRleHQucmVwbGFjZSgvLC9nLCBcIihjb21tYSlcIikgKyBcIixcIiArIExpbmtPYmplY3Qub2xkLnVybCArIFwiLFwiICsgTGlua09iamVjdC5uZXcudXJsICsgXCJcXG5cIjtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5maWxlTmFtZSA9IHRoaXMuX19mb3JtYXRGaWxlTmFtZSh0aGlzLmZpbGVOYW1lKTtcbiAgICAgICAgICAgIHdpbmRvdy5zYXZlQXMobmV3IEJsb2IoW291dHB1dF0sIHsgdHlwZTogXCJ0ZXh0L2NzdlwiIH0pLCB0aGlzLmZpbGVOYW1lICsgXCJfbGlua3MuY3N2XCIpO1xuICAgICAgICAgICAgd2luZG93LmdhKCdzZW5kJywgJ2V2ZW50JywgXCJDU1ZcIiwgXCJkb3dubG9hZFwiLCBcIkNTViBFeHBvcnRcIik7XG4gICAgICAgIH07XG4gICAgICAgIEVNTFdvcmtzcGFjZS5wcm90b3R5cGUuZG93bmxvYWRIdG1sID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIG91dHB1dCA9IHRoaXMuYmVmb3JlRGlkRG93bmxvYWRIdG1sKHRoaXMuZ2VuZXJhdGVPdXRwdXRDb2RlKFwiZW1haWxcIikpO1xuICAgICAgICAgICAgdGhpcy5maWxlTmFtZSA9IHRoaXMuX19mb3JtYXRGaWxlTmFtZSh0aGlzLmZpbGVOYW1lKTtcbiAgICAgICAgICAgIHdpbmRvdy5zYXZlQXMobmV3IEJsb2IoW291dHB1dF0sIHsgdHlwZTogXCJ0ZXh0L2h0bWxcIiB9KSwgdGhpcy5maWxlTmFtZSArIFwiLmh0bWxcIik7XG4gICAgICAgICAgICB0aGlzLmFmdGVyRGlkRG93bmxvYWRIdG1sKCk7XG4gICAgICAgIH07XG4gICAgICAgIEVNTFdvcmtzcGFjZS5wcm90b3R5cGUuYmVmb3JlRGlkRG93bmxvYWRIdG1sID0gZnVuY3Rpb24gKGNvZGUpIHtcbiAgICAgICAgICAgIHJldHVybiBjb2RlO1xuICAgICAgICB9O1xuICAgICAgICBFTUxXb3Jrc3BhY2UucHJvdG90eXBlLmFmdGVyRGlkRG93bmxvYWRIdG1sID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgd2luZG93LmdhKCdzZW5kJywgJ2V2ZW50JywgXCJIVE1MXCIsIFwiZG93bmxvYWRcIiwgXCJIVE1MIEV4cG9ydFwiKTtcbiAgICAgICAgfTtcbiAgICAgICAgRU1MV29ya3NwYWNlLnByb3RvdHlwZS5leHBvcnRDb2RlVG9IVE1MID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdGhpcy5iZWZvcmVEaWRFeHBvcnRDb2RlVG9IVE1MKCk7XG4gICAgICAgICAgICB0aGlzLm91dHB1dENvZGUgPSB0aGlzLmdlbmVyYXRlT3V0cHV0Q29kZShcImVtYWlsXCIpO1xuICAgICAgICAgICAgdGhpcy5hZnRlckRpZEV4cG9ydENvZGVUb0hUTUwoKTtcbiAgICAgICAgfTtcbiAgICAgICAgRU1MV29ya3NwYWNlLnByb3RvdHlwZS5iZWZvcmVEaWRFeHBvcnRDb2RlVG9IVE1MID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHRyYWNraW5nT3B0T3V0ID0gZmFsc2U7XG4gICAgICAgICAgICBpZiAodGhpcy5leHBvcnRGb3JFbG9xdWEgJiYgdGhpcy5leHBvcnRGb3JFbG9xdWEgPT0gXCJZZXNcIikge1xuICAgICAgICAgICAgICAgIHdpbmRvdy5nYSgnc2VuZCcsICdldmVudCcsIFwiSFRNTFwiLCBcIkFkZCBFbG9xdWEgVHJhY2tpbmdcIiwgXCJBZGQgRWxvcXVhIFRyYWNraW5nXCIpO1xuICAgICAgICAgICAgICAgIHRoaXMubWFwTGlua09iamVjdHMoZnVuY3Rpb24gKExpbmtPYmplY3QpIHtcbiAgICAgICAgICAgICAgICAgICAgdHJhY2tpbmdPcHRPdXQgPSBMaW5rT2JqZWN0LndoaXRlTGlzdGVkVXJsID09IExpbmtPYmplY3QubmV3LnVybDtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFMaW5rT2JqZWN0LmlzTGlua1R5cGUoXCJtYWlsdG9cIilcbiAgICAgICAgICAgICAgICAgICAgICAgICYmICFMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuaGFzKFwiZWxxVHJhY2tcIilcbiAgICAgICAgICAgICAgICAgICAgICAgICYmICEvYXBwXFwuaW5mb1xcLm9wdHVtXFwuY29tL2dpLnRlc3QoTGlua09iamVjdC5uZXcudXJsKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLmFwcGVuZChcImVscVRyYWNrPXRydWVcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodHJhY2tpbmdPcHRPdXQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBMaW5rT2JqZWN0LndoaXRlTGlzdGVkVXJsID0gTGlua09iamVjdC5uZXcudXJsO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLm1hcExpbmtPYmplY3RzKGZ1bmN0aW9uIChMaW5rT2JqZWN0KSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuaGFzKFwiZWxxVHJhY2tcIikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbmRleCA9IExpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5lbnRyaWVzLmluZGV4T2YoXCJlbHFUcmFjaz10cnVlXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGluZGV4ID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuZGVsZXRlQXRJbmRleChpbmRleCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBMaW5rT2JqZWN0LmlzTGlua0NvbXBsZXRlKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgTGlua09iamVjdC5DaGFuZ2VNb25pdG9yLnVwZGF0ZSgpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5tYXBMaW5rT2JqZWN0cyhmdW5jdGlvbiAoTGlua09iamVjdCkge1xuICAgICAgICAgICAgICAgIGlmICghTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLmhhcyhcInNcIikgJiYgTGlua09iamVjdC5yZXF1aXJlc1NDb2RlKCkpIHtcbiAgICAgICAgICAgICAgICAgICAgTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLmFwcGVuZChcInM9ZW1haWxcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBpZiAoTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLmhhcyhcInNcIikgJiYgTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLmdldChcInNcIikgPT0gXCJvZnRcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLnNldChcInNcIiwgXCJlbWFpbFwiKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBMaW5rT2JqZWN0LkNoYW5nZU1vbml0b3IudXBkYXRlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRoaXMubWFwTGlua09iamVjdHMoZnVuY3Rpb24gKExpbmtPYmplY3QpIHtcbiAgICAgICAgICAgICAgICBMaW5rT2JqZWN0LkNoYW5nZU1vbml0b3IudXBkYXRlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgRU1MV29ya3NwYWNlLnByb3RvdHlwZS5hZnRlckRpZEV4cG9ydENvZGVUb0hUTUwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLm1hcExpbmtPYmplY3RzKGZ1bmN0aW9uIChMaW5rT2JqZWN0KSB7XG4gICAgICAgICAgICAgICAgaWYgKExpbmtPYmplY3Qud2hpdGVMaXN0ZWRVcmwgPT0gTGlua09iamVjdC5uZXcudXJsKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vcmVwb3J0IHRoZSBub24gdHJhY2tlZCBsaW5rO1xuICAgICAgICAgICAgICAgICAgICB3aW5kb3cuZ2EoJ3NlbmQnLCAnZXZlbnQnLCBcIlRyYWNraW5nLU9wdG91dFwiLCBcIm92ZXJyaWRlXCIsIExpbmtPYmplY3QubmV3LnVybCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB3aW5kb3cuZ2EoJ3NlbmQnLCAnZXZlbnQnLCBcIkhUTUxcIiwgXCJ2aWV3IHNvdXJjZWNvZGVcIiwgXCJFeHBvcnQvVmlldyBIVE1MXCIpO1xuICAgICAgICAgICAgbG9jYXRpb24uaHJlZiA9IFwiIy9leHBvcnQtaHRtbFwiO1xuICAgICAgICB9O1xuICAgICAgICBFTUxXb3Jrc3BhY2UucHJvdG90eXBlLnNldFVwU2hvcnRjdXRLZXlzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIHRoaXMua2V5Qm9hcmRTaG9ydGN1dHMgPSBbXTtcbiAgICAgICAgICAgIF90aGlzLmtleUJvYXJkU2hvcnRjdXRzLnB1c2gobmV3IEtleWJvYXJkU2hvcnRjdXQoZnVuY3Rpb24gKGUpIHsgcmV0dXJuIChlLmN0cmxLZXkgfHwgZS5tZXRhS2V5KSAmJiBlLnNoaWZ0S2V5ICYmIGUud2hpY2ggPT0gNTI7IH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAvL2RvdGhpcztcbiAgICAgICAgICAgICAgICBfdGhpcy5zY29wZS4kYXBwbHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnZG93bmxvYWRpbmcgZmlsZScpO1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5kb3dubG9hZEh0bWwoKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0sIFwiQ1RSTCArIFNISUZUICsgNFwiLCBcIkRvd25sb2FkIEhUTUxcIikpO1xuICAgICAgICAgICAgX3RoaXMua2V5Qm9hcmRTaG9ydGN1dHMucHVzaChuZXcgS2V5Ym9hcmRTaG9ydGN1dChmdW5jdGlvbiAoZSkgeyByZXR1cm4gKGUuY3RybEtleSB8fCBlLm1ldGFLZXkpICYmIGUuc2hpZnRLZXkgJiYgZS53aGljaCA9PSA1MTsgfSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIC8vZG90aGlzO1xuICAgICAgICAgICAgICAgIF90aGlzLnNjb3BlLiRhcHBseShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLm1hcExpbmtPYmplY3RzKGZ1bmN0aW9uIChMaW5rT2JqZWN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoTGlua09iamVjdC5lcnJvcnMubWVzc2FnZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIExpbmtPYmplY3QuZXJyb3JzLm1lc3NhZ2VzLmZvckVhY2goZnVuY3Rpb24gKE1lc3NhZ2VPYmplY3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKE1lc3NhZ2VPYmplY3QudHlwZSA9PSBFcnJvclR5cGUuU3VnZ2VzdGlvbikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTWVzc2FnZU9iamVjdC5jdGFIYW5kbGVyKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBMaW5rT2JqZWN0LmlzTGlua0NvbXBsZXRlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSwgXCJDVFJMICsgU0hJRlQgKyAzXCIsIFwiQXBwbHkgYWxsIHN1Z2dlc3Rpb25zXCIpKTtcbiAgICAgICAgICAgIF90aGlzLmtleUJvYXJkU2hvcnRjdXRzLnB1c2gobmV3IEtleWJvYXJkU2hvcnRjdXQoZnVuY3Rpb24gKGUpIHsgcmV0dXJuIChlLmN0cmxLZXkgfHwgZS5tZXRhS2V5KSAmJiBlLnNoaWZ0S2V5ICYmIGUud2hpY2ggPT0gNTA7IH0sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAvL2RvdGhpcztcbiAgICAgICAgICAgICAgICBfdGhpcy5zY29wZS4kYXBwbHkoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5tYXBMaW5rT2JqZWN0cyhmdW5jdGlvbiAoTGlua09iamVjdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFMaW5rT2JqZWN0LnJlYWRPbmx5XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJiYgTGlua09iamVjdC5yZXF1aXJlc1NDb2RlKClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAmJiAhTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLmhhcygncycpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLmFwcGVuZCgncz1lbWFpbCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIExpbmtPYmplY3QuaXNMaW5rQ29tcGxldGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LCBcIkNUUkwgKyBTSElGVCArIDJcIiwgXCJBZGQgcz1lbWFpbCB0byBhbGwgbGlua3NcIikpO1xuICAgICAgICAgICAgX3RoaXMua2V5Qm9hcmRTaG9ydGN1dHMucHVzaChuZXcgS2V5Ym9hcmRTaG9ydGN1dChmdW5jdGlvbiAoZSkgeyByZXR1cm4gKGUuY3RybEtleSB8fCBlLm1ldGFLZXkpICYmIGUuc2hpZnRLZXkgJiYgZS53aGljaCA9PSA0OTsgfSwgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIC8vZG90aGlzO1xuICAgICAgICAgICAgICAgIF90aGlzLnNjb3BlLiRhcHBseShmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLm1hcExpbmtPYmplY3RzKGZ1bmN0aW9uIChMaW5rT2JqZWN0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoTGlua09iamVjdC5yZWFkT25seSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIExpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5kZWxldGUoXCJvXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLmRlbGV0ZShcIm9pblwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIExpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5kZWxldGUoXCJ2XCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLmRlbGV0ZShcIm9pZXhcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICBMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuZGVsZXRlKFwiZWxxX21pZFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIExpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5kZWxldGUoXCJlbHFfbGlkXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLmRlbGV0ZShcImVscVRyYWNrXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgTGlua09iamVjdC5uZXcuc2VhcmNoUGFyYW1zLmRlbGV0ZShcImVscVRyYWNrSWRcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICBMaW5rT2JqZWN0Lm5ldy5zZWFyY2hQYXJhbXMuZGVsZXRlKFwic1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIExpbmtPYmplY3QubmV3LnNlYXJjaFBhcmFtcy5kZWxldGUoXCJzM1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIExpbmtPYmplY3QuaXNMaW5rQ29tcGxldGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmFyZUxpbmtzQ29tcGxldGUoKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LCBcIkNUUkwgKyBTSElGVCArIDFcIiwgXCJSZW1vdmUgYWxsIHF1ZXJ5IHN0cmluZ3MgZnJvbSBlbWFpbFwiKSk7XG4gICAgICAgICAgICBkb2N1bWVudC5vbmtleXVwID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBfaSA9IDAsIF9hID0gX3RoaXMua2V5Qm9hcmRTaG9ydGN1dHM7IF9pIDwgX2EubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzaG9ydGN1dCA9IF9hW19pXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNob3J0Y3V0LndoZW4gJiYgc2hvcnRjdXQud2hlbihlKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2hvcnRjdXQuZG9UaGlzKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICB9O1xuICAgICAgICBFTUxXb3Jrc3BhY2UucHJvdG90eXBlLnJlcGxhY2VTcGVjaWFsQ2hhcmFjdGVycyA9IGZ1bmN0aW9uICh0ZXh0KSB7XG4gICAgICAgICAgICB2YXIgcmVwbGFjZSA9IHtcbiAgICAgICAgICAgICAgICAxNzQ6IFtcIiZyZWc7XCJdLFxuICAgICAgICAgICAgICAgIDE2OTogW1wiJmNvcHk7XCJdLFxuICAgICAgICAgICAgICAgIDgyMTE6IFtcIiZuZGFzaDtcIl0sXG4gICAgICAgICAgICAgICAgODIxMjogW1wiJm1kYXNoO1wiXSxcbiAgICAgICAgICAgICAgICA4MjIwOiBbXCImbGRxdW87XCJdLFxuICAgICAgICAgICAgICAgIDgyMjE6IFtcIiZyZHF1bztcIl0sXG4gICAgICAgICAgICAgICAgODIxNjogW1wiJmxzcXVvO1wiXSxcbiAgICAgICAgICAgICAgICA4MjE3OiBbXCImcnNxdW87XCJdLFxuICAgICAgICAgICAgICAgIDg0ODI6IFtcIiZ0cmFkZTtcIl1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBmb3IgKHZhciBpIGluIHJlcGxhY2UpIHtcbiAgICAgICAgICAgICAgICBpZiAocmVwbGFjZS5oYXNPd25Qcm9wZXJ0eShpKSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmVnZXhwID0gbmV3IFJlZ0V4cChTdHJpbmcuZnJvbUNoYXJDb2RlKHBhcnNlSW50KGkpKSwgXCJnXCIpO1xuICAgICAgICAgICAgICAgICAgICBpZiAocmVnZXhwLnRlc3QodGV4dCkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwiZm91bmQgY2hhcmFjdGVyXCIgKyBTdHJpbmcuZnJvbUNoYXJDb2RlKHBhcnNlSW50KGkpKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ID0gdGV4dC5yZXBsYWNlKHJlZ2V4cCwgcmVwbGFjZVtpXVswXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGV4dDtcbiAgICAgICAgfTtcbiAgICAgICAgRU1MV29ya3NwYWNlLnByb3RvdHlwZS5wcm9jZXNzSHRtbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIC8vY3JlYXRlcyBhIG5ldyB3b3Jrc3BhY2UgZnJvbSBodG1sXG4gICAgICAgICAgICB0aGlzLnNldFVwU2hvcnRjdXRLZXlzKCk7XG4gICAgICAgICAgICB0aGlzLmxpbmtEYXRhID0gW107XG4gICAgICAgICAgICB0aGlzLmludGVsbGlnZW5jZS5vdmVycmlkZGVuID0gW107XG4gICAgICAgICAgICB0aGlzLmludGVsbGlnZW5jZS5ldmFsdWF0ZVJ1bGVzKCk7XG4gICAgICAgICAgICB3aW5kb3cuc2Nyb2xsVG8oMCwgMCk7XG4gICAgICAgICAgICAvLyAucmVwbGFjZShuZXcgUmVnRXhwKFwiPC9hPlwiLFwiaWdcIiksIFwiPC9hPlxcblwiKVxuICAgICAgICAgICAgdGhpcy53b3JraW5nQ29kZSA9IHRoaXMucmVwbGFjZVNwZWNpYWxDaGFyYWN0ZXJzKHRoaXMuc291cmNlQ29kZSk7XG4gICAgICAgICAgICAvL2RldGVybWluZSBlbWFpbCBoZWFkZXJzXG4gICAgICAgICAgICB0aGlzLl9fZW1sSGVhZGVycyA9IHRoaXMuX19idWlsZEhlYWRlcnMoKTtcbiAgICAgICAgICAgIC8vICAgJHNjb3BlLmRhdGEuaGVhZGVyLFxuICAgICAgICAgICAgLy8gICAkc2NvcGUuZGF0YS5hbGxvd2FibGVIZWFkZXJGaWVsZHMpO1xuICAgICAgICAgICAgLy9yZXBsYWNlIG1lcmdlIGZpZWxkc1xuICAgICAgICAgICAgaWYgKHRoaXMuZmlsZU5hbWUgPT0gXCJ1bnRpdGxlZFwiKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRpdGxlUmVnID0gLzx0aXRsZT4oW148XS4qPyk8XFwvdGl0bGU+L2dpO1xuICAgICAgICAgICAgICAgIGlmICh0aXRsZVJlZy50ZXN0KHRoaXMud29ya2luZ0NvZGUpKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0aXRsZVRhZyA9IHRoaXMud29ya2luZ0NvZGUubWF0Y2godGl0bGVSZWcpO1xuICAgICAgICAgICAgICAgICAgICBpZiAodGl0bGVUYWcubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5maWxlTmFtZSA9IHRoaXMuX19mb3JtYXRGaWxlTmFtZSh0aXRsZVRhZ1swXS5yZXBsYWNlKHRpdGxlUmVnLCBcIiQxXCIpKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBfc3VwZXIgPSB0aGlzO1xuICAgICAgICAgICAgdmFyIHJlMSA9IC88YVxcYltePl0qPz4oW1xcclxcbl18LikqPzxcXC9hPi9nbSwgbiA9IDA7XG4gICAgICAgICAgICB0aGlzLndvcmtpbmdDb2RlID0gdGhpcy53b3JraW5nQ29kZS5yZXBsYWNlKHJlMSwgZnVuY3Rpb24gKGZvdW5kKSB7XG4gICAgICAgICAgICAgICAgbisrO1xuICAgICAgICAgICAgICAgIHJldHVybiBmb3VuZC5yZXBsYWNlKFwiPGFcIiwgXCI8YSBlbWwtaWQ9XFxcIlwiICsgbiArIFwiXFxcIlwiKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgbiA9IDA7XG4gICAgICAgICAgICB0aGlzLndvcmtpbmdDb2RlID0gdGhpcy53b3JraW5nQ29kZS5yZXBsYWNlKHJlMSwgZnVuY3Rpb24gKGNvbnRleHQpIHtcbiAgICAgICAgICAgICAgICBuKys7XG4gICAgICAgICAgICAgICAgLy9nZXQgbGluZVxuICAgICAgICAgICAgICAgIHZhciBsaW5lID0gX3N1cGVyLndvcmtpbmdDb2RlLnN1YnN0cigwLCBfc3VwZXIud29ya2luZ0NvZGUuaW5kZXhPZihjb250ZXh0KSkuc3BsaXQoXCJcXG5cIikubGVuZ3RoIC0gMTtcbiAgICAgICAgICAgICAgICBpZiAoLyhocmVmXFw9XFxcIihbXlxcXCJcXD5dKilcXFwiPykvZy50ZXN0KGNvbnRleHQpKSB7XG4gICAgICAgICAgICAgICAgICAgIG4rKztcbiAgICAgICAgICAgICAgICAgICAgdmFyIGEgPSBuZXcgTGlua09iamVjdChsaW5lLCBjb250ZXh0LCBfc3VwZXIpO1xuICAgICAgICAgICAgICAgICAgICBhLmlkID0gbjtcbiAgICAgICAgICAgICAgICAgICAgYS5yZWFkT25seSA9IChhLm5ldy5jb250YWlucyhcIi5jb20vZS9lcy5hc3B4XCIpICYmIGEubmV3LmNvbnRhaW5zKFwifn5lbG9xdWFcIikpO1xuICAgICAgICAgICAgICAgICAgICBfc3VwZXIubGlua0RhdGEucHVzaChhKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIFwie3tFTUxNYWtlcl9MaW5rOlwiICsgbiArIFwifX1cIjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjb250ZXh0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5tYXBMaW5rT2JqZWN0cyhmdW5jdGlvbiAoTGlua09iamVjdCkge1xuICAgICAgICAgICAgICAgIExpbmtPYmplY3QuaXNMaW5rQ29tcGxldGUoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgLy8gY29uc29sZS5sb2codGhpcy5pbnRlbGxpZ2VuY2UpO1xuICAgICAgICAgICAgLy9yZWRpcmVjdFxuICAgICAgICAgICAgbG9jYXRpb24uaHJlZiA9IFwiIy9saW5rc1wiO1xuICAgICAgICB9O1xuICAgICAgICBFTUxXb3Jrc3BhY2UucHJvdG90eXBlLmFkZE5ld0hlYWRlckZpZWxkID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLmhlYWRlclt2YWx1ZV0gPSBcIlwiO1xuICAgICAgICB9O1xuICAgICAgICBFTUxXb3Jrc3BhY2UucHJvdG90eXBlLnJlbW92ZUhlYWRlckZpZWxkID0gZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICBkZWxldGUgdGhpcy5oZWFkZXJbdmFsdWVdO1xuICAgICAgICB9O1xuICAgICAgICBFTUxXb3Jrc3BhY2UucHJvdG90eXBlLmlzSGVhZGVyU2VsZWN0ZWQgPSBmdW5jdGlvbiAoaGVhZGVyKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuaGVhZGVyLmhhc093blByb3BlcnR5KGhlYWRlcikgfHwgdGhpcy5oZWFkZXIgPT0gXCJcIikge1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBFTUxXb3Jrc3BhY2UucHJvdG90eXBlLnZlcmlmeUxpbmtTZWN0aW9uQ29tcGxldGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgb3V0cHV0ID0gZmFsc2U7XG4gICAgICAgICAgICBpZiAodGhpcy5pbnRlbGxpZ2VuY2UgJiYgIXRoaXMuaW50ZWxsaWdlbmNlLmNhbkNvbnRpbnVlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gYXJlIHRoZXJlIGxpbmsgaXNzdWVzP1xuICAgICAgICAgICAgaWYgKHRoaXMubGlua0RhdGEgJiYgdGhpcy5saW5rRGF0YS5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgICAgIG91dHB1dCA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuYXJlTGlua3NDb21wbGV0ZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgIG91dHB1dCA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBvdXRwdXQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gb3V0cHV0O1xuICAgICAgICB9O1xuICAgICAgICBFTUxXb3Jrc3BhY2UucHJvdG90eXBlLmdlbmVyYXRlT3V0cHV0Q29kZSA9IGZ1bmN0aW9uICh0eXBlLCBjbG9uZSkge1xuICAgICAgICAgICAgaWYgKHR5cGUgPT09IHVuZGVmaW5lZClcbiAgICAgICAgICAgICAgICB0eXBlID0gXCJlbWFpbFwiO1xuICAgICAgICAgICAgaWYgKGNsb25lID09PSB1bmRlZmluZWQpXG4gICAgICAgICAgICAgICAgY2xvbmUgPSB0cnVlO1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIHZhciBvdXRwdXQgPSB0aGlzLndvcmtpbmdDb2RlO1xuICAgICAgICAgICAgLy9wb3N0IHByb2Nlc3NpbmcuXG4gICAgICAgICAgICAvL2RvIHBvc3QgcHJvY2Vzc2luZy5cbiAgICAgICAgICAgIC8vZXhwb3J0IGNvZGU/XG4gICAgICAgICAgICB0aGlzLm1hcExpbmtPYmplY3RzKGZ1bmN0aW9uIChMaW5rT2JqZWN0KSB7XG4gICAgICAgICAgICAgICAgaWYgKExpbmtPYmplY3QuaGFzT3duUHJvcGVydHkoXCJkZWxldGVPblJlbmRlclwiKSAmJiBMaW5rT2JqZWN0LmRlbGV0ZU9uUmVuZGVyKSB7XG4gICAgICAgICAgICAgICAgICAgIG91dHB1dCA9IG91dHB1dC5yZXBsYWNlKG5ldyBSZWdFeHAoXCJ7e0VNTE1ha2VyX0xpbms6XCIgKyBMaW5rT2JqZWN0LmlkICsgXCJ9fVwiLCBcImdpXCIpLCBcIlwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSBpZiAoTGlua09iamVjdC5yZWFkT25seSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgcmVhZE9ubHlVcmwgPSBMaW5rT2JqZWN0LmNvbnRleHQucmVwbGFjZSgvZW1sXFwtaWRcXD1cXFwiWzAtOV17MSx9XFxcIlxccy9nLCBcIlwiKTtcbiAgICAgICAgICAgICAgICAgICAgb3V0cHV0ID0gb3V0cHV0LnJlcGxhY2UobmV3IFJlZ0V4cChcInt7RU1MTWFrZXJfTGluazpcIiArIExpbmtPYmplY3QuaWQgKyBcIn19XCIsIFwiZ2lcIiksIHJlYWRPbmx5VXJsKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBzdGFydCA9IExpbmtPYmplY3QuY29udGV4dC5pbmRleE9mKFwiaHJlZj1cXFwiXCIgKyBMaW5rT2JqZWN0Lm9sZC51cmwpO1xuICAgICAgICAgICAgICAgICAgICAvLyBjb2RlTGluZXNbbGluZV0gPSBjb2RlTGluZXNbbGluZV0uc3Vic3RyKDAsIHN0YXJ0KSArIFwiaHJlZj1cXFwiXCIgKyBMaW5rT2JqZWN0Lm5ldy51cmwgKyBjb2RlTGluZXNbbGluZV0uc3Vic3RyKHN0YXJ0KzYrTGlua09iamVjdC5vbGQudXJsLmxlbmd0aCwgY29kZUxpbmVzW2xpbmVdLmxlbmd0aCk7XG4gICAgICAgICAgICAgICAgICAgIC8vdGhpcyBpcyB3aGVyZSB3ZSB1cGRhdGUgdGhlIGNvbnRleHQ7XG4gICAgICAgICAgICAgICAgICAgIHZhciBuZXdDb250ZXh0ID0gTGlua09iamVjdC5jb250ZXh0O1xuICAgICAgICAgICAgICAgICAgICBuZXdDb250ZXh0ID0gbmV3Q29udGV4dC5zdWJzdHIoMCwgc3RhcnQpICsgXCJocmVmPVxcXCJcIiArIExpbmtPYmplY3QubmV3LnVybCArIG5ld0NvbnRleHQuc3Vic3RyKHN0YXJ0ICsgNiArIExpbmtPYmplY3Qub2xkLnVybC5sZW5ndGgsIG5ld0NvbnRleHQubGVuZ3RoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKExpbmtPYmplY3QuTGlua2VkSW1hZ2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld0NvbnRleHQgPSBMaW5rT2JqZWN0LkxpbmtlZEltYWdlLmdlbmVyYXRlT3V0cHV0KG5ld0NvbnRleHQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIG5ld0NvbnRleHQgPSBuZXdDb250ZXh0LnJlcGxhY2UoL1xccz9lbWxcXC1pZFxcPVxcXCJbMC05XSpcXFwiL2csIFwiXCIpO1xuICAgICAgICAgICAgICAgICAgICAvL3RoZW4gdXBkYXRlIHRoZSB3b3JraW5nIGNvZGUgd2l0aCB0aGUgbmV3IGNvbnRleHQ7XG4gICAgICAgICAgICAgICAgICAgIG91dHB1dCA9IG91dHB1dC5yZXBsYWNlKG5ldyBSZWdFeHAoXCJ7e0VNTE1ha2VyX0xpbms6XCIgKyBMaW5rT2JqZWN0LmlkICsgXCJ9fVwiLCBcImdpXCIpLCBuZXdDb250ZXh0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIC8vZmluZCBhbGwgaW1hZ2VzIHdpdGhvdXQgYWx0IGF0dHJpYnV0ZSBhbmQgYWRkIGFsdD1cIlwiO1xuICAgICAgICAgICAgb3V0cHV0ID0gb3V0cHV0LnJlcGxhY2UoL1xcPGltZ1teXFw+XS4qP1xcPi9naSwgZnVuY3Rpb24gKGZvdW5kKSB7XG4gICAgICAgICAgICAgICAgaWYgKGZvdW5kLmluZGV4T2YoXCJhbHQ9XCIpID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZvdW5kO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZvdW5kLnJlcGxhY2UoL1xcPGltZy9naSwgXCI8aW1nIGFsdD1cXFwiXFxcIlwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgb3V0cHV0ID0gb3V0cHV0LnJlcGxhY2UoLzxcXC9hPlxcbnswLDV9KFxcLnwsfFxcP3whfDp8O3xcXHwpL2csIFwiPC9hPiQxXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImVycm9yIG1lcmdpbmcgbGluZXMgd2l0aCBsaW5rcyB0aGF0IHByZXZpb3VzbHkgaGFkIHB1bmN0dWF0aW9uLlwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgICAgIH07XG4gICAgICAgIEVNTFdvcmtzcGFjZS5wcm90b3R5cGUudXBkYXRlTGlua3NBbmRFeHBvcnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuYXJlTGlua3NDb21wbGV0ZSgpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbG9jYXRpb24uaHJlZiA9IFwiIy9leHBvcnRcIjtcbiAgICAgICAgICAgIHdpbmRvdy5zY3JvbGxUbygwLCAwKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9O1xuICAgICAgICBFTUxXb3Jrc3BhY2UucHJvdG90eXBlLmFyZUxpbmtzQ29tcGxldGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgb3V0cHV0ID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMubWFwTGlua09iamVjdHMoZnVuY3Rpb24gKExpbmtPYmplY3QpIHtcbiAgICAgICAgICAgICAgICBpZiAoIUxpbmtPYmplY3QuX19pc0NvbXBsZXRlKSB7XG4gICAgICAgICAgICAgICAgICAgIG91dHB1dCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoTGlua09iamVjdC5uZWVkc1RyYWNraW5nQ29kZSgpKSB7XG4gICAgICAgICAgICAgICAgICAgIG91dHB1dCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICAgICAgfTtcbiAgICAgICAgRU1MV29ya3NwYWNlLnByb3RvdHlwZS5nZXRMaW5rc1N1bW1hcnkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgZGF0YSA9IHtcbiAgICAgICAgICAgICAgICBuZWVkc1RyYWNraW5nOiAwLFxuICAgICAgICAgICAgICAgIGludmFsaWRVcmw6IDBcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLm1hcExpbmtPYmplY3RzKGZ1bmN0aW9uIChMaW5rT2JqZWN0KSB7XG4gICAgICAgICAgICAgICAgaWYgKExpbmtPYmplY3QubmVlZHNUcmFja2luZ0NvZGUoKSlcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5uZWVkc1RyYWNraW5nKys7XG4gICAgICAgICAgICAgICAgaWYgKExpbmtPYmplY3QuaXNMaW5rQ29tcGxldGUoKSlcbiAgICAgICAgICAgICAgICAgICAgZGF0YS5pbnZhbGlkVXJsKys7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgICB9O1xuICAgICAgICBFTUxXb3Jrc3BhY2UucHJvdG90eXBlLmltcG9ydEh0bWxGcm9tRmlsZURyb3AgPSBmdW5jdGlvbiAoZXZ0KSB7XG4gICAgICAgICAgICBpZiAodGhpcy5zb3VyY2VDb2RlLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNvdXJjZUNvZGUgPSBcIlwiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGZpbGVzID0gZXZ0LmRhdGFUcmFuc2Zlci5maWxlcztcbiAgICAgICAgICAgIGlmIChldnQuZGF0YVRyYW5zZmVyLmZpbGVzLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgICAgICBhbGVydCgneW91IGNhbiBvbmx5IGltcG9ydCBvbmUgZmlsZSBhdCBhdCB0aW1lLicpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XG4gICAgICAgICAgICAgICAgdmFyIFdTID0gdGhpcztcbiAgICAgICAgICAgICAgICByZWFkZXIub25sb2FkZW5kID0gZnVuY3Rpb24gKGV2dCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgZHJvcFRleHQgPSBldnQudGFyZ2V0LnJlc3VsdDtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5hbWVQYXJ0cyA9IGZpbGVzWzBdLm5hbWUuc3BsaXQoXCIuXCIpO1xuICAgICAgICAgICAgICAgICAgICB2YXIgZXh0ID0gbmFtZVBhcnRzLnBvcCgpLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgICAgICAgICAgICAgIFdTLmZpbGVOYW1lID0gV1MuX19mb3JtYXRGaWxlTmFtZShuYW1lUGFydHMuam9pbihcIi5cIikpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoZXh0ID09ICdlbWwnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBXUy5zb3VyY2VDb2RlID0gV1MuX19zdHJpcEh0bWxBbmRTdWJqZWN0RnJvbUVNTChkcm9wVGV4dCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBXUy5zb3VyY2VDb2RlID0gZHJvcFRleHQ7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgV1MucHJvY2Vzc0h0bWwoKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gV1MuaW50ZWxsaWdlbmNlID0gRU1MTWFrZXJBSUVuZ2luZS5DaGVja0VtYWlsKFdTKTtcbiAgICAgICAgICAgICAgICAgICAgbG9jYXRpb24uaHJlZiA9IFwiIy9saW5rc1wiO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgcmVhZGVyLnJlYWRBc1RleHQoZmlsZXNbMF0pO1xuICAgICAgICAgICAgICAgIHdpbmRvdy5nYSgnc2VuZCcsICdldmVudCcsIFwiSFRNTFwiLCBcImltcG9ydFwiLCBcIkhUTUwgSW1wb3J0IEZpbGUgRHJvcFwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEVNTFdvcmtzcGFjZS5wcm90b3R5cGUsIFwiZGVmYXVsdFNDb2RlXCIsIHtcbiAgICAgICAgICAgIHNldDogZnVuY3Rpb24gKG5ld1ZhbHVlKSB7XG4gICAgICAgICAgICAgICAgdmFyIG9sZCA9IHRoaXMuX2RlZmF1bHRTQ29kZTtcbiAgICAgICAgICAgICAgICBpZiAob2xkICE9PSBuZXdWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl9kZWZhdWx0U0NvZGUgPSBuZXdWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tYXBMaW5rT2JqZWN0cyhmdW5jdGlvbiAoTGlua09iamVjdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgTGlua09iamVjdC5pc0xpbmtDb21wbGV0ZSgpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgICB9KTtcbiAgICAgICAgRU1MV29ya3NwYWNlLnByb3RvdHlwZS5fX2Zvcm1hdEZpbGVOYW1lID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICAgICAgICAgIHZhciBfc2x1Z2lmeV9zdHJpcF9yZSA9IC9bXlxcd1xccy1dL2c7XG4gICAgICAgICAgICB2YXIgX3NsdWdpZnlfaHlwaGVuYXRlX3JlID0gL1stXFxzXSsvZztcbiAgICAgICAgICAgIG5hbWUgPSBuYW1lLnJlcGxhY2UoX3NsdWdpZnlfc3RyaXBfcmUsICcnKS50cmltKCkudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgIG5hbWUgPSBuYW1lLnJlcGxhY2UoX3NsdWdpZnlfaHlwaGVuYXRlX3JlLCAnLScpO1xuICAgICAgICAgICAgcmV0dXJuIG5hbWU7XG4gICAgICAgIH07XG4gICAgICAgIEVNTFdvcmtzcGFjZS5wcm90b3R5cGUuX19yZXBsYWNlRWxvcXVhTWVyZ2VGaWVsZHMgPSBmdW5jdGlvbiAoY29udGVudCkge1xuICAgICAgICAgICAgdmFyIHJlNCA9IC88c3BhbiglMjB8XFxzKWNsYXNzPVwiP2Vsb3F1YWVtYWlsXCI/XFxzPz4oLio/KTxcXC9zcGFuPi9pZztcbiAgICAgICAgICAgIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UocmU0LCBcIiMkMiNcIik7XG4gICAgICAgICAgICByZXR1cm4gY29udGVudDtcbiAgICAgICAgfTtcbiAgICAgICAgRU1MV29ya3NwYWNlLnByb3RvdHlwZS5fX3N0cmlwSHRtbEFuZFN1YmplY3RGcm9tRU1MID0gZnVuY3Rpb24gKGNvZGUpIHtcbiAgICAgICAgICAgIHZhciBvdXRwdXQgPSBjb2RlLnNwbGl0KFwiXFxuXCIpO1xuICAgICAgICAgICAgdmFyIGh0bWwgPSBvdXRwdXQucG9wKCk7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG91dHB1dC5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmIChvdXRwdXRbaV0uaW5kZXhPZihcIlN1YmplY3Q6XCIpID4gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuaGVhZGVyID09PSB1bmRlZmluZWQpXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmhlYWRlciA9IHt9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBodG1sO1xuICAgICAgICB9O1xuICAgICAgICBFTUxXb3Jrc3BhY2UucHJvdG90eXBlLl9fcmVtb3ZlV2hpdGVTcGFjZSA9IGZ1bmN0aW9uIChjb2RlKSB7XG4gICAgICAgICAgICB2YXIgb3V0cHV0ID0gY29kZTtcbiAgICAgICAgICAgIG91dHB1dCA9IG91dHB1dC5yZXBsYWNlKG5ldyBSZWdFeHAoXCJcXG5cIiwgXCJnXCIpLCBcIiBcIik7XG4gICAgICAgICAgICBvdXRwdXQgPSBvdXRwdXQucmVwbGFjZShuZXcgUmVnRXhwKFwiXFx0XCIsIFwiZ1wiKSwgXCIgXCIpO1xuICAgICAgICAgICAgb3V0cHV0ID0gb3V0cHV0LnJlcGxhY2UoL1xcc3syLDk5OTk5fS9nLCBcIiBcIik7XG4gICAgICAgICAgICByZXR1cm4gb3V0cHV0O1xuICAgICAgICB9O1xuICAgICAgICBFTUxXb3Jrc3BhY2UucHJvdG90eXBlLl9fYnVpbGRIZWFkZXJzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIGhlYWRlcnMgPSBbXTtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5oZWFkZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaGVhZGVycy5wdXNoKHRoaXMuaGVhZGVyc1tpXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YXIgY2hhcnNldCA9IHRoaXMuX19nZXRDaGFyc2V0RnJvbUhUTUwodGhpcy5zb3VyY2VDb2RlKTtcbiAgICAgICAgICAgIGlmIChjaGFyc2V0ID09IFwiXCIpXG4gICAgICAgICAgICAgICAgY2hhcnNldCA9IFwiY2hhcnNldD1VVEYtOFwiO1xuICAgICAgICAgICAgaGVhZGVycy5wdXNoKFwiQ29udGVudC1UeXBlOiB0ZXh0L2h0bWw7XFxuXFx0XCIgKyBjaGFyc2V0KTtcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGhlYWRlcnMsIGFsbG93YWJsZUhlYWRlckZpZWxkcyk7XG4gICAgICAgICAgICBmb3IgKHZhciBpXzEgaW4gdGhpcy5oZWFkZXIpIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5oZWFkZXIuaGFzT3duUHJvcGVydHkoaV8xKSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fX2FsbG93YWJsZUhlYWRlckZpZWxkcy5oYXNPd25Qcm9wZXJ0eShpXzEpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXJzLnB1c2godGhpcy5fX2FsbG93YWJsZUhlYWRlckZpZWxkc1tpXzFdLnN5bnRheCArIFwiIFwiICsgdGhpcy5oZWFkZXJbaV8xXSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLl9fZW1sSGVhZGVycyA9IGhlYWRlcnMuam9pbihcIlxcblwiKTtcbiAgICAgICAgICAgIHJldHVybiBoZWFkZXJzLmpvaW4oXCJcXG5cIik7XG4gICAgICAgIH07XG4gICAgICAgIEVNTFdvcmtzcGFjZS5wcm90b3R5cGUuX19nZXRDaGFyc2V0RnJvbUhUTUwgPSBmdW5jdGlvbiAoY29udGVudCkge1xuICAgICAgICAgICAgdmFyIHJlNSA9IC88bWV0YS4qP2NoYXJzZXQ9KFteXFxzXCJdKikvaWcsIGNoYXJzZXQgPSBcIlwiO1xuICAgICAgICAgICAgdmFyIG1ldGFUYWdzID0gY29udGVudC5tYXRjaChyZTUpO1xuICAgICAgICAgICAgaWYgKG1ldGFUYWdzKSB7XG4gICAgICAgICAgICAgICAgbWV0YVRhZ3MuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgY2hhcnNldFZhbHMgPSBpdGVtLm1hdGNoKC9jaGFyc2V0PShbXlxcc1wiXSopL2lnKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNoYXJzZXRWYWxzKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjaGFyc2V0ID0gY2hhcnNldFZhbHNbMF07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjaGFyc2V0ID0gXCJjaGFyc2V0PVVURi04XCI7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBjaGFyc2V0O1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gRU1MV29ya3NwYWNlO1xuICAgIH0oKSk7XG4gICAgRU1MTW9kdWxlLkVNTFdvcmtzcGFjZSA9IEVNTFdvcmtzcGFjZTtcbiAgICB2YXIgS2V5Ym9hcmRTaG9ydGN1dCA9IChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIEtleWJvYXJkU2hvcnRjdXQod2hlbiwgZG9UaGlzLCBrZXlzLCBkZXNjcmlwdGlvbikge1xuICAgICAgICAgICAgdGhpcy53aGVuID0gd2hlbjtcbiAgICAgICAgICAgIHRoaXMuZG9UaGlzID0gZG9UaGlzO1xuICAgICAgICAgICAgdGhpcy5rZXlzID0ga2V5cztcbiAgICAgICAgICAgIHRoaXMuZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gS2V5Ym9hcmRTaG9ydGN1dDtcbiAgICB9KCkpO1xuICAgIEVNTE1vZHVsZS5LZXlib2FyZFNob3J0Y3V0ID0gS2V5Ym9hcmRTaG9ydGN1dDtcbn0pKEVNTE1vZHVsZSB8fCAoRU1MTW9kdWxlID0ge30pKTtcblxudmFyIEludGVsbGlnZW5jZUFsZXJ0ID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBJbnRlbGxpZ2VuY2VBbGVydCgpIHtcbiAgICAgICAgdGhpcy5vdmVycmlkZSA9IGZhbHNlO1xuICAgIH1cbiAgICBJbnRlbGxpZ2VuY2VBbGVydC5wcm90b3R5cGUuZ2VuZXJhdGVHdWlkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBmdW5jdGlvbiBzNCgpIHtcbiAgICAgICAgICAgIHJldHVybiBNYXRoLmZsb29yKCgxICsgTWF0aC5yYW5kb20oKSkgKiAweDEwMDAwKVxuICAgICAgICAgICAgICAgIC50b1N0cmluZygxNilcbiAgICAgICAgICAgICAgICAuc3Vic3RyaW5nKDEpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzNCgpICsgczQoKSArICctJyArIHM0KCkgKyAnLScgKyBzNCgpICsgJy0nICsgczQoKSArICctJyArIHM0KCkgKyBzNCgpICsgczQoKTtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShJbnRlbGxpZ2VuY2VBbGVydC5wcm90b3R5cGUsIFwidHlwZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3R5cGU7XG4gICAgICAgIH0sXG4gICAgICAgIHNldDogZnVuY3Rpb24gKG5ld1ZhbCkge1xuICAgICAgICAgICAgdGhpcy5fdHlwZSA9IG5ld1ZhbDtcbiAgICAgICAgICAgIHRoaXMuY2xlYW5UeXBlID0gRXJyb3JUeXBlW25ld1ZhbF07XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIEludGVsbGlnZW5jZUFsZXJ0LnByb3RvdHlwZS5zZXRPdmVycmlkZVN0YXR1cyA9IGZ1bmN0aW9uICh2YWwpIHtcbiAgICAgICAgdGhpcy5vdmVycmlkZSA9IHZhbDtcbiAgICAgICAgLy8gY29uc29sZS5sb2codGhpcy5pZCArIFwiIC0gb3ZlcnJpZGRlblwiKTtcbiAgICB9O1xuICAgIHJldHVybiBJbnRlbGxpZ2VuY2VBbGVydDtcbn0oKSk7XG52YXIgRU1MTWFrZXJJbnRlbGxpZ2VuY2U7XG4oZnVuY3Rpb24gKEVNTE1ha2VySW50ZWxsaWdlbmNlKSB7XG4gICAgdmFyIEludGVsbGlnZW5jZUNlbnRlciA9IChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIEludGVsbGlnZW5jZUNlbnRlcigkbW9uaXRvciwgJHNjb3BlKSB7XG4gICAgICAgICAgICB0aGlzLl9zY29wZSA9ICRzY29wZTtcbiAgICAgICAgICAgIHRoaXMuX21vbml0b3IgPSAkbW9uaXRvcjtcbiAgICAgICAgICAgIHRoaXMuc2VhcmNoVHlwZSA9IHRoaXMuZGVmYXVsdFNlYXJjaFR5cGUoKTtcbiAgICAgICAgfVxuICAgICAgICBJbnRlbGxpZ2VuY2VDZW50ZXIucHJvdG90eXBlLnNldFR5cGUgPSBmdW5jdGlvbiAodmFsKSB7XG4gICAgICAgICAgICB0aGlzLnNlYXJjaFR5cGUgPSB2YWw7XG4gICAgICAgIH07XG4gICAgICAgIEludGVsbGlnZW5jZUNlbnRlci5wcm90b3R5cGUuZGVmYXVsdFNlYXJjaFR5cGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgdHlwZXMgPSB0aGlzLl9tb25pdG9yLnR5cGVzO1xuICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5rZXlzKHRoaXMuX21vbml0b3IudGFicykubGVuZ3RoID4gMVxuICAgICAgICAgICAgICAgID8gXCJcIlxuICAgICAgICAgICAgICAgIDogKHRoaXMuX21vbml0b3IudGFicylbKE9iamVjdC5rZXlzKHRoaXMuX21vbml0b3IudGFicylbMF0pXTtcbiAgICAgICAgfTtcbiAgICAgICAgSW50ZWxsaWdlbmNlQ2VudGVyLnByb3RvdHlwZS5jYW5WaWV3QWxsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5rZXlzKHRoaXMuX21vbml0b3IudGFicykubGVuZ3RoID4gMTtcbiAgICAgICAgfTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEludGVsbGlnZW5jZUNlbnRlci5wcm90b3R5cGUsIFwic2VhcmNoXCIsIHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciB0eXBlcyA9IHRoaXMuX21vbml0b3IudHlwZXM7XG4gICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2coXCJzZWFyY2hUeXBlXCIsdGhpcy5zZWFyY2hUeXBlKTtcbiAgICAgICAgICAgICAgICBpZiAodHlwZXMgJiYgdGhpcy5zZWFyY2hUeXBlIGluIHR5cGVzKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7IHR5cGU6IHRoaXMuc2VhcmNoVHlwZSB9O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHsgdHlwZTogdGhpcy5kZWZhdWx0U2VhcmNoVHlwZSgpIH07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBJbnRlbGxpZ2VuY2VDZW50ZXI7XG4gICAgfSgpKTtcbiAgICBFTUxNYWtlckludGVsbGlnZW5jZS5JbnRlbGxpZ2VuY2VDZW50ZXIgPSBJbnRlbGxpZ2VuY2VDZW50ZXI7XG4gICAgdmFyIEludGVsbGlnZW5jZUVuZ2luZSA9IChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIEludGVsbGlnZW5jZUVuZ2luZSgpIHtcbiAgICAgICAgICAgIHRoaXMubWVzc2FnZXMgPSBbXTtcbiAgICAgICAgICAgIHRoaXMuY2FuQ29udGludWUgPSB0cnVlO1xuICAgICAgICAgICAgdGhpcy5jYWNoZWRSZXN1bHRzID0gW107XG4gICAgICAgICAgICB0aGlzLnNjb3BlcyA9IFtdO1xuICAgICAgICB9XG4gICAgICAgIEludGVsbGlnZW5jZUVuZ2luZS5wcm90b3R5cGUuX19sb2NhdGVTY29wZSA9IGZ1bmN0aW9uIChzY29wZSkge1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHRoaXMuc2NvcGVzLmZpbHRlcihmdW5jdGlvbiAob2JqKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG9iai5zY29wZSA9PSBzY29wZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKHJlc3VsdC5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgICAgIHZhciBhID0gbmV3IEludGVsbGlnZW5jZU1vZHVsZShzY29wZSk7XG4gICAgICAgICAgICAgICAgdmFyIGIgPSB0aGlzLnNjb3Blcy5wdXNoKGEpO1xuICAgICAgICAgICAgICAgIHJldHVybiBhO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdFswXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgSW50ZWxsaWdlbmNlRW5naW5lLnByb3RvdHlwZS5yZWFkT3V0UnVsZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAvLyB0aGlzLnNjb3BlcztcbiAgICAgICAgICAgIHRoaXMuc2NvcGVzLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgICAgICAvL2xldCB0cmFzaE1vbml0b3IgPSBuZXcgSW50ZWxsaWdlbmNlTW9uaXRvcihpdGVtLnNjb3BlKTtcbiAgICAgICAgICAgICAgICB2YXIgcnVsZXMgPSBPYmplY3Qua2V5cyhpdGVtLnJ1bGVzKTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJ1bGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vIHRyYXNoTW9uaXRvciA9IG51bGw7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIC8vcnVuIGVhY2ggb2YgdGhlIGZ1bmN0aW9ucyBhbmQgcmV0dXJuIHRoZSBzdWJydC5cbiAgICAgICAgfTtcbiAgICAgICAgSW50ZWxsaWdlbmNlRW5naW5lLnByb3RvdHlwZS5tb2R1bGUgPSBmdW5jdGlvbiAoc2NvcGUpIHtcbiAgICAgICAgICAgIHZhciBtb2R1bGUgPSB0aGlzLl9fbG9jYXRlU2NvcGUoc2NvcGUpO1xuICAgICAgICAgICAgcmV0dXJuIG1vZHVsZTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIEludGVsbGlnZW5jZUVuZ2luZTtcbiAgICB9KCkpO1xuICAgIEVNTE1ha2VySW50ZWxsaWdlbmNlLkludGVsbGlnZW5jZUVuZ2luZSA9IEludGVsbGlnZW5jZUVuZ2luZTtcbiAgICB2YXIgSW50ZWxsaWdlbmNlTW9kdWxlID0gKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZnVuY3Rpb24gSW50ZWxsaWdlbmNlTW9kdWxlKHNjb3BlKSB7XG4gICAgICAgICAgICB0aGlzLnNjb3BlID0gc2NvcGU7XG4gICAgICAgICAgICB0aGlzLnJ1bGVzID0ge307XG4gICAgICAgIH1cbiAgICAgICAgSW50ZWxsaWdlbmNlTW9kdWxlLnByb3RvdHlwZS5tb25pdG9yID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBJbnRlbGxpZ2VuY2VNb25pdG9yKHRoaXMpO1xuICAgICAgICB9O1xuICAgICAgICBJbnRlbGxpZ2VuY2VNb2R1bGUucHJvdG90eXBlLnJlZ2lzdGVyID0gZnVuY3Rpb24gKGlkLCBydWxlKSB7XG4gICAgICAgICAgICB0aGlzLnJ1bGVzW2lkXSA9IHJ1bGU7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIEludGVsbGlnZW5jZU1vZHVsZTtcbiAgICB9KCkpO1xuICAgIEVNTE1ha2VySW50ZWxsaWdlbmNlLkludGVsbGlnZW5jZU1vZHVsZSA9IEludGVsbGlnZW5jZU1vZHVsZTtcbiAgICB2YXIgSW50ZWxsaWdlbmNlTW9uaXRvciA9IChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGZ1bmN0aW9uIEludGVsbGlnZW5jZU1vbml0b3IocGFyZW50U2NvcGUpIHtcbiAgICAgICAgICAgIHRoaXMucnVsZXMgPSBwYXJlbnRTY29wZS5ydWxlcztcbiAgICAgICAgICAgIHRoaXMub3ZlcnJpZGRlbiA9IFtdO1xuICAgICAgICAgICAgdGhpcy52YXJpYWJsZXMgPSB7XG4gICAgICAgICAgICAgICAgXCJJbnRlbGxpZ2VuY2VNb25pdG9yXCI6IHRoaXNcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLnJlc2V0KCk7XG4gICAgICAgIH1cbiAgICAgICAgSW50ZWxsaWdlbmNlTW9uaXRvci5wcm90b3R5cGUucmVzZXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLm1lc3NhZ2VzID0gW107XG4gICAgICAgICAgICB0aGlzLmNhbkNvbnRpbnVlID0gdHJ1ZTtcbiAgICAgICAgfTtcbiAgICAgICAgSW50ZWxsaWdlbmNlTW9uaXRvci5wcm90b3R5cGUuYXNzb2NpYXRlVmFyaWFibGUgPSBmdW5jdGlvbiAoYWNjZXNzb3IsIHZhbHVlKSB7XG4gICAgICAgICAgICB0aGlzLnZhcmlhYmxlc1thY2Nlc3Nvcl0gPSB2YWx1ZTtcbiAgICAgICAgfTtcbiAgICAgICAgSW50ZWxsaWdlbmNlTW9uaXRvci5wcm90b3R5cGUuZXZhbHVhdGVSdWxlID0gZnVuY3Rpb24gKHJ1bGUpIHtcbiAgICAgICAgICAgIC8vbG9vayBmb3IgaW5qZWN0aW9uIHBhcmFtZXRlcnNcbiAgICAgICAgICAgIHZhciByZXN1bHQ7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHJ1bGUgPT0gXCJvYmplY3RcIikge1xuICAgICAgICAgICAgICAgIC8vbGFzdCBwYXJhbWV0ZXIgaXMgdGhlIGZ1dW5jdGlvbjtcbiAgICAgICAgICAgICAgICB2YXIgZnVuYyA9IHJ1bGVbcnVsZS5sZW5ndGggLSAxXTtcbiAgICAgICAgICAgICAgICB2YXIgcGFyYW1ldGVycyA9IHJ1bGUuc2xpY2UoMCwgcnVsZS5sZW5ndGggLSAxKTtcbiAgICAgICAgICAgICAgICB2YXIgSU1fMSA9IHRoaXM7XG4gICAgICAgICAgICAgICAgdmFyIGFyZ3MgPSBwYXJhbWV0ZXJzLm1hcChmdW5jdGlvbiAoa2V5KSB7IHJldHVybiBJTV8xLnZhcmlhYmxlc1trZXldOyB9KTtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBmdW5jLmFwcGx5KG51bGwsIGFyZ3MpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHJ1bGUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH07XG4gICAgICAgIEludGVsbGlnZW5jZU1vbml0b3IucHJvdG90eXBlLmV2YWx1YXRlUnVsZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB0aGlzLnJlc2V0KCk7XG4gICAgICAgICAgICB2YXIgcnVsZXMgPSBPYmplY3Qua2V5cyh0aGlzLnJ1bGVzKTtcbiAgICAgICAgICAgIGZvciAodmFyIF9pID0gMCwgcnVsZXNfMSA9IHJ1bGVzOyBfaSA8IHJ1bGVzXzEubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHJ1bGUgPSBydWxlc18xW19pXTtcbiAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gdGhpcy5ldmFsdWF0ZVJ1bGUodGhpcy5ydWxlc1tydWxlXSk7XG4gICAgICAgICAgICAgICAgdmFyIHByb2NlZWQgPSByZXN1bHQuaGFzT3duUHJvcGVydHkoXCJ3aGVuXCIpID8gcmVzdWx0LndoZW4uYXBwbHkobnVsbCkgOiBmYWxzZTtcbiAgICAgICAgICAgICAgICBpZiAocHJvY2VlZCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBQVVNIIEFMRVJUIE1FU1NBR0UuXG4gICAgICAgICAgICAgICAgICAgIHZhciBJQSA9IG5ldyBJbnRlbGxpZ2VuY2VBbGVydCgpO1xuICAgICAgICAgICAgICAgICAgICBJQS5pZCA9IHJlc3VsdC5pZCA9PT0gdW5kZWZpbmVkIHx8IHJlc3VsdC5pZCA9PSBcIlwiID8gSUEuZ2VuZXJhdGVHdWlkKCkgOiByZXN1bHQuaWQ7XG4gICAgICAgICAgICAgICAgICAgIElBLnR5cGUgPSByZXN1bHQudHlwZSA9PT0gdW5kZWZpbmVkID8gRXJyb3JUeXBlLldhcm4gOiByZXN1bHQudHlwZTtcbiAgICAgICAgICAgICAgICAgICAgSUEuc2V2ZXJpdHkgPSByZXN1bHQuc2V2ZXJpdHkgPT09IHVuZGVmaW5lZCA/IEVycm9yU2V2ZXJpdHkuWmVybyA6IHJlc3VsdC5zZXZlcml0eTtcbiAgICAgICAgICAgICAgICAgICAgSUEudGl0bGUgPSByZXN1bHQudGl0bGUgPT09IHVuZGVmaW5lZCA/IFwiXCIgOiByZXN1bHQudGl0bGU7XG4gICAgICAgICAgICAgICAgICAgIElBLmRlc2NyaXB0aW9uID0gcmVzdWx0LmRlc2NyaXB0aW9uID09PSB1bmRlZmluZWQgPyBcIlwiIDogcmVzdWx0LmRlc2NyaXB0aW9uO1xuICAgICAgICAgICAgICAgICAgICBJQS5yZXNvdXJjZSA9IHJlc3VsdC5yZXNvdXJjZSA9PT0gdW5kZWZpbmVkID8gXCJcIiA6IHJlc3VsdC5yZXNvdXJjZTtcbiAgICAgICAgICAgICAgICAgICAgSUEuY3RhSGFuZGxlciA9IHJlc3VsdC5jdGEgJiYgcmVzdWx0LmN0YS5oYW5kbGVyID8gcmVzdWx0LmN0YS5oYW5kbGVyIDogZnVuY3Rpb24gKCkgeyB9O1xuICAgICAgICAgICAgICAgICAgICBJQS5jdGFMYWJlbCA9IHJlc3VsdC5jdGEgJiYgcmVzdWx0LmN0YS5sYWJlbCA/IHJlc3VsdC5jdGEubGFiZWwgOiBcIlwiO1xuICAgICAgICAgICAgICAgICAgICBJQS5jYW5Db250aW51ZSA9IHJlc3VsdC5oYXNPd25Qcm9wZXJ0eShcImNhbkNvbnRpbnVlXCIpID8gcmVzdWx0LmNhbkNvbnRpbnVlIDogdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tZXNzYWdlcy5wdXNoKElBKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubWVzc2FnZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5vdmVycmlkZGVuLmluZGV4T2YodGhpcy5tZXNzYWdlc1tpXS5pZCkgPiAtMSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm1lc3NhZ2VzW2ldLm92ZXJyaWRlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCF0aGlzLm1lc3NhZ2VzW2ldLmNhbkNvbnRpbnVlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghdGhpcy5tZXNzYWdlc1tpXS5vdmVycmlkZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jYW5Db250aW51ZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5tZXNzYWdlcy5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgICAgICAgICAgaWYgKGEuX3R5cGUgPiBiLl90eXBlKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gMTtcbiAgICAgICAgICAgICAgICBpZiAoYS5fdHlwZSA8IGIuX3R5cGUpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAtMTtcbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoSW50ZWxsaWdlbmNlTW9uaXRvci5wcm90b3R5cGUsIFwidGFic1wiLCB7XG4gICAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2YXIgb3V0cHV0ID0ge307XG4gICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1lc3NhZ2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIG91dHB1dFt0aGlzLm1lc3NhZ2VzW2ldLmNsZWFuVHlwZV0gPSB0aGlzLm1lc3NhZ2VzW2ldLnR5cGU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KEludGVsbGlnZW5jZU1vbml0b3IucHJvdG90eXBlLCBcInR5cGVzXCIsIHtcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHZhciBvdXRwdXQgPSB7fTtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubWVzc2FnZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgb3V0cHV0W3RoaXMubWVzc2FnZXNbaV0udHlwZV0gPSBFcnJvclR5cGVbdGhpcy5tZXNzYWdlc1tpXS50eXBlXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoSW50ZWxsaWdlbmNlTW9uaXRvci5wcm90b3R5cGUsIFwiY291bnRcIiwge1xuICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdmFyIG91dHB1dCA9IHt9O1xuICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tZXNzYWdlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBpZiAob3V0cHV0W0Vycm9yVHlwZVt0aGlzLm1lc3NhZ2VzW2ldLnR5cGVdXSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXRbRXJyb3JUeXBlW3RoaXMubWVzc2FnZXNbaV0udHlwZV1dID0gMDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBvdXRwdXRbRXJyb3JUeXBlW3RoaXMubWVzc2FnZXNbaV0udHlwZV1dKys7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIEludGVsbGlnZW5jZU1vbml0b3I7XG4gICAgfSgpKTtcbiAgICBFTUxNYWtlckludGVsbGlnZW5jZS5JbnRlbGxpZ2VuY2VNb25pdG9yID0gSW50ZWxsaWdlbmNlTW9uaXRvcjtcbn0pKEVNTE1ha2VySW50ZWxsaWdlbmNlIHx8IChFTUxNYWtlckludGVsbGlnZW5jZSA9IHt9KSk7XG52YXIgRU1MSW50ZWxsaWdlbmNlID0gbmV3IEVNTE1ha2VySW50ZWxsaWdlbmNlLkludGVsbGlnZW5jZUVuZ2luZSgpO1xuXG5mdW5jdGlvbiBnZXRPZmZsaW5lVmVyc2lvbk51bWJlcigpIHtcbiAgICB2YXIgb3V0cHV0ID0gXCJcIjtcbiAgICBpZiAod2luZG93LmxvY2F0aW9uLnNlYXJjaC5pbmRleE9mKFwib2ZmbGluZV92ZXJzaW9uXCIpKSB7XG4gICAgICAgIHZhciBwYXJhbXMgPSB3aW5kb3cubG9jYXRpb24uc2VhcmNoLnN1YnN0cigxLCB3aW5kb3cubG9jYXRpb24uc2VhcmNoLmxlbmd0aCkuc3BsaXQoXCImXCIpO1xuICAgICAgICBwYXJhbXMuZm9yRWFjaChmdW5jdGlvbiAocGFyYW0pIHtcbiAgICAgICAgICAgIGlmIChwYXJhbS5pbmRleE9mKFwib2ZmbGluZV92ZXJzaW9uPVwiKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgb3V0cHV0ID0gcGFyYW0uc3Vic3RyKFwib2ZmbGluZV92ZXJzaW9uPVwiLmxlbmd0aCwgcGFyYW0ubGVuZ3RoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiBvdXRwdXQ7XG59XG52YXIgQWNjZXNzT25saW5lVmVyc2lvbiA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQWNjZXNzT25saW5lVmVyc2lvbihhcmdzKSB7XG4gICAgICAgIHRoaXMuYW5pbWF0ZSA9IHRydWU7XG4gICAgICAgIHRoaXMuc3RhdHVzID0gXCJhdHRlbXB0aW5nXCI7XG4gICAgICAgIHRoaXMuaGVhZGxpbmUgPSBcIkNoZWNraW5nIGF2YWlsYWJpbGl0eSBvZiBvbmxpbmUgdmVyc2lvblwiO1xuICAgICAgICB0aGlzLm1lc3NhZ2UgPSBcIklmIHdlJ3JlIGFibGUgdG8gYWNjZXNzIHRoZSBvbmxpbmUgdmVyc2lvbiwgeW91IHdpbGwgYmUgcmVkaXJlY3RlZC5cIjtcbiAgICAgICAgaWYgKGFyZ3Muc3VjY2VzcyA9PT0gdW5kZWZpbmVkKVxuICAgICAgICAgICAgYXJncy5zdWNjZXNzID0gZnVuY3Rpb24gKCkgeyB9O1xuICAgICAgICBpZiAoYXJncy5vbmVycm9yID09PSB1bmRlZmluZWQpXG4gICAgICAgICAgICBhcmdzLm9uZXJyb3IgPSBmdW5jdGlvbiAoKSB7IH07XG4gICAgICAgIHdpbmRvdy5MT0NBTEhPU1QgPSB0aGlzLmlzTG9jYWxNYWNoaW5lKCk7XG4gICAgICAgIHdpbmRvdy5PRkZMSU5FX1ZFUlNJT04gPSBnZXRPZmZsaW5lVmVyc2lvbk51bWJlcigpO1xuICAgICAgICBpZiAod2luZG93LkxPQ0FMSE9TVCkge1xuICAgICAgICAgICAgd2luZG93LnNjcm9sbFRvKDAsIDApO1xuICAgICAgICAgICAgdGhpcy5vYnRhaW5LZXlGcm9tU2VydmVyKGFyZ3MpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5zdGF0dXMgPSBcImZhaWxlZFwiO1xuICAgICAgICAgICAgdGhpcy5hbmltYXRlID0gZmFsc2U7XG4gICAgICAgICAgICBkb2N1bWVudC50aXRsZSA9IHdpbmRvdy5QQUdFX1RJVExFO1xuICAgICAgICB9XG4gICAgfVxuICAgIEFjY2Vzc09ubGluZVZlcnNpb24ucHJvdG90eXBlLm9idGFpbktleUZyb21TZXJ2ZXIgPSBmdW5jdGlvbiAoYXJncykge1xuICAgICAgICBpZiAodGhpcy5pc0xvY2FsTWFjaGluZSgpKSB7XG4gICAgICAgICAgICB2YXIgciwgYSwgbTtcbiAgICAgICAgICAgIHdpbmRvdy5yZWRpcmVjdEpzb25wQ2FsbGJhY2sgPSBmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgICAgICAgICAgaWYgKHJlc3VsdCA9PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgIGFyZ3Muc3VjY2VzcygpO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkZPVU5EP1wiKTtcbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbi5ocmVmID0gXCJodHRwOi8vam9obnByb2VzdGFrZXMuZ2l0aHViLmlvL2VtbC1tYWtlcj9vZmZsaW5lX3ZlcnNpb249XCIgKyB3aW5kb3cuQ1VSUkVOVF9WRVJTSU9OO1xuICAgICAgICAgICAgICAgICAgICB9LCA1MDApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ25vdCBnaXRodWInKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpLFxuICAgICAgICAgICAgICAgIGEgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnc2NyaXB0JylbMF07XG4gICAgICAgICAgICByLnR5cGUgPSBcInRleHQvamF2YXNjcmlwdFwiO1xuICAgICAgICAgICAgci5vbmVycm9yID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIGFyZ3Mub25lcnJvcigpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHIuc3JjID0gIXRoaXMuaXNMb2NhbE1hY2hpbmUoKSA/IFwiXCIgOiBcImh0dHA6Ly9qb2hucHJvZXN0YWtlcy5naXRodWIuaW8vZW1sLW1ha2VyL3Byb2QvYXBwL2NhbnJlZGlyZWN0LmpzXCI7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBhLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKHIsIG0pO1xuICAgICAgICAgICAgfSwgMjAwMCk7XG4gICAgICAgICAgICBkb2N1bWVudC50aXRsZSA9IHdpbmRvdy5QQUdFX1RJVExFICsgXCIgKE9mZmxpbmUgTW9kZSlcIjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuc3RhdHVzID0gXCJmYWlsZWRcIjtcbiAgICAgICAgICAgIHRoaXMuYW5pbWF0ZSA9IGZhbHNlO1xuICAgICAgICAgICAgZG9jdW1lbnQudGl0bGUgPSB3aW5kb3cuUEFHRV9USVRMRTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQWNjZXNzT25saW5lVmVyc2lvbi5wcm90b3R5cGUuZ2V0T2ZmbGluZVZlcnNpb25OdW1iZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBvdXRwdXQgPSBcIlwiO1xuICAgICAgICBpZiAod2luZG93LmxvY2F0aW9uLnNlYXJjaC5pbmRleE9mKFwib2ZmbGluZV92ZXJzaW9uXCIpKSB7XG4gICAgICAgICAgICB2YXIgcGFyYW1zID0gd2luZG93LmxvY2F0aW9uLnNlYXJjaC5zdWJzdHIoMSwgd2luZG93LmxvY2F0aW9uLnNlYXJjaC5sZW5ndGgpLnNwbGl0KFwiJlwiKTtcbiAgICAgICAgICAgIHBhcmFtcy5mb3JFYWNoKGZ1bmN0aW9uIChwYXJhbSkge1xuICAgICAgICAgICAgICAgIGlmIChwYXJhbS5pbmRleE9mKFwib2ZmbGluZV92ZXJzaW9uPVwiKSA+IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIG91dHB1dCA9IHBhcmFtLnN1YnN0cihcIm9mZmxpbmVfdmVyc2lvbj1cIi5sZW5ndGgsIHBhcmFtLmxlbmd0aCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICB9O1xuICAgIEFjY2Vzc09ubGluZVZlcnNpb24ucHJvdG90eXBlLmlzTG9jYWxNYWNoaW5lID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAvLyByZXR1cm4gZmFsc2U7XG4gICAgICAgIHJldHVybiBsb2NhdGlvbi5ocmVmLmluZGV4T2YoJ2pvaG5wcm9lc3Rha2VzLmdpdGh1Yi5pbycpID09IC0xO1xuICAgIH07XG4gICAgcmV0dXJuIEFjY2Vzc09ubGluZVZlcnNpb247XG59KCkpO1xudmFyIFVwZGF0ZU1vZHVsZSA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gVXBkYXRlTW9kdWxlKCkge1xuICAgICAgICB0aGlzLnVwZGF0ZVZlcnNpb24gPSBmYWxzZTtcbiAgICAgICAgdGhpcy51cGRhdGVGb3JjZWQgPSBmYWxzZTtcbiAgICAgICAgdGhpcy5vZmZsaW5lVmVyc2lvbiA9IHdpbmRvdy5PRkZMSU5FX1ZFUlNJT04gPT09IHVuZGVmaW5lZCA/IFwiXCIgOiB3aW5kb3cuT0ZGTElORV9WRVJTSU9OO1xuICAgICAgICB0aGlzLm9ubGluZVZlcnNpb24gPSB3aW5kb3cuQ1VSUkVOVF9WRVJTSU9OO1xuICAgICAgICAvL3RyZWF0IGxvY2FsaG9zdDo4ODg4IGFzIGludGVybmV0XG4gICAgICAgIGlmIChsb2NhdGlvbi5ocmVmLmluZGV4T2YoXCJsb2NhbGhvc3RcIikgPiAtMSkge1xuICAgICAgICAgICAgd2luZG93LkxPQ0FMSE9TVCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGlmICh3aW5kb3cuT0ZGTElORV9WRVJTSU9OID09IFwiXCIpIHtcbiAgICAgICAgICAgIHRoaXMuYWNjZXNzaW5nRnJvbU9mZmxpbmUgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmICh3aW5kb3cuT0ZGTElORV9WRVJTSU9OICYmIHdpbmRvdy5MT0NBTEhPU1QpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmFjY2Vzc2luZ0Zyb21PZmZsaW5lID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh3aW5kb3cuT0ZGTElORV9WRVJTSU9OICYmICh3aW5kb3cuT0ZGTElORV9WRVJTSU9OICE9PSB3aW5kb3cuQ1VSUkVOVF9WRVJTSU9OKSkge1xuICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlVmVyc2lvbiA9IHRydWU7XG4gICAgICAgICAgICAgICAgdmFyIG9mViA9IG5ldyBBcHBsaWNhdGlvblZlcnNpb24od2luZG93Lk9GRkxJTkVfVkVSU0lPTiksIG9uViA9IG5ldyBBcHBsaWNhdGlvblZlcnNpb24od2luZG93LkNVUlJFTlRfVkVSU0lPTik7XG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGVGb3JjZWQgPSBvZlYuY29tcGFyZUFnYWluc3Qob25WKSA8PSBBcHBWZXJzaW9uRGlmZmVyZW5jZVR5cGUuUEFUQ0g7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgVXBkYXRlTW9kdWxlLnByb3RvdHlwZS5zaG93TWVzc2FnZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudXBkYXRlVmVyc2lvbiAmJiB0aGlzLnVwZGF0ZUZvcmNlZDtcbiAgICB9O1xuICAgIFVwZGF0ZU1vZHVsZS5wcm90b3R5cGUuc2hvd1RlYXNlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMub2ZmbGluZVZlcnNpb24gPT0gXCJcIiAmJiAhd2luZG93LkxPQ0FMSE9TVDtcbiAgICB9O1xuICAgIFVwZGF0ZU1vZHVsZS5wcm90b3R5cGUuZm9yY2VVcGRhdGUgPSBmdW5jdGlvbiAob2ZmbGluZSwgb25saW5lKSB7XG4gICAgICAgIHZhciBvZmZsaW5lVmVyc2lvbiA9IG9mZmxpbmUuc3BsaXQoXCIuXCIpLCBvbmxpbmVWZXJzaW9uID0gb25saW5lLnNwbGl0KFwiLlwiKSwgbWF0Y2ggPSAwLCBvdXRwdXQgPSBmYWxzZTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBvbmxpbmVWZXJzaW9uLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAob25saW5lVmVyc2lvbltpXSA9PSBvZmZsaW5lVmVyc2lvbltpXSlcbiAgICAgICAgICAgICAgICBtYXRjaCsrO1xuICAgICAgICB9XG4gICAgICAgIGlmIChtYXRjaCA8IDMpIHtcbiAgICAgICAgICAgIG91dHB1dCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICB9O1xuICAgIHJldHVybiBVcGRhdGVNb2R1bGU7XG59KCkpO1xudmFyIEFwcFZlcnNpb25EaWZmZXJlbmNlVHlwZTtcbihmdW5jdGlvbiAoQXBwVmVyc2lvbkRpZmZlcmVuY2VUeXBlKSB7XG4gICAgQXBwVmVyc2lvbkRpZmZlcmVuY2VUeXBlW0FwcFZlcnNpb25EaWZmZXJlbmNlVHlwZVtcIk1BSk9SXCJdID0gMF0gPSBcIk1BSk9SXCI7XG4gICAgQXBwVmVyc2lvbkRpZmZlcmVuY2VUeXBlW0FwcFZlcnNpb25EaWZmZXJlbmNlVHlwZVtcIk1JTk9SXCJdID0gMV0gPSBcIk1JTk9SXCI7XG4gICAgQXBwVmVyc2lvbkRpZmZlcmVuY2VUeXBlW0FwcFZlcnNpb25EaWZmZXJlbmNlVHlwZVtcIlBBVENIXCJdID0gMl0gPSBcIlBBVENIXCI7XG4gICAgQXBwVmVyc2lvbkRpZmZlcmVuY2VUeXBlW0FwcFZlcnNpb25EaWZmZXJlbmNlVHlwZVtcIlNVQlBBVENIXCJdID0gM10gPSBcIlNVQlBBVENIXCI7XG4gICAgQXBwVmVyc2lvbkRpZmZlcmVuY2VUeXBlW0FwcFZlcnNpb25EaWZmZXJlbmNlVHlwZVtcIk5PTkVcIl0gPSA0XSA9IFwiTk9ORVwiO1xufSkoQXBwVmVyc2lvbkRpZmZlcmVuY2VUeXBlIHx8IChBcHBWZXJzaW9uRGlmZmVyZW5jZVR5cGUgPSB7fSkpO1xudmFyIEFwcGxpY2F0aW9uVmVyc2lvbiA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQXBwbGljYXRpb25WZXJzaW9uKHZlcnNpb24pIHtcbiAgICAgICAgdGhpcy5fdmVyc2lvbiA9IHZlcnNpb247XG4gICAgICAgIHRoaXMudmVyc2lvbk9iamVjdCA9IHRoaXMuX3ZlcnNpb24uc3BsaXQoXCIuXCIpLm1hcChmdW5jdGlvbiAobikgeyByZXR1cm4gcGFyc2VJbnQobik7IH0pO1xuICAgIH1cbiAgICBBcHBsaWNhdGlvblZlcnNpb24ucHJvdG90eXBlLmNvbXBhcmVBZ2FpbnN0ID0gZnVuY3Rpb24gKE90aGVyVmVyc2lvbikge1xuICAgICAgICB2YXIgbWUgPSB0aGlzLnZlcnNpb25PYmplY3QsIG90aGVyID0gT3RoZXJWZXJzaW9uLnZlcnNpb25PYmplY3QsIG1hdGNoID0gMCwgb3V0cHV0ID0gZmFsc2U7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgNDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAobWVbaV0gPT0gb3RoZXJbaV0pIHtcbiAgICAgICAgICAgICAgICBtYXRjaCsrO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIEFwcFZlcnNpb25EaWZmZXJlbmNlVHlwZVtBcHBWZXJzaW9uRGlmZmVyZW5jZVR5cGVbbWF0Y2hdXTtcbiAgICB9O1xuICAgIHJldHVybiBBcHBsaWNhdGlvblZlcnNpb247XG59KCkpO1xuXG52YXIgU2VjdXJlR2F0ZXdheSA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gU2VjdXJlR2F0ZXdheShsb2dpbkNhbGxiYWNrLCAkc2NvcGUpIHtcbiAgICAgICAgdGhpcy5jYW5Mb2dpbiA9IGZhbHNlO1xuICAgICAgICB0aGlzLmxvZ2luQ2FsbGJhY2sgPSBsb2dpbkNhbGxiYWNrO1xuICAgICAgICB0aGlzLmxvZ2luVGltZXIgPSBudWxsO1xuICAgICAgICB0aGlzLnNlc3Npb25Vc2VyRW1haWwgPSBcIlwiO1xuICAgICAgICB0aGlzLnRpbWVyRGVsYXkgPSA1MDA7XG4gICAgICAgIHRoaXMuc2FsdCA9IFwiNDdkYWZlYTlhYWUzYjI4YWI1YzM5ZWI3ZjdkMmM5MjRcIjtcbiAgICAgICAgdGhpcy5lbWFpbFJlZ2V4ID0gL14oKFtePD4oKVxcW1xcXVxcXFwuLDs6XFxzQFwiXSsoXFwuW148PigpXFxbXFxdXFxcXC4sOzpcXHNAXCJdKykqKXwoXCIuK1wiKSlAKChcXFtbMC05XXsxLDN9XFwuWzAtOV17MSwzfVxcLlswLTldezEsM31cXC5bMC05XXsxLDN9XSl8KChbYS16QS1aXFwtMC05XStcXC4pK1thLXpBLVpdezIsfSkpJC87XG4gICAgICAgIHRoaXMuc2Vzc2lvbklkTG9jYWxTdG9yYWdlS2V5ID0gXCJFTUxNYWtlci5lbWxTZXNzaW9uVUlEXCI7XG4gICAgICAgIGlmICghd2luZG93LnBlcnNpc3Rfc3RvcmUpIHtcbiAgICAgICAgICAgIHdpbmRvdy5wZXJzaXN0X3N0b3JlID0gbmV3IHdpbmRvdy5QZXJzaXN0LlN0b3JlKCdFTUxNYWtlcicpO1xuICAgICAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3VubG9hZCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB3aW5kb3cucGVyc2lzdF9zdG9yZS5zYXZlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgU0cgPSB0aGlzO1xuICAgICAgICBsb2NhdGlvbi5ocmVmID0gXCIjL2xvZ2luXCI7XG4gICAgfVxuICAgIFNlY3VyZUdhdGV3YXkucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICh0aGlzLmhhc1NhdmVkU2Vzc2lvbklkKCkpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLmlzVmFsaWRFbWFpbEFkZHJlc3ModGhpcy5zZXNzaW9uSWQpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXNzaW9uVXNlckVtYWlsID0gdGhpcy5zZXNzaW9uSWQ7XG4gICAgICAgICAgICAgICAgLy8gbG9naW5DYWxsYmFjaygpO1xuICAgICAgICAgICAgICAgIGxvY2F0aW9uLmhyZWYgPSBcIiMvbG9naW5cIjtcbiAgICAgICAgICAgICAgICAvL2F1dG8gbG9ncyBpbjtcbiAgICAgICAgICAgICAgICAvL2lzIG9mZmxpbmUgLT5nZXQgb25saW5lIHZlcnNpb24uXG4gICAgICAgICAgICAgICAgdGhpcy5sb2dpblRpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGxvY2F0aW9uLmhyZWYgPSBcIiMvbWFpblwiO1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5zZXRDdXJyZW50VXNlcihfdGhpcy5zZXNzaW9uVXNlckVtYWlsKTtcbiAgICAgICAgICAgICAgICB9LCB0aGlzLnRpbWVyRGVsYXkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgbG9jYXRpb24uaHJlZiA9IFwiIy9sb2dpblwiO1xuICAgICAgICAgICAgICAgIHRoaXMuc2Vzc2lvblVzZXJFbWFpbCA9IFwiXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBsb2NhdGlvbi5ocmVmID0gXCIjL2xvZ2luXCI7XG4gICAgICAgICAgICB0aGlzLnNlc3Npb25Vc2VyRW1haWwgPSBcIlwiO1xuICAgICAgICB9XG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdoYXNoY2hhbmdlJywgZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKF90aGlzLnNlc3Npb25Vc2VyRW1haWwgPT0gXCJcIiB8fCAhX3RoaXMuaGFzU2F2ZWRTZXNzaW9uSWQoKSkge1xuICAgICAgICAgICAgICAgIGxvY2F0aW9uLmhyZWYgPSBcIiMvbG9naW5cIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBTZWN1cmVHYXRld2F5LnByb3RvdHlwZS5sb2dPdXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMubG9naW5Bc090aGVyKCk7XG4gICAgICAgIHRoaXMuc2Vzc2lvbklkID0gXCJcIjtcbiAgICAgICAgdGhpcy5zZXNzaW9uVXNlckVtYWlsID0gXCJcIjtcbiAgICAgICAgd2luZG93LnBlcnNpc3Rfc3RvcmUucmVtb3ZlKHRoaXMuc2Vzc2lvbklkTG9jYWxTdG9yYWdlS2V5KTtcbiAgICAgICAgaWYgKFwicmVsb2FkXCIgaW4gbG9jYXRpb24pIHtcbiAgICAgICAgICAgIGxvY2F0aW9uLnJlbG9hZCgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZG9jdW1lbnQubG9jYXRpb24uaHJlZiA9IGRvY3VtZW50LmxvY2F0aW9uLmhyZWY7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFNlY3VyZUdhdGV3YXkucHJvdG90eXBlLmxvZ2luQXNPdGhlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMubG9naW5UaW1lcik7XG4gICAgICAgIGRlbGV0ZSB0aGlzLmxvZ2luVGltZXI7XG4gICAgfTtcbiAgICBTZWN1cmVHYXRld2F5LnByb3RvdHlwZS5zZXNzaW9uVXBkYXRlVXNlckVtYWlsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmVycm9yTWVzc2FnZSA9IFwiXCI7XG4gICAgICAgIGlmICh0aGlzLmlzVmFsaWRFbWFpbEFkZHJlc3ModGhpcy5zZXNzaW9uVXNlckVtYWlsKSkge1xuICAgICAgICAgICAgdGhpcy5zZXRDdXJyZW50VXNlcih0aGlzLnNlc3Npb25Vc2VyRW1haWwpO1xuICAgICAgICAgICAgdGhpcy5sb2dpbkNhbGxiYWNrKCk7XG4gICAgICAgICAgICBsb2NhdGlvbi5ocmVmID0gXCIjL21haW5cIjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIC8vIEVycm9yIG1lc3NhZ2VcbiAgICAgICAgICAgIHRoaXMuZXJyb3JNZXNzYWdlID0gXCJTb3JyeSEgWW91IGhhdmUgdG8gZW50ZXIgYSB2YWxpZCBlbWFpbCBhZGRyZXNzLlwiO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTZWN1cmVHYXRld2F5LnByb3RvdHlwZS5oYXNTYXZlZFNlc3Npb25JZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHNhdmVkRW1haWxJZCA9IHdpbmRvdy5wZXJzaXN0X3N0b3JlLmdldCh0aGlzLnNlc3Npb25JZExvY2FsU3RvcmFnZUtleSk7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKHNhdmVkRW1haWxJZCk7XG4gICAgICAgIGlmIChzYXZlZEVtYWlsSWQpIHtcbiAgICAgICAgICAgIHRoaXMuc2Vzc2lvbklkID0gdGhpcy5kZWNyeXB0KHNhdmVkRW1haWxJZCk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuc2Vzc2lvbklkID0gXCJcIjtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU2VjdXJlR2F0ZXdheS5wcm90b3R5cGUuZW5jcnlwdCA9IGZ1bmN0aW9uICh0ZXh0KSB7XG4gICAgICAgIHZhciBvdXRwdXQgPSB0ZXh0ICsgXCJcIjtcbiAgICAgICAgb3V0cHV0ID0gb3V0cHV0LnJlcGxhY2UoLy4vZ2ksIGZ1bmN0aW9uIChjaCkge1xuICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhjaC5jaGFyQ29kZUF0KDApKzEpO1xuICAgICAgICAgICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUoY2guY2hhckNvZGVBdCgwKSArIDEpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICB9O1xuICAgIFNlY3VyZUdhdGV3YXkucHJvdG90eXBlLmRlY3J5cHQgPSBmdW5jdGlvbiAodGV4dCkge1xuICAgICAgICB2YXIgb3V0cHV0ID0gdGV4dCArIFwiXCI7XG4gICAgICAgIG91dHB1dCA9IG91dHB1dC5yZXBsYWNlKC8uL2dpLCBmdW5jdGlvbiAoY2gpIHtcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coY2guY2hhckNvZGVBdCgwKSsxKTtcbiAgICAgICAgICAgIHJldHVybiBTdHJpbmcuZnJvbUNoYXJDb2RlKGNoLmNoYXJDb2RlQXQoMCkgLSAxKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgfTtcbiAgICBTZWN1cmVHYXRld2F5LnByb3RvdHlwZS5zZXRDdXJyZW50VXNlciA9IGZ1bmN0aW9uIChlbWFpbCkge1xuICAgICAgICB2YXIgaGFzaCA9IHdpbmRvdy5DcnlwdG9KUy5NRDUoZW1haWwgKyB0aGlzLnNhbHQpLnRvU3RyaW5nKCk7XG4gICAgICAgIHdpbmRvdy5wZXJzaXN0X3N0b3JlLnNldCh0aGlzLnNlc3Npb25JZExvY2FsU3RvcmFnZUtleSwgdGhpcy5lbmNyeXB0KGVtYWlsKSk7XG4gICAgICAgIHdpbmRvdy5nYSgnc2V0JywgJ3VzZXJJZCcsIGhhc2gpO1xuICAgIH07XG4gICAgU2VjdXJlR2F0ZXdheS5wcm90b3R5cGUuaXNWYWxpZEVtYWlsQWRkcmVzcyA9IGZ1bmN0aW9uIChlbWFpbCkge1xuICAgICAgICBpZiAodGhpcy5lbWFpbFJlZ2V4LnRlc3QoZW1haWwpKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlbWFpbCwgXCJpcyB2YWxpZFwiKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY29uc29sZS5sb2coZW1haWwsIFwiaXMgbm90IHZhbGlkXCIpO1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gU2VjdXJlR2F0ZXdheTtcbn0oKSk7XG4iLCJcbmludGVyZmFjZSBJbnRlbGxpZ2VuY2VBbGVydEFyZ3Mge1xuICBoYW5kbGVyOiAoKT0+dm9pZCxcbiAgY3RhTGFiZWw6IHN0cmluZyxcbiAgc2V2ZXJpdHk6IEVycm9yU2V2ZXJpdHksXG4gIGlucHV0TW9kZWw6IHN0cmluZyxcbiAgaW5wdXRMYWJlbDogc3RyaW5nXG59XG5pbnRlcmZhY2UgSW50ZWxsaWdlbmNlU2NvcGV7XG4gIHNjb3BlOiBzdHJpbmc7XG4gIHJ1bGU6IGFueVxufVxuaW50ZXJmYWNlIEludGVsbGlnZW5jZVN1YntcbiAgd2hlbjogKCk9PmJvb2xlYW4sXG4gIGlkOiBzdHJpbmcsXG4gIHR5cGU6IEVycm9yVHlwZSxcbiAgc2V2ZXJpdHk6IEVycm9yU2V2ZXJpdHksXG4gIHRpdGxlOiBzdHJpbmcsXG4gIGRlc2NyaXB0aW9uOiBzdHJpbmcsXG4gIHJlc291cmNlOiBzdHJpbmcsXG4gIGN0YToge1xuICAgIGxhYmVsOiBzdHJpbmcsXG4gICAgaGFuZGxlcjogKCk9PnZvaWRcbiAgfVxuICBjYW5Db250aW51ZTogYm9vbGVhblxuXG59XG5jbGFzcyBJbnRlbGxpZ2VuY2VBbGVydCB7XG4gIGlkOiBzdHJpbmc7XG4gIF90eXBlOiBFcnJvclR5cGU7XG4gIG92ZXJyaWRlOiBib29sZWFuO1xuICB0aXRsZTogc3RyaW5nO1xuICBkZXNjcmlwdGlvbjogc3RyaW5nO1xuICByZXNvdXJjZTogc3RyaW5nO1xuICBjdGFMYWJlbDogc3RyaW5nO1xuICBjdGFIYW5kbGVyOiBhbnk7XG4gIGNhbkNvbnRpbnVlOiBib29sZWFuO1xuICBzZXZlcml0eTogRXJyb3JTZXZlcml0eTtcbiAgY2xlYW5UeXBlOiBzdHJpbmc7XG4gIGFyZ3M6IEludGVsbGlnZW5jZUFsZXJ0QXJncztcblxuICBnZW5lcmF0ZUd1aWQoKSB7XG4gICAgZnVuY3Rpb24gczQoKSB7XG4gICAgICByZXR1cm4gTWF0aC5mbG9vcigoMSArIE1hdGgucmFuZG9tKCkpICogMHgxMDAwMClcbiAgICAgICAgLnRvU3RyaW5nKDE2KVxuICAgICAgICAuc3Vic3RyaW5nKDEpO1xuICAgIH1cbiAgICByZXR1cm4gczQoKSArIHM0KCkgKyAnLScgKyBzNCgpICsgJy0nICsgczQoKSArICctJyArIHM0KCkgKyAnLScgKyBzNCgpICsgczQoKSArIHM0KCk7XG4gIH1cbiAgY29uc3RydWN0b3IoKXtcbiAgICB0aGlzLm92ZXJyaWRlID0gZmFsc2U7XG4gIH1cbiAgZ2V0IHR5cGUoKXtcbiAgICByZXR1cm4gdGhpcy5fdHlwZTtcbiAgfVxuICBzZXQgdHlwZShuZXdWYWwpe1xuICAgIHRoaXMuX3R5cGUgPSBuZXdWYWw7XG4gICAgdGhpcy5jbGVhblR5cGUgPSBFcnJvclR5cGVbbmV3VmFsXTtcbiAgfVxuICBzZXRPdmVycmlkZVN0YXR1cyh2YWwpe1xuICAgIHRoaXMub3ZlcnJpZGUgPSB2YWw7XG4gICAgLy8gY29uc29sZS5sb2codGhpcy5pZCArIFwiIC0gb3ZlcnJpZGRlblwiKTtcbiAgfVxufVxuaW50ZXJmYWNlIEludGVsbGlnZW5jZUNlbnRlckZpbHRlciB7XG4gIHR5cGU6IHN0cmluZztcbn1cbm1vZHVsZSBFTUxNYWtlckludGVsbGlnZW5jZSB7XG5cbiAgZXhwb3J0IGNsYXNzIEludGVsbGlnZW5jZUNlbnRlciB7XG4gICAgX3NlYXJjaDogYW55O1xuICAgIF9tb25pdG9yOiBJbnRlbGxpZ2VuY2VNb25pdG9yO1xuICAgIF9zY29wZTogYW55O1xuICAgIHNlYXJjaFR5cGU6IHN0cmluZztcblxuICAgIGNvbnN0cnVjdG9yKCRtb25pdG9yLCAkc2NvcGUpe1xuICAgICAgdGhpcy5fc2NvcGUgPSAkc2NvcGU7XG4gICAgICB0aGlzLl9tb25pdG9yID0gJG1vbml0b3I7XG4gICAgICB0aGlzLnNlYXJjaFR5cGUgPSB0aGlzLmRlZmF1bHRTZWFyY2hUeXBlKCk7XG4gICAgfVxuICAgIHNldFR5cGUodmFsKXtcbiAgICAgIHRoaXMuc2VhcmNoVHlwZSA9IHZhbDtcbiAgICB9XG4gICAgZGVmYXVsdFNlYXJjaFR5cGUoKXtcbiAgICAgIHZhciB0eXBlcyA9IHRoaXMuX21vbml0b3IudHlwZXM7XG4gICAgICByZXR1cm4gT2JqZWN0LmtleXModGhpcy5fbW9uaXRvci50YWJzKS5sZW5ndGg+MVxuICAgICAgPyBcIlwiXG4gICAgICA6ICh0aGlzLl9tb25pdG9yLnRhYnMpWyhPYmplY3Qua2V5cyh0aGlzLl9tb25pdG9yLnRhYnMpWzBdKV07XG4gICAgfVxuICAgIGNhblZpZXdBbGwoKXtcbiAgICAgIHJldHVybiBPYmplY3Qua2V5cyh0aGlzLl9tb25pdG9yLnRhYnMpLmxlbmd0aD4xO1xuICAgIH1cbiAgICBnZXQgc2VhcmNoKCk6SW50ZWxsaWdlbmNlQ2VudGVyRmlsdGVyIHtcblxuICAgICAgdmFyIHR5cGVzID0gdGhpcy5fbW9uaXRvci50eXBlcztcbiAgICAgIC8vIGNvbnNvbGUubG9nKFwic2VhcmNoVHlwZVwiLHRoaXMuc2VhcmNoVHlwZSk7XG4gICAgICBpZiggdHlwZXMgJiYgdGhpcy5zZWFyY2hUeXBlIGluIHR5cGVzKXtcbiAgICAgICAgcmV0dXJuIHt0eXBlOiB0aGlzLnNlYXJjaFR5cGUgfTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiB7dHlwZTogdGhpcy5kZWZhdWx0U2VhcmNoVHlwZSgpIH07XG4gICAgICB9XG4gICAgfVxuICB9XG5cblxuICBleHBvcnQgY2xhc3MgSW50ZWxsaWdlbmNlRW5naW5lIHtcbiAgICBtZXNzYWdlczogSW50ZWxsaWdlbmNlQWxlcnRbXTtcbiAgICBjYW5Db250aW51ZTogYm9vbGVhbjtcbiAgICBjYWNoZWRSZXN1bHRzOiBJbnRlbGxpZ2VuY2VBbGVydFtdO1xuICAgIG92ZXJyaWRkZW46IHN0cmluZ1tdO1xuICAgIHNjb3BlczogSW50ZWxsaWdlbmNlTW9kdWxlW107XG5cbiAgICBjb25zdHJ1Y3Rvcigpe1xuICAgICAgdGhpcy5tZXNzYWdlcyA9IFtdO1xuICAgICAgdGhpcy5jYW5Db250aW51ZSA9IHRydWU7XG4gICAgICB0aGlzLmNhY2hlZFJlc3VsdHMgPSBbXTtcbiAgICAgIHRoaXMuc2NvcGVzID0gW107XG5cbiAgICB9XG4gICAgX19sb2NhdGVTY29wZShzY29wZSkge1xuICAgICAgdmFyIHJlc3VsdCA9IHRoaXMuc2NvcGVzLmZpbHRlcihmdW5jdGlvbihvYmo6SW50ZWxsaWdlbmNlTW9kdWxlKXtcbiAgICAgICAgcmV0dXJuIG9iai5zY29wZSA9PSBzY29wZTtcbiAgICAgICB9KTtcblxuICAgICAgaWYocmVzdWx0Lmxlbmd0aCA9PSAwKXtcbiAgICAgICAgbGV0IGEgPSBuZXcgSW50ZWxsaWdlbmNlTW9kdWxlKHNjb3BlKTtcbiAgICAgICAgbGV0IGIgPSB0aGlzLnNjb3Blcy5wdXNoKGEpO1xuICAgICAgICByZXR1cm4gYTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiByZXN1bHRbMF07XG4gICAgICB9XG4gICAgfVxuICAgIHJlYWRPdXRSdWxlcygpe1xuICAgICAgLy8gdGhpcy5zY29wZXM7XG5cbiAgICAgIHRoaXMuc2NvcGVzLmZvckVhY2goKGl0ZW06SW50ZWxsaWdlbmNlTW9kdWxlKT0+e1xuICAgICAgICAvL2xldCB0cmFzaE1vbml0b3IgPSBuZXcgSW50ZWxsaWdlbmNlTW9uaXRvcihpdGVtLnNjb3BlKTtcblxuICAgICAgICB2YXIgcnVsZXMgPSBPYmplY3Qua2V5cyhpdGVtLnJ1bGVzKTtcbiAgICAgICAgZm9yKHZhciBpPTA7IGk8cnVsZXMubGVuZ3RoOyBpKyspe1xuXG4gICAgICAgICAgLy8gaWYoaXRlbS5ydWxlcy5oYXNPd25Qcm9wZXJ0eShydWxlKSl7XG4gICAgICAgICAgLy8gICBjb25zb2xlLmxvZyh0cmFzaE1vbml0b3IuZXZhbHVhdGVSdWxlKGl0ZW0ucnVsZXNbcnVsZV0pKTtcbiAgICAgICAgICAvLyB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gdHJhc2hNb25pdG9yID0gbnVsbDtcbiAgICAgIH0pO1xuXG5cblxuICAgICAgLy9ydW4gZWFjaCBvZiB0aGUgZnVuY3Rpb25zIGFuZCByZXR1cm4gdGhlIHN1YnJ0LlxuICAgIH1cbiAgICBtb2R1bGUoc2NvcGUpe1xuICAgICAgbGV0IG1vZHVsZSA9IHRoaXMuX19sb2NhdGVTY29wZShzY29wZSk7XG4gICAgICByZXR1cm4gbW9kdWxlO1xuICAgIH1cbiAgfVxuXG4gIGV4cG9ydCBjbGFzcyBJbnRlbGxpZ2VuY2VNb2R1bGUge1xuICAgIHNjb3BlOiBzdHJpbmc7XG4gICAgcnVsZXM6IHtzdHJpbmc/OiBhbnlbXX07XG4gICAgb3ZlcnJpZGRlbjogc3RyaW5nW107XG4gICAgY2FuQ29udGludWU6IGJvb2xlYW47XG4gICAgbWVzc2FnZXM6IEludGVsbGlnZW5jZUFsZXJ0W107XG5cbiAgICBjb25zdHJ1Y3RvcihzY29wZSl7XG4gICAgICB0aGlzLnNjb3BlID0gc2NvcGU7XG4gICAgICB0aGlzLnJ1bGVzID0ge307XG4gICAgfVxuXG5cbiAgICBtb25pdG9yKCl7XG4gICAgICByZXR1cm4gbmV3IEludGVsbGlnZW5jZU1vbml0b3IodGhpcyk7XG4gICAgfVxuICAgIHJlZ2lzdGVyKGlkLCBydWxlKTpJbnRlbGxpZ2VuY2VNb2R1bGV7XG4gICAgICB0aGlzLnJ1bGVzW2lkXSA9IHJ1bGU7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gIH1cbiAgZXhwb3J0IGNsYXNzIEludGVsbGlnZW5jZU1vbml0b3Ige1xuICAgIHNjb3BlOiBzdHJpbmc7XG4gICAgcnVsZXM6IGFueVtdO1xuICAgIHZhcmlhYmxlczoge307XG4gICAgb3ZlcnJpZGRlbjogc3RyaW5nW107XG4gICAgY2FuQ29udGludWU6IGJvb2xlYW47XG4gICAgbWVzc2FnZXM6IEludGVsbGlnZW5jZUFsZXJ0W107XG5cbiAgICBjb25zdHJ1Y3RvcihwYXJlbnRTY29wZSl7XG4gICAgICB0aGlzLnJ1bGVzID0gcGFyZW50U2NvcGUucnVsZXM7XG4gICAgICB0aGlzLm92ZXJyaWRkZW4gPSBbXTtcbiAgICAgIHRoaXMudmFyaWFibGVzID0ge1xuICAgICAgICBcIkludGVsbGlnZW5jZU1vbml0b3JcIjogdGhpc1xuICAgICAgfTtcbiAgICAgIHRoaXMucmVzZXQoKTtcbiAgICB9XG4gICAgcmVzZXQoKXtcbiAgICAgIHRoaXMubWVzc2FnZXMgPSBbXTtcbiAgICAgIHRoaXMuY2FuQ29udGludWUgPSB0cnVlO1xuICAgIH1cbiAgICBhc3NvY2lhdGVWYXJpYWJsZShhY2Nlc3NvciwgdmFsdWUpe1xuICAgICAgdGhpcy52YXJpYWJsZXNbYWNjZXNzb3JdID0gdmFsdWU7XG4gICAgfVxuICAgIGV2YWx1YXRlUnVsZShydWxlKTpJbnRlbGxpZ2VuY2VTdWJ7XG4gICAgICAvL2xvb2sgZm9yIGluamVjdGlvbiBwYXJhbWV0ZXJzXG4gICAgICB2YXIgcmVzdWx0O1xuXG4gICAgICBpZih0eXBlb2YgcnVsZSA9PSBcIm9iamVjdFwiKXtcbiAgICAgICAgLy9sYXN0IHBhcmFtZXRlciBpcyB0aGUgZnV1bmN0aW9uO1xuICAgICAgICB2YXIgZnVuYyA9IHJ1bGVbcnVsZS5sZW5ndGgtMV07XG4gICAgICAgIHZhciBwYXJhbWV0ZXJzID0gcnVsZS5zbGljZSgwLCBydWxlLmxlbmd0aC0xKTtcbiAgICAgICAgbGV0IElNID0gdGhpcztcblxuICAgICAgICB2YXIgYXJncyA9IHBhcmFtZXRlcnMubWFwKGZ1bmN0aW9uKGtleTpzdHJpbmcpe3JldHVybiBJTS52YXJpYWJsZXNba2V5XTsgfSk7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgcmVzdWx0ID0gZnVuYy5hcHBseShudWxsLCBhcmdzKTtcbiAgICAgICAgfSBjYXRjaChlKXtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKGUpO1xuICAgICAgICB9XG5cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc3VsdCA9IHJ1bGUoKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgIGV2YWx1YXRlUnVsZXMoKXtcbiAgICAgIHRoaXMucmVzZXQoKTtcbiAgICAgIHZhciBydWxlcyA9IE9iamVjdC5rZXlzKHRoaXMucnVsZXMpO1xuICAgICAgZm9yKHZhciBydWxlICBvZiBydWxlcyl7XG4gICAgICAgIHZhciByZXN1bHQgPSB0aGlzLmV2YWx1YXRlUnVsZSh0aGlzLnJ1bGVzW3J1bGVdKTtcblxuICAgICAgICB2YXIgcHJvY2VlZCA9IHJlc3VsdC5oYXNPd25Qcm9wZXJ0eShcIndoZW5cIikgPyByZXN1bHQud2hlbi5hcHBseShudWxsKSA6IGZhbHNlO1xuXG4gICAgICAgIGlmKHByb2NlZWQpe1xuICAgICAgICAgIC8vIFBVU0ggQUxFUlQgTUVTU0FHRS5cbiAgICAgICAgICBsZXQgSUEgPSBuZXcgSW50ZWxsaWdlbmNlQWxlcnQoKTtcbiAgICAgICAgICBJQS5pZCA9IHJlc3VsdC5pZD09PXVuZGVmaW5lZCB8fCByZXN1bHQuaWQ9PVwiXCIgPyBJQS5nZW5lcmF0ZUd1aWQoKSA6IHJlc3VsdC5pZDtcbiAgICAgICAgICBJQS50eXBlID0gcmVzdWx0LnR5cGUgPT09IHVuZGVmaW5lZCA/IEVycm9yVHlwZS5XYXJuIDogcmVzdWx0LnR5cGU7XG4gICAgICAgICAgSUEuc2V2ZXJpdHkgPSByZXN1bHQuc2V2ZXJpdHkgPT09IHVuZGVmaW5lZCA/IEVycm9yU2V2ZXJpdHkuWmVybyA6IHJlc3VsdC5zZXZlcml0eTtcbiAgICAgICAgICBJQS50aXRsZSA9IHJlc3VsdC50aXRsZSA9PT0gdW5kZWZpbmVkID8gXCJcIiA6IHJlc3VsdC50aXRsZTtcbiAgICAgICAgICBJQS5kZXNjcmlwdGlvbiA9IHJlc3VsdC5kZXNjcmlwdGlvbiA9PT0gdW5kZWZpbmVkID8gXCJcIiA6IHJlc3VsdC5kZXNjcmlwdGlvbjtcbiAgICAgICAgICBJQS5yZXNvdXJjZSA9IHJlc3VsdC5yZXNvdXJjZSA9PT0gdW5kZWZpbmVkID8gXCJcIiA6IHJlc3VsdC5yZXNvdXJjZTtcbiAgICAgICAgICBJQS5jdGFIYW5kbGVyID0gcmVzdWx0LmN0YSAmJiByZXN1bHQuY3RhLmhhbmRsZXIgPyByZXN1bHQuY3RhLmhhbmRsZXIgOiBmdW5jdGlvbigpe307XG4gICAgICAgICAgSUEuY3RhTGFiZWwgPSByZXN1bHQuY3RhICYmIHJlc3VsdC5jdGEubGFiZWwgPyByZXN1bHQuY3RhLmxhYmVsIDogXCJcIjtcbiAgICAgICAgICBJQS5jYW5Db250aW51ZSA9IHJlc3VsdC5oYXNPd25Qcm9wZXJ0eShcImNhbkNvbnRpbnVlXCIpID8gcmVzdWx0LmNhbkNvbnRpbnVlIDogdHJ1ZTtcbiAgICAgICAgICB0aGlzLm1lc3NhZ2VzLnB1c2goSUEpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGZvcih2YXIgaT0wOyBpIDwgdGhpcy5tZXNzYWdlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZih0aGlzLm92ZXJyaWRkZW4uaW5kZXhPZiggdGhpcy5tZXNzYWdlc1tpXS5pZCApPi0xKXtcbiAgICAgICAgICB0aGlzLm1lc3NhZ2VzW2ldLm92ZXJyaWRlID0gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmKCF0aGlzLm1lc3NhZ2VzW2ldLmNhbkNvbnRpbnVlKSB7XG4gICAgICAgICAgaWYoIXRoaXMubWVzc2FnZXNbaV0ub3ZlcnJpZGUpIHtcbiAgICAgICAgICAgIHRoaXMuY2FuQ29udGludWUgPSBmYWxzZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuXG4gICAgICB0aGlzLm1lc3NhZ2VzLnNvcnQoKGE6SW50ZWxsaWdlbmNlQWxlcnQsIGI6SW50ZWxsaWdlbmNlQWxlcnQpOm51bWJlciA9PiB7XG4gICAgICAgICAgaWYoYS5fdHlwZT5iLl90eXBlKSByZXR1cm4gMTtcbiAgICAgICAgICBpZihhLl90eXBlPGIuX3R5cGUpIHJldHVybiAtMTtcbiAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIGdldCB0YWJzKCl7XG4gICAgICBsZXQgb3V0cHV0ID0ge307XG4gICAgICBmb3IobGV0IGkgPSAwOyBpPHRoaXMubWVzc2FnZXMubGVuZ3RoOyBpKyspe1xuICAgICAgICBvdXRwdXRbdGhpcy5tZXNzYWdlc1tpXS5jbGVhblR5cGVdID0gdGhpcy5tZXNzYWdlc1tpXS50eXBlO1xuICAgICAgICAvLyBvdXRwdXRbdGhpcy5tZXNzYWdlc1tpXS50eXBlXSA9IEVycm9yVHlwZVt0aGlzLm1lc3NhZ2VzW2ldLnR5cGVdO1xuICAgICAgfVxuICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICB9XG4gICAgZ2V0IHR5cGVzKCl7XG4gICAgICBsZXQgb3V0cHV0ID0ge307XG4gICAgICBmb3IobGV0IGkgPSAwOyBpPHRoaXMubWVzc2FnZXMubGVuZ3RoOyBpKyspe1xuICAgICAgICBvdXRwdXRbdGhpcy5tZXNzYWdlc1tpXS50eXBlXSA9IEVycm9yVHlwZVt0aGlzLm1lc3NhZ2VzW2ldLnR5cGVdO1xuICAgICAgfVxuICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICB9XG4gICAgZ2V0IGNvdW50KCl7XG4gICAgICBsZXQgb3V0cHV0ID0ge307XG4gICAgICBmb3IodmFyIGkgPTA7IGkgPCB0aGlzLm1lc3NhZ2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmKG91dHB1dFtFcnJvclR5cGVbdGhpcy5tZXNzYWdlc1tpXS50eXBlXV0gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgIG91dHB1dFtFcnJvclR5cGVbdGhpcy5tZXNzYWdlc1tpXS50eXBlXV0gPSAwO1xuICAgICAgICB9XG4gICAgICAgIG91dHB1dFtFcnJvclR5cGVbdGhpcy5tZXNzYWdlc1tpXS50eXBlXV0rKztcbiAgICAgIH1cbiAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgfVxuICB9XG5cbn1cblxuXG52YXIgRU1MSW50ZWxsaWdlbmNlID0gbmV3IEVNTE1ha2VySW50ZWxsaWdlbmNlLkludGVsbGlnZW5jZUVuZ2luZSgpO1xuIiwiaW50ZXJmYWNlIFdpbmRvdyB7XG4gICAgZ2Eob3B0aW9uMSwgb3B0aW9uMiwgb3B0aW9uMywgb3B0aW9uND8sIG9wdGlvbjU/KTogdm9pZDtcbiAgICBQZXJzaXN0OiBhbnk7XG4gICAgQ3J5cHRvSlM6IGFueTtcbiAgICBqUXVlcnkob3B0aW9uKTphbnk7XG4gICAgZGVjb2RlVVJJQ29tcG9uZW50KG9wdGlvbik6IHN0cmluZztcbiAgICBlbmNvZGVVUklDb21wb25lbnQob3B0aW9uKTogc3RyaW5nO1xufVxuXG5jbGFzcyBTZWN1cmVHYXRld2F5e1xuICBsb2dpbkNhbGxiYWNrOiAoKT0+e307XG4gIGxvZ2luVGltZXI6IGFueTtcbiAgZXJyb3JNZXNzYWdlOiBzdHJpbmc7XG4gIHNlc3Npb25JZDpzdHJpbmc7XG4gIHNlc3Npb25JZExvY2FsU3RvcmFnZUtleTogc3RyaW5nO1xuICBzZXNzaW9uVXNlckVtYWlsOnN0cmluZztcbiAgdGltZXJEZWxheTogbnVtYmVyO1xuICBzYWx0OiBzdHJpbmc7XG4gIGVtYWlsUmVnZXg6IFJlZ0V4cDtcbiAgY2FuTG9naW46IGJvb2xlYW47XG4gIEFPVjogQWNjZXNzT25saW5lVmVyc2lvbjtcblxuXG4gIGNvbnN0cnVjdG9yKGxvZ2luQ2FsbGJhY2ssICRzY29wZSl7XG4gICAgdGhpcy5jYW5Mb2dpbiA9IGZhbHNlO1xuICAgIHRoaXMubG9naW5DYWxsYmFjayA9IGxvZ2luQ2FsbGJhY2s7XG4gICAgdGhpcy5sb2dpblRpbWVyID0gbnVsbDtcbiAgICB0aGlzLnNlc3Npb25Vc2VyRW1haWwgPSBcIlwiO1xuICAgIHRoaXMudGltZXJEZWxheSA9IDUwMDtcbiAgICB0aGlzLnNhbHQgPSBcIjQ3ZGFmZWE5YWFlM2IyOGFiNWMzOWViN2Y3ZDJjOTI0XCI7XG4gICAgdGhpcy5lbWFpbFJlZ2V4ID0gL14oKFtePD4oKVxcW1xcXVxcXFwuLDs6XFxzQFwiXSsoXFwuW148PigpXFxbXFxdXFxcXC4sOzpcXHNAXCJdKykqKXwoXCIuK1wiKSlAKChcXFtbMC05XXsxLDN9XFwuWzAtOV17MSwzfVxcLlswLTldezEsM31cXC5bMC05XXsxLDN9XSl8KChbYS16QS1aXFwtMC05XStcXC4pK1thLXpBLVpdezIsfSkpJC87XG4gICAgdGhpcy5zZXNzaW9uSWRMb2NhbFN0b3JhZ2VLZXkgPSBcIkVNTE1ha2VyLmVtbFNlc3Npb25VSURcIjtcblxuICAgIGlmKCF3aW5kb3cucGVyc2lzdF9zdG9yZSlcbiAgICB7d2luZG93LnBlcnNpc3Rfc3RvcmUgPSBuZXcgd2luZG93LlBlcnNpc3QuU3RvcmUoJ0VNTE1ha2VyJyk7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3VubG9hZCcsIGZ1bmN0aW9uKCl7XG4gICAgICB3aW5kb3cucGVyc2lzdF9zdG9yZS5zYXZlKCk7XG4gICAgfSk7fVxuICAgIGxldCBTRyA9IHRoaXM7XG4gICAgbG9jYXRpb24uaHJlZj1cIiMvbG9naW5cIjtcbiAgfVxuICBpbml0KCl7XG5cbiAgICBpZih0aGlzLmhhc1NhdmVkU2Vzc2lvbklkKCkpe1xuICAgICAgaWYodGhpcy5pc1ZhbGlkRW1haWxBZGRyZXNzKHRoaXMuc2Vzc2lvbklkKSl7XG4gICAgICAgIHRoaXMuc2Vzc2lvblVzZXJFbWFpbCA9IHRoaXMuc2Vzc2lvbklkO1xuICAgICAgICAvLyBsb2dpbkNhbGxiYWNrKCk7XG4gICAgICAgIGxvY2F0aW9uLmhyZWY9XCIjL2xvZ2luXCI7XG5cbiAgICAgICAgLy9hdXRvIGxvZ3MgaW47XG4gICAgICAgIC8vaXMgb2ZmbGluZSAtPmdldCBvbmxpbmUgdmVyc2lvbi5cbiAgICAgICAgdGhpcy5sb2dpblRpbWVyID0gc2V0VGltZW91dCgoKT0+e1xuICAgICAgICAgIGxvY2F0aW9uLmhyZWY9XCIjL21haW5cIjtcbiAgICAgICAgICB0aGlzLnNldEN1cnJlbnRVc2VyKHRoaXMuc2Vzc2lvblVzZXJFbWFpbCk7XG4gICAgICAgIH0sIHRoaXMudGltZXJEZWxheSk7XG5cblxuXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBsb2NhdGlvbi5ocmVmPVwiIy9sb2dpblwiO1xuICAgICAgICB0aGlzLnNlc3Npb25Vc2VyRW1haWwgPSBcIlwiO1xuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGxvY2F0aW9uLmhyZWY9XCIjL2xvZ2luXCI7XG4gICAgICB0aGlzLnNlc3Npb25Vc2VyRW1haWwgPSBcIlwiO1xuICAgIH1cbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignaGFzaGNoYW5nZScsICgpPT57XG4gICAgICBpZiggdGhpcy5zZXNzaW9uVXNlckVtYWlsID09IFwiXCIgfHwgIXRoaXMuaGFzU2F2ZWRTZXNzaW9uSWQoKSkge1xuICAgICAgICBsb2NhdGlvbi5ocmVmPVwiIy9sb2dpblwiO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG4gIGxvZ091dCgpOnZvaWQge1xuICAgIHRoaXMubG9naW5Bc090aGVyKCk7XG4gICAgdGhpcy5zZXNzaW9uSWQgPSBcIlwiO1xuICAgIHRoaXMuc2Vzc2lvblVzZXJFbWFpbCA9IFwiXCI7XG4gICAgd2luZG93LnBlcnNpc3Rfc3RvcmUucmVtb3ZlKHRoaXMuc2Vzc2lvbklkTG9jYWxTdG9yYWdlS2V5KTtcbiAgICBpZihcInJlbG9hZFwiIGluIGxvY2F0aW9uKXtcbiAgICAgIGxvY2F0aW9uLnJlbG9hZCgpO1xuICAgIH0gZWxzZSB7XG4gICAgICBkb2N1bWVudC5sb2NhdGlvbi5ocmVmID0gZG9jdW1lbnQubG9jYXRpb24uaHJlZjtcbiAgICB9XG4gIH1cbiAgbG9naW5Bc090aGVyKCk6dm9pZCB7XG4gICAgY2xlYXJUaW1lb3V0KHRoaXMubG9naW5UaW1lcik7XG4gICAgZGVsZXRlIHRoaXMubG9naW5UaW1lcjtcbiAgfVxuICBzZXNzaW9uVXBkYXRlVXNlckVtYWlsKCk6dm9pZCB7XG4gICAgdGhpcy5lcnJvck1lc3NhZ2UgPSBcIlwiO1xuXG4gICAgaWYodGhpcy5pc1ZhbGlkRW1haWxBZGRyZXNzKHRoaXMuc2Vzc2lvblVzZXJFbWFpbCkpIHtcbiAgICAgIHRoaXMuc2V0Q3VycmVudFVzZXIodGhpcy5zZXNzaW9uVXNlckVtYWlsKTtcbiAgICAgIHRoaXMubG9naW5DYWxsYmFjaygpO1xuICAgICAgbG9jYXRpb24uaHJlZiA9IFwiIy9tYWluXCI7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIEVycm9yIG1lc3NhZ2VcbiAgICAgIHRoaXMuZXJyb3JNZXNzYWdlID0gXCJTb3JyeSEgWW91IGhhdmUgdG8gZW50ZXIgYSB2YWxpZCBlbWFpbCBhZGRyZXNzLlwiO1xuICAgIH1cbiAgfVxuICBoYXNTYXZlZFNlc3Npb25JZCgpOmJvb2xlYW4ge1xuICAgIHZhciBzYXZlZEVtYWlsSWQgPSB3aW5kb3cucGVyc2lzdF9zdG9yZS5nZXQodGhpcy5zZXNzaW9uSWRMb2NhbFN0b3JhZ2VLZXkpO1xuICAgIC8vIGNvbnNvbGUubG9nKHNhdmVkRW1haWxJZCk7XG4gICAgaWYoc2F2ZWRFbWFpbElkKXtcbiAgICAgIHRoaXMuc2Vzc2lvbklkID0gdGhpcy5kZWNyeXB0KHNhdmVkRW1haWxJZCk7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5zZXNzaW9uSWQgPSBcIlwiO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuICBlbmNyeXB0KHRleHQpe1xuICAgIHZhciBvdXRwdXQ9dGV4dCtcIlwiO1xuICAgIG91dHB1dCA9IG91dHB1dC5yZXBsYWNlKC8uL2dpLGZ1bmN0aW9uKGNoKXtcbiAgICAvL2NvbnNvbGUubG9nKGNoLmNoYXJDb2RlQXQoMCkrMSk7XG4gICAgICByZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZShjaC5jaGFyQ29kZUF0KDApKzEpO1xuICAgIH0pO1xuICAgIHJldHVybiBvdXRwdXQ7XG5cbiAgfVxuICBkZWNyeXB0KHRleHQpe1xuICAgIHZhciBvdXRwdXQ9dGV4dCtcIlwiO1xuICAgIG91dHB1dCA9IG91dHB1dC5yZXBsYWNlKC8uL2dpLGZ1bmN0aW9uKGNoKXtcbiAgICAvL2NvbnNvbGUubG9nKGNoLmNoYXJDb2RlQXQoMCkrMSk7XG4gICAgICByZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZShjaC5jaGFyQ29kZUF0KDApLTEpO1xuICAgIH0pO1xuICAgIHJldHVybiBvdXRwdXQ7XG5cbiAgfVxuICBzZXRDdXJyZW50VXNlcihlbWFpbCl7XG4gICAgdmFyIGhhc2ggPSB3aW5kb3cuQ3J5cHRvSlMuTUQ1KGVtYWlsICsgdGhpcy5zYWx0KS50b1N0cmluZygpO1xuICAgIHdpbmRvdy5wZXJzaXN0X3N0b3JlLnNldCh0aGlzLnNlc3Npb25JZExvY2FsU3RvcmFnZUtleSwgdGhpcy5lbmNyeXB0KGVtYWlsKSk7XG4gICAgd2luZG93LmdhKCdzZXQnLCAndXNlcklkJywgaGFzaCk7XG4gIH1cbiAgaXNWYWxpZEVtYWlsQWRkcmVzcyhlbWFpbCk6Ym9vbGVhbntcbiAgICBpZih0aGlzLmVtYWlsUmVnZXgudGVzdChlbWFpbCkpe1xuICAgICAgY29uc29sZS5sb2coZW1haWwsIFwiaXMgdmFsaWRcIik7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc29sZS5sb2coZW1haWwsIFwiaXMgbm90IHZhbGlkXCIpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuXG5cbn1cbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
