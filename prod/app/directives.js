angular.module("EMLMaker").directive("aceEditor",["$timeout",function(e){return{restrict:"A",link:function(t,o,n){e(function(){var e=ace.edit(o.get(0).id);e.setTheme("ace/theme/eclipse"),e.getSession().setUseWrapMode(!0),e.getSession().setMode("ace/mode/xml");e.getSession().on("change",function(o){t.$apply(function(){t.workspace.sourceCode=e.getValue()})}),t.$on("$destroy",function(){e.destroy()})})}}}]);
angular.module("EMLMaker").directive("dropEnable",["$timeout",function(e){return{restrict:"A",scope:{ondropfile:"&",dataTransferEvt:"="},link:function(t,n,o){var r=n,a=null,i=function(e){clearTimeout(a),a=setTimeout(function(){r.removeClass("active"),setTimeout(function(){window.jQuery(".ui.sticky").sticky("refresh")},100),r.css({border:"",color:"",background:""})},100),e.stopPropagation(),e.preventDefault()},d=0;e(function(){r.get(0).addEventListener("drop",function(e){return"#/main"===location.hash&&(e.stopPropagation(),e.preventDefault(),d++,i(e),void((location.hash="#/main")&&t.ondropfile({evt:e})))},!1),r.get(0).addEventListener("dragend",i,!1),r.get(0).addEventListener("dragleave",i,!1),r.get(0).addEventListener("dragover",function(e){return clearTimeout(a),"#/main"===location.hash&&(e.dataTransfer.dropEffect="copy",r.addClass("active"),r.css({border:"solid 3px blue",color:"blue",background:"lightblue"}),a=setTimeout(function(){},100),void e.preventDefault())},!1)})}}}]);
angular.module("EMLMaker").directive("uiDropdown",["$timeout",function(o){return{restrict:"A",scope:{dropdownAction:"@"},link:function(n,t,d){o(function(){var o={action:"hide"};n.dropdownAction&&(o.action=n.dropdownAction),$(t).dropdown(o)}),n.$on("$destroy",function(){$(t).dropdown("destroy")})}}}]);
angular.module("EMLMaker").directive("gaEvent",["$timeout",function(n){return{restrict:"A",scope:{gaEvent:"@"},link:function(t,e,o){n(function(){var n=function(){for(var n=["send","event"],e=t.gaEvent.split(/\,|\|/),o=0;o<e.length;o++)n.push(e[o]);window.ga.apply(null,n)};e.on("click",n)}),t.$on("$destroy",function(){e.on("off",reportEvent)})}}}]);
angular.module("EMLMaker").directive("htmlViewer",["$timeout",function(t){return{restrict:"E",template:'<div><ol start="{{item.line}}"><li ng-repeat="ln in code(item) track by $index" ng-bind-html="ln"></li></ol></div>',scope:{item:"="},link:function(e,i,n){e.code=function(t){var e=t.displayFormattedURL().split(/\<br\>|\n/g);return e},t(function(){})}}}]);
angular.module("EMLMaker").directive("messageCenter",["$timeout",function(e){return{restrict:"E",template:'<div class="message-center"><div class="ui tiny secondary menu">    <div class="item mnu-title" style="padding-left:0;">{{heading === undefined ? "MESSAGES:" : heading }}</div>    <a class="item" ng-click="IntelligenceCenter.setType(\'\')" ng-class="{active: IntelligenceCenter.search.type==\'\'}" ng-show="IntelligenceCenter.canViewAll()">All <span class="ui tiny label">{{errors.messages.length}}</span></a>    <a class="item" ng-repeat="(tab,val) in errors.tabs track by $index" ng-show="errors.count[tab]" ng-click="IntelligenceCenter.setType(val)" ng-class="{active: IntelligenceCenter.search.type==val}">{{tab | uncamelize}} <span class="ui tiny label">{{errors.count[tab]}}</span></a>    </div>    <div id="error-messages-list" class="ui middle aligned divided list">      <message-item item="item" class="item" ng-repeat="obj in errors.messages | filter: IntelligenceCenter.search" error="obj"></message-item>      </div>      <div align="center" style="margin-top: -1.5em; padding-bottom: 1.5em;" ng-show="IntelligenceCenter.search.type!==\'\' && IntelligenceCenter.canViewAll()">      <button class="ui tiny basic button" ng-click="IntelligenceCenter.setType(\'\')"><i class="minus square icon"></i> Remove filter</button></div>    </div>',scope:{errors:"=",heading:"@",item:"="},link:function(n,t,i){e(function(){n.IntelligenceCenter=new EMLMakerIntelligence.IntelligenceCenter(n.errors,n),n.$on("$destroy",function(){})})}}}]);
angular.module("EMLMaker").directive("messageItem",["$timeout",function(e){return{restrict:"E",template:'<div ng-class="messageCls" class="intel-msg">    <div class="right floated content" ng-if="error.ctaLabel!==\'\'" >    <div class="ui small compact"     ng-class="buttonCls" ng-if="buttonCls"      ng-click="error.ctaHandler(item)"      ng-bind-html="error.ctaLabel">{{error.ctaLabel ? error.ctaLabel : "Resolve"}}</div>    </div>    <div class="right floated content" ng-if="error.cleanType==\'QA\'" >    <span class="ui icon label" ng-show="error.cleanType==\'QA\'&&error.override"><i class="thumbs up icon"></i> YOU CONFIRMED</span>    <div class="ui small compact"     ng-class="buttonCls" ng-if="buttonCls" ng-hide="error.override"      ng-click="error.setOverrideStatus(true);error.ctaHandler()"><i class="check icon"></i> Confirm</div>    </div>      <div class="content" ng-show="buttonCls">         <h4 ng-bind-html="error.title | dewidow"></h4>        <div ng-bind-html="error.description"></div></div>        <div ng-if="error.suggestion.length>0" ng-hide="error.override" class="suggestion">SUGGESTION: <div ng-bind-html="error.suggestion"></div></div>        <div ng-if="error.resource!==\'\'"><a ng-href="{{error.resource}}" target="_blank">{{error.resourceText}} <i class="external alternate icon"></i></a></div>    </div>',scope:{error:"=",item:"="},link:function(r,i,t){e(function(){var e=["","red","orange","violet","teal","blue"];r.buttonCls=[e[r.error.severity],"button"].join(" "),"QA"==r.error.cleanType&&r.error.override?r.messageCls="":r.messageCls=["type-",r.error.type," level-",r.error.severity].join(""),r.$on("$destroy",function(){})})}}}]);
angular.module("EMLMaker").directive("messagesNotify",["$timeout",function(n){return{restrict:"E",template:'<div class="ui fluid labeled button" ng-click="ngClick()" ng-class="{\'animate-tada\': doAnimation}">      <div class="ui fluid button" ng-class="{\'yellow\':doAnimation, \'red\': !workspace.intelligence.canContinue}">        <i class="warning icon" alt="[!]" ng-show="!workspace.intelligence.canContinue"></i>        <i class="info icon" alt="(i)" ng-show="workspace.intelligence.canContinue"></i>        {{ count>1 ? "Messages" : "Message"}}        </div>      <div class="ui label" ng-class="{\'yellow\':doAnimation, \'red\': !workspace.intelligence.canContinue}">        {{count}}        </div>      </div>      </div>',scope:{workspace:"=",ngClick:"&",count:"="},link:function(i,o,t){i.doAnimation=!0,setTimeout(function(){i.$apply(function(){i.doAnimation=!1})},1500),i.$watch("count",function(n,i,o){n>i&&(o.doAnimation=!0,console.log("UPDATED"),setTimeout(function(){o.$apply(function(){o.doAnimation=!1})},1500))}),n(function(){setTimeout(function(){i.$apply(function(){i.doAnimation=!1})},2e3),i.$on("$destroy",function(){})})}}}]);
angular.module("EMLMaker").directive("ngChangeLazy",["$timeout",function(n){return{restrict:"A",scope:{ngModel:"=",ngChangeLazy:"&",changeLazyBuffer:"=",dataTransferEvt:"="},link:function(e,a,t){var u=null;n(function(){var n=e.ngModel.toString();a.on("keyup",function(o){clearTimeout(u),u=setTimeout(function(){n!==a[0].value&&e.$apply(function(){e.ngChangeLazy(),n=a[0].value})},void 0===t.changeLazyBuffer?500:1*t.changeLazyBuffer)}),e.$on("$destroy",function(){a.off("keyup")})})}}}]);
angular.module("EMLMaker").directive("onReturnPress",["$timeout",function(e){return{restrict:"A",scope:{onReturnPress:"&",dataTransferEvt:"="},link:function(n,r,t){e(function(){r.on("keypress",function(e){13==e.keyCode&&n.onReturnPress()}),n.$on("$destroy",function(){r.off("keypress")})})}}}]);
angular.module("EMLMaker").directive("uiPopup",["$timeout",function(p){return{restrict:"A",scope:{popupId:"@",popupBehavior:"@"},link:function(o,u,i){p(function(){var p={hoverable:!0,popup:"#"+i.popupId};!function(o,i,e){void 0!==e.popupBehavior&&(p.on="click"),void 0!==e.popupId&&(p.popup="#"+e.popupId),o(u).popup(p),void 0!==e.popupShow&&o(u).popup("show"),i.$on("$destroy",function(){o(u).popup("destroy")})}(jQuery,o,i)})}}}]);
angular.module("EMLMaker").directive("queryStringEditor",["$timeout",function(e){return{restrict:"E",template:'<div class="query-string-editor well-component" ng-hide="item.isLinkType(\'mailto\')"><div style="overflow:hidden;padding-bottom:.5em;"><strong>QUERY STRING EDITOR</strong>    <div class="ui tiny basic buttons" style="float:right;">  <button class="ui icon button" ng-click="item.new.searchParams.deleteAll();item.isLinkComplete();scrollToItem(item.id);">Remove all</button>  <button class="ui icon button" ng-click="view == 1 ? view=0 : view=1">{{view==1? "Close" : "Edit"}}</button></div></div>     <div ng-if="item.new.searchParams._entries.length==1&&item.new.searchParams._entries[0].length==0">Query strings will appear here.</div>      <div ng-show="view==1">      <div style="margin-bottom:.5em;" class="ui action input" ng-if="str.length>0" ng-repeat="str in item.new.searchParams.entries track by $index">      <input type="text" ng-keyup="item.new.searchParams.updateSearchProp();item.isLinkComplete()" ng-model="item.new.searchParams._entries[$index]"/>      <button class="ui icon button" ng-click="item.new.searchParams.deleteAtIndex($index)">      Remove</button></div>      </div>      <div ng-show="view==0">      <ul class="tags-layout">       <li ng-if="str.length>0" ng-repeat="str in item.new.searchParams.entries track by $index">       {{str}} <a href="javascript:angular.noop()" ng-click="item.new.searchParams.deleteAtIndex($index);item.isLinkComplete()">       <i class="close icon" alt="[X]"></i></a></li></ul>       </div>      </div>',scope:{item:"=",scrollTo:"&"},link:function(t,i,n){e(function(){var e=function(e){return e[e.DEFAULT=0]="DEFAULT",e[e.EDIT=1]="EDIT",e}({});window.qs_debug=t;var i=t;do i=i.$parent;while(void 0===i.scrollTo);t.scrollToItem=function(e){setTimeout(function(){t.$apply(function(){i.scrollTo(e-1)})},50)},t.view=e.DEFAULT,t.$on("$destroy",function(){})})}}}]);
angular.module("EMLMaker").directive("scrollspy",["$timeout",function(i){return{restrict:"A",link:function(n,e,o){i(function(){void 0===n.activeLinkId&&(n.activeLinkId=1),void 0===n.isScrolling&&(n.isScrolling=!1);var i=function(){if(n.isScrolling&&1==n.isScrolling)return!1;var i=jQuery(e).attr("id").split("-").pop();n.$apply(function(){n.activeLinkId=1*i})};jQuery(e).visibility({once:!1,observeChanges:!0,onTopVisible:i,onTopPassedReverse:i}),n.$on("$destroy",function(){jQuery(e).visibility("destroy")})})}}}]);
angular.module("EMLMaker").directive("simpleAccordion",["$timeout",function(n){return{restrict:"E",transclude:!0,scope:{heading:"@",show:"="},template:'<div ng-class="{expanded: show, collapsed: !show}"><div ng-click="togglePane()" class="accordion-title">    <i class="chevron right icon" ng-show="!show" alt="[+]"></i>    <i class="chevron down icon" ng-show="show" alt="[-]"></i>     <span>{{heading}}</span></div><ng-transclude ng-show="show"></ng-transclude></div>',link:function(o,e,i){o.show=!1,n(function(){o.togglePane=function(){o.show=!o.show},jQuery.extend(jQuery(e),{toggleAccordion:function(){o.$apply(function(){o.togglePane()})}}),o.$on("$destroy",function(){})})}}}]);
angular.module("EMLMaker").directive("sticky",["$timeout",function(e){return{restrict:"A",link:function(i,n,t){e(function(){jQuery(n).sticky({context:"#stickyparent"});var e=null,t=function(){e=setTimeout(function(){var e=$("#right-panel"),i=e.find(".ui.secondary.vertical.pointing.menu"),t=e.find(".message-area");e[0].style.height="",e[0].clientHeight>window.innerHeight-135?(e[0].style.height=window.innerHeight-150+"px",i[0].style.height=e[0].clientHeight-t[0].clientHeight+"px",i.addClass("scrolling")):i.removeClass("scrolling"),jQuery(n).sticky("refresh")},300)};$(window).on("resize",t),$(window).on("scroll",t),t(),i.$on("$destroy",function(){$(window).off("resize",t),$(window).off("scroll",t),jQuery(n).sticky("destroy")})})}}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFjZUVkaXRvci5qcyIsImRyb3AtZW5hYmxlLmpzIiwiZHJvcGRvd24uanMiLCJnYUV2ZW50LmpzIiwiaHRtbFZpZXdlci5qcyIsIm1lc3NhZ2VDZW50ZXIuanMiLCJtZXNzYWdlSXRlbS5qcyIsIm1lc3NhZ2VzTm90aWZ5LmpzIiwibmdDaGFuZ2VMYXp5LmpzIiwib25SZXR1cm5QcmVzcy5qcyIsInBvcHVwLmpzIiwicXVlcnlTdHJpbmdFZGl0b3IuanMiLCJzY3JvbGxzcHkuanMiLCJzaW1wbGVBY2NvcmRpb24uanMiLCJzdGlja3kuanMiXSwibmFtZXMiOlsiYW5ndWxhciIsIm1vZHVsZSIsImRpcmVjdGl2ZSIsIiR0aW1lb3V0IiwicmVzdHJpY3QiLCJsaW5rIiwic2NvcGUiLCJlbCIsImF0dHIiLCJlZGl0b3IiLCJhY2UiLCJlZGl0IiwiZ2V0IiwiaWQiLCJzZXRUaGVtZSIsImdldFNlc3Npb24iLCJzZXRVc2VXcmFwTW9kZSIsInNldE1vZGUiLCJvbiIsImUiLCIkYXBwbHkiLCJ3b3Jrc3BhY2UiLCJzb3VyY2VDb2RlIiwiZ2V0VmFsdWUiLCIkb24iLCJkZXN0cm95Iiwib25kcm9wZmlsZSIsImRhdGFUcmFuc2ZlckV2dCIsImZpbGVEcm9wcGVyIiwidGltZXIiLCJkcm9wcGVyUmVzZXQiLCJldnQiLCJjbGVhclRpbWVvdXQiLCJzZXRUaW1lb3V0IiwicmVtb3ZlQ2xhc3MiLCJ3aW5kb3ciLCJqUXVlcnkiLCJzdGlja3kiLCJjc3MiLCJib3JkZXIiLCJjb2xvciIsImJhY2tncm91bmQiLCJzdG9wUHJvcGFnYXRpb24iLCJwcmV2ZW50RGVmYXVsdCIsImNvdW50ZXIiLCJhZGRFdmVudExpc3RlbmVyIiwibG9jYXRpb24iLCJoYXNoIiwiZGF0YVRyYW5zZmVyIiwiZHJvcEVmZmVjdCIsImFkZENsYXNzIiwiZHJvcGRvd25BY3Rpb24iLCJhY3Rpb24iLCIkIiwiZHJvcGRvd24iLCJnYUV2ZW50IiwicmVwb3J0RXZlbnQiLCJhcmdzIiwibmV3QXJncyIsInNwbGl0IiwiaSIsImxlbmd0aCIsInB1c2giLCJnYSIsImFwcGx5IiwidGVtcGxhdGUiLCJpdGVtIiwiY29kZSIsImMiLCJiIiwiZGlzcGxheUZvcm1hdHRlZFVSTCIsImVycm9ycyIsImhlYWRpbmciLCJJbnRlbGxpZ2VuY2VDZW50ZXIiLCJFTUxNYWtlckludGVsbGlnZW5jZSIsImVycm9yIiwiY2xzIiwiYnV0dG9uQ2xzIiwic2V2ZXJpdHkiLCJqb2luIiwiY2xlYW5UeXBlIiwib3ZlcnJpZGUiLCJtZXNzYWdlQ2xzIiwidHlwZSIsIm5nQ2xpY2siLCJjb3VudCIsImRvQW5pbWF0aW9uIiwiJHdhdGNoIiwibmV3VmFsdWUiLCJvbGRWYWx1ZSIsImNvbnNvbGUiLCJsb2ciLCJuZ01vZGVsIiwibmdDaGFuZ2VMYXp5IiwiY2hhbmdlTGF6eUJ1ZmZlciIsImxhc3RWYWx1ZSIsInRvU3RyaW5nIiwidmFsdWUiLCJ1bmRlZmluZWQiLCJvZmYiLCJvblJldHVyblByZXNzIiwia2V5Q29kZSIsInBvcHVwSWQiLCJwb3B1cEJlaGF2aW9yIiwiaG92ZXJhYmxlIiwicG9wdXAiLCJwb3B1cFNob3ciLCJzY3JvbGxUbyIsIlZpZXciLCJxc19kZWJ1ZyIsInBvaW50ZXIiLCIkcGFyZW50Iiwic2Nyb2xsVG9JdGVtIiwicGFyYW0iLCJ2aWV3IiwiREVGQVVMVCIsImFjdGl2ZUxpbmtJZCIsImlzU2Nyb2xsaW5nIiwiZnVuYyIsInBvcCIsInZpc2liaWxpdHkiLCJvbmNlIiwib2JzZXJ2ZUNoYW5nZXMiLCJvblRvcFZpc2libGUiLCJvblRvcFBhc3NlZFJldmVyc2UiLCJ0cmFuc2NsdWRlIiwic2hvdyIsInRvZ2dsZVBhbmUiLCJleHRlbmQiLCJ0b2dnbGVBY2NvcmRpb24iLCJjb250ZXh0IiwicmVzaXplVGltZXIiLCJSZXNpemVTdGlja3kiLCJhIiwiZmluZCIsInN0eWxlIiwiaGVpZ2h0IiwiY2xpZW50SGVpZ2h0IiwiaW5uZXJIZWlnaHQiXSwibWFwcGluZ3MiOiJBQUFBQSxRQUFRQyxPQUFPLFlBQVlDLFVB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cyIsInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdFTUxNYWtlcicpLmRpcmVjdGl2ZSgnYWNlRWRpdG9yJywgWyckdGltZW91dCcsIGZ1bmN0aW9uKCR0aW1lb3V0KXtcblxuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0OiBcIkFcIixcbiAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWwsIGF0dHIpe1xuICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKXtcblxuXG4gICAgICAgICAgdmFyIGVkaXRvciA9IGFjZS5lZGl0KGVsLmdldCgwKS5pZCk7XG5cbiAgICAgICAgICBlZGl0b3Iuc2V0VGhlbWUoXCJhY2UvdGhlbWUvZWNsaXBzZVwiKTtcbiAgICAgICAgICAvL2Rhd25cbiAgICAgICAgICAvL2VjbGlwc2VcbiAgICAgICAgICBlZGl0b3IuZ2V0U2Vzc2lvbigpLnNldFVzZVdyYXBNb2RlKHRydWUpO1xuICAgICAgICAgIGVkaXRvci5nZXRTZXNzaW9uKCkuc2V0TW9kZShcImFjZS9tb2RlL3htbFwiKTtcbiAgICAgICAgICB2YXIgdGltZXIgPSBudWxsO1xuICAgICAgICAgIGVkaXRvci5nZXRTZXNzaW9uKCkub24oJ2NoYW5nZScsIGZ1bmN0aW9uKGUpe1xuICAgICAgICAgICAgc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgIHNjb3BlLndvcmtzcGFjZS5zb3VyY2VDb2RlID0gZWRpdG9yLmdldFZhbHVlKCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgIH0pO1xuXG4gICAgICAgIHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbigpe1xuICAgICAgICAgIGVkaXRvci5kZXN0cm95KCk7XG4gICAgICAgIH0pO1xuXG5cblxuICAgIH0pO1xuICB9XG59XG5cblxufV0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ0VNTE1ha2VyJylcbi5kaXJlY3RpdmUoJ2Ryb3BFbmFibGUnLCBbJyR0aW1lb3V0JywgZnVuY3Rpb24oJHRpbWVvdXQpe1xuXHRyZXR1cm4ge1xuXHRcdHJlc3RyaWN0OiBcIkFcIixcblx0XHQvLyB0cmFuc2NsdWRlOiB0cnVlLFxuXHRcdHNjb3BlOiB7XG5cdFx0XHRvbmRyb3BmaWxlOlwiJlwiLFxuXHRcdFx0ZGF0YVRyYW5zZmVyRXZ0OlwiPVwiXG5cdFx0fSxcblx0XHRsaW5rOiBmdW5jdGlvbihzY29wZSwgZWwsIGF0dHIpe1xuXHRcdFx0dmFyIGZpbGVEcm9wcGVyID0gZWw7XG5cdFx0XHR2YXIgdGltZXIgPSBudWxsO1xuXHRcdFx0Ly9yZXNldFxuXHRcdFx0dmFyIGRyb3BwZXJSZXNldCA9IGZ1bmN0aW9uKGV2dCl7XG5cdFx0XHRcdGNsZWFyVGltZW91dCh0aW1lcik7XG5cdFx0XHRcdHRpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbigpe1xuXHRcdFx0XHRmaWxlRHJvcHBlci5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG5cdFx0XHRcdHNldFRpbWVvdXQoZnVuY3Rpb24oKXt3aW5kb3cualF1ZXJ5KCcudWkuc3RpY2t5Jykuc3RpY2t5KFwicmVmcmVzaFwiKTt9LDEwMCk7XG5cdFx0XHRcdGZpbGVEcm9wcGVyLmNzcyh7Ym9yZGVyOiBcIlwiLGNvbG9yOlwiXCIsIGJhY2tncm91bmQ6IFwiXCJ9KTtcblxuXHRcdFx0XHRcdC8vIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHR9LCAxMDApO1xuXHRcdFx0XHRldnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgXHRcdFx0ZXZ0LnByZXZlbnREZWZhdWx0KCk7XG5cblx0XHRcdFx0fTtcblxuXHRcdFx0XHR2YXIgY291bnRlciA9IDA7XG5cdFx0XHQkdGltZW91dChmdW5jdGlvbigpe1xuXG5cdFx0XHRmaWxlRHJvcHBlci5nZXQoMCkuYWRkRXZlbnRMaXN0ZW5lcignZHJvcCcsIGZ1bmN0aW9uKGV2dCl7XG5cdFx0XHRcdGlmKGxvY2F0aW9uLmhhc2ggIT09IFwiIy9tYWluXCIpIHJldHVybiBmYWxzZTtcblx0XHRcdFx0ZXZ0LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgIFx0XHRcdGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRcdGNvdW50ZXIrKztcblx0XHRcdFx0XHRkcm9wcGVyUmVzZXQoZXZ0KTtcblx0XHRcdFx0XHRpZihsb2NhdGlvbi5oYXNoID0gXCIjL21haW5cIil7XG5cdFx0XHRcdFx0XHRzY29wZS5vbmRyb3BmaWxlKHtcImV2dFwiOmV2dH0pO1xuXHRcdFx0XHRcdH1cblxuXG5cblx0XHRcdFx0fSwgZmFsc2UpO1xuXHRcdFx0ZmlsZURyb3BwZXIuZ2V0KDApLmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdlbmQnLCBkcm9wcGVyUmVzZXQsIGZhbHNlKTtcblx0XHRcdGZpbGVEcm9wcGVyLmdldCgwKS5hZGRFdmVudExpc3RlbmVyKCdkcmFnbGVhdmUnLCBkcm9wcGVyUmVzZXQsIGZhbHNlKTtcblx0XHRcdGZpbGVEcm9wcGVyLmdldCgwKS5hZGRFdmVudExpc3RlbmVyKCdkcmFnb3ZlcicsIGZ1bmN0aW9uKGV2dCl7XG5cblx0XHRcdFx0Ly8gZXZ0LnN0b3BQcm9wYWdhdGlvbigpO1xuXG5cdFx0XHRcdGNsZWFyVGltZW91dCh0aW1lcik7XG5cdFx0XHRcdGlmKGxvY2F0aW9uLmhhc2ggIT09IFwiIy9tYWluXCIpIHJldHVybiBmYWxzZTtcblx0XHRcdFx0ZXZ0LmRhdGFUcmFuc2Zlci5kcm9wRWZmZWN0ID0gJ2NvcHknO1xuXHRcdFx0XHRmaWxlRHJvcHBlci5hZGRDbGFzcyhcImFjdGl2ZVwiKTtcblx0XHRcdFx0ZmlsZURyb3BwZXIuY3NzKHtib3JkZXI6IFwic29saWQgM3B4IGJsdWVcIiwgY29sb3I6XCJibHVlXCIsIGJhY2tncm91bmQ6IFwibGlnaHRibHVlXCJ9KTtcblx0XHRcdFx0dGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG5cblx0XHRcdFx0XHQvLyBldnQucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0fSwgMTAwKTtcblxuXHRcdFx0XHRldnQucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0fSwgZmFsc2UpO1xuXG5cblx0XHRcdFx0fSk7XG5cblx0XHRcdH1cblx0XHR9O1xuXHR9XSk7XG4iLCJhbmd1bGFyLm1vZHVsZSgnRU1MTWFrZXInKS5kaXJlY3RpdmUoJ3VpRHJvcGRvd24nLCBbJyR0aW1lb3V0JywgZnVuY3Rpb24oJHRpbWVvdXQpe1xuXG4gIHJldHVybiB7XG4gICAgcmVzdHJpY3Q6IFwiQVwiLFxuICAgIHNjb3BlOiB7ZHJvcGRvd25BY3Rpb246IFwiQFwifSxcbiAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWwsIGF0dHIpe1xuICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgICAgdmFyIGF0dHIgPSB7IGFjdGlvbjogXCJoaWRlXCJ9O1xuICAgICAgICBpZihzY29wZS5kcm9wZG93bkFjdGlvbikgYXR0ci5hY3Rpb24gPSBzY29wZS5kcm9wZG93bkFjdGlvbjtcbiAgICAgICAgJChlbCkuZHJvcGRvd24oYXR0cik7XG4gICAgICB9KTtcbiAgICAgIHNjb3BlLiRvbignJGRlc3Ryb3knLGZ1bmN0aW9uKCl7XG4gICAgICAgICQoZWwpLmRyb3Bkb3duKFwiZGVzdHJveVwiKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcblxuXG59XSk7XG4iLCJhbmd1bGFyLm1vZHVsZSgnRU1MTWFrZXInKVxuLmRpcmVjdGl2ZSgnZ2FFdmVudCcsIFsnJHRpbWVvdXQnLCBmdW5jdGlvbigkdGltZW91dCl7XG5cdHJldHVybiB7XG5cdFx0cmVzdHJpY3Q6IFwiQVwiLFxuXHRcdHNjb3BlOiB7XG5cdFx0XHRnYUV2ZW50OlwiQFwiXG5cdFx0fSxcblx0XHRsaW5rOiBmdW5jdGlvbihzY29wZSwgZWwsIGF0dHIpe1xuXG5cdFx0XHQkdGltZW91dChmdW5jdGlvbigpe1xuXHRcdFx0XHR2YXIgcmVwb3J0RXZlbnQgPSBmdW5jdGlvbigpe1xuXHRcdFx0XHRcdHZhciBhcmdzID0gW1wic2VuZFwiLFwiZXZlbnRcIl0sIG5ld0FyZ3MgPSBzY29wZS5nYUV2ZW50LnNwbGl0KC9cXCx8XFx8Lyk7XG5cdFx0XHRcdFx0Zm9yKHZhciBpID0wOyBpPG5ld0FyZ3MubGVuZ3RoO2krKyl7XG5cdFx0XHRcdFx0XHRhcmdzLnB1c2gobmV3QXJnc1tpXSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHdpbmRvdy5nYS5hcHBseShudWxsLCBhcmdzKTtcblx0XHRcdFx0fTtcblx0XHRcdFx0ZWwub24oJ2NsaWNrJywgcmVwb3J0RXZlbnQpO1xuXHRcdFx0XHR9KTtcblxuXHRcdFx0c2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uKCl7XG5cdFx0XHRcdGVsLm9uKCdvZmYnLHJlcG9ydEV2ZW50KTtcblx0XHRcdH0pO1xuXG5cdFx0XHR9XG5cdFx0fTtcblx0fV0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ0VNTE1ha2VyJylcbi5kaXJlY3RpdmUoJ2h0bWxWaWV3ZXInLCBbJyR0aW1lb3V0JywgZnVuY3Rpb24oJHRpbWVvdXQpe1xuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0OiBcIkVcIixcbiAgICB0ZW1wbGF0ZTogJzxkaXY+PG9sIHN0YXJ0PVwie3tpdGVtLmxpbmV9fVwiPjxsaSBuZy1yZXBlYXQ9XCJsbiBpbiBjb2RlKGl0ZW0pIHRyYWNrIGJ5ICRpbmRleFwiIG5nLWJpbmQtaHRtbD1cImxuXCI+PC9saT48L29sPjwvZGl2PicsXG4gICAgc2NvcGU6IHtpdGVtOiBcIj1cIn0sXG4gICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsLCBhdHRyKXtcbiAgICAgIHNjb3BlLmNvZGUgPSBmdW5jdGlvbihjKXtcbiAgICAgICAgdmFyIGIgPSAoYy5kaXNwbGF5Rm9ybWF0dGVkVVJMKCkpLnNwbGl0KC9cXDxiclxcPnxcXG4vZyk7XG4gICAgICAgIHJldHVybiBiO1xuICAgICAgfTtcbiAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCl7XG5cblxuICAgIH0pO1xuICB9XG59O1xuXG5cbn1dKTtcbiIsImFuZ3VsYXIubW9kdWxlKCdFTUxNYWtlcicpXG4uZGlyZWN0aXZlKCdtZXNzYWdlQ2VudGVyJywgWyckdGltZW91dCcsIGZ1bmN0aW9uKCR0aW1lb3V0KXtcbiAgcmV0dXJuIHtcbiAgICByZXN0cmljdDogXCJFXCIsXG4gICAgdGVtcGxhdGU6ICc8ZGl2IGNsYXNzPVwibWVzc2FnZS1jZW50ZXJcIj48ZGl2IGNsYXNzPVwidWkgdGlueSBzZWNvbmRhcnkgbWVudVwiPlxcXG4gICAgPGRpdiBjbGFzcz1cIml0ZW0gbW51LXRpdGxlXCIgc3R5bGU9XCJwYWRkaW5nLWxlZnQ6MDtcIj57e2hlYWRpbmcgPT09IHVuZGVmaW5lZCA/IFwiTUVTU0FHRVM6XCIgOiBoZWFkaW5nIH19PC9kaXY+XFxcbiAgICA8YSBjbGFzcz1cIml0ZW1cIiBuZy1jbGljaz1cIkludGVsbGlnZW5jZUNlbnRlci5zZXRUeXBlKFxcJ1xcJylcIiBuZy1jbGFzcz1cInthY3RpdmU6IEludGVsbGlnZW5jZUNlbnRlci5zZWFyY2gudHlwZT09XFwnXFwnfVwiIG5nLXNob3c9XCJJbnRlbGxpZ2VuY2VDZW50ZXIuY2FuVmlld0FsbCgpXCI+QWxsIDxzcGFuIGNsYXNzPVwidWkgdGlueSBsYWJlbFwiPnt7ZXJyb3JzLm1lc3NhZ2VzLmxlbmd0aH19PC9zcGFuPjwvYT5cXFxuICAgIDxhIGNsYXNzPVwiaXRlbVwiIG5nLXJlcGVhdD1cIih0YWIsdmFsKSBpbiBlcnJvcnMudGFicyB0cmFjayBieSAkaW5kZXhcIiBuZy1zaG93PVwiZXJyb3JzLmNvdW50W3RhYl1cIiBuZy1jbGljaz1cIkludGVsbGlnZW5jZUNlbnRlci5zZXRUeXBlKHZhbClcIiBuZy1jbGFzcz1cInthY3RpdmU6IEludGVsbGlnZW5jZUNlbnRlci5zZWFyY2gudHlwZT09dmFsfVwiPnt7dGFiIHwgdW5jYW1lbGl6ZX19IDxzcGFuIGNsYXNzPVwidWkgdGlueSBsYWJlbFwiPnt7ZXJyb3JzLmNvdW50W3RhYl19fTwvc3Bhbj48L2E+XFxcbiAgICA8L2Rpdj5cXFxuICAgIDxkaXYgaWQ9XCJlcnJvci1tZXNzYWdlcy1saXN0XCIgY2xhc3M9XCJ1aSBtaWRkbGUgYWxpZ25lZCBkaXZpZGVkIGxpc3RcIj5cXFxuICAgICAgPG1lc3NhZ2UtaXRlbSBpdGVtPVwiaXRlbVwiIGNsYXNzPVwiaXRlbVwiIG5nLXJlcGVhdD1cIm9iaiBpbiBlcnJvcnMubWVzc2FnZXMgfCBmaWx0ZXI6IEludGVsbGlnZW5jZUNlbnRlci5zZWFyY2hcIiBlcnJvcj1cIm9ialwiPjwvbWVzc2FnZS1pdGVtPlxcXG4gICAgICA8L2Rpdj5cXFxuICAgICAgPGRpdiBhbGlnbj1cImNlbnRlclwiIHN0eWxlPVwibWFyZ2luLXRvcDogLTEuNWVtOyBwYWRkaW5nLWJvdHRvbTogMS41ZW07XCIgbmctc2hvdz1cIkludGVsbGlnZW5jZUNlbnRlci5zZWFyY2gudHlwZSE9PVxcJ1xcJyAmJiBJbnRlbGxpZ2VuY2VDZW50ZXIuY2FuVmlld0FsbCgpXCI+XFxcbiAgICAgIDxidXR0b24gY2xhc3M9XCJ1aSB0aW55IGJhc2ljIGJ1dHRvblwiIG5nLWNsaWNrPVwiSW50ZWxsaWdlbmNlQ2VudGVyLnNldFR5cGUoXFwnXFwnKVwiPjxpIGNsYXNzPVwibWludXMgc3F1YXJlIGljb25cIj48L2k+IFJlbW92ZSBmaWx0ZXI8L2J1dHRvbj48L2Rpdj5cXFxuICAgIDwvZGl2PicsXG4gICAgc2NvcGU6IHtcbiAgICAgIGVycm9yczpcIj1cIixcbiAgICAgIGhlYWRpbmc6XCJAXCIsXG4gICAgICBpdGVtOlwiPVwiXG4gICAgfSxcbiAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWwsIGF0dHIpe1xuICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKXtcblxuICAgICAgICBzY29wZS5JbnRlbGxpZ2VuY2VDZW50ZXIgPSBuZXcgRU1MTWFrZXJJbnRlbGxpZ2VuY2UuSW50ZWxsaWdlbmNlQ2VudGVyKHNjb3BlLmVycm9ycywgc2NvcGUpO1xuXG4gICAgICAgIHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbigpe1xuICAgICAgICAgIC8vIGpRdWVyeShlbCkucG9wdXAoXCJkZXN0cm95XCIpO1xuICAgICAgICB9KTtcbiAgICB9KTtcbiAgfVxufTtcblxuXG59XSk7XG4iLCJhbmd1bGFyLm1vZHVsZSgnRU1MTWFrZXInKVxuLmRpcmVjdGl2ZSgnbWVzc2FnZUl0ZW0nLCBbJyR0aW1lb3V0JywgZnVuY3Rpb24oJHRpbWVvdXQpe1xuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0OiBcIkVcIixcbiAgICB0ZW1wbGF0ZTogJzxkaXYgbmctY2xhc3M9XCJtZXNzYWdlQ2xzXCIgY2xhc3M9XCJpbnRlbC1tc2dcIj5cXFxuICAgIDxkaXYgY2xhc3M9XCJyaWdodCBmbG9hdGVkIGNvbnRlbnRcIiBuZy1pZj1cImVycm9yLmN0YUxhYmVsIT09XFwnXFwnXCIgPlxcXG4gICAgPGRpdiBjbGFzcz1cInVpIHNtYWxsIGNvbXBhY3RcIiBcXFxuICAgIG5nLWNsYXNzPVwiYnV0dG9uQ2xzXCIgbmctaWY9XCJidXR0b25DbHNcIiBcXFxuICAgIFxcIG5nLWNsaWNrPVwiZXJyb3IuY3RhSGFuZGxlcihpdGVtKVwiIFxcXG4gICAgIG5nLWJpbmQtaHRtbD1cImVycm9yLmN0YUxhYmVsXCI+e3tlcnJvci5jdGFMYWJlbCA/IGVycm9yLmN0YUxhYmVsIDogXCJSZXNvbHZlXCJ9fTwvZGl2PlxcXG4gICAgPC9kaXY+XFxcbiAgICA8ZGl2IGNsYXNzPVwicmlnaHQgZmxvYXRlZCBjb250ZW50XCIgbmctaWY9XCJlcnJvci5jbGVhblR5cGU9PVxcJ1FBXFwnXCIgPlxcXG4gICAgPHNwYW4gY2xhc3M9XCJ1aSBpY29uIGxhYmVsXCIgbmctc2hvdz1cImVycm9yLmNsZWFuVHlwZT09XFwnUUFcXCcmJmVycm9yLm92ZXJyaWRlXCI+PGkgY2xhc3M9XCJ0aHVtYnMgdXAgaWNvblwiPjwvaT4gWU9VIENPTkZJUk1FRDwvc3Bhbj5cXFxuICAgIDxkaXYgY2xhc3M9XCJ1aSBzbWFsbCBjb21wYWN0XCIgXFxcbiAgICBuZy1jbGFzcz1cImJ1dHRvbkNsc1wiIG5nLWlmPVwiYnV0dG9uQ2xzXCIgbmctaGlkZT1cImVycm9yLm92ZXJyaWRlXCIgXFxcbiAgICBcXCBuZy1jbGljaz1cImVycm9yLnNldE92ZXJyaWRlU3RhdHVzKHRydWUpO2Vycm9yLmN0YUhhbmRsZXIoKVwiPjxpIGNsYXNzPVwiY2hlY2sgaWNvblwiPjwvaT4gQ29uZmlybTwvZGl2PlxcXG4gICAgPC9kaXY+XFxcbiAgICAgIDxkaXYgY2xhc3M9XCJjb250ZW50XCIgbmctc2hvdz1cImJ1dHRvbkNsc1wiPiBcXFxuICAgICAgICA8aDQgbmctYmluZC1odG1sPVwiZXJyb3IudGl0bGUgfCBkZXdpZG93XCI+PC9oND5cXFxuICAgICAgICA8ZGl2IG5nLWJpbmQtaHRtbD1cImVycm9yLmRlc2NyaXB0aW9uXCI+PC9kaXY+PC9kaXY+XFxcbiAgICAgICAgPGRpdiBuZy1pZj1cImVycm9yLnN1Z2dlc3Rpb24ubGVuZ3RoPjBcIiBuZy1oaWRlPVwiZXJyb3Iub3ZlcnJpZGVcIiBjbGFzcz1cInN1Z2dlc3Rpb25cIj5TVUdHRVNUSU9OOiA8ZGl2IG5nLWJpbmQtaHRtbD1cImVycm9yLnN1Z2dlc3Rpb25cIj48L2Rpdj48L2Rpdj5cXFxuICAgICAgICA8ZGl2IG5nLWlmPVwiZXJyb3IucmVzb3VyY2UhPT1cXCdcXCdcIj48YSBuZy1ocmVmPVwie3tlcnJvci5yZXNvdXJjZX19XCIgdGFyZ2V0PVwiX2JsYW5rXCI+e3tlcnJvci5yZXNvdXJjZVRleHR9fSA8aSBjbGFzcz1cImV4dGVybmFsIGFsdGVybmF0ZSBpY29uXCI+PC9pPjwvYT48L2Rpdj5cXFxuICAgIDwvZGl2PicsXG4gICAgc2NvcGU6IHtlcnJvcjogXCI9XCIsIGl0ZW06XCI9XCJ9LFxuICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbCwgYXR0cil7XG4gICAgICAkdGltZW91dChmdW5jdGlvbigpe1xuICAgICAgICB2YXIgY2xzID0gW1wiXCIsIFwicmVkXCIsIFwib3JhbmdlXCIsIFwidmlvbGV0XCIsIFwidGVhbFwiLCBcImJsdWVcIl07XG5cblxuICAgICAgICAvLyBlbnVtIEVycm9yVHlwZSB7XG4gICAgICAgIC8vICAgRml4PTEsXG4gICAgICAgIC8vICAgV2FybixcbiAgICAgICAgLy8gICBTdWdnZXN0aW9uLFxuICAgICAgICAvLyAgIFFBLFxuICAgICAgICAvLyAgIEJlc3RQcmFjdGljZVxuICAgICAgICAvLyB9XG5cblxuICAgICAgICAvLyBcIlwiLFxuICAgICAgICAvLyBcInJlZFwiLFxuICAgICAgICAvLyBcIm9yYW5nZVwiLFxuICAgICAgICAvLyBcInZpb2xldFwiLFxuICAgICAgICAvLyBcInllbGxvd1wiLFxuICAgICAgICAvLyBcIlwiXG5cbiAgICAgICAgc2NvcGUuYnV0dG9uQ2xzID0gW2Nsc1tzY29wZS5lcnJvci5zZXZlcml0eV0sXCJidXR0b25cIl0uam9pbihcIiBcIik7XG4gICAgICAgIGlmKHNjb3BlLmVycm9yLmNsZWFuVHlwZT09XCJRQVwiICYmIHNjb3BlLmVycm9yLm92ZXJyaWRlKSB7XG4gICAgICAgICAgc2NvcGUubWVzc2FnZUNscyA9IFwiXCI7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgc2NvcGUubWVzc2FnZUNscyA9IFtcInR5cGUtXCIsc2NvcGUuZXJyb3IudHlwZSxcIiBsZXZlbC1cIixzY29wZS5lcnJvci5zZXZlcml0eV0uam9pbihcIlwiKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbigpe1xuICAgICAgICAgIC8vIGpRdWVyeShlbCkucG9wdXAoXCJkZXN0cm95XCIpO1xuICAgICAgICB9KTtcbiAgICB9KTtcbiAgfVxufTtcblxuXG59XSk7XG4iLCJhbmd1bGFyLm1vZHVsZSgnRU1MTWFrZXInKVxuLmRpcmVjdGl2ZSgnbWVzc2FnZXNOb3RpZnknLCBbJyR0aW1lb3V0JywgZnVuY3Rpb24oJHRpbWVvdXQpe1xuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0OiBcIkVcIixcbiAgICB0ZW1wbGF0ZTogJzxkaXYgY2xhc3M9XCJ1aSBmbHVpZCBsYWJlbGVkIGJ1dHRvblwiIG5nLWNsaWNrPVwibmdDbGljaygpXCIgbmctY2xhc3M9XCJ7XFwnYW5pbWF0ZS10YWRhXFwnOiBkb0FuaW1hdGlvbn1cIj5cXFxuICAgICAgPGRpdiBjbGFzcz1cInVpIGZsdWlkIGJ1dHRvblwiIG5nLWNsYXNzPVwie1xcJ3llbGxvd1xcJzpkb0FuaW1hdGlvbiwgXFwncmVkXFwnOiAhd29ya3NwYWNlLmludGVsbGlnZW5jZS5jYW5Db250aW51ZX1cIj5cXFxuICAgICAgICA8aSBjbGFzcz1cIndhcm5pbmcgaWNvblwiIGFsdD1cIlshXVwiIG5nLXNob3c9XCIhd29ya3NwYWNlLmludGVsbGlnZW5jZS5jYW5Db250aW51ZVwiPjwvaT5cXFxuICAgICAgICA8aSBjbGFzcz1cImluZm8gaWNvblwiIGFsdD1cIihpKVwiIG5nLXNob3c9XCJ3b3Jrc3BhY2UuaW50ZWxsaWdlbmNlLmNhbkNvbnRpbnVlXCI+PC9pPlxcXG4gICAgICAgIHt7IGNvdW50PjEgPyBcIk1lc3NhZ2VzXCIgOiBcIk1lc3NhZ2VcIn19XFxcbiAgICAgICAgPC9kaXY+XFxcbiAgICAgIDxkaXYgY2xhc3M9XCJ1aSBsYWJlbFwiIG5nLWNsYXNzPVwie1xcJ3llbGxvd1xcJzpkb0FuaW1hdGlvbiwgXFwncmVkXFwnOiAhd29ya3NwYWNlLmludGVsbGlnZW5jZS5jYW5Db250aW51ZX1cIj5cXFxuICAgICAgICB7e2NvdW50fX1cXFxuICAgICAgICA8L2Rpdj5cXFxuICAgICAgPC9kaXY+XFxcbiAgICAgIDwvZGl2PicsXG4gICAgc2NvcGU6IHtcbiAgICAgIHdvcmtzcGFjZTogXCI9XCIsXG4gICAgICBuZ0NsaWNrOiBcIiZcIixcbiAgICAgIGNvdW50OiBcIj1cIlxuICAgIH0sXG4gICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsLCBhdHRyKXtcbiAgICAgIHNjb3BlLmRvQW5pbWF0aW9uID0gdHJ1ZTtcbiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgICAgc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgc2NvcGUuZG9BbmltYXRpb24gPSBmYWxzZTtcbiAgICAgICAgfSk7XG4gICAgICB9LCAxNTAwKTtcbiAgICAgIHNjb3BlLiR3YXRjaChcImNvdW50XCIsIGZ1bmN0aW9uKG5ld1ZhbHVlLCBvbGRWYWx1ZSwgc2NvcGUpe1xuICAgICAgICBpZihuZXdWYWx1ZSA+IG9sZFZhbHVlKSB7XG5cbiAgICAgICAgICAgIHNjb3BlLmRvQW5pbWF0aW9uID0gdHJ1ZTtcblxuICAgICAgICAgIGNvbnNvbGUubG9nKFwiVVBEQVRFRFwiKTtcbiAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICBzY29wZS4kYXBwbHkoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgc2NvcGUuZG9BbmltYXRpb24gPSBmYWxzZTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgfSwxNTAwKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICAkdGltZW91dChmdW5jdGlvbigpe1xuICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICBzY29wZS5kb0FuaW1hdGlvbiA9IGZhbHNlO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9LCAyMDAwKTtcblxuICAgICAgICBzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24oKXtcbiAgICAgICAgICAvLyBqUXVlcnkoZWwpLnBvcHVwKFwiZGVzdHJveVwiKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG4gIH1cbn07XG5cblxufV0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ0VNTE1ha2VyJylcbi5kaXJlY3RpdmUoJ25nQ2hhbmdlTGF6eScsIFsnJHRpbWVvdXQnLCBmdW5jdGlvbigkdGltZW91dCl7XG5cdHJldHVybiB7XG5cdFx0cmVzdHJpY3Q6IFwiQVwiLFxuXHRcdC8vIHRyYW5zY2x1ZGU6IHRydWUsXG5cdFx0c2NvcGU6IHtcblx0XHRcdG5nTW9kZWw6XCI9XCIsXG5cdFx0XHRuZ0NoYW5nZUxhenk6XCImXCIsXG5cdFx0XHRjaGFuZ2VMYXp5QnVmZmVyOlwiPVwiLFxuXHRcdFx0ZGF0YVRyYW5zZmVyRXZ0OlwiPVwiXG5cdFx0fSxcblx0XHRsaW5rOiBmdW5jdGlvbihzY29wZSwgZWwsIGF0dHIpe1xuXHRcdFx0dmFyIHRpbWVyID0gbnVsbDtcblx0XHRcdCR0aW1lb3V0KGZ1bmN0aW9uKCl7XG5cdFx0XHRcdHZhciBsYXN0VmFsdWUgPSBzY29wZS5uZ01vZGVsLnRvU3RyaW5nKCk7XG5cdFx0XHRcdGVsLm9uKCdrZXl1cCcsIGZ1bmN0aW9uKGUpe1xuXHRcdFx0XHRcdGNsZWFyVGltZW91dCh0aW1lcik7XG5cdFx0XHRcdFx0dGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG5cdFx0XHRcdFx0XHRpZihsYXN0VmFsdWUgIT09IGVsWzBdLnZhbHVlKXtcblx0XHRcdFx0XHRcdHNjb3BlLiRhcHBseShmdW5jdGlvbigpe1xuXHRcdFx0XHRcdFx0XHRcdHNjb3BlLm5nQ2hhbmdlTGF6eSgpO1xuXHRcdFx0XHRcdFx0XHRcdGxhc3RWYWx1ZSA9IGVsWzBdLnZhbHVlO1xuXHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSwgYXR0ci5jaGFuZ2VMYXp5QnVmZmVyPT09IHVuZGVmaW5lZCA/IDUwMCA6IGF0dHIuY2hhbmdlTGF6eUJ1ZmZlcioxKTtcblx0XHRcdFx0fSk7XG5cdFx0XHRcdHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbigpe1xuXHRcdFx0XHRcdGVsLm9mZigna2V5dXAnKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcblxuXHRcdFx0fVxuXHRcdH07XG5cdH1dKTtcbiIsImFuZ3VsYXIubW9kdWxlKCdFTUxNYWtlcicpXG4uZGlyZWN0aXZlKCdvblJldHVyblByZXNzJywgWyckdGltZW91dCcsIGZ1bmN0aW9uKCR0aW1lb3V0KXtcblx0cmV0dXJuIHtcblx0XHRyZXN0cmljdDogXCJBXCIsXG5cdFx0c2NvcGU6IHtcblx0XHRcdG9uUmV0dXJuUHJlc3M6XCImXCIsXG5cdFx0XHRkYXRhVHJhbnNmZXJFdnQ6XCI9XCJcblx0XHR9LFxuXHRcdGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbCwgYXR0cil7XG5cblx0XHRcdCR0aW1lb3V0KGZ1bmN0aW9uKCl7XG5cdFx0XHRcdGVsLm9uKCdrZXlwcmVzcycsIGZ1bmN0aW9uKGUpe1xuXHRcdFx0XHRcdGlmKGUua2V5Q29kZT09MTMpe1xuXHRcdFx0XHRcdFx0c2NvcGUub25SZXR1cm5QcmVzcygpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cblx0XHRcdFx0c2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uKCl7XG5cdFx0XHRcdFx0ZWwub2ZmKCdrZXlwcmVzcycpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXG5cdFx0XHR9XG5cdFx0fTtcblx0fV0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ0VNTE1ha2VyJykuZGlyZWN0aXZlKCd1aVBvcHVwJywgWyckdGltZW91dCcsIGZ1bmN0aW9uKCR0aW1lb3V0KXtcblxuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0OiBcIkFcIixcbiAgICBzY29wZToge3BvcHVwSWQ6XCJAXCIscG9wdXBCZWhhdmlvcjpcIkBcIn0sXG4gICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsLCBhdHRyKXtcbiAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICAgIHZhciBhcmdzID0ge1xuICAgICAgICAgIGhvdmVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICBwb3B1cDogXCIjXCIgKyBhdHRyLnBvcHVwSWRcbiAgICAgICAgfTtcbiAgICAgICAgKGZ1bmN0aW9uKCQsIHNjb3BlLCBhdHRyKXtcbiAgICAgICAgICBpZihhdHRyLnBvcHVwQmVoYXZpb3IgIT09IHVuZGVmaW5lZCApIGFyZ3Mub24gPSBcImNsaWNrXCI7XG4gICAgICAgICAgaWYoYXR0ci5wb3B1cElkICE9PSB1bmRlZmluZWQgKSBhcmdzLnBvcHVwID0gXCIjXCIgKyBhdHRyLnBvcHVwSWQ7XG4gICAgICAgICAgJChlbCkucG9wdXAoYXJncyk7XG4gICAgICAgICAgaWYoYXR0ci5wb3B1cFNob3cgIT09IHVuZGVmaW5lZCApICQoZWwpLnBvcHVwKFwic2hvd1wiKTtcbiAgICAgICAgICBzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICQoZWwpLnBvcHVwKFwiZGVzdHJveVwiKTtcbiAgICAgICAgICB9KTtcblxuICAgICAgICB9KShqUXVlcnksIHNjb3BlLCBhdHRyKVxuXG4gICAgfSk7XG4gIH1cbn07XG5cblxufV0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ0VNTE1ha2VyJylcbi5kaXJlY3RpdmUoJ3F1ZXJ5U3RyaW5nRWRpdG9yJywgWyckdGltZW91dCcsIGZ1bmN0aW9uKCR0aW1lb3V0KXtcbiAgcmV0dXJuIHtcbiAgICByZXN0cmljdDogXCJFXCIsXG4gICAgdGVtcGxhdGU6ICc8ZGl2IGNsYXNzPVwicXVlcnktc3RyaW5nLWVkaXRvciB3ZWxsLWNvbXBvbmVudFwiIG5nLWhpZGU9XCJpdGVtLmlzTGlua1R5cGUoXFwnbWFpbHRvXFwnKVwiPjxkaXYgc3R5bGU9XCJvdmVyZmxvdzpoaWRkZW47cGFkZGluZy1ib3R0b206LjVlbTtcIj48c3Ryb25nPlFVRVJZIFNUUklORyBFRElUT1I8L3N0cm9uZz5cXFxuICAgIDxkaXYgY2xhc3M9XCJ1aSB0aW55IGJhc2ljIGJ1dHRvbnNcIiBzdHlsZT1cImZsb2F0OnJpZ2h0O1wiPlxcXG4gIDxidXR0b24gY2xhc3M9XCJ1aSBpY29uIGJ1dHRvblwiIG5nLWNsaWNrPVwiaXRlbS5uZXcuc2VhcmNoUGFyYW1zLmRlbGV0ZUFsbCgpO2l0ZW0uaXNMaW5rQ29tcGxldGUoKTtzY3JvbGxUb0l0ZW0oaXRlbS5pZCk7XCI+UmVtb3ZlIGFsbDwvYnV0dG9uPlxcXG4gIDxidXR0b24gY2xhc3M9XCJ1aSBpY29uIGJ1dHRvblwiIG5nLWNsaWNrPVwidmlldyA9PSAxID8gdmlldz0wIDogdmlldz0xXCI+e3t2aWV3PT0xPyBcIkNsb3NlXCIgOiBcIkVkaXRcIn19PC9idXR0b24+XFxcbjwvZGl2PjwvZGl2PlxcXG4gICAgIDxkaXYgbmctaWY9XCJpdGVtLm5ldy5zZWFyY2hQYXJhbXMuX2VudHJpZXMubGVuZ3RoPT0xJiZpdGVtLm5ldy5zZWFyY2hQYXJhbXMuX2VudHJpZXNbMF0ubGVuZ3RoPT0wXCI+UXVlcnkgc3RyaW5ncyB3aWxsIGFwcGVhciBoZXJlLjwvZGl2PlxcXG4gICAgICA8ZGl2IG5nLXNob3c9XCJ2aWV3PT0xXCI+XFxcbiAgICAgIDxkaXYgc3R5bGU9XCJtYXJnaW4tYm90dG9tOi41ZW07XCIgY2xhc3M9XCJ1aSBhY3Rpb24gaW5wdXRcIiBuZy1pZj1cInN0ci5sZW5ndGg+MFwiIG5nLXJlcGVhdD1cInN0ciBpbiBpdGVtLm5ldy5zZWFyY2hQYXJhbXMuZW50cmllcyB0cmFjayBieSAkaW5kZXhcIj5cXFxuICAgICAgPGlucHV0IHR5cGU9XCJ0ZXh0XCIgbmcta2V5dXA9XCJpdGVtLm5ldy5zZWFyY2hQYXJhbXMudXBkYXRlU2VhcmNoUHJvcCgpO2l0ZW0uaXNMaW5rQ29tcGxldGUoKVwiIG5nLW1vZGVsPVwiaXRlbS5uZXcuc2VhcmNoUGFyYW1zLl9lbnRyaWVzWyRpbmRleF1cIi8+XFxcbiAgICAgIDxidXR0b24gY2xhc3M9XCJ1aSBpY29uIGJ1dHRvblwiIG5nLWNsaWNrPVwiaXRlbS5uZXcuc2VhcmNoUGFyYW1zLmRlbGV0ZUF0SW5kZXgoJGluZGV4KVwiPlxcXG4gICAgICBSZW1vdmU8L2J1dHRvbj48L2Rpdj5cXFxuICAgICAgPC9kaXY+XFxcbiAgICAgIDxkaXYgbmctc2hvdz1cInZpZXc9PTBcIj5cXFxuICAgICAgPHVsIGNsYXNzPVwidGFncy1sYXlvdXRcIj5cXFxuICAgICAgIDxsaSBuZy1pZj1cInN0ci5sZW5ndGg+MFwiIG5nLXJlcGVhdD1cInN0ciBpbiBpdGVtLm5ldy5zZWFyY2hQYXJhbXMuZW50cmllcyB0cmFjayBieSAkaW5kZXhcIj5cXFxuICAgICAgIHt7c3RyfX0gPGEgaHJlZj1cImphdmFzY3JpcHQ6YW5ndWxhci5ub29wKClcIiBuZy1jbGljaz1cIml0ZW0ubmV3LnNlYXJjaFBhcmFtcy5kZWxldGVBdEluZGV4KCRpbmRleCk7aXRlbS5pc0xpbmtDb21wbGV0ZSgpXCI+XFxcbiAgICAgICA8aSBjbGFzcz1cImNsb3NlIGljb25cIiBhbHQ9XCJbWF1cIj48L2k+PC9hPjwvbGk+PC91bD5cXFxuICAgICAgIDwvZGl2PlxcXG4gICAgICA8L2Rpdj4nLFxuICAgIHNjb3BlOiB7aXRlbTpcIj1cIiwgc2Nyb2xsVG86XCImXCJ9LFxuICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbCwgYXR0cil7XG4gICAgICAkdGltZW91dChmdW5jdGlvbigpe1xuICAgICAgICB2YXIgVmlldyA9IChmdW5jdGlvbihWaWV3KXtcbiAgICAgICAgICBWaWV3W1ZpZXdbXCJERUZBVUxUXCJdPTBdID0gXCJERUZBVUxUXCI7XG4gICAgICAgICAgVmlld1tWaWV3W1wiRURJVFwiXT0xXSA9IFwiRURJVFwiO1xuICAgICAgICAgIHJldHVybiBWaWV3O1xuICAgICAgICB9KSh7fSk7XG4gICAgICAgIHdpbmRvdy5xc19kZWJ1ZyA9IHNjb3BlO1xuICAgICAgICB2YXIgcG9pbnRlciA9IHNjb3BlO1xuICAgICAgICBkbyB7XG4gICAgICAgICAgcG9pbnRlciA9IHBvaW50ZXIuJHBhcmVudDtcbiAgICAgICAgfSB3aGlsZSAocG9pbnRlci5zY3JvbGxUbyA9PT0gdW5kZWZpbmVkKTtcblxuICAgICAgICBzY29wZS5zY3JvbGxUb0l0ZW0gPSBmdW5jdGlvbihwYXJhbSl7XG4gICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xuICAgICAgICAgICAgc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgIHBvaW50ZXIuc2Nyb2xsVG8ocGFyYW0tMSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9LDUwKTtcblxuXG4gICAgICAgIH1cbiAgICAgICAgc2NvcGUudmlldyA9IFZpZXcuREVGQVVMVDtcbiAgICAgICAgc2NvcGUuJG9uKCckZGVzdHJveScsIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgLy8galF1ZXJ5KGVsKS5wb3B1cChcImRlc3Ryb3lcIik7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuICB9XG59O1xuXG5cbn1dKTtcbiIsImFuZ3VsYXIubW9kdWxlKCdFTUxNYWtlcicpLmRpcmVjdGl2ZSgnc2Nyb2xsc3B5JywgWyckdGltZW91dCcsIGZ1bmN0aW9uKCR0aW1lb3V0KXtcblxuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0OiBcIkFcIixcbiAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWwsIGF0dHIpe1xuICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgICAgaWYoc2NvcGUuYWN0aXZlTGlua0lkID09PSB1bmRlZmluZWQpIHNjb3BlLmFjdGl2ZUxpbmtJZCA9IDE7XG4gICAgICAgIGlmKHNjb3BlLmlzU2Nyb2xsaW5nID09PSB1bmRlZmluZWQpIHNjb3BlLmlzU2Nyb2xsaW5nID0gZmFsc2U7XG5cblxuICAgICAgICB2YXIgZnVuYyA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgaWYoc2NvcGUuaXNTY3JvbGxpbmcgJiYgc2NvcGUuaXNTY3JvbGxpbmcgPT0xKSByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgdmFyIGlkID0galF1ZXJ5KGVsKS5hdHRyKFwiaWRcIikuc3BsaXQoXCItXCIpLnBvcCgpO1xuICAgICAgICAgIHNjb3BlLiRhcHBseShmdW5jdGlvbigpe1xuICAgICAgICAgICAgc2NvcGUuYWN0aXZlTGlua0lkID1pZCoxO1xuICAgICAgICAgIH0pO1xuXG4gICAgICAgIH07XG4gICAgICAgIGpRdWVyeShlbCkudmlzaWJpbGl0eSh7XG4gICAgICAgICAgICBvbmNlOiBmYWxzZSxcbiAgICAgICAgICAgIC8vIHVwZGF0ZSBzaXplIHdoZW4gbmV3IGNvbnRlbnQgbG9hZHNcbiAgICAgICAgICAgIG9ic2VydmVDaGFuZ2VzOiB0cnVlLFxuICAgICAgICAgICAgLy8gbG9hZCBjb250ZW50IG9uIGJvdHRvbSBlZGdlIHZpc2libGVcbiAgICAgICAgICAgIG9uVG9wVmlzaWJsZTogZnVuYyxcbiAgICAgICAgICAgIG9uVG9wUGFzc2VkUmV2ZXJzZTogZnVuY1xuXG5cbiAgICAgICAgICB9KTtcblxuXG5cblxuXG4gICAgICAgIHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbigpe1xuICAgICAgICAgIC8vJChlbCkucG9wdXAoXCJkZXN0cm95XCIpO1xuICAgICAgICAgIGpRdWVyeShlbCkudmlzaWJpbGl0eShcImRlc3Ryb3lcIik7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuICB9XG59O1xuXG5cbn1dKTtcbiIsImFuZ3VsYXIubW9kdWxlKCdFTUxNYWtlcicpXG4uZGlyZWN0aXZlKCdzaW1wbGVBY2NvcmRpb24nLCBbJyR0aW1lb3V0JywgZnVuY3Rpb24oJHRpbWVvdXQpe1xuICByZXR1cm4ge1xuICAgIHJlc3RyaWN0OiBcIkVcIixcbiAgICB0cmFuc2NsdWRlOiB0cnVlLFxuICAgIHNjb3BlOntoZWFkaW5nOlwiQFwiLHNob3c6IFwiPVwifSxcbiAgICB0ZW1wbGF0ZTogJzxkaXYgbmctY2xhc3M9XCJ7ZXhwYW5kZWQ6IHNob3csIGNvbGxhcHNlZDogIXNob3d9XCI+PGRpdiBuZy1jbGljaz1cInRvZ2dsZVBhbmUoKVwiIGNsYXNzPVwiYWNjb3JkaW9uLXRpdGxlXCI+XFxcbiAgICA8aSBjbGFzcz1cImNoZXZyb24gcmlnaHQgaWNvblwiIG5nLXNob3c9XCIhc2hvd1wiIGFsdD1cIlsrXVwiPjwvaT5cXFxuICAgIDxpIGNsYXNzPVwiY2hldnJvbiBkb3duIGljb25cIiBuZy1zaG93PVwic2hvd1wiIGFsdD1cIlstXVwiPjwvaT5cXFxuICAgICA8c3Bhbj57e2hlYWRpbmd9fTwvc3Bhbj48L2Rpdj48bmctdHJhbnNjbHVkZSBuZy1zaG93PVwic2hvd1wiPjwvbmctdHJhbnNjbHVkZT48L2Rpdj4nLFxuICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbCwgYXR0cil7XG4gICAgICBzY29wZS5zaG93ID0gZmFsc2U7XG4gICAgICAkdGltZW91dChmdW5jdGlvbigpe1xuICAgICAgICBzY29wZS50b2dnbGVQYW5lID0gZnVuY3Rpb24oKXtcbiAgICAgICAgICBzY29wZS5zaG93ID0gIXNjb3BlLnNob3c7XG4gICAgICAgIH07XG4gICAgICAgIGpRdWVyeS5leHRlbmQoalF1ZXJ5KGVsKSx7XCJ0b2dnbGVBY2NvcmRpb25cIjogZnVuY3Rpb24oKXtcbiAgICAgICAgICBzY29wZS4kYXBwbHkoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIHNjb3BlLnRvZ2dsZVBhbmUoKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfX0pO1xuICAgICAgICBzY29wZS4kb24oJyRkZXN0cm95JywgZnVuY3Rpb24oKXtcbiAgICAgICAgICAvLyBqUXVlcnkoZWwpLnBvcHVwKFwiZGVzdHJveVwiKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9XG4gIH07XG59XSk7XG4iLCJhbmd1bGFyLm1vZHVsZSgnRU1MTWFrZXInKS5kaXJlY3RpdmUoJ3N0aWNreScsIFsnJHRpbWVvdXQnLCBmdW5jdGlvbigkdGltZW91dCl7XG5cbiAgcmV0dXJuIHtcbiAgICByZXN0cmljdDogXCJBXCIsXG4gICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsLCBhdHRyKXtcbiAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICAgIGpRdWVyeShlbClcbiAgLnN0aWNreSh7XG4gICAgY29udGV4dDogJyNzdGlja3lwYXJlbnQnXG4gIH0pXG47XG5cbiAgdmFyIHJlc2l6ZVRpbWVyID0gbnVsbDtcblxuICB2YXIgUmVzaXplU3RpY2t5ID0gZnVuY3Rpb24oKXtcbiAgICByZXNpemVUaW1lciA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgIHZhciBhID0gJCgnI3JpZ2h0LXBhbmVsJyk7XG4gICAgICB2YXIgYiA9IGEuZmluZCgnLnVpLnNlY29uZGFyeS52ZXJ0aWNhbC5wb2ludGluZy5tZW51Jyk7XG4gICAgICB2YXIgYyA9IGEuZmluZCgnLm1lc3NhZ2UtYXJlYScpO1xuICAgICAgYVswXS5zdHlsZS5oZWlnaHQgPSBcIlwiO1xuICAgICAgLy8gY29uc29sZS5sb2coYS5oZWlnaHQoKSx3aW5kb3cuaW5uZXJIZWlnaHQsMjAwKTtcbiAgICAgIGlmKGFbMF0uY2xpZW50SGVpZ2h0ID4gKHdpbmRvdy5pbm5lckhlaWdodCAtICg3NSs2MCkpICl7XG4gICAgICAgIGFbMF0uc3R5bGUuaGVpZ2h0ID0gd2luZG93LmlubmVySGVpZ2h0IC0gKDc1Kzc1KSArIFwicHhcIjtcbiAgICAgICAgYlswXS5zdHlsZS5oZWlnaHQgPSBhWzBdLmNsaWVudEhlaWdodCAtIGNbMF0uY2xpZW50SGVpZ2h0ICsgXCJweFwiO1xuICAgICAgICBiLmFkZENsYXNzKCdzY3JvbGxpbmcnKTtcbiAgICAgICAgLy8gY29uc29sZS5sb2coJ3RvbyBiaWcnKTtcblxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYi5yZW1vdmVDbGFzcygnc2Nyb2xsaW5nJyk7XG4gICAgICB9XG4gICAgICBqUXVlcnkoZWwpLnN0aWNreShcInJlZnJlc2hcIik7XG5cbiAgICB9LDMwMCk7XG5cbiAgfTtcblxuXG4gICAgJCh3aW5kb3cpLm9uKCdyZXNpemUnLCBSZXNpemVTdGlja3kpO1xuICAgICQod2luZG93KS5vbignc2Nyb2xsJywgUmVzaXplU3RpY2t5KTtcblxuICAgIFJlc2l6ZVN0aWNreSgpO1xuXG4gICAgICAgIHNjb3BlLiRvbignJGRlc3Ryb3knLCBmdW5jdGlvbigpe1xuICAgICAgICAgIC8vJChlbCkucG9wdXAoXCJkZXN0cm95XCIpO1xuICAgICAgICAgICQod2luZG93KS5vZmYoJ3Jlc2l6ZScsIFJlc2l6ZVN0aWNreSk7XG4gICAgICAgICAgJCh3aW5kb3cpLm9mZignc2Nyb2xsJywgUmVzaXplU3RpY2t5KTtcbiAgICAgICAgICBqUXVlcnkoZWwpLnN0aWNreShcImRlc3Ryb3lcIik7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuICB9XG59O1xuXG5cbn1dKTtcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
